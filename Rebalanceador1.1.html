<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Portfolio Analytics — Asesor360 + Activos (HTML Only)</title>

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bbva-primary: #001391;
      --bbva-secondary: #85C8FF;
      --bbva-text: #070E46;

      --bg-main: #ffffff;
      --bg-sidebar: #f8f9fa;
      --bg-card: #ffffff;
      --border-light: #e1e4e8;
      --border-medium: #d1d5da;
      --text-primary: #070E46;
      --text-secondary: #586069;
      --text-muted: #6a737d;
      --hover-bg: #f6f8fa;
      --active-bg: #e8f0ff;
      --positive: #16a34a;
      --negative: #dc2626;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    html, body { height:100%; font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:var(--text-primary); background:var(--bg-main); font-size:14px; line-height:1.5; }

    .app-container { display:grid; grid-template-columns:260px 1fr; height:100vh; overflow:hidden; }
    .sidebar { background:var(--bg-sidebar); border-right:1px solid var(--border-light); overflow-y:auto; padding:24px 0; }
    .sidebar-header { padding:0 20px 20px; border-bottom:1px solid var(--border-light); margin-bottom:16px; }
    .sidebar-title { font-size:18px; font-weight:700; color:var(--bbva-primary); margin-bottom:4px; }
    .sidebar-subtitle { font-size:12px; color:var(--text-muted); }

    nav .tabs { 
      list-style:none; 
      padding:0; 
      display: flex;
      flex-direction: column;
    }
    .tab { 
      display: flex; 
      align-items: center; 
      gap: 12px; 
      width: 100%; 
      padding: 12px 24px; 
      background: transparent; 
      border: none; 
      border-left: 3px solid transparent; 
      color: var(--text-primary); 
      font-size: 14px; 
      font-weight: 500; 
      text-align: left; 
      cursor: pointer; 
      transition: .2s; 
      appearance: none; 
    }
    .tab:hover { background:var(--hover-bg); color:var(--bbva-primary); }
    .tab.active { background:var(--active-bg); border-left-color:var(--bbva-primary); color:var(--bbva-primary); font-weight:600; }

    /* Iconos SVG */
    .icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      color: #6b7280;
      transition: color 0.2s;
    }
    
    .tab:hover .icon {
      color: var(--bbva-primary);
    }
    
    .tab.active .icon {
      color: var(--bbva-primary);
    }
    
    .tab-child .icon {
      width: 16px;
      height: 16px;
    }

    /* Tabs tipo árbol - Reporte con subpestañas */
    .tab-label { 
      cursor: pointer;
      font-weight: 500;
      color: var(--text-primary);
      font-size: 14px;
      padding: 12px 24px;
    }
    .tab-label:hover { background: var(--hover-bg); }
    .tab-label.active { 
      background: var(--active-bg); 
      color: var(--bbva-primary);
      font-weight: 600;
    }
    
    .tab-children { 
      display: none; 
      background: transparent; 
    }
    .tab-children.show { display: block; }
    
    .tab-child {
      padding-left: 40px !important;
      font-size: 14px;
      font-weight: 500;
      position: relative;
    }
    .tab-child:hover { background: var(--hover-bg); color: var(--bbva-primary); }
    .tab-child.active { 
      background: transparent; 
      border-left-color: transparent;
      color: var(--bbva-primary);
      font-weight: 600;
    }

    /* Centro de datos pegado abajo */
    .tab[data-tab="data"] {
      margin-top: auto; /* Empuja hacia el borde inferior */
    }

    .main-content { overflow-y:auto; padding:32px; background:var(--bg-main); }
    /* Vistas: solo la .active es visible, con padding consistente */
    .view { display:none; padding: 18px; }
    .view.active { display:block; }

    .card { background:var(--bg-card); border:1px solid var(--border-light); border-radius:8px; padding:24px; margin-bottom:24px; box-shadow:0 1px 3px rgba(0,0,0,0.04); }
    .card > h2 { font-size:16px; font-weight:600; color:var(--text-primary); margin-bottom:20px; padding-bottom:12px; border-bottom:1px solid var(--border-light); }
    .card > h3 { font-size:14px; font-weight:600; color:var(--text-primary); margin-bottom:16px; padding-bottom:8px; border-bottom:1px solid var(--border-light); }
    .card .body { padding-top:8px; }
    .card .small { font-size:12px; color:var(--text-muted); margin-bottom:12px; }
    .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(7,14,70,.32); z-index:10010; }
    .modal.show { display:flex; }
    .modal .box { background:#fff; border:1px solid var(--border-light); border-radius:12px; box-shadow:0 12px 40px rgba(0,0,0,.15); padding:24px; max-width:900px; width:90%; max-height:90vh; display:flex; flex-direction:column; }
    .modal .box h3 { font-size:18px; font-weight:600; color:var(--text-primary); margin:0 0 16px; }
    .modal .box .scroll { flex:1; overflow-y:auto; padding-right:8px; }
    .modal .box .row { display:flex; gap:10px; }
    .grid { display:grid; gap:16px; }
    .grid.cols-2 { grid-template-columns:repeat(2,1fr); }
    .btn { padding:10px 20px; background:var(--bbva-primary); color:#fff; border:none; border-radius:6px; font-size:14px; font-weight:600; cursor:pointer; transition:.2s; }
    .btn:hover { opacity:.9; }
    .muted { color:var(--text-muted); }

    .client-bar { background:var(--bg-card); border:1px solid var(--border-light); border-radius:8px; padding:16px 20px; margin-bottom:24px; box-shadow:0 1px 3px rgba(0,0,0,0.04); }
    .client-bar h2 { margin:0 0 12px; font-size:14px; font-weight:600; }
    .client-bar > div { display:grid; grid-template-columns:repeat(7, 1fr); gap:16px; }
    .client-bar label { display:block; font-size:11px; font-weight:600; text-transform:uppercase; color:var(--text-muted); margin:0 0 4px; letter-spacing:.5px; }
    .client-bar input { width:100%; padding:6px 10px; border:1px solid var(--border-light); border-radius:4px; font-size:14px; }
    .client-bar select {
      padding: 6px 8px;
      height: 31px;
      line-height: 1;
      width: 100%;
      max-width: 100%;
    }
    .client-bar input[list]::-webkit-calendar-picker-indicator { 
      filter: brightness(0) invert(1);
      opacity: 1;
    }
    input[readonly]{ background:var(--bg-sidebar); color:var(--text-secondary); }

    .table-wrapper { overflow-x:auto; border:1px solid var(--border-light); border-radius:8px; max-height:900px; overflow-y:auto; }
    table { width:100%; border-collapse:collapse; font-size:13px; }
    thead { background:#E2E6EA; position:sticky; top:0; z-index:10; }
    th { padding:12px 16px; text-align:left; font-weight:600; color:#fff; border-bottom:1px solid var(--border-medium); background:#070E46; }
    #tablaPortafolioBonosUSD thead th,
    #tablaPortafolioBonosPEN thead th,
    #tablaPortafolioBonosTotal thead th { background: #CAD1D8 !important; color: #060E46 !important; }
    #tablaOperacionesBonosUSD thead th,
    #tablaOperacionesBonosPEN thead th,
    #tablaOperacionesBonosTotal thead th { background: #CAD1D8 !important; color: #060E46 !important; }
    td { padding:10px 16px; border-bottom:1px solid var(--border-light); vertical-align:middle; }
    tbody tr:nth-child(even){ background:rgba(248,249,250,0.3); }
    tbody tr:hover{ background:var(--hover-bg); }
    .left{ text-align:left; } .num{ text-align:right; } .center{ text-align:center; }
    .row-total{ background:#E2E6EA; font-weight:600; }
    .row-sub{ background:#E2E6EA; font-weight:700; }
    .row-sub td{ font-weight:700; background:#E2E6EA; }

    .subtabs { display:flex; gap:4px; margin-bottom:20px; background:var(--bg-sidebar); padding:4px; border-radius:6px; width:fit-content; }
    .subtab { padding:8px 20px; background:transparent; border:none; color:var(--text-secondary); font-size:13px; font-weight:500; cursor:pointer; border-radius:4px; transition:.2s; appearance:none; }
    .subtab.active{ background:var(--bg-card); color:var(--bbva-primary); font-weight:600; box-shadow:0 1px 3px rgba(0,0,0,0.05); }
    .subview{ display:none; } .subview.active{ display:block; }
    .subtab-content{ display:none; } .subtab-content.active{ display:block; }

    .chart-wrapper { border:1px solid var(--border-light); border-radius:8px; padding:20px; background:var(--bg-card); min-height:400px; display:flex; flex-direction:column; }
    .chart-title { font-size:14px; font-weight:600; color:var(--text-primary); margin-bottom:16px; }

    td.left, .td-nombre { max-width:260px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    /* Excepción: primera columna de tablaAmort no tiene max-width */
    #tablaAmort td:first-child { max-width: none; }

    #loaderOverlay { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(255,255,255,0.95); backdrop-filter:blur(4px); z-index:9999; }
    .loaderBox { background:var(--bg-card); border:1px solid var(--border-light); border-radius:12px; padding:32px; box-shadow:0 20px 40px rgba(0,0,0,0.1); max-width:420px; width:90%; }
    .loaderTitle { font-size:16px; font-weight:600; color:var(--text-primary); margin-bottom:16px; text-align:center; }
    .progressWrap { height:6px; background:var(--bg-sidebar); border-radius:3px; overflow:hidden; margin-bottom:12px; }
    .progressBar { height:100%; background:linear-gradient(90deg, var(--bbva-primary), var(--bbva-secondary)); border-radius:3px; width:0%; transition:width .3s ease; }
    #loaderMsg { font-size:12px; color:var(--text-muted); text-align:center; }
    select, input[type="number"], input[type="text"]{
      font-family: inherit; font-size:14px;
      padding:6px 8px; border:1px solid var(--border-light); border-radius:6px;
      background:#fff; color:var(--text-primary);
    }

    /* Modal sections */
    .secBar{
      display:flex; align-items:center;
      border-left:4px solid var(--bbva-secondary);
      padding:6px 8px; margin:6px 0 8px; font-weight:600; color:var(--text-primary);
      background:#f7f9ff; border-radius:4px;
    }
    /* Switch Toggle */
    .switch {
      position: relative;
      display: inline-block;
      width: 32px;
      height: 18px;
    }
    
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #E2E6EA;
      transition: .3s;
      border-radius: 24px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 12px;
      width: 12px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: #88E783;
    }
    
    input:checked + .slider:before {
      transform: translateX(14px);
    }
    
    input:disabled + .slider {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .formGrid{
      display:grid; grid-template-columns:180px 1fr; gap:10px 14px; align-items:center;
      max-width:900px; margin:6px 0 12px; margin-left:auto;
    }
    .formGrid label{ color:var(--text-secondary); }
    .field{ position:relative; }
    .field .prefix{
      position:absolute; left:10px; top:50%; transform:translateY(-50%);
      color:var(--text-secondary); font-weight:600;
    }

    /* Balance table */
    .tableTitle{
      background:var(--bbva-secondary); color:#fff; font-weight:700; padding:8px 12px;
      border-radius:6px 6px 0 0; margin-top:6px;
    }
    table.balance thead th{ background:#070E46; }
    .errline{ color:#dc2626; font-size:13px; margin-top:4px; }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      background:#F1F7FF;
      border:1px solid #D8E8FF;
      color:#001391;
      border-radius:999px; padding:6px 10px;
      font-weight:400; font-size:12px; line-height:1;
    }
    .pill .amount{ font-weight:800; margin-left:4px; }
    .saldoBar{
      background:#9694FF; color:#fff; display:flex; justify-content:flex-end;
      padding:10px 12px; border-radius:0 0 6px 6px;
    }
    /* === Mini‑modal: inputs de mismo ancho === */
    .formGrid select,
    .formGrid input[type="number"],
    .formGrid input[type="text"]{
      width: 100%;
    }
    .formGrid input[type="number"],
    .formGrid input[type="text"]{
      text-align: right;
    }
    .field input{
      width: 100%;
      padding-left: 26px;
    }
    .saldoBarRow .saldoLabel{
      text-align:left; border-bottom-left-radius:6px;
    }
    .saldoBarRow .saldoAmount{
      text-align:right; border-bottom-right-radius:6px;
    }
    .fxChip{
      display:inline-flex; align-items:center; gap:8px; justify-content:flex-end;
    }
    .fxDel{
      display:inline-block; 
      text-align:center; cursor:pointer; background:transparent; color:#001391;
      border:none; font-size:11px; padding:4px;
    }
    .btn-action{
      display:inline-flex; align-items:center; gap:6px;
      padding:8px 12px; border-radius:8px;
      font-weight:400; font-size:13px; cursor:pointer;
      border:1px solid transparent; background:#fff; color:var(--text-primary);
      box-shadow:0 1px 0 rgba(0,0,0,.04);
    }
    .btn-fill{
      background: var(--bbva-secondary);
      color:#0b306a;
      border-color: rgba(0,0,0,0);
    }
    .btn-outline{
      background:#fff;
      color: var(--bbva-primary);
      border-color: var(--bbva-primary);
    }
    .btn-primary{
      background: var(--bbva-primary);
      color:#fff;
      border-color: var(--bbva-primary);
    }
    .btn-action:hover{ opacity:.95; }

    /* Botón blanco con texto/borde azul (uno bajo otro) */
    .upload{
      display:block;
      background:#fff;
      color:var(--bbva-primary);
      border:1px solid var(--bbva-primary);
      border-radius:8px;
      padding:10px 14px;
      font-weight:600; font-size:14px;
      cursor:pointer;
    }
    .upload:hover{ opacity:.95; }

    /* Texto corto a la derecha del botón */
    .hint{ margin-left:6px; font-size:12px; color:var(--text-muted); }
    .hint:empty{ display:none; }

    /* Contenedor del modal + Bonos: grande, ocupa casi toda la pantalla */
    .bonos-shell{
      width: min(1620px, 98vw);
      height: 94vh;
      display: flex;
      flex-direction: column;
      background:#fff;
      border:1px solid var(--border-light);
      border-radius:12px;
      box-shadow:0 12px 40px rgba(0,0,0,.15);
      overflow: hidden;
    }

    /* Cuerpo flexible con scroll propio si hiciera falta */
    .bonos-body{
      flex: 1 1 auto;
      overflow: auto;
      padding:16px 18px;
    }

    /* Dentro del modal no limites altura de las tablas */
    #modalBonos .table-wrapper{ max-height: none; }
    #modalActivos .table-wrapper{ max-height: none; } /* igual a Bonos */

    /* === + Activos: ajuste visual para igualar + Bonos === */
    #modalActivos .bonos-shell{
      width: min(1500px, 96vw);     /* ligeramente más compacto */
      height: 92vh;                 /* ligeramente más bajo */
    }
    #modalActivos .bonos-body{ padding:12px 16px; } /* menos padding que bonos */
    /* Filtros en una sola línea (sin labels) */
    #modalActivos .filters-act{
      display:grid;
      grid-template-columns: minmax(220px,1.6fr) repeat(4, minmax(140px,1fr));
      gap:10px; margin:8px 0 10px;
      align-items:center;
    }
    @media (max-width:1280px){
      #modalActivos .filters-act{
        grid-template-columns: minmax(200px,1.4fr) repeat(4, minmax(120px,1fr));
      }
    }
    /* Columnas compactas para Añadir/Info */
    #tablaActivos th:nth-last-child(2), #tablaActivos td:nth-last-child(2){ width:110px; text-align:center; }
    #tablaActivos th:last-child,       #tablaActivos td:last-child{       width:44px;  text-align:center; }
    /* Píldora de Moneda pegada a la derecha del header */
    #modalActivos #minActTag{ margin-left:auto; }

    /* Evita que el head del modal se deforme si usas cabeceras sticky */
    #modalBonos .subtabs,
    #modalBonos .secBar{ flex:0 0 auto; }

    /* Celdas bloqueadas (bonos, cash, CTS) - desactivar cursor */
    td .locked { cursor: default; }

    /* Iconitos '-' e 'i' (look&feel compacto) */
    .icon-btn{
      display:inline-block;
      text-align:center;
      cursor:pointer;
      border:none;
      background:transparent;
      color:#060E46;
      font-weight:400;
      font-size:11px;
      padding:4px;
    }
    #miniInfo .icon-btn {
      font-size: 18px !important;
    }
    .icon-btn:hover{ box-shadow:0 1px 2px rgba(0,0,0,.06); }
    .icon-btn:focus {
      outline: none !important;
      border: none !important;
      box-shadow: none !important;
    }
    .icon-btn:active {
      outline: none !important;
      border: none !important;
      box-shadow: none !important;
    }
    
    /* Botón × en mini-modal bonos: sin cuadrado, tamaño 12px */
    #nominalesTbl button[data-del] {
      font-size: 12px !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
    }
    #nominalesTbl td:nth-last-child(2) {
      background: transparent !important;
    }
    
    /* Botón i en mini-modal bonos: tamaño 12px, sin cuadrado */
    #nominalesTbl button[data-info] {
      font-size: 12px !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
    }
    #nominalesTbl td:last-child {
      background: transparent !important;
    }

    /* Mini‑modal de Info dentro de + Bonos */
    #miniInfo{
      position:absolute; inset:0; display:none;
      align-items:center; justify-content:center;
      background:rgba(7,14,70,.12);
      z-index:10030;
    }
    #miniInfo .panel{
      width:min(520px, 85vw);
      background:#fff; border:1px solid var(--border-light);
      border-radius:10px; box-shadow:0 20px 40px rgba(0,0,0,.18);
      overflow:hidden;
    }
    #miniInfo .head{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px; border-bottom:1px solid var(--border-light);
      font-weight:600;
    }
    #miniInfo .close{
      background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;
    }
    #miniInfo .body{ padding:20px; font-size:13px; }

    /* === Mini-modal de Info de Activos (idéntico a bonos) === */
    #miniInfoAsset{
      position:fixed; inset:0; display:none;
      align-items:center; justify-content:center;
      background:rgba(7,14,70,.12); z-index:10030;
    }
    #miniInfoAsset .panel{
      width:min(680px, 92vw);
      background:#fff; border:1px solid var(--border-light);
      border-radius:10px; box-shadow:0 20px 40px rgba(0,0,0,.18);
      overflow:hidden;
    }
    #miniInfoAsset .head{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px; border-bottom:1px solid var(--border-light);
      font-weight:600;
    }
    #miniInfoAsset .close{
      background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;
    }
    #miniInfoAsset .body{ padding:12px 14px; font-size:13px; }

    /* Columnas compactas para iconitos en #nominalesTbl */
    #nominalesTbl th:last-child,
    #nominalesTbl th:nth-last-child(2),
    #nominalesTbl td:last-child,
    #nominalesTbl td:nth-last-child(2){
      width:28px;                         /* antes 36px */
      text-align:center;
    }

    /* Menús superiores (Posiciones) */
    .hold-menu{ position:relative; }
    .hold-menu .menu-panel{
      position:absolute; top:calc(100% + 6px); left:0;
      display:none; background:#fff; border:1px solid var(--border-light);
      border-radius:8px; box-shadow:0 10px 24px rgba(0,0,0,.08);
      padding:6px; min-width:200px; z-index:10050;
    }
    .hold-menu.open .menu-panel{ display:block; }
    .menu-panel .menu-item{
      display:block; width:100%; text-align:left; background:#fff;
      border:none; padding:8px 10px; border-radius:6px; cursor:pointer;
      font-size:13px; color:var(--text-primary);
    }
    .menu-panel .menu-item:hover{ background:#f7f9ff; }

    /* Botones "+Agregar …" más compactos */
    .btn-compact{ padding:6px 10px; font-size:12px; border-radius:8px; }

    /* ===== Posiciones: exact L&F de la imagen ===== */

    /* Botones grandes de la izquierda */
    #btnMgmt.btn-primary{
      background: var(--bbva-primary);       /* azul marino */
      color:#fff; border-color: var(--bbva-primary);
      padding:10px 18px; font-weight:600;
    }
    #btnProd.btn-fill{
      background: var(--bbva-secondary);     /* azul claro */
      color:#0b306a; border-color: transparent;
      padding:10px 18px; font-weight:600;
    }
    /* Igualar dimensiones de ambos botones (tomando Portfolio Mgmt como referencia) */
    #btnMgmt.menu-trigger,
    #btnProd.menu-trigger{
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
    }
    /* Asegurar que ambos botones tengan el mismo ancho */
    #btnMgmt.menu-trigger{
      min-width: 145px;
    }
    #btnProd.menu-trigger{
      min-width: 145px;
      width: 145px;
    }

    /* Chips "+Agregar …" */
    .btn-chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 12px; font-size:12px; line-height:1;
      background:#F1F7FF; color:var(--bbva-primary);
      border:1px solid #D8E8FF; border-radius:999px; cursor:pointer;
    }
    .btn-chip::before{
      content:""; width:10px; height:10px; border-radius:50%;
      background:#fff; border:2px solid var(--bbva-primary);
    }

    /* Botón "Gestión de Caja" (contorno con punto verde a la izquierda) */
    #btnCashModal.btn-outline{ background:#fff; }
    #btnCashModal.btn-outline::before{
      content:""; width:10px; height:10px; border-radius:50%;
      background:var(--positive); display:inline-block; margin-right:8px;
    }

    /* Píldoras derechas: ya coinciden con la imagen; solo refino spacing */
    .hold-topbar{ gap:12px; }
    .hold-topbar .actions{ gap:12px; flex-wrap:wrap; }
    .rightbits .pill{ margin-left:4px; }

    /* Botón "+ …" con círculo + y texto afuera */
    .btn-addplus{
      display:inline-flex; align-items:center; gap:8px;
      background:transparent; border:none; padding:0;
      color:var(--bbva-primary); font-size:13px; cursor:pointer;
    }
    .btn-addplus:focus-visible{ outline:2px solid #9CC2FF; outline-offset:3px; border-radius:12px; }

    /* Círculo */
    .btn-addplus .addplus-icon{
      width:22px; height:22px; border-radius:50%;
      display:inline-grid; place-items:center; line-height:1;
      font-weight:700; border:1px solid #85C8FF;
      background:#fff; /* se ve como en la referencia */
      color:#85C8FF;
    }
    /* Círculo con fondo celeste para Agregar Bonos y Agregar Activos */
    #btnAddBonos .addplus-icon,
    #btnAddActivos .addplus-icon{
      background:#85C8FF;
      color:#fff;
    }
    /* Hover: invierte colores del círculo */
    .btn-addplus:hover .addplus-icon{ background:var(--bbva-primary); color:#fff; border-color:var(--bbva-primary); }
    /* Hover específico para Agregar Bonos y Agregar Activos: fondo azul #001391 */
    #btnAddBonos:hover .addplus-icon,
    #btnAddActivos:hover .addplus-icon{
      background:#001391;
      border-color:#001391;
      color:#fff;
    }

    /* Texto */
    .btn-addplus .addplus-text{ white-space:nowrap; }

    /* (Opcional) un poco más de aire entre controles en la topbar */
    .hold-topbar .actions{ gap:14px; }

    /* Botón tipo "+ …" ya definido (btn-addplus).
       Variación verde para Gestión de Caja */
    .btn-addplus--cash .addplus-icon{
      background:#9694FF;
      border-color:#9694FF;
      color:#fff;            /* + en blanco */
      font-weight:700;
    }
    .btn-addplus--cash:hover .addplus-icon{
      background:var(--bbva-primary);
      border-color:var(--bbva-primary);
      color:#fff;
      filter:brightness(0.95);
    }

    /* Píldoras de Caja Disponible (USD y PEN) */
    #pillUSD, #pillPEN{
      background:#F7F8F8;
      border:1px solid #9694FF;
      color:#001391;
      border-radius:999px;
      padding:8px 12px;
      display:inline-flex; align-items:center; gap:6px;
    }
    #pillUSD .amount, #pillPEN .amount{
      color:#001391; font-weight:600;
    }

    /* Botón + compacto para filas (bolita con fondo blanco y borde azul) */
    .btn-addplus--row{ display:inline-flex; align-items:center; gap:8px; background:transparent; border:0; padding:0; color:var(--bbva-primary); font-size:12px; cursor:pointer; }
    .btn-addplus--row .addplus-icon{ width:18px; height:18px; border-radius:50%; display:inline-grid; place-items:center; line-height:1; font-weight:700; background:#fff; border:1px solid var(--bbva-primary); color:var(--bbva-primary); }
    .btn-addplus--row:hover .addplus-icon{ background:var(--bbva-primary); color:#fff; }
    .btn-addplus--row[disabled]{ opacity:.55; cursor:default; }
    .btn-addplus--row[disabled] .addplus-icon{ background:#fff; border-color:#B9C9F9; color:#8CA3E6; }

    /* Minimodales: bolita + con borde #E2E6EA */
    .btn-addplus--row .addplus-icon{
      border-color:#E2E6EA !important;
    }
    /* (opcional) mismo borde cuando esté deshabilitado */
    .btn-addplus--row[disabled] .addplus-icon{
      border-color:#E2E6EA !important;
    }

    /* Posiciones: compactar el card superior */
    #view-hold > .card:first-child{
      padding-top:12px;          /* antes 24px */
      padding-bottom:12px;       /* si ya tenías 6px, se mantiene */
    }

    /* Gap entre USD/PEN y la barra de acciones (override al inline) */
    #view-hold > .card:first-child > div:first-child{
      margin-bottom:4px !important;   /* antes 12px */
    }

    /* Gap bajo la barra de acciones (override al inline) */
    #view-hold .hold-topbar{
      margin-bottom:2px !important;   /* antes 12px */
    }

    /* Hover para "Portfolio Mgmt" y "Productos" */
    #btnMgmt.menu-trigger,
    #btnProd.menu-trigger{
      transition: background-color .15s ease, border-color .15s ease, color .15s ease;
    }

    /* Portfolio Mgmt */
    #btnMgmt.menu-trigger:hover,
    #btnMgmt.menu-trigger:focus-visible{
      background: color-mix(in srgb, var(--bbva-primary, #001391) 88%, white);
      border-color: color-mix(in srgb, var(--bbva-primary, #001391) 88%, white);
    }
    /* Productos */
    #btnProd.menu-trigger:hover,
    #btnProd.menu-trigger:focus-visible{
      background: color-mix(in srgb, var(--bbva-secondary, #8FC8FF) 88%, white);
    }

    /* Mantener color cuando el menú está abierto */
    #menuMgmt.open > .menu-trigger{
      background: color-mix(in srgb, var(--bbva-primary, #001391) 88%, white);
      border-color: color-mix(in srgb, var(--bbva-primary, #001391) 88%, white);
    }
    #menuProd.open > .menu-trigger{
      background: color-mix(in srgb, var(--bbva-secondary, #8FC8FF) 88%, white);
    }

    /* Fallback si el navegador no soporta color-mix */
    @supports not (color-mix(in srgb, black, white)){
      #btnMgmt.menu-trigger:hover,
      #btnMgmt.menu-trigger:focus-visible,
      #menuMgmt.open > .menu-trigger{ filter: brightness(1.07); }
      #btnProd.menu-trigger:hover,
      #btnProd.menu-trigger:focus-visible,
      #menuProd.open > .menu-trigger{ filter: brightness(1.07); }
    }

    /* === Portafolios Modelo → PM (subcategorías) === */
    .pm-toggle {
      display:inline-block; margin-right:8px; cursor:pointer; user-select:none;
    }
    .pm-detail { display:none; }
    .pmTable { width:100%; border-collapse:collapse; margin-top:6px; }
    .pmTable thead th { background:#E2E6EA; color:#070E46; }
    .pmTable th, .pmTable td { padding:8px 10px; border-bottom:1px solid var(--border-light); }
    .pmTable .num { text-align:right; }
    .pmTable .small { font-size:12px; color:var(--text-muted); }
    .pmTable .pm-otros-select { min-width:200px; }

    /* Botones de carga CSV en modal */
    .btn-csv-load{
      background:#fff;
      border:1px solid var(--bbva-primary);
      color:var(--bbva-primary);
      transition: background-color .15s ease;
    }
    .btn-csv-load.loaded{
      background:#f5f5f5;
      border-color:#d1d5da;
      color:var(--text-primary);
    }

    /* Portafolios Modelo — igual look&feel que Posiciones (tabla plana) */

    /* ===== Mini-modal Portafolios Modelo: scroll vertical ===== */
    #modalModelos .modal-content{
      display:flex; flex-direction:column;
      max-height: 92vh;
    }

    #modalModelos .modal-header,
    #modalModelos .modal-footer{ flex:0 0 auto; }

    #modalModelos .modal-body{
      flex:1 1 auto; min-height:0; /* clave para que el hijo pueda scrollear */
      overflow: hidden;            /* el scroll lo hace la table-wrapper */
    }

    /* === Portafolios Modelo: tabla PLANA como Posiciones === */
    #modalModelos .table-wrapper{
      overflow-y:auto; overflow-x:auto;
      max-height:70vh;
      margin:0 18px 18px 18px !important;
      -webkit-overflow-scrolling:touch;
    }

    #modalModelos thead th{ position: sticky; top: 0; z-index: 2; }

    /* Fila de CLASE (igual a subtotales de Posiciones) */
    #modalModelos tr.row-sub td{
      background:#E2E6EA;
      font-weight:700;
    }

    /* Subfilas (PM) como filas normales, solo con sangría */
    #modalModelos tr.pmSubRow td{
      background:#fff;
      padding-left:24px;
    }

    /* Asegura que NO haya tabla anidada ni bloques */
    #modalModelos .pmTable,
    #modalModelos .pm-detail{ display:none !important; }

    /* Filtros del gráfico de Portafolios Modelo */
    #mmViewChart .filter-bar{
      display:flex; flex-direction:column; gap:6px; margin:8px 0 12px;
    }
    #mmViewChart .filter-bar .row{
      display:flex; flex-wrap:wrap; gap:12px; align-items:center;
    }
    #mmViewChart .filter-bar label{
      display:inline-flex; align-items:center; gap:6px; font-size:12px;
      padding:4px 8px; border:1px solid #e3e7ef; border-radius:8px; background:#fff;
    }

    /* Portafolios Modelo — vista GRÁFICO con el mismo alto que la tabla */
    #mmViewChart { display:flex; flex-direction:column; min-height:0; }
    #mmViewChart .chart-wrapper{
      flex:1 1 auto;
      height:70vh;             /* igual que la tabla (max-height:70vh) */
      max-height:70vh;
      margin:0 18px 18px 18px; /* mismo margen que la tabla */
    }

    /* Subtotal de subclase (debajo del subtotal de clase) */
    .row-sub2 td{
      background:#F3F5FF;
      font-weight:600;
    }
    .indent-1 td { padding-left: 16px; }
    .indent-2 td { padding-left: 28px; }

    /* Headers pegados para las 3 tablas del cronograma */
    #tablaCompra thead th,
    #tablaCupones thead th,
    #tablaAmort thead th{
      position: sticky; top: 0; z-index: 3;
      background: var(--tbl-head-bg, #060E46) !important;
      color: var(--tbl-head-fg, #fff) !important;
      border-bottom: 2px solid var(--tbl-head-bg, #060E46) !important;
      font-weight: 700 !important;
      text-transform: uppercase !important;
      letter-spacing: .5px !important;
    }

    /* Celdas comunes */
    #tablaCompra, #tablaCupones, #tablaAmort{
      table-layout: fixed; width: 100%; font-size: 13px; border-collapse: collapse;
    }
    #tablaCupones{
      table-layout: auto; /* Cambiar a auto para mejor distribución de espacio */
      font-size: 12px; /* Tamaño de fuente para toda la tabla */
    }
    #tablaCompra th, #tablaCompra td,
    #tablaCupones th, #tablaCupones td,
    #tablaAmort th, #tablaAmort td{
      padding: 9px; border-bottom: 1px solid var(--line, #CAD1D8);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    /* Excepción: tablaAmort permite wrap */
    #tablaAmort th, #tablaAmort td {
      white-space: normal;
      overflow: visible;
      text-overflow: clip;
    }
    #tablaCompra td.left, #tablaCupones td.left, #tablaAmort td.left{ text-align: left; }
    #tablaCompra td.num, #tablaAmort td.num{ text-align: right; }
    #tablaCupones td.num{ text-align: center; }
    #tablaAmort th.center, #tablaAmort td.center{ text-align: center; }

    /* Amortizaciones: encabezado de bloque por bono / emisión */
    #tablaAmort .amortGroupHead td{
      background: #CAD1D8 !important; font-weight: 700; border-top: 2px solid var(--line, #CAD1D8); padding-top: 10px;
    }
    /* Alternado visual por grupo (por si lo usas) */
    #tablaAmort tr.grpA td { background: transparent; }
    #tablaAmort tr.grpB td { background: var(--surface-2, #F3F4F6); }
    #tablaAmort tr.grpNo td{ background: #ffffff !important; }
    
    /* Anchos específicos para tabla de amortizaciones */
    #tablaAmort {
      table-layout: fixed;
    }
    #tablaAmort th:first-child,
    #tablaAmort td:first-child {
      width: 30%; /* Un poco más de espacio para INSTRUMENTO */
      max-width: none;
      white-space: normal;
      word-wrap: break-word;
    }
    #tablaAmort th:not(:first-child),
    #tablaAmort td:not(:first-child) {
      width: calc(70% / 6); /* Resto de columnas con el mismo ancho (6 columnas) */
      white-space: normal;
      word-wrap: break-word;
    }
    /* Permitir que los títulos de columna se envuelvan */
    #tablaAmort thead th {
      white-space: normal;
      word-wrap: break-word;
      line-height: 1.3;
    }

    /* Estilos para tabla de cupones */
    #tablaCupones thead th{ position:sticky; top:0; z-index:3; }
    #tablaCupones tfoot td{ font-weight:700; }
    #tablaCupones tr:last-child td{ border-bottom:0; }
    
    /* Ajustes de tamaño y espacio para Cupones (12 meses) */
    #tablaCupones thead th.left{ 
      font-size: 12px; 
      min-width: 200px; 
      width: auto; 
    }
    #tablaCupones thead th.num{ 
      font-size: 12px; 
      padding: 6px 4px; 
      min-width: 60px; 
      width: auto; 
      text-align: center; 
    }
    #tablaCupones td.left{ 
      font-size: 13px;
      min-width: 200px; 
      width: auto; 
    }
    #tablaCupones td.num{ 
      font-size: 13px; 
      padding: 6px 4px; 
      min-width: 60px; 
      width: auto; 
    }
    #tablaCupones tbody td,
    #tablaCupones tfoot td{
      font-size: 13px;
    }

    /* === Subpestañas del Reporte === */
    #view-reporte .rep-subtabs{
      position: sticky; top: 0; z-index: 5;
      display:flex; align-items:center; gap:10px;
      background: var(--surface, #fff);
      border-bottom: 1px solid var(--line, #e6e9ef);
      margin: -6px -6px 12px; padding: 6px; /* igual que otras cards */
    }
    #view-reporte .rep-subtabs .subtab{
      appearance:none; border:1px solid var(--line, #CAD1D8);
      background:var(--surface-2, #f5f5f5); color:var(--text-muted, #666);
      border-radius:12px 12px 0 0; cursor:pointer;
      font-weight:800; letter-spacing:.2px;
      padding:10px 18px;
    }
    #view-reporte .rep-subtabs .subtab.active{
      background:linear-gradient(180deg,var(--surface, #fff),var(--surface-2, #f5f5f5));
      color:var(--text-primary, #000);
    }
    #view-reporte .rep-subtabs .spacer{ flex:1; }
    #view-reporte .repPane{ display:none; }
    #view-reporte .repPane.active{ display:block; }

    /* === TODAS LAS VISTAS: mismo patrón que Dashboard/Posiciones === */
    .view{ display:none; padding:18px; }
    .view.active{ display:block; }

    /* === REPORTE y CENTRO DE DATOS: impedir que algo los saque del flujo === */
    #view-reporte, #view-datos, #view-data{
      position: static !important; /* por si heredaron fixed/absolute */
      inset: auto !important;
    }

    /* Subtabs del Reporte: arriba, pegadas como las otras barras */
    #view-reporte .rep-subtabs{
      position: sticky; top: 0; z-index: 5;
      display:flex; align-items:center; gap:10px;
      background: var(--surface, #fff);
      border-bottom: 1px solid var(--line, #e6e9ef);
      padding: 6px; margin: -6px -6px 12px;
    }

    /* Cualquier barra inferior accidental dentro de estas vistas pasa a flujo normal */
    #view-reporte [class*="actionbar"], #view-datos [class*="actionbar"], #view-data [class*="actionbar"],
    #view-reporte [class*="footer"],    #view-datos [class*="footer"],    #view-data [class*="footer"]{
      position: static !important;
      bottom: auto !important; left: auto !important; right: auto !important;
      width: auto !important;
      margin-top: 12px;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">Portfolio Analytics</div>
        <div class="sidebar-subtitle">BBVA Global Wealth</div>
      </div>
      <nav>
        <div class="tabs">
          <button class="tab active" data-tab="conf">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7" rx="1"/>
              <rect x="14" y="3" width="7" height="7" rx="1"/>
              <rect x="14" y="14" width="7" height="7" rx="1"/>
              <rect x="3" y="14" width="7" height="7" rx="1"/>
            </svg>
            <span>Dashboard</span>
          </button>
          <button class="tab" data-tab="hold">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="17 1 21 5 17 9"/>
              <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
              <polyline points="7 23 3 19 7 15"/>
              <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
            </svg>
            <span>Rebalanceo de Portafolio</span>
          </button>
          
          <!-- Reporte con subpestañas -->
          <button class="tab tab-label" id="tabReporte">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10 9 9 9 8 9"/>
            </svg>
            <span>Reporte</span>
          </button>
          <div class="tab-children show">
            <button class="tab tab-child" data-tab="portafolio">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="20" x2="12" y2="10"></line>
                <line x1="18" y1="20" x2="18" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="16"></line>
              </svg>
              <span>Portafolio Final</span>
            </button>
            <button class="tab tab-child" data-tab="renta-variable">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
              </svg>
              <span>Renta Variable</span>
            </button>
            <button class="tab tab-child" data-tab="renta-fija">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
              </svg>
              <span>Renta Fija</span>
            </button>
            <button class="tab tab-child" data-tab="reporte">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
              <span>Cronograma de Pagos</span>
            </button>
          </div>
          
          <button class="tab" data-tab="data">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <ellipse cx="12" cy="5" rx="9" ry="3"/>
              <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
              <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
            </svg>
            <span>Centro de Datos</span>
          </button>
        </div>
      </nav>
    </aside>

    <main class="main-content">
      <!-- Loader -->
      <div id="loaderOverlay">
        <div class="loaderBox">
          <div class="loaderTitle">Procesando…</div>
          <div class="progressWrap"><div class="progressBar" id="progressBar"></div></div>
          <div class="loaderMsg" id="loaderMsg">Leyendo CSV…</div>
        </div>
      </div>

      <!-- ============ Dashboard ============ -->
      <section id="view-conf" class="view active">

        <div class="client-bar">
          <h2>DATOS DEL CLIENTE</h2>
          <div>
            <div>
              <label for="codigo">Código</label>
              <input id="codigo" type="text" maxlength="8" placeholder="00001234" list="codigosCliente" required />
              <datalist id="codigosCliente"></datalist>
            </div>
            <div>
              <label>Perfil</label>
              <select id="perfil">
                <option value="">-- Seleccionar --</option>
              </select>
            </div>
            <div>
              <label>Banca</label>
              <input id="banca" type="text" readonly />
            </div>
            <div>
              <label>Banquero</label>
              <input id="banquero" type="text" readonly />
            </div>
            <div>
              <label>Asesor</label>
              <input id="asesor" type="text" readonly />
            </div>
            <div>
              <label>Fecha de datos</label>
              <input id="fechaDatosInput" type="text" readonly />
            </div>
            <div>
              <label>Tipo de Cambio</label>
              <input id="tipoCambio" type="text" readonly />
            </div>
          </div>
        </div>

        <div class="card" style="min-height:auto;margin-bottom:10px;">
          <h2>ASIGNACIÓN POR CLASE DE ACTIVO</h2>
          <div class="table-wrapper">
            <table id="tablaGuiaConsolidada">
              <thead>
                <tr>
                  <th class="left">Clase de Activo</th>
                  <th class="num">Monto USD</th>
                  <th class="num">Monto PEN</th>
                  <th class="num">Total Dolarizado</th>
                  <th class="num">Peso</th>
                </tr>
              </thead>
              <tbody id="tablaGuiaBodyConsolidada"></tbody>
            </table>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <div class="card">
            <h2 class="chart-title">DISTRIBUCIÓN POR CLASE DE ACTIVO (%)</h2>
            <div class="chart-wrapper" style="height:500px">
              <canvas id="aaCanvasGrouped"></canvas>
            </div>
          </div>
          <div class="card">
            <h2 class="chart-title">DISTRIBUCIÓN POR MONEDA (%)</h2>
            <div class="chart-wrapper" style="height:500px">
              <canvas id="aaCanvasDonut"></canvas>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ Rebalanceo de Portafolio ============ -->
      <section id="view-hold" class="view">
        <div class="card" style="min-height:auto">
          <!-- Primera línea: Subtabs USD/PEN -->
          <div style="margin-bottom:12px;">
          <div class="subtabs" id="hold-subtabs">
            <button class="subtab active" data-sub="hold-usd">USD</button>
            <button class="subtab" data-sub="hold-pen">PEN</button>
            <button class="subtab" data-sub="hold-total">Consolidado</button>
            </div>
          </div>

          <!-- Segunda línea: Acciones (izq) + Píldoras (der) -->

          <div class="hold-topbar" style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;">



            <!-- Izquierda: menus + botones compactos -->

            <div class="actions" style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">



              <!-- Portfolio Mgmt (NO es modal: abre 2 opciones) -->

              <div class="hold-menu" id="menuMgmt">

                <button class="btn-action btn-primary menu-trigger" id="btnMgmt">Portfolio Mgmt</button>

                <div class="menu-panel">

                  <button class="menu-item" id="btnBalance">Asset Allocation</button>

                  <button class="menu-item" id="btnModelos">Portafolios Modelo</button>

                  <button class="menu-item" id="btnMaturity">Maturity Wall</button>

                  <button class="menu-item" id="btnLimites">Límites de Concentración</button>

                </div>

              </div>



              <!-- Productos (abre 2 minimodales) -->

              <div class="hold-menu" id="menuProd">

                <button class="btn-action btn-fill menu-trigger" id="btnProd">Productos</button>

                <div class="menu-panel">

                  <button class="menu-item" id="btnMatrizBono">Matriz Bonos</button>

                  <button class="menu-item" id="btnCurvaDPF">Curva DPF</button>

                </div>

              </div>



              <!-- Botones compactos: Agregar -->

              <button id="btnAddBonos" class="btn-addplus">
                <span class="addplus-icon" aria-hidden="true">+</span>
                <span class="addplus-text">Agregar Bonos</span>
              </button>

              <button id="btnAddActivos" class="btn-addplus">
                <span class="addplus-icon" aria-hidden="true">+</span>
                <span class="addplus-text">Agregar Activos</span>
              </button>

            </div>



            <!-- Derecha: botón Gestión + píldoras -->

            <div class="rightbits" style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">

              <button id="btnCashModal" class="btn-addplus btn-addplus--cash">
                <span class="addplus-icon" aria-hidden="true">+</span>
                <span class="addplus-text">Gestión de Caja</span>
              </button>

              <div id="pillUSD"     class="pill">Caja Disponible: <span id="cashUSD" class="amount"> - </span></div>

              <div id="pillPEN"     class="pill" style="display:none;">Caja Disponible: <span id="cashPEN" class="amount"> - </span></div>

            </div>

          </div>
          </div>

          <!-- USD -->
          <div id="subview-hold-usd" class="subview active">
            <div class="table-wrapper">
              <table id="tablaHoldUSD">
                <colgroup>
                  <col style="width:18%"><col style="width:9%"><col style="width:10%"><col style="width:6%"><col style="width:8%"><col style="width:5%"><col style="width:7%"><col style="width:8%"><col style="width:7%"><col style="width:9%"><col style="width:2%"><col style="width:2%">
                </colgroup>
                <thead>
                  <tr>
                    <th class="left" rowspan="2">Nombre</th>
                    <th rowspan="2">Vehículo</th>
                    <th rowspan="2">Subclasificación</th>
                    <th class="center" rowspan="2">Fecha<br>Compra</th>
                    <th class="center" rowspan="2">Valor<br>Mercado</th>
                    <th class="center" rowspan="2">Peso<br>Inicial</th>
                    <th class="center" rowspan="2">Monto<br>Prendado</th>
                    <th class="center" rowspan="2">Monto<br>Final</th>
                    <th class="center" rowspan="2">Peso<br>Final</th>
                    <th class="center" rowspan="2">Rebalanceo</th>
                    <th class="center" rowspan="2" style="width:3px;"></th>
                    <th class="center" rowspan="2" style="width:3px;">!</th>
                  </tr>
                </thead>
                <tbody id="holdBodyUSD"></tbody>
              </table>
            </div>
          </div>

          <!-- PEN -->
          <div id="subview-hold-pen" class="subview">
            <div class="table-wrapper">
              <table id="tablaHoldPEN">
                <colgroup>
                  <col style="width:18%"><col style="width:9%"><col style="width:10%"><col style="width:6%"><col style="width:8%"><col style="width:5%"><col style="width:7%"><col style="width:8%"><col style="width:7%"><col style="width:9%"><col style="width:2%"><col style="width:2%">
                </colgroup>
                <thead>
                  <tr>
                    <th class="left" rowspan="2">Nombre</th>
                    <th rowspan="2">Vehículo</th>
                    <th rowspan="2">Subclasificación</th>
                    <th class="center" rowspan="2">Fecha<br>Compra</th>
                    <th class="center" rowspan="2">Valor<br>Mercado</th>
                    <th class="center" rowspan="2">Peso<br>Inicial</th>
                    <th class="center" rowspan="2">Monto<br>Prendado</th>
                    <th class="center" rowspan="2">Monto<br>Final</th>
                    <th class="center" rowspan="2">Peso<br>Final</th>
                    <th class="center" rowspan="2">Rebalanceo</th>
                    <th class="center" rowspan="2" style="width:3px;"></th>
                    <th class="center" rowspan="2" style="width:3px;">!</th>
                  </tr>
                </thead>
                <tbody id="holdBodyPEN"></tbody>
              </table>
            </div>
          </div>
          <div id="subview-hold-total" class="subview">
            <div class="table-wrapper">
              <table id="tablaHoldTotal">
                <colgroup>
                  <col style="width:18%"><col style="width:9%"><col style="width:10%"><col style="width:6%"><col style="width:8%"><col style="width:5%"><col style="width:7%"><col style="width:8%"><col style="width:7%"><col style="width:9%"><col style="width:2%"><col style="width:2%">
                </colgroup>
                <thead>
                  <tr>
                    <th class="left" rowspan="2">Nombre</th>
                    <th rowspan="2">Vehículo</th>
                    <th rowspan="2">Subclasificación</th>
                    <th class="center" rowspan="2">Fecha<br>Compra</th>
                    <th class="center" rowspan="2">Valor<br>Mercado</th>
                    <th class="center" rowspan="2">Peso<br>Inicial</th>
                    <th class="center" rowspan="2">Monto<br>Prendado</th>
                    <th class="center" rowspan="2">Monto<br>Final</th>
                    <th class="center" rowspan="2">Peso<br>Final</th>
                    <th class="center" rowspan="2">Rebalanceo</th>
                    <th class="center" rowspan="2" style="width:3px;"></th>
                    <th class="center" rowspan="2" style="width:3px;">!</th>
                  </tr>
                </thead>
                <tbody id="holdBodyTotal"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- === REPORTE (con sub-pestañas) === -->
      <section id="view-reporte" class="view">
        <div class="card">
          <div class="body">
            <!-- Panes -->
            <div id="repPanes">
              <div id="repPane-crono" class="repPane active">
                <!-- Aquí va el contenido del cronograma que hoy tienes en el modal -->
                <!-- Subtabs USD/PEN -->
                <div style="margin-bottom:12px;">
                  <div class="subtabs" id="crono-subtabs">
                  <button class="subtab active" data-sub="crono-usd">USD</button>
                  <button class="subtab" data-sub="crono-pen">PEN</button>
                  <button class="subtab" data-sub="crono-total">Consolidado</button>
                  </div>
                </div>
                <div class="card" id="crono-seccion-cupones">
                  <h3 style="padding:10px 12px">CUPONES PRÓXIMOS 12 MESES</h3>
                  <div class="body">
                    <div class="table-wrapper">
                      <table id="tablaCupones">
                        <thead>
                          <tr>
                            <th class="left">Instrumento</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                        <tfoot></tfoot>
                      </table>
                    </div>
                  </div>
                </div>

                <div class="card" id="crono-seccion-amort" style="margin-top:12px">
                  <h3 style="padding:10px 12px">AMORTIZACIONES Y VENCIMIENTOS</h3>
                  <div class="body">
                    <div class="table-wrapper">
                      <table id="tablaAmort">
                        <thead>
                          <tr>
                            <th class="left">INSTRUMENTO</th>
                            <th class="left">Tipo de Activo</th>
                            <th class="left">Concepto</th>
                            <th class="center">Fecha Pago</th>
                            <th class="center">% Amortizado</th>
                            <th class="center">Monto Amortizado</th>
                            <th class="center">Valor nominal remanente</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>
                    <div class="small" style="margin-top:6px">
                      <em>Fechas referenciales; si no hay calendario/frecuencia, se asume semestral (ajustable en código).</em>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Ejemplo de otros panes, por ahora vacíos (para crecer luego) -->
              <div id="repPane-port"  class="repPane" style="display:none"></div>
              <div id="repPane-rf"    class="repPane" style="display:none"></div>
              <div id="repPane-rv"    class="repPane" style="display:none"></div>
              <div id="repPane-anx"   class="repPane" style="display:none"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ Portafolio ============ -->
      <section id="view-portafolio" class="view">
        <div class="card" style="min-height:auto">
          <!-- Header con título y botón descarga -->
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <div class="subtabs" id="portafolio-subtabs">
              <button class="subtab active" data-sub="portafolio-usd">USD</button>
              <button class="subtab" data-sub="portafolio-pen">PEN</button>
              <button class="subtab" data-sub="portafolio-total">Consolidado</button>
            </div>
            <button id="btnDescargarReporte" onclick="descargarReportePDF()" style="background: #001391; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-family: 'Lato', sans-serif; font-size: 14px; display: flex; align-items: center; gap: 8px;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Descargar Reporte
            </button>
          </div>
          
          <!-- Contenido USD -->
          <div id="portafolio-usd" class="subtab-content active">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Vehículo</th>
                    <th class="left">Subclasificación</th>
                    <th class="center">Monto</th>
                    <th class="center">Peso</th>
                    <th class="center">Rebalanceo</th>
                  </tr>
                </thead>
                <tbody id="portafolioBodyUSD"></tbody>
              </table>
            </div>
            
            <!-- Gráficos: AA1 y Maturity lado a lado, AA2 horizontal abajo -->
            <div style="display: flex; flex-direction: column; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Fila superior: AA1 y Maturity lado a lado -->
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                <div>
                  <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">ASSET ALLOCATION NIVEL 1 (%)</h3>
                  <div class="chart-wrapper" style="height:360px">
                    <canvas id="sectoresPFChartUSD"></canvas>
                  </div>
                </div>
                <div>
                  <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">MATURITY WALL</h3>
                  <div class="chart-wrapper" style="height:360px">
                    <canvas id="maturityWallPFChartUSD"></canvas>
                  </div>
                </div>
              </div>
              <!-- Fila inferior: AA2 horizontal ocupando todo el ancho -->
              <div>
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">ASSET ALLOCATION NIVEL 2 (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="assetAllocationL2ChartUSD"></canvas>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Contenido PEN -->
          <div id="portafolio-pen" class="subtab-content">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Vehículo</th>
                    <th class="left">Subclasificación</th>
                    <th class="center">Monto</th>
                    <th class="center">Peso</th>
                    <th class="center">Rebalanceo</th>
                  </tr>
                </thead>
                <tbody id="portafolioBodyPEN"></tbody>
              </table>
            </div>
            
            <!-- Gráficos: AA1 y Maturity lado a lado, AA2 horizontal abajo -->
            <div style="display: flex; flex-direction: column; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Fila superior: AA1 y Maturity lado a lado -->
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                <div>
                  <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">ASSET ALLOCATION NIVEL 1 (%)</h3>
                  <div class="chart-wrapper" style="height:360px">
                    <canvas id="sectoresPFChartPEN"></canvas>
                  </div>
                </div>
                <div>
                  <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">MATURITY WALL</h3>
                  <div class="chart-wrapper" style="height:360px">
                    <canvas id="maturityWallPFChartPEN"></canvas>
                  </div>
                </div>
              </div>
              <!-- Fila inferior: AA2 horizontal ocupando todo el ancho -->
              <div>
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">ASSET ALLOCATION NIVEL 2 (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="assetAllocationL2ChartPEN"></canvas>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Contenido Total -->
          <div id="portafolio-total" class="subtab-content">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Vehículo</th>
                    <th class="left">Subclasificación</th>
                    <th class="center">Monto</th>
                    <th class="center">Peso</th>
                    <th class="center">Rebalanceo</th>
                  </tr>
                </thead>
                <tbody id="portafolioBodyTotal"></tbody>
              </table>
            </div>
            
            <!-- Gráficos: AA1 y Maturity lado a lado, AA2 horizontal abajo -->
            <div style="display: flex; flex-direction: column; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Fila superior: AA1 y Maturity lado a lado -->
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                <div>
                  <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">ASSET ALLOCATION NIVEL 1 (%)</h3>
                  <div class="chart-wrapper" style="height:360px">
                    <canvas id="sectoresPFChartTotal"></canvas>
                  </div>
                </div>
                <div>
                  <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">MATURITY WALL</h3>
                  <div class="chart-wrapper" style="height:360px">
                    <canvas id="maturityWallPFChartTotal"></canvas>
                  </div>
                </div>
              </div>
              <!-- Fila inferior: AA2 horizontal ocupando todo el ancho -->
              <div>
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">ASSET ALLOCATION NIVEL 2 (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="assetAllocationL2ChartTotal"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ Renta Fija ============ -->
      <section id="view-renta-fija" class="view">
        <div class="card" style="min-height:auto">
          <!-- Subtabs USD/PEN -->
          <div style="margin-bottom:12px;">
            <div class="subtabs" id="renta-fija-subtabs">
              <button class="subtab active" data-sub="renta-fija-usd">USD</button>
              <button class="subtab" data-sub="renta-fija-pen">PEN</button>
              <button class="subtab" data-sub="renta-fija-total">Consolidado</button>
            </div>
          </div>
          
          <!-- Contenido USD -->
          <div id="renta-fija-usd" class="subtab-content active">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Región</th>
                    <th class="left">Subclasificación</th>
                    <th class="left">Exposición</th>
                    <th class="center" style="width: 70px;">Vol</th>
                    <th class="center" style="width: 100px;">Patrimonio (mm)</th>
                    <th class="center" style="width: 80px;">N. Holdings</th>
                    <th class="center">Rating</th>
                    <th class="center">Dur.</th>
                    <th class="center">YTW</th>
                    <th class="center">Peso</th>
                  </tr>
                </thead>
                <tbody id="rentaFijaBodyUSD"></tbody>
              </table>
            </div>
            
            <!-- Gráficos de Ratings y Sectores USD (lado a lado) -->
            <div style="display: flex; gap: 24px; margin-top: 32px; margin-bottom: 16px;">
              <!-- Ratings -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR RATING (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="ratingsChartUSD"></canvas>
                </div>
              </div>
              <!-- Sectores -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SECTOR (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="sectoresChartUSD"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Gráficos de Subclasificación y Región USD (lado a lado) -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Región -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DURACIÓN VS YTW</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="scatterRFChartUSD"></canvas>
                </div>
              </div>
              <!-- Subclasificación -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SUBCLASIFICACIÓN (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="subclasificacionChartUSD"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Nueva tabla: Portafolio Bonos USD -->
            <div style="margin-top: 24px;">
              <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391;">Portafolio Bonos</h3>
              <div class="table-wrapper">
                <table class="data-table" id="tablaPortafolioBonosUSD">
                  <thead style="background: #CAD1D8; color: #060E46;">
                    <tr>
                      <th class="left" style="width: 90px;">Bono</th>
                      <th class="left" style="width: 160px;">Emisor</th>
                      <th class="center" style="width: 80px;">F. Call</th>
                      <th class="center" style="width: 55px;">Rating</th>
                      <th class="center" style="width: 50px;">Dur.</th>
                      <th class="center" style="width: 55px;">YTW</th>
                      <th class="center" style="width: 65px;">Precio Últ.<br>Compra</th>
                      <th class="center" style="width: 65px;">Precio<br>Mercado</th>
                      <th class="center" style="width: 90px;">Valor<br>Nominal</th>
                      <th class="center" style="width: 85px;">Intereses<br>Corridos</th>
                      <th class="center" style="width: 95px;">Valor de<br>Mercado</th>
                      <th class="center" style="width: 85px;">Fecha Últ.<br>Compra</th>
                      <th class="center" style="width: 85px;">Cupones<br>Cobrados</th>
                    </tr>
                  </thead>
                  <tbody id="portafolioBondosBodyUSD"></tbody>
                </table>
              </div>
            </div>
            
            <!-- Nueva tabla: Operaciones Bonos USD -->
            <div id="operacionesBonosUSDContainer" style="margin-top: 24px; display: none;">
              <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391;">Operaciones Bonos</h3>
              <div class="table-wrapper">
                <table class="data-table" id="tablaOperacionesBonosUSD">
                  <thead style="background: #CAD1D8; color: #060E46;">
                    <tr>
                      <th class="left" style="width: 90px;">Bono</th>
                      <th class="left" style="width: 160px;">Emisor</th>
                      <th class="center" style="width: 85px;">Fecha Últ.<br>Compra</th>
                      <th class="center" style="width: 55px;">Rating</th>
                      <th class="center" style="width: 50px;">Dur.</th>
                      <th class="center" style="width: 55px;">YTW</th>
                      <th class="center" style="width: 65px;">Precio<br>Compra</th>
                      <th class="center" style="width: 65px;">Precio<br>Mercado</th>
                      <th class="center" style="width: 90px;">VN<br>Operado</th>
                      <th class="center" style="width: 85px;">Intereses<br>Corridos</th>
                      <th class="center" style="width: 95px;">Monto<br>Total</th>
                      <th class="center" style="width: 85px;">Cupones<br>Cobrados</th>
                      <th class="center" style="width: 60px;">Tipo</th>
                    </tr>
                  </thead>
                  <tbody id="operacionesBonosBodyUSD"></tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- Contenido PEN -->
          <div id="renta-fija-pen" class="subtab-content">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Región</th>
                    <th class="left">Subclasificación</th>
                    <th class="left">Exposición</th>
                    <th class="center" style="width: 70px;">Vol</th>
                    <th class="center" style="width: 100px;">Patrimonio (mm)</th>
                    <th class="center" style="width: 80px;">N. Holdings</th>
                    <th class="center">Rating</th>
                    <th class="center">Dur.</th>
                    <th class="center">YTW</th>
                    <th class="center">Peso</th>
                  </tr>
                </thead>
                <tbody id="rentaFijaBodyPEN"></tbody>
              </table>
            </div>
            
            <!-- Gráficos de Ratings y Sectores PEN (lado a lado) -->
            <div style="display: flex; gap: 24px; margin-top: 32px; margin-bottom: 16px;">
              <!-- Ratings -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR RATING (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="ratingsChartPEN"></canvas>
                </div>
              </div>
              <!-- Sectores -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SECTOR (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="sectoresChartPEN"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Gráficos de Subclasificación y Región PEN (lado a lado) -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Región -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DURACIÓN VS YTW</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="scatterRFChartPEN"></canvas>
                </div>
              </div>
              <!-- Subclasificación -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SUBCLASIFICACIÓN (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="subclasificacionChartPEN"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Nueva tabla: Portafolio Bonos PEN -->
            <div style="margin-top: 24px;">
              <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391;">Portafolio Bonos</h3>
              <div class="table-wrapper">
                <table class="data-table" id="tablaPortafolioBonosPEN">
                  <thead style="background: #CAD1D8; color: #060E46;">
                  <tr>
                      <th class="left" style="width: 90px;">Bono</th>
                      <th class="left" style="width: 160px;">Emisor</th>
                      <th class="center" style="width: 80px;">F. Call</th>
                      <th class="center" style="width: 55px;">Rating</th>
                      <th class="center" style="width: 50px;">Dur.</th>
                      <th class="center" style="width: 55px;">YTW</th>
                      <th class="center" style="width: 65px;">Precio Últ.<br>Compra</th>
                      <th class="center" style="width: 65px;">Precio<br>Mercado</th>
                      <th class="center" style="width: 90px;">Valor<br>Nominal</th>
                      <th class="center" style="width: 85px;">Intereses<br>Corridos</th>
                      <th class="center" style="width: 95px;">Valor de<br>Mercado</th>
                      <th class="center" style="width: 85px;">Fecha Últ.<br>Compra</th>
                      <th class="center" style="width: 85px;">Cupones<br>Cobrados</th>
                    </tr>
                  </thead>
                  <tbody id="portafolioBondosBodyPEN"></tbody>
                </table>
              </div>
            </div>
            
            <!-- Nueva tabla: Operaciones Bonos PEN -->
            <div id="operacionesBonosPENContainer" style="margin-top: 24px; display: none;">
              <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391;">Operaciones Bonos</h3>
              <div class="table-wrapper">
                <table class="data-table" id="tablaOperacionesBonosPEN">
                  <thead style="background: #CAD1D8; color: #060E46;">
                    <tr>
                      <th class="left" style="width: 90px;">Bono</th>
                      <th class="left" style="width: 160px;">Emisor</th>
                      <th class="center" style="width: 85px;">Fecha Últ.<br>Compra</th>
                      <th class="center" style="width: 55px;">Rating</th>
                      <th class="center" style="width: 50px;">Dur.</th>
                      <th class="center" style="width: 55px;">YTW</th>
                      <th class="center" style="width: 65px;">Precio<br>Compra</th>
                      <th class="center" style="width: 65px;">Precio<br>Mercado</th>
                      <th class="center" style="width: 90px;">VN<br>Operado</th>
                      <th class="center" style="width: 85px;">Intereses<br>Corridos</th>
                      <th class="center" style="width: 95px;">Monto<br>Total</th>
                      <th class="center" style="width: 85px;">Cupones<br>Cobrados</th>
                      <th class="center" style="width: 60px;">Tipo</th>
                    </tr>
                  </thead>
                  <tbody id="operacionesBonosBodyPEN"></tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- Contenido Total -->
          <div id="renta-fija-total" class="subtab-content">
            <!-- Sección 1: Tabla + Gráficos (para PDF) -->
            <div id="rf-seccion-tabla-graficos">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Región</th>
                    <th class="left">Subclasificación</th>
                    <th class="left">Exposición</th>
                    <th class="center" style="width: 70px;">Vol</th>
                    <th class="center" style="width: 100px;">Patrimonio (mm)</th>
                    <th class="center" style="width: 80px;">N. Holdings</th>
                    <th class="center">Rating</th>
                    <th class="center">Dur.</th>
                    <th class="center">YTW</th>
                    <th class="center">Peso</th>
                  </tr>
                </thead>
                <tbody id="rentaFijaBodyTotal"></tbody>
              </table>
            </div>
            
            <!-- Gráficos de Ratings y Sectores Total (lado a lado) -->
            <div style="display: flex; gap: 24px; margin-top: 32px; margin-bottom: 16px;">
              <!-- Ratings -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR RATING (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="ratingsChartTotal"></canvas>
                </div>
              </div>
              <!-- Sectores -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SECTOR (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="sectoresChartTotal"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Gráficos de Subclasificación y Región Total (lado a lado) -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Región -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DURACIÓN VS YTW</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="scatterRFChartTotal"></canvas>
                </div>
              </div>
              <!-- Subclasificación -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SUBCLASIFICACIÓN (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="subclasificacionChartTotal"></canvas>
                </div>
              </div>
            </div>
            </div><!-- Fin rf-seccion-tabla-graficos -->
            
            <!-- Sección 2: Portafolio Bonos (para PDF) -->
            <div id="rf-seccion-bonos" style="margin-top: 24px;">
              <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391;">Portafolio Bonos</h3>
              <div class="table-wrapper">
                <table class="data-table" id="tablaPortafolioBonosTotal">
                  <thead style="background: #CAD1D8; color: #060E46;">
                    <tr>
                      <th class="left" style="width: 90px;">Bono</th>
                      <th class="left" style="width: 160px;">Emisor</th>
                      <th class="center" style="width: 80px;">F. Call</th>
                      <th class="center" style="width: 55px;">Rating</th>
                      <th class="center" style="width: 50px;">Dur.</th>
                      <th class="center" style="width: 55px;">YTW</th>
                      <th class="center" style="width: 65px;">Precio Últ.<br>Compra</th>
                      <th class="center" style="width: 65px;">Precio<br>Mercado</th>
                      <th class="center" style="width: 90px;">Valor<br>Nominal</th>
                      <th class="center" style="width: 85px;">Intereses<br>Corridos</th>
                      <th class="center" style="width: 95px;">Valor de<br>Mercado</th>
                      <th class="center" style="width: 85px;">Fecha Últ.<br>Compra</th>
                      <th class="center" style="width: 85px;">Cupones<br>Cobrados</th>
                      <th class="center" style="width: 60px;">Moneda</th>
                    </tr>
                  </thead>
                  <tbody id="portafolioBondosBodyTotal"></tbody>
                </table>
              </div>
            </div>
            </div><!-- Fin rf-seccion-bonos -->
            
            <!-- Nueva tabla: Operaciones Bonos Total -->
            <div id="operacionesBonosTotalContainer" style="margin-top: 24px; display: none;">
              <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391;">Operaciones Bonos</h3>
              <div class="table-wrapper">
                <table class="data-table" id="tablaOperacionesBonosTotal">
                  <thead style="background: #CAD1D8; color: #060E46;">
                    <tr>
                      <th class="left" style="width: 90px;">Bono</th>
                      <th class="left" style="width: 160px;">Emisor</th>
                      <th class="center" style="width: 85px;">Fecha Últ.<br>Compra</th>
                      <th class="center" style="width: 55px;">Rating</th>
                      <th class="center" style="width: 50px;">Dur.</th>
                      <th class="center" style="width: 55px;">YTW</th>
                      <th class="center" style="width: 65px;">Precio<br>Compra</th>
                      <th class="center" style="width: 65px;">Precio<br>Mercado</th>
                      <th class="center" style="width: 90px;">VN<br>Operado</th>
                      <th class="center" style="width: 85px;">Intereses<br>Corridos</th>
                      <th class="center" style="width: 95px;">Monto<br>Total</th>
                      <th class="center" style="width: 85px;">Cupones<br>Cobrados</th>
                      <th class="center" style="width: 60px;">Tipo</th>
                    </tr>
                  </thead>
                  <tbody id="operacionesBonosBodyTotal"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ Renta Variable ============ -->
      <section id="view-renta-variable" class="view">
        <div class="card" style="min-height:auto">
          <!-- Subtabs USD/PEN -->
          <div style="margin-bottom:12px;">
            <div class="subtabs" id="renta-variable-subtabs">
              <button class="subtab active" data-sub="renta-variable-usd">USD</button>
              <button class="subtab" data-sub="renta-variable-pen">PEN</button>
              <button class="subtab" data-sub="renta-variable-total">Consolidado</button>
            </div>
          </div>
          
          <!-- Contenido USD -->
          <div id="renta-variable-usd" class="subtab-content active">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Región</th>
                    <th class="left">Subclasificación</th>
                    <th class="left">Exposición</th>
                    <th class="center" style="width: 70px;">Vol</th>
                    <th class="center" style="width: 100px;">Patrimonio (mm)</th>
                    <th class="center" style="width: 80px;">N. Holdings</th>
                    <th class="center">P/E</th>
                    <th class="center">Div Yield (%)</th>
                    <th class="center">Peso</th>
                  </tr>
                </thead>
                <tbody id="rentaVariableBodyUSD"></tbody>
              </table>
            </div>
            
            <!-- Gráficos de Sectores y Top 10 Holdings USD -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Sectores -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SECTOR (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="sectoresRVChartUSD"></canvas>
                </div>
              </div>
              <!-- Top 10 Holdings -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">TOP 10 HOLDINGS (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="top10HoldingsChartUSD"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Gráficos de Región y Subclasificación USD -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Región -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR REGIÓN (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="regionRVChartUSD"></canvas>
                </div>
              </div>
              <!-- Vehículo -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR VEHÍCULO (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="vehiculoRVChartUSD"></canvas>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Contenido PEN -->
          <div id="renta-variable-pen" class="subtab-content">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Región</th>
                    <th class="left">Subclasificación</th>
                    <th class="left">Exposición</th>
                    <th class="center" style="width: 70px;">Vol</th>
                    <th class="center" style="width: 100px;">Patrimonio (mm)</th>
                    <th class="center" style="width: 80px;">N. Holdings</th>
                    <th class="center">P/E</th>
                    <th class="center">Div Yield (%)</th>
                    <th class="center">Peso</th>
                  </tr>
                </thead>
                <tbody id="rentaVariableBodyPEN"></tbody>
              </table>
            </div>
            
            <!-- Gráficos de Sectores y Top 10 Holdings PEN -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Sectores -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SECTOR (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="sectoresRVChartPEN"></canvas>
                </div>
              </div>
              <!-- Top 10 Holdings -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">TOP 10 HOLDINGS (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="top10HoldingsChartPEN"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Gráficos de Región y Subclasificación PEN -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <!-- Región -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR REGIÓN (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="regionRVChartPEN"></canvas>
                </div>
              </div>
              <!-- Vehículo -->
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR VEHÍCULO (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="vehiculoRVChartPEN"></canvas>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Contenido Total -->
          <div id="renta-variable-total" class="subtab-content">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="left" style="min-width: 200px;">Instrumento</th>
                    <th class="left">Región</th>
                    <th class="left">Subclasificación</th>
                    <th class="center">Exposición</th>
                    <th class="center">Vol</th>
                    <th class="center">Patrimonio (mm)</th>
                    <th class="center">N. Holdings</th>
                    <th class="center">P/E</th>
                    <th class="center">Div Yield (%)</th>
                    <th class="center">Peso</th>
                  </tr>
                </thead>
                <tbody id="rentaVariableBodyTotal"></tbody>
              </table>
            </div>
            
            <!-- Gráficos de Sectores y Top 10 Holdings Total -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR SECTOR (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="sectoresRVChartTotal"></canvas>
                </div>
              </div>
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">TOP 10 HOLDINGS (%)</h3>
                <div class="chart-wrapper" style="height: 420px; position: relative;">
                  <canvas id="top10HoldingsChartTotal"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Gráficos de Región y Vehículo Total -->
            <div style="display: flex; gap: 24px; margin-top: 24px; margin-bottom: 16px;">
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR REGIÓN (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="regionRVChartTotal"></canvas>
                </div>
              </div>
              <div style="flex: 1;">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #001391; border-bottom: 2px solid #001391; padding-bottom: 8px;">DESCOMPOSICIÓN POR VEHÍCULO (%)</h3>
                <div class="chart-wrapper" style="height:500px">
                  <canvas id="vehiculoRVChartTotal"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>


      <!-- ============ Centro de datos ============ -->
      <section id="view-data" class="view">
        <div class="card" style="min-height:auto">
          <h2>Centro de Datos</h2>
          <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
            <!-- Botón Cargar CSVs (solo ícono) -->
            <button id="btnCargarCSVs" title="Cargar CSVs" style="padding:8px 10px; background:#fff; border:1px solid #e1e4e8; border-radius:6px; cursor:pointer; color:#070E46;">
              <svg style="width:18px;height:18px;vertical-align:middle;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><polyline points="9 15 12 12 15 15"/></svg>
            </button>
            <!-- Botón Importar Datos (solo ícono, flecha abajo) -->
            <button id="btnImportarDatosExt" title="Importar Datos" style="padding:8px 10px; background:#fff; border:1px solid #e1e4e8; border-radius:6px; cursor:pointer; color:#070E46;" onclick="document.getElementById('fileImportJSON').click();">
              <svg style="width:18px;height:18px;vertical-align:middle;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </button>
            <input id="fileImportJSON" type="file" accept=".json,application/json" hidden>
          </div>
          
          <!-- Mantener los inputs ocultos para funcionalidad -->
          <input id="fileAsesor360" type="file" accept=".csv,text/csv" hidden>
          <input id="fileActivos" type="file" accept=".csv,text/csv" hidden>
          <input id="fileOtrosActivos" type="file" accept=".csv,text/csv" hidden>
          <input id="fileModelos" type="file" accept=".csv,text/csv" hidden>
          <input id="fileBonds" type="file" accept=".csv,text/csv" hidden>
          <input id="fileAmort" type="file" accept=".csv,text/csv" hidden>
          <input id="fileLimites" type="file" accept=".csv,text/csv" hidden>
          <input id="fileRatings" type="file" accept=".csv,text/csv" hidden>
          <input id="fileSectores" type="file" accept=".csv,text/csv" hidden>
          <input id="fileHoldings" type="file" accept=".csv,text/csv" hidden>
          <input id="fileRegionRV" type="file" accept=".csv,text/csv" hidden>
          
          <!-- Mensajes de estado (hints) -->
          <span id="csvInfo" class="hint"></span>
          <span id="actInfo" class="hint"></span>
          <span id="otrosActInfo" class="hint"></span>
          <span id="modelInfo" class="hint"></span>
          <span id="bondsInfo" class="hint"></span>
          <span id="amortInfo" class="hint"></span>
          <span id="limitesInfo" class="hint"></span>
          <span id="ratingsInfo" class="hint"></span>
        </div>
      </section>

    </main>

    <!-- Mini‑modal Gestión de Saldos -->
    <div id="cashModal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(7,14,70,.32);z-index:10000;">
      <div style="width:min(400px,92vw);max-height:86vh;overflow:auto;background:#fff;border:1px solid #e1e4e8;border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,.15);">
        <!-- Header -->
        <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid #e1e4e8;">
          <div class="subtabs" id="cash-subtabs" style="margin:0;">
            <button class="subtab active" data-sub="cash-usd">USD</button>
            <button class="subtab" data-sub="cash-pen">PEN</button>
          </div>
          <button id="closeCashModal" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
        </div>

        <!-- Cuerpo -->
        <div style="padding:16px 18px;">
          <!-- USD -->
          <div id="subview-cash-usd" class="subview active">
            <!-- Saldos Frescos -->
            <div class="formGrid">
              <label>Saldos Frescos</label>
              <div class="field">
                <span class="prefix">$</span>
                <input id="sf-u-monto" type="text" placeholder="0">
          </div>
        </div>

            <!-- Operaciones de Tipo de Cambio -->
            <div class="secBar" style="margin-top:12px;">Operaciones de Tipo de Cambio</div>
            <div class="formGrid">
              <label>Venta USD</label>
              <div class="field">
                <span class="prefix">$</span>
                <input id="fx-u-amt" type="text" placeholder="0">
              </div>

              <label>Tipo de Cambio</label>
              <input id="fx-u-tc" type="number" step="any" placeholder="3.50">
            </div>
            <div id="fx-u-err" class="errline" style="display:none;">Saldo en Cuenta Insuficiente</div>

          </div>

          <!-- PEN -->
          <div id="subview-cash-pen" class="subview">
            <!-- Saldos Frescos -->
            <div class="formGrid">
              <label>Saldos Frescos</label>
              <div class="field">
                <span class="prefix">S/</span>
                <input id="sf-p-monto" type="text" placeholder="0">
              </div>
            </div>

            <!-- Operaciones de Tipo de Cambio -->
            <div class="secBar" style="margin-top:12px;">Operaciones de Tipo de Cambio</div>
            <div class="formGrid">
              <label>Compra USD</label>
              <div class="field">
                <span class="prefix">S/</span>
                <input id="fx-p-amt" type="text" placeholder="0">
              </div>

              <label>Tipo de Cambio</label>
              <input id="fx-p-tc" type="number" step="any" placeholder="3.50">
            </div>
            <div id="fx-p-err" class="errline" style="display:none;">Saldo en Cuenta Insuficiente</div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ Mini-modal: Curva DPF (USD & PEN) ============ -->

  <div id="modalDPF" class="modal" role="dialog" aria-modal="true">

    <div class="box">

      <!-- Header -->
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);">
        <div style="font-weight:600;">+ Curva Depositos a Plazo Fijo</div>
        <button id="dpfClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>

      <!-- Filtros: dos rangos, uno para USD y otro para PEN -->

      <div class="row" style="margin:12px 0; padding:0 18px; gap:10px; align-items:center;">

        <select id="dpfSelUSD" title="Rango USD"></select>

        <select id="dpfSelPEN" title="Rango PEN"></select>

        <div class="small" id="dpfHint"></div>

        <div id="dpfLabelsCtrl" style="margin-left:auto;display:flex;align-items:center;gap:8px;white-space:nowrap;">

          <span class="small">Agregar etiquetas:</span>

          <label class="small" style="display:flex;align-items:center;gap:4px;">

            <input type="checkbox" id="showUSDLabels" checked> USD

          </label>

          <label class="small" style="display:flex;align-items:center;gap:4px;">

            <input type="checkbox" id="showPENLabels" checked> PEN

          </label>

        </div>

      </div>



      <div class="chart-wrapper" style="min-height:360px; padding:0 18px 12px 18px;">

        <canvas id="dpfChart2"></canvas>

      </div>

    </div>

  </div>

  <!-- ============ Mini-modal: + Matriz de Bonos ============ -->
  <div id="modalMatriz" class="modal" role="dialog" aria-modal="true">
    <div class="box">
      <!-- Header -->
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);">
        <div style="font-weight:600;">+ Matriz de Bonos</div>
        <button id="matrizClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>

      <!-- Filtros en una línea -->
      <div class="row"
           style="margin:12px 0; padding:0 18px 0 12px; gap:8px;
                  align-items:center; justify-content:flex-start;
                  flex-wrap:nowrap; white-space:nowrap;">
        <!-- MÚLTIPLE: Bono -->
        <select id="mbBono" title="Bonos" multiple size="1" style="height:32px; flex:0 0 auto;"></select>

        <select id="mbPais"   title="País" style="height:32px; flex:0 0 auto;"></select>

        <!-- MÚLTIPLE: Sector -->
        <select id="mbSector" title="Sector" multiple size="1" style="height:32px; flex:0 0 auto; max-width:120px;"></select>

        <select id="mbIG"     title="IG/HY" style="height:32px; flex:0 0 auto;">
          <option value="">IG/HY (Todos)</option>
          <option value="IG">IG</option>
          <option value="HY">HY</option>
        </select>

        <!-- MÚLTIPLE: Rating -->
        <select id="mbRating" title="Rating" multiple size="1" style="height:32px; flex:0 0 auto; max-width:120px;"></select>

        <input  id="mbDurMin" type="number" step="1" placeholder="Dur. ≥" style="height:32px; width:75px; flex:0 0 auto;">
        <input  id="mbDurMax" type="number" step="1" placeholder="Dur. ≤" style="height:32px; width:75px; flex:0 0 auto;">

        <!-- vacío, no empuja; reservado por si lo usas luego -->
        <div id="mbHint" class="small" style="flex:1 1 auto;"></div>
      </div>

      <div class="chart-wrapper" style="min-height:360px; padding:0 18px 12px 18px;">
        <canvas id="matrizChart"></canvas>
      </div>

      <!-- Check: Portafolio (justo debajo del contorno inferior del gráfico) -->
      <label for="mbPortfolioOnly"
             style="display:inline-flex; align-items:center; gap:6px; white-space:nowrap; padding:8px 18px 0 18px; justify-content:flex-end; width:100%; box-sizing:border-box;">
        <input type="checkbox" id="mbPortfolioOnly">
        <span class="small">Portafolio</span>
      </label>
    </div>
  </div>

  <!-- ============ Mini-modal: Asset Allocation (Modelo vs Propuesto) ============ -->
  <div id="modalBalance" class="modal" role="dialog" aria-modal="true">
    <div class="box">
      <!-- Header -->
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);gap:10px;">
        <div style="font-weight:600;">Asset Allocation</div>
        <div style="display:flex;align-items:center;gap:10px;">
          <select id="balPerfilSel" title="Perfil"></select>
          <button id="balanceClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
        </div>
      </div>

      <!-- Subtabs USD / PEN -->
      <div class="row" style="margin:12px 0; padding:0 18px; align-items:center;">
        <div class="subtabs" id="bal-subtabs" style="margin:0;">
          <button class="subtab active" data-sub="bal-usd">USD</button>
          <button class="subtab" data-sub="bal-pen">PEN</button>
        </div>
      </div>

      <!-- Chart -->
      <div class="chart-wrapper" style="min-height:300px; padding:0 18px 8px 18px;">
        <canvas id="balanceChart"></canvas>
      </div>

      <!-- Tabla guía mini -->
      <div class="table-wrapper" style="margin:8px 18px 8px 18px; overflow:visible; max-height:none;">
        <table id="tablaBalanceMini">
          <thead>
            <tr>
              <th class="left">Clase</th>
              <th class="num">Mín</th>
              <th class="num">P. Modelo</th>
              <th class="num">Máx</th>
              <th class="num">Actual</th>
              <th class="num">Propuesto</th>
              <th class="num">OW/UW</th>
            </tr>
          </thead>
          <tbody id="tablaBalanceBody"></tbody>
          <tfoot>
            <tr class="row-total">
              <td class="left"><strong>Total</strong></td>
              <td class="num" id="balMinTot"></td>      <!-- vacío -->
              <td class="num" id="balSugTot"></td>      <!-- P. Modelo -->
              <td class="num" id="balMaxTot"></td>      <!-- vacío -->
              <td class="num" id="balActTot"></td>      <!-- Actual -->
              <td class="num" id="balAsiTot"></td>      <!-- Propuesto -->
              <td class="num" id="balDelTot"></td>      <!-- OW/UW -->
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>

  <!-- ============ Mini-modal: Portafolios Modelo ============ -->
  <div id="modalModelos" class="modal" role="dialog" aria-modal="true">
    <div class="box modal-content">
      <div class="modal-header" style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);gap:10px;">
        <div style="font-weight:600;">Portafolios Modelo</div>
        <div style="display:flex;align-items:center;gap:8px;margin-left:auto;">
          <button id="btnPMTable" class="icon-btn" title="Ver tabla" aria-label="Ver tabla">▦</button>
          <button id="btnPMChart" class="icon-btn" title="Ver gráfico" aria-label="Ver gráfico">📊</button>
          <button id="modelosClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
        </div>
      </div>
      <div class="modal-body">
        <!-- Perfil y checkbox en la misma línea -->
        <div class="row" style="margin:12px 18px; padding:0; align-items:center; justify-content: space-between;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <label class="small">Perfil</label>
            <select id="mmPerfilSel"></select>
          </div>
          <div id="pmShowLabelsContainer" style="display: none;">
            <label style="font-size: 13px; color: var(--text-secondary); cursor: pointer;">
              <input type="checkbox" id="pmShowLabels" checked style="margin-right: 5px;">
              Mostrar etiquetas de datos
            </label>
          </div>
        </div>

        <!-- VISTA: TABLA (por defecto) -->
        <div id="mmViewTable" class="subview active">
          <div class="table-wrapper" style="margin:0 18px 18px 18px;">
            <table id="tablaModelos">
              <thead>
                <tr>
                  <th class="left">Clase</th>
                  <th class="num">P. Modelo</th>
                  <th class="num">P. Actual</th>
                  <th class="num">P. Sugerido</th>
                </tr>
              </thead>
              <tbody id="mmBody"></tbody>
              <tfoot>
                <tr class="row-total">
                  <td class="left"><strong>Total</strong></td>
                  <td class="num" id="mmTotMod"><strong>100.00%</strong></td>
                  <td class="num" id="mmTotAct"><strong>0.00%</strong></td>
                  <td class="num" id="mmTotSug"><strong>0.00%</strong></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>

        <!-- VISTA: GRÁFICO -->
        <div id="mmViewChart" class="subview" style="padding:0 18px 18px 18px;">
          <div class="chart-wrapper">
            <canvas id="mmChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ Mini-modal: Maturity Wall ============ -->
  <div id="modalMaturity" class="modal" role="dialog" aria-modal="true">
    <div class="box modal-content">
      <div class="modal-header" style="display:flex;align-items:center;justify-content:space-between;padding:12px 18px;border-bottom:1px solid var(--border-light);gap:10px;">
        <div style="font-weight:600;">Maturity Wall</div>
        <div style="display:flex;align-items:center;gap:8px;margin-left:auto;">
          <!-- USD / PEN -->
          <div class="subtabs" id="mw-subtabs" style="margin:0;">
            <button class="subtab active" data-sub="mw-usd">USD</button>
            <button class="subtab" data-sub="mw-pen">PEN</button>
          </div>
          <!-- Tabla / Gráfico -->
          <button id="btnMWTable" class="icon-btn" title="Ver tabla" aria-label="Ver tabla">▦</button>
          <button id="btnMWChart" class="icon-btn" title="Ver gráfico" aria-label="Ver gráfico">📊</button>
          <button id="maturityClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
        </div>
      </div>
      <div class="modal-body">
        <!-- VISTA: TABLA -->
        <div id="mwViewTable" class="subview" style="padding:18px 18px 18px 18px;">
          <div class="table-wrapper">
            <table id="mwTable">
              <thead>
                <tr>
                  <th class="left">Año</th>
                  <th class="num">Monto</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- VISTA: GRÁFICO -->
        <div id="mwViewChart" class="subview" style="padding:18px 18px 18px 18px;">
          <div class="chart-wrapper">
            <canvas id="mwChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ Mini-modal: Límites de Concentración ============ -->
  <div id="modalLimites" class="modal" role="dialog" aria-modal="true">
    <div class="box">
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);gap:10px;">
        <div style="font-weight:600;">Límites de Concentración</div>
        <button id="limitesClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>
      <div style="padding:18px;">
        <!-- Tabla de límites excedidos -->
        <div id="limitesExcedidosContainer" style="display:none;">
          <div class="table-wrapper">
            <table id="tablaLimitesExcedidos">
              <thead>
                <tr>
                  <th class="left" style="width:35%;">Límite</th>
                  <th class="center" style="width:16.25%;">Ámbito</th>
                  <th class="center" style="width:16.25%;">Límite</th>
                  <th class="center" style="width:16.25%;">Valor Actual</th>
                  <th class="center" style="width:16.25%;">Exceso</th>
                </tr>
              </thead>
              <tbody id="limitesExcedidosBody"></tbody>
            </table>
          </div>
        </div>
        
        <!-- Mensaje cuando no hay excesos -->
        <div id="limitesOkMessage" style="display:none;text-align:center;padding:40px;">
          <p style="font-size:14px;color:#6b7280;">Todos los límites se cumplen</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ Modal: Exceso de Concentración (individual) ============ -->
  <div id="modalExcesoConcentracion" class="modal" role="dialog" aria-modal="true">
    <div class="box" style="max-width:600px;">
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);gap:10px;">
        <div style="font-weight:600;">Exceso de concentración</div>
        <button id="excesoConcentracionClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>
      <div style="padding:18px;">
        <div class="table-wrapper">
          <table id="tablaExcesoConcentracion">
            <thead>
              <tr>
                <th class="left" style="width:30%;">Límite</th>
                <th class="center" style="width:20%;">Ámbito</th>
                <th class="center" style="width:20%;">Límite</th>
                <th class="center" style="width:30%;">Actual</th>
              </tr>
            </thead>
            <tbody id="excesoConcentracionBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ Mini-modal: Cargar CSVs ============ -->
  <div id="modalCargarCSVs" class="modal" role="dialog" aria-modal="true">
    <div class="box" style="max-width: 320px;">
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border-light);gap:10px;">
        <div style="font-weight:600;">Cargar .csv</div>
        <button id="cargarCSVsClose" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>
      <div style="padding:18px; display:flex; flex-direction:column; gap:8px;">
        <button id="btnCsvAsesor360" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileAsesor360').click();">
          Asesor360
        </button>
        <span id="csvInfo" class="hint"></span>

        <button id="btnCsvActivos" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileActivos').click();">
          Activos
        </button>
        <span id="actInfo" class="hint"></span>

        <button id="btnCsvOtrosActivos" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileOtrosActivos').click();">
          Otros Activos
        </button>
        <span id="otrosActInfo" class="hint"></span>

        <button id="btnCsvModelos" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileModelos').click();">
          Portafolios Modelo
        </button>
        <span id="modelInfo" class="hint"></span>

        <button id="btnCsvBonos" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileBonds').click();">
          Bonos
        </button>
        <span id="bondsInfo" class="hint"></span>

        <button id="btnCsvAmort" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileAmort').click();">
          Amortizaciones
        </button>
        <span id="amortInfo" class="hint"></span>

        <button id="btnCsvLimites" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileLimites').click();">
          Límites
        </button>
        <span id="limitesInfo" class="hint"></span>
        <button id="btnCsvRatings" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileRatings').click();">
          Ratings
        </button>
        <span id="ratingsInfo" class="hint"></span>
        <button id="btnCsvSectores" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileSectores').click();">
          Sectores
        </button>
        <span id="sectoresInfo" class="hint"></span>
        <button id="btnCsvHoldings" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileHoldings').click();">
          Holdings
        </button>
        <span id="holdingsInfo" class="hint"></span>
        <button id="btnCsvRegionRV" class="btn-action btn-fill btn-csv-load" style="width:100%; text-align:left;" onclick="document.getElementById('fileRegionRV').click();">
          Región RV
        </button>
        <span id="regionRVInfo" class="hint"></span>
        
        <!-- Separador y botón Exportar Datos -->
        <div style="border-top: 1px solid #e1e4e8; margin-top: 8px; padding-top: 12px;">
          <button id="btnExportarDatos" class="btn-action btn-fill btn-csv-load loaded" style="width:100%; text-align:left;" onclick="exportarTodosDatos();">
            <svg style="width:14px;height:14px;margin-right:6px;vertical-align:middle;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Exportar Datos
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ================= Mini‑modal + Bonos ================= -->
  <div id="modalBonos" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(7,14,70,.32);z-index:10010;">
    <div class="bonos-shell">
      <!-- Header -->
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid #e1e4e8;">
        <div style="display:flex;gap:6px;">
          <button id="tabSelBono" class="subtab active">Seleccionar Bonos</button>
          <button id="tabMontos"  class="subtab">Agregar Nominales</button>
        </div>
        <div id="cajaDisponibleBonos" class="pill" style="margin-left: auto; margin-right: 12px; border: 1px solid #9694FF; background: #F8F8F8; color: #001391; padding: 8px 14px;">Caja Disponible: <span id="cajaDispBonos" class="amount" style="font-weight: 600;">$0</span></div>
        <button id="bonosCerrar" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>

      <!-- Body -->
      <div class="bonos-body">
        <!-- Pane Montos -->
        <div id="paneMontos" class="subview">
          <div class="table-wrapper">
            <table id="nominalesTbl">
              <thead>
                <tr>
                  <th class="left" style="min-width:120px">Bono</th>
                  <th class="left">Emisor</th>
                  <th class="center">Fecha<br>Call</th>
                  <th class="center" style="min-width:60px">Precio<br>Limpio (%)</th>
                  <th class="center" style="min-width:60px">Dur.</th>
                  <th class="center" style="min-width:60px">YTM</th>
                  <th class="center" style="min-width:60px">Rating</th>
                  <th class="center" style="min-width:60px">Amort.</th>
                  <th class="center">Circulante<br>(mm)</th>
                  <th class="center">Nominal<br>Inicial</th>
                  <th class="center">Intereses<br>Corridos</th>
                  <th class="center">Monto<br>Estimado</th>
                  <th class="center">Rebalanceo<br>(V. Nominal)</th>
                  <th class="center"></th>
                  <th class="center"></th>
                </tr>
              </thead>
              <tbody id="montosBodyModal"></tbody>
            </table>
          </div>
          <!-- KPIs del modal (fuera de table-wrapper) -->
          <div id="kpiBonos" style="display:flex;gap:10px;flex-wrap:wrap;margin-top:16px;padding:0 18px;">
            <div class="pill" style="background: #F8F8F8; border: 1px solid #85C8FF; padding: 8px 14px;">% IG: <span id="kIG" class="amount"> - </span></div>
            <div class="pill" style="background: #F8F8F8; border: 1px solid #85C8FF; padding: 8px 14px;">% HY: <span id="kHY" class="amount"> - </span></div>
            <div class="pill" style="background: #F8F8F8; border: 1px solid #85C8FF; padding: 8px 14px;">Rating prom.: <span id="kRat" class="amount"> - </span></div>
            <div class="pill" style="background: #F8F8F8; border: 1px solid #85C8FF; padding: 8px 14px;">Duración prom.: <span id="kDur" class="amount"> - </span></div>
            <div class="pill" style="background: #F8F8F8; border: 1px solid #85C8FF; padding: 8px 14px;">YTW prom.: <span id="kYtw" class="amount"> - </span></div>
          </div>
        </div>

        <!-- Pane Seleccionar Bonos -->
        <div id="paneSelBonos" class="subview active">
          <!-- Filtros -->
          <div class="row filters" style="display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin-bottom:10px;">
            <input  id="fEmisor" type="text" placeholder="Buscar (Emisor/Bono)"/>
            <select id="fSector"></select>
            <select id="fRating"></select>
            <select id="fPais"></select>
            <input  id="fDurMax" type="number" step="any" placeholder="Duración ≤ (años)"/>
            <input  id="fYtwMin" type="number" step="any" placeholder="YTW ≥ (%)"/>
            <select id="fIG"><option value="">IG/HY</option><option value="IG">IG</option><option value="HY">HY</option></select>
          </div>
          <div class="table-wrapper">
            <table id="tablaBonos">
              <thead>
                <tr>
                  <th class="left">Bono</th><th class="left">Emisor</th><th>Sector</th><th>País</th>
                  <th>Cupón</th><th>Dur.</th><th>YTW</th><th>Precio</th><th>Rating</th><th>Seniority</th>
                  <th>F. Venc.</th><th>F. Call</th><th>Amort.</th><th></th>
                </tr>
              </thead>
              <tbody id="bonosBody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Mini‑modal de información del bono (dentro de + Bonos) -->
      <div id="miniInfo">
        <div class="panel">
          <div class="head">
            <div id="miniInfoTitle">Detalle del bono</div>
            <button class="icon-btn" id="miniInfoClose" title="Cerrar">×</button>
          </div>
          <div class="body" id="miniInfoBody"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Libs -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // --- Persistencia local con IndexedDB ---
    window.ACTIVE_CRONO_CUR = window.ACTIVE_CRONO_CUR || 'USD';
    const DB_NAME = 'rebalanceador-db';
    const DB_STORE = 'datasets';

    function idbOpen() {
      return new Promise((resolve, reject) => {
        const req = indexedDB.open(DB_NAME, 1);
        req.onupgradeneeded = () => req.result.createObjectStore(DB_STORE);
        req.onsuccess = () => resolve(req.result);
        req.onerror = () => reject(req.error);
      });
    }
    function idbPut(key, value) {
      return idbOpen().then(db => new Promise((resolve, reject) => {
        const tx = db.transaction(DB_STORE, 'readwrite');
        tx.objectStore(DB_STORE).put(value, key);
        tx.oncomplete = () => resolve();
        tx.onerror = () => reject(tx.error);
      }));
    }
    function idbGet(key) {
      return idbOpen().then(db => new Promise((resolve, reject) => {
        const tx = db.transaction(DB_STORE, 'readonly');
        const req = tx.objectStore(DB_STORE).get(key);
        req.onsuccess = () => resolve(req.result);
        req.onerror = () => reject(req.error);
      }));
    }

    // --- Helpers genéricos ---
    async function persistCsv(key, rows, filename){
      await idbPut(key, { rows, meta:{ filename, ts: Date.now() } });
    }
    async function restoreCsv(key, onRows){
      const saved = await idbGet(key);
      if(saved?.rows?.length){ onRows(saved.rows, saved.meta); }
    }
    async function getStoredCsv(key){
      return await idbGet(key);
    }

    // =========================
    // Exportar / Importar Datos
    // =========================
    const CSV_KEYS = ['asesor360', 'activos', 'activos2', 'modelos', 'bonds', 'amorts', 'limits', 'ratings', 'sectores', 'holdings', 'regionrv'];
    
    // === Encriptación AES-GCM (Optimizada) ===
    const _CRYPTO_KEY = 'Estrategia_2025';
    
    async function _deriveKey(password) {
      const enc = new TextEncoder();
      const keyMaterial = await crypto.subtle.importKey(
        'raw', enc.encode(password), 'PBKDF2', false, ['deriveKey']
      );
      return crypto.subtle.deriveKey(
        { name: 'PBKDF2', salt: enc.encode('portfolio_salt_v1'), iterations: 10000, hash: 'SHA-256' },
        keyMaterial,
        { name: 'AES-GCM', length: 256 },
        false,
        ['encrypt', 'decrypt']
      );
    }
    
    async function _encryptData(jsonStr) {
      const key = await _deriveKey(_CRYPTO_KEY);
      const enc = new TextEncoder();
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const encrypted = await crypto.subtle.encrypt(
        { name: 'AES-GCM', iv },
        key,
        enc.encode(jsonStr)
      );
      const combined = new Uint8Array(iv.length + encrypted.byteLength);
      combined.set(iv);
      combined.set(new Uint8Array(encrypted), iv.length);
      // Usar Blob + FileReader para convertir a base64 (nativo, rápido)
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onloadend = () => resolve(reader.result.split(',')[1]);
        reader.readAsDataURL(new Blob([combined]));
      });
    }
    
    async function _decryptData(base64Str) {
      const key = await _deriveKey(_CRYPTO_KEY);
      // Usar fetch con data URL para decodificar base64 (nativo, rápido)
      const response = await fetch('data:application/octet-stream;base64,' + base64Str);
      const buffer = await response.arrayBuffer();
      const combined = new Uint8Array(buffer);
      const iv = combined.slice(0, 12);
      const data = combined.slice(12);
      const decrypted = await crypto.subtle.decrypt(
        { name: 'AES-GCM', iv },
        key,
        data
      );
      return new TextDecoder().decode(decrypted);
    }
    
    async function exportarTodosDatos() {
      startLoader('Exportando datos…');
      try {
        const exportData = {
          version: 1,
          exportedAt: new Date().toISOString(),
          data: {}
        };
        
        for (const key of CSV_KEYS) {
          const stored = await idbGet(key);
          if (stored?.rows?.length) {
            exportData.data[key] = stored;
          }
        }
        
        const keysExportados = Object.keys(exportData.data);
        if (keysExportados.length === 0) {
          alert('No hay datos cargados para exportar.');
          return;
        }
        
        const jsonStr = JSON.stringify(exportData);
        const encryptedData = await _encryptData(jsonStr);
        const blob = new Blob([encryptedData], { type: 'application/octet-stream' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `datos_portfolio_${new Date().toISOString().slice(0,10)}.dat`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        const infoEl = document.getElementById('importExportInfo');
        if (infoEl) infoEl.textContent = `Exportados: ${keysExportados.length} archivos (${keysExportados.join(', ')})`;
      } catch (err) {
        console.error('Error exportando:', err);
        alert('Error al exportar: ' + err.message);
      } finally {
        stopLoader();
      }
    }
    
    // =========================
    // Descargar Reporte PDF
    // =========================
    async function descargarReportePDF() {
      const btnDescargar = document.getElementById('btnDescargarReporte');
      const textoOriginal = btnDescargar.innerHTML;
      btnDescargar.innerHTML = '⏳ Generando PDF...';
      btnDescargar.disabled = true;
      
      try {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        const margin = 10;
        
        // Base64 de imágenes para carátula BBVA
       const LOGO_BLANCO_B64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB9AAAAfQCAYAAACaOMR5AAAgAElEQVR4nOzBAQEAAACAkP6v7ggKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA2bvzcEnPss7j3+ru7IQQdghhCxACRMJi2MMahMgqq4AIDuCKI4r76KCOCK4ooiDqoCgCKogjI4pxREBRVMYFBVxAdhQETUhIIF3zx9sZk9B9uk93nfNU1fl8ruu9uvucOlW/PnXqPVV1P/f9AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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dpNeHihJkiRJkiRJkiRJUo8wgS5JkiRJkiRJkiRJEibQJUmSJEmSJEmSJEkCTKBLkiRJkiRJkiRJkgSYQJckSZIkSZIkSZIkCTCBLkmSJEmSJEmSJEkSYAJdkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkl5iPIIAACAASURBVCRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8//bggAQAAABA0P/X/QgVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALyTVKwAAABbSURBVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYCDm34nmpJ+4wAAAAAElFTkSuQmCC';
        const LOGO_AZUL_B64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB9AAAAfQCAYAAACaOMR5AAAgAElEQVR4nOzBAQEAAACAkP6v7ggKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA2bv7IMvS+y7s3+c5p2/39PTMzu6OdqWVZAmkyNbLaiXLbxBbGENw8FvsGIwBEcKbiz+AQpAEKlVOgUlcJhUCqUBVqkzyBySh8mICSSovpJwUSZWD7Tj2WqZQANnCliwZSburnZme7nvveZ78cW739Lzv7uy87uczdWa6773n9Llz7jn39vN7fr8fAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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2RKePtsjb4iIKGNCKhERERERERERERERERERERhAJyIiIiIiIiIiIiIiIiIiAsAAOhERERERERERERERfY5gG3QiIiIiIiIiIiIiIiIiurRJ+4eIiIjoacYKdCIiIiIiIiIiIiIiIiIiIjCATkREREREREREREREREREBIABdCIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIqL/nz04EAAAAAAA8n9tBFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVXYSU1+AAAFw0lEQVRVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVZX24IAEAAAAQND/1+0IVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALYCDkfaMJgiT/8AAAAASUVORK5CYII=';
        
        // Función para agregar imagen al PDF
        async function agregarSeccionAlPDF(elemento, titulo) {
          if (!elemento) {
            console.warn('Elemento no encontrado:', titulo);
            return false;
          }
          
          try {
            const originalDisplay = elemento.style.display;
            const originalVisibility = elemento.style.visibility;
            elemento.style.display = 'block';
            elemento.style.visibility = 'visible';
            
            await new Promise(r => setTimeout(r, 300));
            
            if (elemento.offsetHeight === 0) {
              console.warn('Elemento sin altura:', titulo);
              elemento.style.display = originalDisplay;
              elemento.style.visibility = originalVisibility;
              return false;
            }
            
            const canvas = await html2canvas(elemento, {
              scale: 1.5,
              useCORS: true,
              logging: false,
              backgroundColor: '#ffffff',
              allowTaint: true
            });
            
            elemento.style.display = originalDisplay;
            elemento.style.visibility = originalVisibility;
            
            if (canvas.width === 0 || canvas.height === 0) {
              console.warn('Canvas vacío para:', titulo);
              return false;
            }
            
            pdf.addPage();
            // Logo BBVA en esquina superior derecha
            pdf.addImage(LOGO_AZUL_B64, 'PNG', 160, 5, 40, 40);
            pdf.setFontSize(14);
            pdf.setTextColor(0, 19, 145);
            pdf.text(titulo, margin, 12);
            
            const imgData = canvas.toDataURL('image/jpeg', 0.95);
            const imgWidth = pageWidth - (margin * 2);
            const imgHeight = (canvas.height * imgWidth) / canvas.width;
            
            const maxHeight = pageHeight - 25;
            
            if (imgHeight <= maxHeight) {
              pdf.addImage(imgData, 'JPEG', margin, 18, imgWidth, imgHeight);
            } else {
              const scale = maxHeight / imgHeight;
              pdf.addImage(imgData, 'JPEG', margin, 18, imgWidth * scale, maxHeight);
            }
            
            return true;
          } catch (err) {
            console.error('Error capturando:', titulo, err);
            return false;
          }
        }
        
        // Función para navegar y esperar
        async function navegarA(tabSelector, subtabSelector) {
          const tab = document.querySelector(tabSelector);
          if (tab) {
            tab.click();
            await new Promise(r => setTimeout(r, 300));
          }
          if (subtabSelector) {
            const subtab = document.querySelector(subtabSelector);
            if (subtab) {
              subtab.click();
              await new Promise(r => setTimeout(r, 400));
            }
          }
        }
        
        // Función para crear carátula BBVA
        function crearCaratula() {
          const codigo = document.getElementById('codigo')?.value || '';
          const banquero = document.getElementById('banquero')?.value || '';
          const asesor = document.getElementById('asesor')?.value || '';
          const fecha = new Date();
          const meses = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
          const fechaStr = `Lima, ${meses[fecha.getMonth()]} ${fecha.getFullYear()}`;
          
          // Fondo azul BBVA: #060E46 = rgb(6, 14, 70)
          pdf.setFillColor(6, 14, 70);
          pdf.rect(0, 0, pageWidth, pageHeight, 'F');
          
          // Logo blanco - proporción 2.93:1 (original 739x252px)
          // Ancho 80mm, alto 27.3mm
          try {
            pdf.addImage(LOGO_BLANCO_B64, 'PNG', 15, 12, 45, 45);
          } catch(e) { console.warn('Error logo:', e); }
          
          // Título principal - Rebalanceo Portafolio (Tamaño 54)
          pdf.setTextColor(255, 255, 255);
          pdf.setFontSize(54);
          pdf.setFont('times', 'bold');
          pdf.text('Rebalanceo', 15, 95);
          pdf.text('Portafolio', 15, 120);
          
          // Banquero | Asesor (Tamaño 21)
          pdf.setFontSize(21);
          pdf.setFont('helvetica', 'normal');
          const infoLine = `Banquero: ${banquero} | Asesor: ${asesor}`;
          pdf.text(infoLine, 15, 145);
          
          // Línea divisoria blanca
          pdf.setDrawColor(255, 255, 255);
          pdf.setLineWidth(0.3);
          pdf.line(15, 155, 140, 155);
          
          // Código cliente (Tamaño 16 - bold)
          pdf.setFontSize(16);
          pdf.setFont('helvetica', 'bold');
          pdf.text(`Código: ${codigo}`, 15, 166);
          
          // Fecha (Tamaño 12 - normal)
          pdf.setFont('helvetica', 'normal');
          pdf.setFontSize(12);
          pdf.text(fechaStr, 15, 175);
          
          // Imagen ciudad (parte inferior)
          try {
            pdf.addImage(CIUDAD_B64, 'JPEG', 10, 185, 190, 100);
          } catch(e) { console.warn('Error imagen ciudad:', e); }
        }
        
        // 0. Carátula BBVA
        crearCaratula();
        
        // 1. Dashboard - Información del Cliente (view-conf contiene: código, perfil, banca, banquero, asesor, fecha datos, tipo cambio, tabla asignación, gráficos)
        await agregarSeccionAlPDF(document.getElementById('view-conf'), 'DATOS DEL CLIENTE');
        
        // 2. Portafolio Final - Consolidado
        await navegarA('[data-tab="portafolio"].tab-child', '[data-sub="portafolio-total"]');
        await agregarSeccionAlPDF(document.getElementById('portafolio-total'), 'PORTAFOLIO FINAL - CONSOLIDADO');
        
        // 3. Renta Variable - Consolidado
        await navegarA('[data-tab="renta-variable"].tab-child', '[data-sub="renta-variable-total"]');
        await agregarSeccionAlPDF(document.getElementById('renta-variable-total'), 'RENTA VARIABLE - CONSOLIDADO');
        
        // 4. Renta Fija - Tabla + Gráficos
        await navegarA('[data-tab="renta-fija"].tab-child', '[data-sub="renta-fija-total"]');
        await agregarSeccionAlPDF(document.getElementById('rf-seccion-tabla-graficos'), 'RENTA FIJA - CONSOLIDADO');
        
        // 5. Portafolio Bonos + Cupones Próximos 12 Meses
        await navegarA('[data-tab="reporte"].tab-child', '[data-sub="crono-total"]');
        await new Promise(r => setTimeout(r, 300));
        
        const tempContainer = document.createElement('div');
        tempContainer.style.background = '#ffffff';
        tempContainer.style.padding = '10px';
        
        const bonosSection = document.getElementById('rf-seccion-bonos');
        const cuponesSection = document.getElementById('crono-seccion-cupones');
        
        if (bonosSection && cuponesSection) {
          const bonosClone = bonosSection.cloneNode(true);
          const cuponesClone = cuponesSection.cloneNode(true);
          tempContainer.appendChild(bonosClone);
          tempContainer.appendChild(cuponesClone);
          document.body.appendChild(tempContainer);
          await agregarSeccionAlPDF(tempContainer, 'PORTAFOLIO BONOS Y CUPONES');
          document.body.removeChild(tempContainer);
        }
        
        // 6. Amortizaciones y Vencimientos
        await agregarSeccionAlPDF(document.getElementById('crono-seccion-amort'), 'AMORTIZACIONES Y VENCIMIENTOS');
        
        // Volver a Portafolio Final
        await navegarA('[data-tab="portafolio"].tab-child', '[data-sub="portafolio-total"]');
        
        // Descargar PDF
        const codigo = document.getElementById('codigoClienteInput')?.value || 'cliente';
        const fecha = new Date().toISOString().slice(0, 10);
        pdf.save(`Reporte_${codigo}_${fecha}.pdf`);
        
      } catch (error) {
        console.error('Error generando PDF:', error);
        alert('Error al generar el PDF: ' + error.message);
      } finally {
        btnDescargar.innerHTML = textoOriginal;
        btnDescargar.disabled = false;
      }
    }
    
    async function importarTodosDatos(file) {
      startLoader('Importando datos…');
      try {
        const text = await file.text();
        let importData;
        
        // Intentar desencriptar (archivo .dat) o leer JSON directo (retrocompatibilidad)
        try {
          const decrypted = await _decryptData(text);
          importData = JSON.parse(decrypted);
        } catch (decryptErr) {
          // Si falla desencriptación, intentar como JSON plano (archivos viejos)
          try {
            importData = JSON.parse(text);
          } catch (jsonErr) {
            throw new Error('Archivo inválido o corrupto');
          }
        }
        
        if (!importData.data || typeof importData.data !== 'object') {
          throw new Error('Formato de archivo inválido');
        }
        
        const keysImportados = [];
        
        for (const key of CSV_KEYS) {
          if (importData.data[key]?.rows?.length) {
            await idbPut(key, importData.data[key]);
            keysImportados.push(key);
          }
        }
        
        if (keysImportados.length === 0) {
          alert('El archivo no contiene datos válidos.');
          return;
        }
        
        const infoEl = document.getElementById('importExportInfo');
        if (infoEl) infoEl.textContent = `Importados: ${keysImportados.length} archivos. Recargando…`;
        
        // Recargar la página para que se procesen todos los datos
        setTimeout(() => {
          window.location.reload();
        }, 1000);
        
      } catch (err) {
        console.error('Error importando:', err);
        alert('Error al importar: ' + err.message);
        stopLoader();
      }
    }

    // =========================
    // Helpers UI / formatos
    // =========================
    let loaderTimer = null;
    function startLoader(msg='Procesando…') {
      const overlay = document.getElementById('loaderOverlay');
      const bar = document.getElementById('progressBar');
      const lbl = document.getElementById('loaderMsg');
      if(lbl) lbl.textContent = msg;
      if(!overlay || !bar) return;
      overlay.style.display='flex';
      bar.style.width = '0%';
      let p = 0;
      loaderTimer = setInterval(() => {
        p = Math.min(p + Math.random()*7 + 3, 90);
        bar.style.width = p.toFixed(0) + '%';
      }, 180);
    }
    function stopLoader() {
      const overlay = document.getElementById('loaderOverlay');
      const bar = document.getElementById('progressBar');
      if(loaderTimer){ clearInterval(loaderTimer); loaderTimer = null; }
      if(bar) bar.style.width = '100%';
      setTimeout(()=>{ if(overlay) overlay.style.display='none'; }, 250);
    }

    function debounce(fn, wait=350){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), wait); }; }
    function norm8(s){ return (String(s||'').replace(/\D/g,'').slice(0,8).padStart(8,'0')); }
    function setVal(id, v){ const el = document.getElementById(id); if(el) el.value = (v ?? ''); }

// Formatear texto a Nombre Propio con artículos en minúscula
function toTitleCase(str) {
  if (!str) return '';
  
  const articulos = ['de', 'del', 'de los', 'de las', 'la', 'las', 'los'];
  
  let formatted = String(str).toLowerCase().replace(/\b\w/g, l => l.toUpperCase());
  
  articulos.forEach(art => {
    const regex = new RegExp('\\b' + art.replace(/\s/g, '\\s') + '\\b', 'gi');
    formatted = formatted.replace(regex, art.toLowerCase());
  });
  
  return formatted;
}

// Limpiar texto de BANCA
function cleanBanca(str) {
  if (!str) return '';
  let cleaned = String(str).replace(/OFICINA\s+GLOBAL\s+WEALTH\s*/i, '').trim();
  cleaned = cleaned.replace(/Pardo\s*&/i, 'Pardo y Aliaga');
  return cleaned;
}

// Formatear nombre completo a "Nombre Apellido"
function formatBanquero(fullName) {
  if (!fullName) return '';
  
  const formatted = toTitleCase(fullName);
  const palabras = formatted.split(/\s+/).filter(Boolean);
  
  if (palabras.length >= 3) {
    const nombre1 = palabras[2];
    const apellido1 = palabras[0];
    return `${nombre1} ${apellido1}`;
  }
  
  return formatted;
}
    
    // =========================
    // Sincronización de Perfil
    // =========================

    function populatePerfilSelector() {
      const sel = document.getElementById('perfil');
      if (!sel) return;
      
      const currentValue = sel.value;
      const profiles = modelProfiles();
      
      sel.innerHTML = '<option value="">-- Seleccionar --</option>';
      profiles.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p;
        opt.textContent = p;
        sel.appendChild(opt);
      });
      
      if (currentValue && profiles.includes(currentValue)) {
        sel.value = currentValue;
      }
    }

    function syncPerfilToAllViews(perfil) {
      if (!perfil) return;
      
      // 1. Re-renderizar Asset Allocation
      const aaData = calculateAssetAllocation('USD', perfil);
      renderAssetAllocationChart('sectoresPFChartUSD', aaData);
      const aaPEN = calculateAssetAllocation('PEN', perfil);
      renderAssetAllocationChart('sectoresPFChartPEN', aaPEN);
      
      const aaL2Data = calculateAssetAllocationL2('USD', perfil);
      renderAssetAllocationL2Chart('assetAllocationL2ChartUSD', aaL2Data);
      const aaL2PEN = calculateAssetAllocationL2('PEN', perfil);
      renderAssetAllocationL2Chart('assetAllocationL2ChartPEN', aaL2PEN);
      
      // Gráficos TOTAL (combina USD + PEN)
      const aaTotal = calculateAssetAllocation('TOTAL', perfil);
      renderAssetAllocationChart('sectoresPFChartTotal', aaTotal);
      const aaL2Total = calculateAssetAllocationL2('TOTAL', perfil);
      renderAssetAllocationL2Chart('assetAllocationL2ChartTotal', aaL2Total);
      
      // Maturity Wall para Total
      renderMaturityWallPFChart('maturityWallPFChartTotal', 'TOTAL').catch(e => console.error('Error renderizando Maturity Wall Total:', e));
      
      // Re-renderizar tablas de Holdings (para actualizar Monto Sugerido)
      if (typeof renderHoldingsTables === 'function' && LAST_HOLDINGS) {
        try { renderHoldingsTables(LAST_HOLDINGS); } catch(e) {}
      }
      
      // 2. Sincronizar con Balance
      const balPerfilSel = document.getElementById('balPerfilSel');
      if (balPerfilSel) {
        const opts = Array.from(balPerfilSel.options).map(o => o.value);
        if (opts.includes(perfil)) {
          balPerfilSel.value = perfil;
          if (typeof renderBalance === 'function') {
            try { renderBalance(); } catch(e) {}
          }
        }
      }
      
      // 3. Sincronizar con Portafolios Modelo
      const mmPerfilSel = document.getElementById('mmPerfilSel');
      if (mmPerfilSel) {
        const opts = Array.from(mmPerfilSel.options).map(o => o.value);
        if (opts.includes(perfil)) {
          mmPerfilSel.value = perfil;
          const modalModelos = document.getElementById('modalModelos');
          if (modalModelos && modalModelos.classList.contains('show')) {
            if (typeof renderModelosTable === 'function') {
              try { renderModelosTable(); } catch(e) {}
            }
            if (typeof renderPMChart === 'function') {
              try { renderPMChart(); } catch(e) {}
            }
          }
        }
      }
      
      // 4. Re-evaluar límites
      if (typeof evaluateLimits === 'function') {
        try { evaluateLimits(); } catch(e) {}
      }
    }

    function fmtMoney(v, cur='USD'){
      const n = Number(v);
      if (!isFinite(n) || n === 0) return ' - ';
      return n.toLocaleString(cur==='PEN'?'es-PE':'en-US', {
        style:'currency', currency:cur, maximumFractionDigits:0
      });
    }
    function fmtNum(v, d=1){
      if (v===null || v===undefined || v==='') return '';
      const n = Number(v);
      if (!isFinite(n)) return '';
      if (n === 0) return ' - ';
      return n.toLocaleString('en-US', { maximumFractionDigits:d });
    }
    const stripAccents = s => String(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'');
    function normalizeHeader(h) {
      return String(h || '')
        .trim()
        .toLowerCase()
        .replace(/\s+/g, '');  // Elimina TODOS los espacios
    }
    function normalizeRowKeys(obj){ const out={}; for(const k in obj){ out[normalizeHeader(k)] = obj[k]; } return out; }
    function pick(row, aliases){ for(const k of aliases){ if(Object.prototype.hasOwnProperty.call(row,k)) return row[k]; } return undefined; }
    function toNum(x){ if(x===null||x===undefined||x==='') return 0; if(typeof x==='number') return isFinite(x)?x:0; const s=String(x).replace(/,/g,'').replace(/\s+/g,''); const v=Number(s); return isFinite(v)?v:0; }
    function faceFrom(x){
      let q = toNum(x);
      if (!Number.isFinite(q)) return 0;
      
      // Guardar el signo para valores negativos (ventas)
      const sign = q < 0 ? -1 : 1;
      q = Math.abs(q);
      
      if (q === 0) return 0;
      if (q < 1000) q *= 1000;          // si viene en #bonos, lo llevamos a nominal
      q = Math.floor(q/1000)*1000;      // múltiplos de 1,000
      return q * sign;  // Restaurar el signo
    }
    function toFechaStr(v){
      if(v===null || v===undefined || v==='') return '';
      if (typeof v === 'number') {                    // Excel serial date
        const ms = Math.round(v - 25569) * 86400 * 1000;
        const d = new Date(ms);
        return isNaN(d) ? String(v) : d.toLocaleDateString('es-PE');
      }
      const d = new Date(String(v));
      return isNaN(d) ? String(v) : d.toLocaleDateString('es-PE');
    }

    // =========================
    // Normalizadores dominio
    // =========================
    function normTxt(s){ return stripAccents(String(s||'').toUpperCase().trim()).replace(/\s+/g,' '); }
    function normIsin(x){ return String(x||'').toUpperCase().replace(/\s+/g,''); }
    function normCodprod(x){ let s=String(x||'').toUpperCase().replace(/^'+/,'').replace(/\s+/g,''); if(s.endsWith('.0')) s=s.slice(0,-2); s=s.replace(/^0+/,''); return s||'0'; }
    function normMoneda(s){
      const t = String(s||'').toUpperCase().replace(/\s+/g,'').replace('US$','USD');
      if (t.includes('PEN') || t.includes('SOL')) return 'PEN';
      return 'USD';
    }
    function canonSubcatName(x){
      const s = stripAccents(String(x||'').toUpperCase().trim());
      if(!s) return '';
      return s
        .replace(/\s*&\s*/g, ' Y ')
        .replace(/\s+/g, ' ')
        .replace(/[^\w\s]/g, '')
        .trim();
    }

    // =========================
    // Activos CACHE (igual backend)
    // =========================
    const ACT = {
      loaded:false,
      rows: [],  // Guardar filas originales para procesamiento de Portafolios Modelo
      class_by_isin:new Map(),
      veh_by_isin:new Map(),
      class_by_subprod_name:new Map(),
      class_by_codprod:new Map(),
      currency_by_codprod:new Map(),
      class_by_prodsub:new Map(),
      name_by_codprod:new Map(),
      name_by_isin:new Map(),
      region_by_isin:new Map(),
      region_by_codprod:new Map(),
      subclase_by_isin:new Map(),
      subclase_by_codprod:new Map(),
      veh_by_subprod_name:new Map(),
      region_by_subprod_name:new Map(),
      subclase_by_subprod_name:new Map(),
      product_by_subprod_name:new Map(),
      group_by_isin:new Map(),
      group_by_codprod:new Map(),
      group_by_subprod_name:new Map(),
      pm_by_isin:new Map(),
      pm_by_codprod:new Map(),
      pm_by_subprod_name:new Map(),
      dict_by_isin:new Map(),
      dict_by_codprod:new Map(),
      dict_by_subprod:new Map(),
      pm_cats_by_class:new Map(),   // Clase -> Set de PMs
      // === NUEVO: subclases por clase, y etiqueta preferida por clave jerárquica ===
      subcats_by_class: new Map(),          // Clase -> Set(SubclaseCanon)
      subcat_label_by_key: new Map(),       // "Clase||SubclaseCanon" -> Etiqueta original preferida
      // === Mapas para Cronograma de Pagos ===
      coupon_pct_by_isin:new Map(),
      coupon_pct_by_codprod:new Map(),
      coupon_pct_by_subprod_name:new Map(),
      freq_by_isin:new Map(),
      freq_by_codprod:new Map(),
      freq_by_subprod_name:new Map(),
      proxcupon_by_isin:new Map(),
      proxcupon_by_codprod:new Map(),
      proxcupon_by_subprod_name:new Map()
    };
    function canonClassName(x){
      const t = normTxt(x);
      if(!t) return '';

      // Verificaciones exactas primero
      if(t === 'LIQUIDEZ') return 'Liquidez';
      if(t === 'RENTA FIJA CP') return 'Renta Fija CP';
      if(t === 'RENTA FIJA MP') return 'Renta Fija MP';
      if(t === 'RENTA VARIABLE') return 'Renta Variable';
      if(t === 'ALTERNATIVO') return 'Alternativo';

      // Verificaciones parciales (orden importante: CP antes que genérico)
      if(t.includes('LIQUIDEZ') || t.includes('CASH')) return 'Liquidez';
      if(t.includes('RENTA FIJA CORTO') || t.includes('CORTO PLAZO') || t.includes('RF CP') || t==='CP') return 'Renta Fija CP';
      if(t.includes('RENTA FIJA MEDIANO') || t.includes('MEDIANO PLAZO') || t.includes('RF MP') || t==='MP') return 'Renta Fija MP';
      if(t.includes('RENTA FIJA')) return 'Renta Fija MP'; // Fallback genérico al final
      if(t.includes('RENTA VARIABLE') || t.includes('EQUITY') || t.includes('ACCION')) return 'Renta Variable';
      if(t.includes('ALTERNATIV') || t.includes('DERIVAD') || t.includes('ESTRUCTUR')) return 'Alternativo';

      return '';
    }

    function canonPMLabel(s){
      const t = normTxt(s);
      if (!t) return '';

      // === Equity (RV) primero: casos específicos antes que 'Global'
      // US / EEUU
      if (/\brv\s*us\b/.test(t)) return 'EEUU';
      if (/\b(u\.?s\.?a?|u\.?s\.?)\b/.test(t)) return 'EEUU';
      if (/\bee\.?uu\b/.test(t) || /estados\s*unidos/.test(t)) return 'EEUU';

      // Europa / Japón / Asia ex-Japón / Emergentes
      if (/europa/.test(t)) return 'Europa';
      if (/jap[oó]n/.test(t)) return 'Japon';
      if (/asia.*ex.*jap/.test(t)) return 'Asia Desarrollado ex - Japon';
      if (/emerg/.test(t)) return 'M. Emergentes';

      // Global (solo si no matcheó nada más específico)
      if (/\bglobal|world|all\s*country\b/.test(t)) return 'Global';

      // === FI (por compatibilidad)
      if ((/^(ig|investment\s*grade)/.test(t)) && /desarroll/.test(t)) return 'IG M. Desarrollados';
      if ((/^(hy|high\s*yield)/.test(t))      && /desarroll/.test(t))  return 'HY M. Desarrollados';
      if (/latino.?america/.test(t)) return 'Latinoamerica';

      // Cash / REIT
      if (/cash|equival/.test(t)) return 'Cash y Equivalentes';
      if (/reits?/.test(t)) return 'REITS';

      // Por defecto, mantén etiqueta tal cual (evita colapsar a "Global")
      return s || 'Otros';
    }

    // === Normalizador para ranking por Región/Subclasificación (NO cambia la etiqueta visible)
    function _pmForRank(pm){
      const t = normTxt(pm);
      if (!t) return '';

      // RV
      if (/\b(u\.?s\.?a?|u\.?s\.?|ee\.?uu)\b/.test(t) || /\brv\s*us\b/.test(t)) return 'EEUU';
      if (/europa/.test(t)) return 'Europa';
      if (/jap[oó]n/.test(t)) return 'Japon';
      if (/asia.*ex.*jap/.test(t) || /asia.*desarrollad.*ex/.test(t)) return 'Asia Desarrollado ex - Japon';
      if (/emerg/.test(t)) return 'Emergente';         // para RV
      if (/global|world|all\s*country/.test(t)) return 'Global';

      // RF
      if ((/^ig\b|investment\s*grade/.test(t)) && /desarroll/.test(t)) return 'IG M. Desarrollados';
      if ((/^hy\b|high\s*yield/.test(t))      && /desarroll/.test(t)) return 'HY M. Desarrollados';
      if (/latino.?america|latam/.test(t)) return 'Latinoamerica';
      if (/cash|equival/.test(t)) return 'Cash y Equivalentes';

      // Alt
      if (/reits?/.test(t)) return 'REITS';
      if (/materias\s*primas|commod/.test(t)) return 'Materias Primas';
      if (/cripto|crypto/.test(t)) return 'Criptomonedas';

      return pm || '';
    }

    // === Ranking por Clase (tu orden)
    function _rankPM(clase, pm){
      const c = String(clase||'');
      const p = _pmForRank(pm);

      if (c === 'Renta Fija CP'){
        const order = ['Cash y Equivalentes','IG M. Desarrollados','HY M. Desarrollados','M. Emergentes','Latinoamerica'];
        const i = order.indexOf(p);
        return i >= 0 ? i : 999;
      }
      if (c === 'Renta Fija MP'){
        const order = ['IG M. Desarrollados','HY M. Desarrollados','M. Emergentes','Latinoamerica'];
        const i = order.indexOf(p);
        return i >= 0 ? i : 999;
      }
      if (c === 'Renta Variable'){
        const order = ['Global','EEUU','Europa','Japon','Asia Desarrollado ex - Japon','Emergente'];
        const i = order.indexOf(p);
        return i >= 0 ? i : 999;
      }
      if (c === 'Alternativo'){
        const order = ['REITS','Materias Primas','Criptomonedas'];
        const i = order.indexOf(p);
        return i >= 0 ? i : 999;
      }
      if (c === 'Liquidez'){
        const order = ['Cash y Equivalentes'];
        const i = order.indexOf(p);
        return i >= 0 ? i : 500;
      }
      return 999;
    }

    // === Obtener la Región/PM del holding (la misma lógica usada en P.Actual/Sugerido)
    function _pmOfHolding(r){
      if (typeof pmForHoldRow === 'function') return pmForHoldRow(r);
      return r.subclase || r.subcategoria || '';
    }

    function pmCatsForClass(clase){
      const set = ACT.pm_cats_by_class.get(clase) || new Set();
      const arr = Array.from(set);
      // 'Otros' siempre al final
      arr.sort((a,b)=>{
        const A = normTxt(a), B = normTxt(b);
        if (A==='OTROS') return 1;
        if (B==='OTROS') return -1;
        return String(a).localeCompare(String(b),'es',{sensitivity:'base'});
      });
      return arr;
    }

    // =========================
    // Estado de Asesor360
    // =========================
    let A360 = [];                 // filas normalizadas
    let A360ByCode = new Map();    // code -> filas
    let CURRENT_CODE = null;
    let charts = { grouped:null, donut:null };
    let fechaMaxData = '';
    let LAST_HOLDINGS = { USD:[], PEN:[] };
    let edits = { USD:new Map(), PEN:new Map() };
    let CASH = {
      base: { USD:{ accts:new Map(), total:0 }, PEN:{ accts:new Map(), total:0 } },
      aportes: { USD:0, PEN:0 },
      fxops: []
    };

    // Sistema de fondeo (por moneda independiente)
    let CUENTA_ACTIVA = {
      USD: null,  // { _rid: '...', nombre: '...' }
      PEN: null   // { _rid: '...', nombre: '...' }
    };

    // Total de saldos frescos por moneda
    let SALDOS_FRESCOS = { USD: 0, PEN: 0 };

    // Total de operaciones FX por moneda (monto vendido/comprado en cada moneda)
    let FX_TOTALES = { USD: 0, PEN: 0 };
    
    // Tipo de cambio usado en FX (para mantenerlo en el input)
    let FX_TC = { USD: 3.50, PEN: 3.50 };

    // Tracking: de qué cuenta salió cada compra
    let FONDEO_TRACKING = {
      USD: new Map(), // _rid del activo → { cuentaRid: '...', monto: 50000 }
      PEN: new Map()
    };

    /* ======== + Bonos: estado y constantes ======== */
    const BOND_MIN = { USD: 30000, PEN: 10000 };
    let ACTIVE_BOND_CUR = 'USD';
    // Única fuente de verdad y visible para todo (incl. Maturity Wall)
    var ACTIVE_CRONO_CUR = (window.ACTIVE_CRONO_CUR || 'USD');
    window.ACTIVE_CRONO_CUR = ACTIVE_CRONO_CUR;
    let BOND_MODE = 'buy';
    let BONDS = [];
    let BONDS_RAW = [];
    const BONDS_BY_ISIN = new Map();
    let AMORT = [];
    let AMORTS_BY_ISIN = {};
    let RATINGS = {
      loaded: false,
      rows: [],
      by_isin: new Map(),
      by_codprod: new Map()
    };
    let SECTORES = {
      loaded: false,
      rows: [],
      by_isin: new Map(),
      by_codprod: new Map()
    };
    let HOLDINGS = {
      loaded: false,
      rows: [],
      by_isin: new Map(),
      by_codprod: new Map()
    };
    let REGION_RV = {
      loaded: false,
      rows: [],
      by_isin: new Map(),
      by_codprod: new Map()
    };
    let ACTIVOS2 = []; // dataset de 'Otros Activos' (CSV Agregar Activos)
    // opcional: expón también en window para compatibilidad
    window.ACTIVOS2 = ACTIVOS2;
    window.BONDS = BONDS;
    window.BONDS_RAW = BONDS_RAW;
    window.BONDS_BY_ISIN = BONDS_BY_ISIN;
    window.AMORT = AMORT;
    window.AMORTS_BY_ISIN = AMORTS_BY_ISIN;
    const state = { cartera: [], bondLots: {}, monto: 0 };
    // opcional: expón también en window por compatibilidad con otros handlers
    window.state = state;
    
    // --- Bonos: estado por lado (buy/sell) ---
    function getLot(bid, side){
      const rec = (state.bondLots[bid] ||= {});
      return (rec[side] ||= { nominal:0 });
    }
    function setLot(bid, side, patch){
      Object.assign(getLot(bid, side), patch||{});
    }
    function lotNom(bid, side){ return toNum(getLot(bid, side).nominal); }
    function hasLotSide(bid, side){ return !!(state.bondLots[bid] && state.bondLots[bid][side]); }
    
    let editsAcct = { USD:new Map(), PEN:new Map() };
    let FX_LOG = [];
    let CASH_ACC = { USD:new Map(), PEN:new Map() };
    let APORTES = { USD:new Map(), PEN:new Map() };
    let FX_IN = { USD:new Map(), PEN:new Map() };
    let FX_OUT = { USD:new Map(), PEN:new Map() };
    let ASIG = { USD:new Map(), PEN:new Map() };

    // Identificar si una fila es una cuenta elegible para fondeo
    function esCuentaFondeable(row) {
      const vehiculo = String(row.vehiculo || row.Vehiculo || '').toUpperCase();
      const producto = String(row.Producto || row.producto || '').toUpperCase();
      
      if (vehiculo !== 'CUENTAS') return false;
      
      return producto === 'CUENTA AHORRO' || 
             producto === 'CUENTA CORRIENTE' || 
             producto === 'CTS';
    }

    // Mostrar popup para seleccionar cuenta a activar
    function mostrarPopupSeleccionCuenta(cur, callback) {
      const cuentas = (LAST_HOLDINGS[cur] || []).filter(r => esCuentaFondeable(r));
      
      if (cuentas.length === 0) {
        alert('No hay cuentas disponibles en ' + cur + ' para activar.');
        return;
      }
      
      const overlay = document.createElement('div');
      overlay.id = 'popupSeleccionCuentaOverlay';
      overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(7,14,70,0.32);z-index:10020;display:flex;align-items:center;justify-content:center;';
      
      let opcionesHTML = '';
      cuentas.forEach(cuenta => {
        const valorActual = toNum(cuenta.valor_mercado);
        const edit = (edits && edits[cur]) ? (edits[cur].get(cuenta._rid) || 0) : 0;
        const saldo = valorActual + edit;
        
        opcionesHTML += `
          <div style="display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #E2E6EA;">
            <div>
              <div style="font-weight:600;color:#060E46;font-size:14px;">${cuenta.nombre}</div>
              <div style="font-size:12px;color:#666;margin-top:2px;">Saldo: ${moneyByCur(saldo, cur)}</div>
            </div>
            <label class="switch" style="margin:0;">
              <input type="checkbox" onchange="seleccionarCuentaPopup('${cuenta._rid}', '${cur}', this)">
              <span class="slider"></span>
            </label>
          </div>
        `;
      });
      
      overlay.innerHTML = `
        <div style="background:#fff;border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.15);max-width:400px;width:90%;overflow:hidden;">
          <div style="display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #E2E6EA;">
            <h3 style="margin:0;color:#060E46;font-size:16px;font-weight:600;">Seleccionar Cuenta ${cur}</h3>
            <button onclick="cerrarPopupSeleccionCuenta()" style="background:none;border:none;font-size:20px;cursor:pointer;color:#666;padding:0;line-height:1;">&times;</button>
          </div>
          <div style="max-height:300px;overflow-y:auto;">
            ${opcionesHTML}
          </div>
        </div>
      `;
      
      window._popupCuentaCallback = callback;
      document.body.appendChild(overlay);
    }

    // Popup especial para Tipo de Cambio (seleccionar ambas monedas)
    function mostrarPopupSeleccionCuentaFX(callback) {
      const cuentasUSD = (LAST_HOLDINGS.USD || []).filter(r => esCuentaFondeable(r));
      const cuentasPEN = (LAST_HOLDINGS.PEN || []).filter(r => esCuentaFondeable(r));
      
      if (cuentasUSD.length === 0 && cuentasPEN.length === 0) {
        alert('No hay cuentas disponibles para activar.');
        return;
      }
      
      const overlay = document.createElement('div');
      overlay.id = 'popupSeleccionCuentaOverlay';
      overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(7,14,70,0.32);z-index:10020;display:flex;align-items:center;justify-content:center;';
      
      const generarOpciones = (cuentas, cur) => {
        if (!CUENTA_ACTIVA[cur]) {
          return cuentas.map(cuenta => {
            const valorActual = toNum(cuenta.valor_mercado);
            const edit = (edits && edits[cur]) ? (edits[cur].get(cuenta._rid) || 0) : 0;
            const saldo = valorActual + edit;
            
            return `
              <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 16px;border-bottom:1px solid #E2E6EA;">
                <div>
                  <div style="font-weight:600;color:#060E46;font-size:13px;">${cuenta.nombre}</div>
                  <div style="font-size:11px;color:#666;margin-top:2px;">Saldo: ${moneyByCur(saldo, cur)}</div>
                </div>
                <label class="switch" style="margin:0;">
                  <input type="checkbox" onchange="seleccionarCuentaFXPopup('${cuenta._rid}', '${cur}', this)">
                  <span class="slider"></span>
                </label>
              </div>
            `;
          }).join('');
        }
        return `<div style="padding:12px 16px;color:#88E783;font-size:13px;">✓ ${CUENTA_ACTIVA[cur].nombre} (activa)</div>`;
      };
      
      const seccionUSD = !CUENTA_ACTIVA.USD ? `
        <div style="padding:12px 16px;background:#f8f9fa;border-bottom:1px solid #E2E6EA;">
          <div style="font-weight:600;color:#060E46;font-size:14px;">Cuenta USD</div>
        </div>
        ${generarOpciones(cuentasUSD, 'USD')}
      ` : generarOpciones(cuentasUSD, 'USD');
      
      const seccionPEN = !CUENTA_ACTIVA.PEN ? `
        <div style="padding:12px 16px;background:#f8f9fa;border-bottom:1px solid #E2E6EA;">
          <div style="font-weight:600;color:#060E46;font-size:14px;">Cuenta PEN</div>
        </div>
        ${generarOpciones(cuentasPEN, 'PEN')}
      ` : generarOpciones(cuentasPEN, 'PEN');
      
      overlay.innerHTML = `
        <div style="background:#fff;border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.15);max-width:400px;width:90%;overflow:hidden;">
          <div style="display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #E2E6EA;">
            <h3 style="margin:0;color:#060E46;font-size:16px;font-weight:600;">Seleccionar Cuentas</h3>
            <button onclick="cerrarPopupSeleccionCuenta()" style="background:none;border:none;font-size:20px;cursor:pointer;color:#666;padding:0;line-height:1;">&times;</button>
          </div>
          <div style="max-height:400px;overflow-y:auto;">
            ${seccionUSD}
            ${seccionPEN}
          </div>
        </div>
      `;
      
      window._popupCuentaCallback = callback;
      document.body.appendChild(overlay);
    }

    function seleccionarCuentaPopup(rid, moneda, checkbox) {
      if (checkbox.checked) {
        activarCuenta(rid, moneda);
        cerrarPopupSeleccionCuenta();
        
        if (typeof window._popupCuentaCallback === 'function') {
          setTimeout(() => {
            window._popupCuentaCallback();
            window._popupCuentaCallback = null;
          }, 100);
        }
      }
    }

    function seleccionarCuentaFXPopup(rid, moneda, checkbox) {
      if (checkbox.checked) {
        activarCuenta(rid, moneda);
        // Verificar si ambas cuentas están activas
        if (CUENTA_ACTIVA.USD && CUENTA_ACTIVA.PEN) {
          cerrarPopupSeleccionCuenta();
          if (typeof window._popupCuentaCallback === 'function') {
            setTimeout(() => {
              window._popupCuentaCallback();
              window._popupCuentaCallback = null;
            }, 100);
          }
        } else {
          // Refrescar popup para mostrar la cuenta seleccionada
          cerrarPopupSeleccionCuenta();
          mostrarPopupSeleccionCuentaFX(window._popupCuentaCallback);
        }
      }
    }

    function cerrarPopupSeleccionCuenta() {
      const overlay = document.getElementById('popupSeleccionCuentaOverlay');
      if (overlay) overlay.remove();
      window._popupCuentaCallback = null;
    }

    // Activar una cuenta como fuente de fondeo
    function activarCuenta(rid, moneda) {
      const rows = LAST_HOLDINGS[moneda] || [];
      const row = rows.find(r => r._rid === rid);
      
      if (!row) return;
      
      // Verificar que tenga saldo > 0
      const valorActual = toNum(row.valor_mercado);
      const edicion = (edits && edits[moneda]) ? (edits[moneda].get(rid) || 0) : 0;
      const montoFinal = valorActual + edicion;
      
      if (montoFinal <= 0) {
        alert('No puede activar una cuenta con saldo cero o negativo.');
        return;
      }
      
      // Desactivar cuenta anterior en esta moneda si existe
      if (CUENTA_ACTIVA[moneda] && CUENTA_ACTIVA[moneda]._rid !== rid) {
        CUENTA_ACTIVA[moneda] = null;
      }
      
      // Activar esta cuenta
      CUENTA_ACTIVA[moneda] = { _rid: rid, nombre: row.nombre };
      
      // Actualizar UI
      actualizarBotonesActivacion();
      
      // console.log(`✓ Cuenta ${moneda} activada: ${row.nombre} (${moneyByCur(montoFinal, moneda)} disponibles)`);
    }

    // Toggle cuenta activa desde switch
    function toggleCuentaActiva(checkbox, rid, moneda) {
      if (checkbox.checked) {
        // Activar cuenta
        activarCuenta(rid, moneda);
      } else {
        // Desactivar cuenta
        if (CUENTA_ACTIVA[moneda] && CUENTA_ACTIVA[moneda]._rid === rid) {
          CUENTA_ACTIVA[moneda] = null;
          renderHoldingsTables(LAST_HOLDINGS);
        }
      }
    }
    
    // Desactivar cuenta
    function desactivarCuenta(rid, moneda) {
      if (CUENTA_ACTIVA[moneda] && CUENTA_ACTIVA[moneda]._rid === rid) {
        CUENTA_ACTIVA[moneda] = null;
      }
      actualizarBotonesActivacion();
    }

    function actualizarBotonesActivacion() {
      ['USD', 'PEN'].forEach(cur => {
        const rows = LAST_HOLDINGS[cur] || [];
        
        rows.forEach(row => {
          if (!esCuentaFondeable(row)) return;
          
          // Buscar el switch en la tabla
          const switches = document.querySelectorAll(`label.switch input[type="checkbox"]`);
          switches.forEach(sw => {
            const onchangeAttr = sw.getAttribute('onchange');
            if (onchangeAttr && onchangeAttr.includes(row._rid)) {
              const estaActiva = CUENTA_ACTIVA[cur] && CUENTA_ACTIVA[cur]._rid === row._rid;
              sw.checked = estaActiva;
            }
          });
        });
        
        // AGREGAR: Habilitar/deshabilitar botones "Romper DPF"
        const botonesRomper = document.querySelectorAll(`.btn-romper-dpf[data-cur="${cur}"]`);
        botonesRomper.forEach(btn => {
          if (CUENTA_ACTIVA[cur]) {
            btn.disabled = false;
            btn.style.opacity = '1';
            btn.style.cursor = 'pointer';
          } else {
            btn.disabled = true;
            btn.style.opacity = '0.4';
            btn.style.cursor = 'not-allowed';
          }
        });
      });
    }

    // =========================
    // Carga Asesor360
    // =========================
    function ingestRows(rows){
      A360 = rows.map(normalizeRowKeys);
      A360ByCode = new Map();
      for(const r of A360){
        let code = pick(r, ['codigo','codigocliente','codigo_cliente','codcliente','cod','cliente']);
        code = norm8(code ?? '');
        if(!A360ByCode.has(code)) A360ByCode.set(code, []);
        A360ByCode.get(code).push(r);
      }
      const uniqueCodes = Array.from(A360ByCode.keys()).filter(c=>c && c!=='00000000');
      // Sin mensaje de carga
      // Fecha de datos: usar únicamente "FechaInformacion" (normalizado: fechainformacion, formato dd/mm/aaaa)
      const fechas = A360
        .map(r => r.fechainformacion)
        .filter(Boolean)
        .map(s => {
          const [d,m,y] = String(s).trim().split('/').map(Number);
          return new Date(y, m-1, d).getTime();
        })
        .filter(t => !Number.isNaN(t));

      if (fechas.length) {
        const tmax = fechas.reduce((max, val) => val > max ? val : max, fechas[0]);
        fechaMaxData = new Date(tmax).toISOString();
        setVal('fechaDatosInput', new Date(tmax).toLocaleDateString('es-PE', { day:'2-digit', month:'2-digit', year:'numeric' }));
      } else {
        setVal('fechaDatosInput','');
        fechaMaxData = '';
      }
    }
    function onLoadCsv(){
      const inp = document.getElementById('fileAsesor360');
      if(!inp || !inp.files || !inp.files[0]){ alert('Selecciona Asesor360.csv (UTF-8)'); return; }
      startLoader('Leyendo Asesor360.csv…');
      Papa.parse(inp.files[0], {
        header:true, dynamicTyping:true, skipEmptyLines:'greedy', encoding:'UTF-8',
        transformHeader: normalizeHeader,
        complete: async (res) => {
          try{
            ingestRows(res.data || []);
            await persistCsv('asesor360', res.data, (inp.files[0]?.name || 'Asesor360.csv'));
          } finally { stopLoader(); }
        },
        error: (err)=>{ stopLoader(); alert('Error leyendo CSV Asesor360: '+ err.message); }
      });
    }

    // =========================
    // Carga Activos
    // =========================
    function ingestActivosRows(rows){
      window.ACTIVOS_RAW = rows;
      
      // reset
      ACT.rows = rows || [];  // Guardar filas originales
      ACT.class_by_isin.clear();
      ACT.veh_by_isin.clear();
      ACT.class_by_subprod_name.clear();
      ACT.class_by_codprod.clear();
      ACT.currency_by_codprod.clear();
      ACT.class_by_prodsub.clear();
      ACT.name_by_codprod.clear();
      ACT.name_by_isin.clear();
      ACT.region_by_isin.clear();
      ACT.region_by_codprod.clear();
      ACT.subclase_by_isin.clear();
      ACT.subclase_by_codprod.clear();
      ACT.veh_by_subprod_name.clear();
      ACT.region_by_subprod_name.clear();
      ACT.subclase_by_subprod_name.clear();
      ACT.product_by_subprod_name.clear();
      ACT.group_by_isin.clear();
      ACT.group_by_codprod.clear();
      ACT.group_by_subprod_name.clear();
      ACT.pm_by_isin.clear();
      ACT.pm_by_codprod.clear();
      ACT.pm_by_subprod_name.clear();
      ACT.dict_by_isin.clear();
      ACT.dict_by_codprod.clear();
      ACT.dict_by_subprod.clear();
      ACT.pm_cats_by_class.clear();
      ACT.subcats_by_class.clear();
      ACT.subcat_label_by_key.clear();
      ACT.coupon_pct_by_isin.clear();
      ACT.coupon_pct_by_codprod.clear();
      ACT.coupon_pct_by_subprod_name.clear();
      ACT.freq_by_isin.clear();
      ACT.freq_by_codprod.clear();
      ACT.freq_by_subprod_name.clear();
      ACT.proxcupon_by_isin.clear();
      ACT.proxcupon_by_codprod.clear();
      ACT.proxcupon_by_subprod_name.clear();

      const data = rows.map(normalizeRowKeys);
      for(const r of data){
        const isin = normIsin( pick(r, ['isin', 'Isin', 'ISIN']) );
        const prod = normTxt( pick(r, ['producto']) );
        const subn = normTxt( pick(r, ['subproducto','nombre']) );
        const claseRaw = pick(r, ['clasedeactivo','clase']);
        const clase = canonClassName(claseRaw);
        const codp = normCodprod( pick(r, ['codsubproduct','codsubproducto','subproduct_id']) );
        const moneda = normTxt( pick(r, ['moneda']) ).replace('US$','USD');
        const veh = String(pick(r, ['vehiculo','vehicle']) || '').trim();
        const gprod = normTxt( pick(r, ['grupoproducto','grupoproducto','productgroup']) );
        const region   = String(pick(r, ['region','geografia','zona','pais']) || '').trim();
        
        // CLAVE: tomar siempre desde "Exposicion" de Activos
        const exposRaw = pick(r, ['exposicion']);
        const exposVal = exposRaw != null ? String(exposRaw).trim() : '';
        
        // 1) PM desde Activos: usar SIEMPRE "Subclasificacion"; fallback "Sub Asset Class"
        // 1) PM desde Activos: usar SOLO Subclasificación (CON tilde)

        let pmRaw = pick(r, ['subclasificación', 'subclasificacion']);

        const pm = canonPMLabel(pmRaw) || 'Otros';

        // === NUEVO: indexar subclase por clase (clave jerárquica) ===
        if (clase) {
          const scCanon = canonSubcatName(exposVal) || '';
          const bag = ACT.subcats_by_class.get(clase) || new Set();
          if (scCanon) bag.add(scCanon);
          ACT.subcats_by_class.set(clase, bag);
          if (scCanon) {
            const key = `${clase}||${scCanon}`;
            if (!ACT.subcat_label_by_key.has(key)) {
              ACT.subcat_label_by_key.set(key, exposVal); // recuerda la primera etiqueta vista
            }
          }
        }

        if(isin){
          if(clase) ACT.class_by_isin.set(isin, clase);
          if(veh)   ACT.veh_by_isin.set(isin, veh);
          const name = pick(r, ['nombre', 'subproducto']);
          if (name) ACT.name_by_isin.set(isin, String(name));
          const dictIsin = pick(r, ['diccionario']);
          if (dictIsin) ACT.dict_by_isin.set(isin, String(dictIsin));
          if (region)   ACT.region_by_isin.set(isin, region);
          if (exposVal) ACT.subclase_by_isin.set(isin, exposVal);
          if (pm) ACT.pm_by_isin.set(isin, pm);
          if (gprod) ACT.group_by_isin.set(isin, gprod);
        }
        if(subn){
          if(clase) ACT.class_by_subprod_name.set(subn, clase);
          if(prod)  ACT.class_by_prodsub.set(`${prod}|${subn}`, clase);
          if(veh)   ACT.veh_by_subprod_name.set(subn, veh);
          if(region) ACT.region_by_subprod_name.set(subn, region);
          if (exposVal) ACT.subclase_by_subprod_name.set(subn, exposVal);
          if (prod) ACT.product_by_subprod_name.set(subn, prod);
          if (pm) ACT.pm_by_subprod_name.set(subn, pm);
          if (gprod) ACT.group_by_subprod_name.set(subn, gprod);
          const dictSub = pick(r, ['diccionario']);
          if (dictSub) ACT.dict_by_subprod.set(subn, String(dictSub));
        }
        if(codp && codp!=='0'){
          if(clase) ACT.class_by_codprod.set(codp, clase);
          if(moneda) ACT.currency_by_codprod.set(codp, moneda.includes('PEN')?'PEN':'USD');
          const name = pick(r, ['nombre','subproducto']);
          if(name) ACT.name_by_codprod.set(codp, String(name));
          const dictCod = pick(r, ['diccionario']);
          if (dictCod) ACT.dict_by_codprod.set(codp, String(dictCod));
          if (region)   ACT.region_by_codprod.set(codp, region);
          if (exposVal) ACT.subclase_by_codprod.set(codp, exposVal);
          if (pm) ACT.pm_by_codprod.set(codp, pm);
          if (gprod) ACT.group_by_codprod.set(codp, gprod);
        }
        
        // clasifica el PM dentro de la Clase ya canonizada
        if (clase){
          const bag = ACT.pm_cats_by_class.get(clase) || new Set();
          bag.add(pm || 'Otros');
          ACT.pm_cats_by_class.set(clase, bag);
        }

        // === Mapas para Cronograma de Pagos ===
        // === Mapas para Cronograma (si no existen aún)
        ACT.coupon_pct_by_isin            ||= new Map();
        ACT.coupon_pct_by_codprod         ||= new Map();
        ACT.coupon_pct_by_subprod_name    ||= new Map();
        ACT.freq_by_isin                  ||= new Map();
        ACT.freq_by_codprod               ||= new Map();
        ACT.freq_by_subprod_name          ||= new Map();
        ACT.proxcupon_by_isin             ||= new Map();
        ACT.proxcupon_by_codprod          ||= new Map();
        ACT.proxcupon_by_subprod_name     ||= new Map();

        // Funciones de normalización
        const normPct = v => {
          if (v === null || v === undefined || v === '') return null;
          const s = String(v).trim().replace('%','').replace(/\s/g,'').replace(',','.');
          const n = Number(s);
          if (!Number.isFinite(n)) return null;
          return Math.abs(n) <= 1 ? n*100 : n; // 0.05 → 5
        };
        const normInt = v => {
          if (v === null || v === undefined || v === '') return null;
          const s = String(v).trim().replace(/\s/g,'');
          const n = parseInt(s, 10);
          return Number.isFinite(n) ? n : null;
        };
        const normDate = v => {
          if (v === null || v === undefined || v === '') return null;
          const d = typeof parseDateLike === 'function' ? parseDateLike(v) : new Date(v);
          return (d && !isNaN(d)) ? d : null;
        };

        const cupPct = normPct(coalesce(pick(r, [
          'cupon',
          'tasacupon',      // "Tasa Cupon" → "tasacupon"
          'dividendyield'   // "Dividend Yield" → "dividendyield"
        ])));

        const freq = normInt(coalesce(pick(r, [
          'frecuenciacupon',  // "Frecuencia Cupon" → "frecuenciacupon"
          'freq'
        ])));

        const prox = normDate(coalesce(pick(r, [
          'fecha1erpago',     // "Fecha 1er Pago" → "fecha1erpago"
          'firstpaymentdate'
        ])));

        if (cupPct !== null && cupPct > 0 && isin) {
        }

        // Log ANTES de guardar en ACT
        if (isin === 'US4642872000' || isin === 'US78463V1070' || isin === 'US9220428588' || isin === 'US92206C4096') {
        }

        // Poblar (prioridad ISIN → CodSub → Subproducto)
        if (cupPct !== null){
          if (isin)   ACT.coupon_pct_by_isin.set(isin, cupPct);
          if (codp)   ACT.coupon_pct_by_codprod.set(codp, cupPct);
          if (subn)   ACT.coupon_pct_by_subprod_name.set(subn, cupPct);
          
          // VERIFICAR lo que se guardó
          if (isin === 'US4642872000' || isin === 'US78463V1070' || isin === 'US9220428588' || isin === 'US92206C4096') {
          }
        }
        if (freq !== null && freq > 0){
          if (isin)   ACT.freq_by_isin.set(isin, freq);
          if (codp)   ACT.freq_by_codprod.set(codp, freq);
          if (subn)   ACT.freq_by_subprod_name.set(subn, freq);
        }
        if (prox && !isNaN(prox)){
          if (isin)   ACT.proxcupon_by_isin.set(isin, prox);
          if (codp)   ACT.proxcupon_by_codprod.set(codp, prox);
          if (subn)   ACT.proxcupon_by_subprod_name.set(subn, prox);
        }

        // === CIRCUITO PARA ETFs/ACCIONES/CLN (NO BONOS) ===
        if (cupPct === null) {
          // Primero intentar leer Cupon (para CLN)
          let cuponRaw = coalesce(pick(r, ['cupon']));
          let rateValue = null;
          
          if (cuponRaw !== null && cuponRaw !== undefined && cuponRaw !== '') {
            // CLN: tiene columna Cupon
            rateValue = parseFloat(String(cuponRaw).replace(/[,%]/g, ''));
          } else {
            // ETF/Acción: leer Dividend Yield
            const divYieldRaw = coalesce(pick(r, ['dividendyield']));
            if (divYieldRaw !== null) {
              rateValue = parseFloat(String(divYieldRaw).replace(/[,%]/g, ''));
            }
          }
          
          if (rateValue !== null && rateValue > 0) {
            if (isin) ACT.coupon_pct_by_isin.set(isin, rateValue);
            if (codp) ACT.coupon_pct_by_codprod.set(codp, rateValue);
            if (subn) ACT.coupon_pct_by_subprod_name.set(subn, rateValue);
            
            const tipo = cuponRaw ? 'CLN' : 'ETF/ACCIÓN';
          }
        }
      }
      ACT.loaded = true;
      // Sin mensaje de carga
      
      // Sincroniza MODELOS_PM si PMs cambiaron al recargar Activos
      Object.keys(MODELOS).forEach(perf=>{
        ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"].forEach(clase=>{
          ensureModelPMFor(perf, clase);
          normalizePMTotals(perf, clase);
        });
      });
    }
    // =========================
    // Ingestar Ratings.csv
    // =========================
    function ingestRatingsRows(rows){
      window.RATINGS_RAW = rows;
      
      // Reset
      RATINGS.rows = rows || [];
      RATINGS.by_isin.clear();
      RATINGS.by_codprod.clear();
      
      const data = rows.map(normalizeRowKeys);
      
      // Columnas de ratings esperadas (en orden)
      const ratingCols = ['aaa+','aaa','aaa-','aa+','aa','aa-','a+','a','a-',
                          'bbb+','bbb','bbb-','bb+','bb','bb-','b+','b','b-',
                          'ccc+','ccc','ccc-','cc+','cc','cc-','c+','c','c-','nr'];
      
      for(const r of data){
        const isin = normIsin( pick(r, ['isin', 'Isin', 'ISIN']) );
        const codp = normCodprod( pick(r, ['codsubproducto','codsubproduct']) );
        
        // Extraer exposición por rating
        const exposures = {};
        let hasData = false;
        
        for(const rating of ratingCols){
          const val = toNum(r[rating]);
          if(val > 0){
            exposures[rating.toUpperCase()] = val;
            hasData = true;
          }
        }
        
        // Guardar en los Maps si tiene datos
        if(hasData){
          if(isin) RATINGS.by_isin.set(isin, exposures);
          if(codp && codp!=='0') RATINGS.by_codprod.set(codp, exposures);
        }
      }
      
      RATINGS.loaded = true;
      
      const infoEl = document.getElementById('ratingsInfo');
      if(infoEl){
        // Sin mensaje de carga
        infoEl.style.color = '#16a34a';
      }
      
      // Re-renderizar Renta Fija si ya hay datos
      if(LAST_HOLDINGS.USD?.length || LAST_HOLDINGS.PEN?.length){
        try { renderRentaFijaTables(); } catch(e){ console.error('[Ratings] Error rendering Renta Fija', e); }
      }
    }

    // =========================
    // Ingestar Sectores.csv
    // =========================
    function ingestSectoresRows(rows){
      window.SECTORES_RAW = rows;
      
      // Reset
      SECTORES.rows = rows || [];
      SECTORES.by_isin.clear();
      SECTORES.by_codprod.clear();
      
      const data = rows.map(normalizeRowKeys);
      
      // Columnas de sectores esperadas
      const sectorCols = ['materials', 'communicationservices', 'consumerstaples', 
                          'consumerdiscretionary', 'energy', 'financials', 'industrials', 
                          'informationtechnology', 'utilities', 'healthcare', 
                          'realestate', 'government'];
      
      for(const r of data){
        const isin = normIsin( pick(r, ['isin', 'Isin', 'ISIN']) );
        const codp = normCodprod( pick(r, ['codsubproducto','codsubproduct']) );
        
        // Extraer exposición por sector
        const exposures = {};
        let hasData = false;
        
        for(const sector of sectorCols){
          const val = toNum(r[sector]);
          if(val > 0){
            // Mapeo de sectores normalizados a nombres finales
            const sectorNames = {
              'materials': 'Materials',
              'communicationservices': 'Communication Services',
              'consumerstaples': 'Consumer Staples',
              'consumerdiscretionary': 'Consumer Discretionary',
              'energy': 'Energy',
              'financials': 'Financials',
              'industrials': 'Industrials',
              'informationtechnology': 'Information Technology',
              'utilities': 'Utilities',
              'healthcare': 'Health Care',
              'realestate': 'Real Estate',
              'government': 'Government'
            };
            const sectorKey = sectorNames[sector] || sector;
            exposures[sectorKey] = val;
            hasData = true;
          }
        }
        
        // Guardar en los Maps si tiene datos
        if(hasData){
          if(isin) SECTORES.by_isin.set(isin, exposures);
          if(codp && codp!=='0') SECTORES.by_codprod.set(codp, exposures);
        }
      }
      
      SECTORES.loaded = true;
      
      // Re-renderizar Renta Fija si ya hay datos
      if(LAST_HOLDINGS.USD?.length || LAST_HOLDINGS.PEN?.length){
        try { renderRentaFijaTables(); } catch(e){ console.error('[Sectores] Error rendering Renta Fija', e); }
      }
    }

    // =========================
    // Ingestar Holdings.csv
    // =========================
    function ingestHoldingsRows(rows, fileName){
      HOLDINGS.rows = rows || [];
      HOLDINGS.by_isin.clear();
      HOLDINGS.by_codprod.clear();
      
      const data = rows.map(normalizeRowKeys);
      
      for(const r of data){
        const isin = normIsin(pick(r, ['isin', 'Isin', 'ISIN']));
        const codp = normCodprod(pick(r, ['codsubproducto','codsubproduct']));
        const nombre = String(r.nombre || '').trim();
        const peso = toNum(r.peso);
        
        if(!nombre || peso <= 0) continue;
        
        const holding = { nombre, peso };
        
        if(isin){
          if(!HOLDINGS.by_isin.has(isin)) HOLDINGS.by_isin.set(isin, []);
          HOLDINGS.by_isin.get(isin).push(holding);
        }
        
        if(codp && codp !== '0'){
          if(!HOLDINGS.by_codprod.has(codp)) HOLDINGS.by_codprod.set(codp, []);
          HOLDINGS.by_codprod.get(codp).push(holding);
        }
      }
      
      HOLDINGS.loaded = true;
      
      // Re-renderizar RV si ya hay datos
      if(LAST_HOLDINGS.USD?.length || LAST_HOLDINGS.PEN?.length){
        try { renderRentaVariableTables(); } catch(e){ console.error('[Holdings] Error rendering RV', e); }
      }
    }

    // =========================
    // Ingestar Region.csv (para RV)
    // =========================
    function ingestRegionRVRows(rows, fileName){
      REGION_RV.rows = rows || [];
      REGION_RV.by_isin.clear();
      REGION_RV.by_codprod.clear();
      
      const data = rows.map(normalizeRowKeys);
      
const regionCols = [
        'northamerica',
        'europe',
        'asiaexpacific',
        'asiaex-pacific',
        'pacific',
        'latinamerica',
        'africa',
        'middleeast'
      ];
      
      const regionNames = {
        'northamerica': 'North America',
        'europe': 'Europe',
        'asiaexpacific': 'Asia ex Pacific',
        'asiaex-pacific': 'Asia ex Pacific',
        'pacific': 'Pacific',
        'latinamerica': 'Latin America',
        'africa': 'Africa',
        'middleeast': 'Middle East'
      };
      
      for(const r of data){
        const isin = normIsin(pick(r, ['isin', 'Isin', 'ISIN']));
        const codp = normCodprod(pick(r, ['codsubproducto','codsubproduct']));
        
        const regionMap = {};
        let hasData = false;
        
        regionCols.forEach(col => {
          const val = toNum(r[col]);
          if(val > 0){
            regionMap[regionNames[col]] = val * 100; // Convertir a porcentaje
            hasData = true;
          }
        });
        
        if(!hasData) continue;
        
        if(isin){
          REGION_RV.by_isin.set(isin, regionMap);
        }
        
        if(codp && codp !== '0'){
          REGION_RV.by_codprod.set(codp, regionMap);
        }
      }
      
      REGION_RV.loaded = true;
      
      // Re-renderizar RV si ya hay datos
      if(LAST_HOLDINGS.USD?.length || LAST_HOLDINGS.PEN?.length){
        try { renderRentaVariableTables(); } catch(e){ console.error('[RegionRV] Error rendering RV', e); }
      }
    }

    function onLoadActivos(){
      const inp = document.getElementById('fileActivos');
      if(!inp || !inp.files || !inp.files[0]){ alert('Selecciona Activos.csv (UTF-8)'); return; }
      startLoader('Leyendo Activos.csv…');
      Papa.parse(inp.files[0], {
        header: true,
        delimiter: ";",
        delimitersToGuess: [";"],
        skipEmptyLines: 'greedy',
        encoding: 'UTF-8',
        transformHeader: normalizeHeader,
        complete: async (res) => {
          try{
            ingestActivosRows(res.data || []);
            await persistCsv('activos', res.data, (inp.files[0]?.name || 'Activos.csv'));
          } finally { stopLoader(); }
        },
        error: (err)=>{ stopLoader(); alert('Error leyendo CSV Activos: '+ err.message); }
      });
    }

    // =========================
    // Clasificación y moneda (usa Activos si existe)
    // =========================
    function mapClassFromActivos(prod, subName, isin, codp){
      // Prioridades: CV by ISIN > Fondos by Codprod > Subproducto name > Prod|Subprod > Heurística
      if(isin && ACT.class_by_isin.has(isin)) return ACT.class_by_isin.get(isin);
      if(prod==='CUENTA VALOR' && isin && ACT.class_by_isin.has(isin)) return ACT.class_by_isin.get(isin);
      if(prod==='FONDOS MUTUOS' && codp && ACT.class_by_codprod.has(codp)) return ACT.class_by_codprod.get(codp);
      if(subName && ACT.class_by_subprod_name.has(subName)) return ACT.class_by_subprod_name.get(subName);
      const key = `${prod}|${subName}`;
      if(prod && subName && ACT.class_by_prodsub.has(key)) return ACT.class_by_prodsub.get(key);
      return '';
    }
    function guessCurrency(row, prod, isin, codp, subName){
      // Base
      let m = String(pick(row, ['moneda','divisa','currency']) || '').toUpperCase();
      if(!m){
        if(toNum(row.saldoactualdetalleusd)>0) m = 'USD';
        else if(toNum(row.saldoactualori)>0) m = 'PEN';
      }
      // Overrides por Activos
      if (subName && ACT.veh_by_subprod_name.get(subName)==='BEST') m = 'USD';
      if(isin && ACT.veh_by_isin.get(isin)==='BEST') m = 'USD'; // WHY: BEST siempre USD en backend. :contentReference[oaicite:11]{index=11}
      if(prod==='FONDOS MUTUOS' && codp && ACT.currency_by_codprod.has(codp)){
        m = ACT.currency_by_codprod.get(codp);
      }
      if(m==='US$') m='USD';
      if(m!=='USD' && m!=='PEN') m='USD';
      return m;
    }

    // =========================
    // Heurísticas fallback (si no hay Activos)
    // =========================
    function isCashAccount(row) {
      const n = String(pick(row, ['nombre','descripcion','nombreactivo','instrumento']) || '').toUpperCase();
      return n.includes('CUENTA CORRIENTE') || n.includes('CUENTA AHORRO') || n.includes('CTS') || n.includes('CASH');
    }
    function isCuentaAPlazo(row) {
      // Buscar en campos con mayúscula y minúscula
      const producto = (row.Producto || row.producto || '').toString().toLowerCase();
      const subproducto = (row._subn || row.subproducto || '').toString().toLowerCase();
      const tipo = (row.tipo || row.tiposubproducto || '').toString().toLowerCase();
      const nombre = (row.nombre || row.descripcion || '').toString().toLowerCase();
      const vehiculo = (row.vehiculo || '').toString().toLowerCase();
      
      // Verificar si alguno contiene "cuenta a plazo" o "dpf"
      const campos = [producto, subproducto, tipo, nombre, vehiculo].join(' ');
      return campos.includes('cuenta a plazo') || campos.includes('dpf');
    }
    function guessClassHeuristic(row){
      if(isCashAccount(row)) return 'Liquidez';
      if(isCuentaAPlazo(row)) return 'Renta Fija CP';
      const prod = String(pick(row,['producto','categoria','tiposubproducto']) || '').toLowerCase();
      const name = String(pick(row,['nombre','descripcion']) || '').toLowerCase();
      const txt = prod + ' ' + name;
      if(/accion|equity|etf|rv|stock/.test(txt)) return 'Renta Variable';
      if(/bono|renta fija|bond|note|debenture/.test(txt)) return 'Renta Fija MP';
      if(/alternativo|commodity|oro|private|hedge/.test(txt)) return 'Alternativo';
      return 'Renta Fija MP';
    }

    // =========================
    // Charts
    // =========================
    function renderGroupedBar(canvasId, classes, sumsUSD, sumsPEN){
      const canvas = document.getElementById(canvasId);
      if(!canvas) return;
      const ctx = canvas.getContext('2d');
      if(charts.grouped) charts.grouped.destroy();
      
      // Obtener tipo de cambio para dolarizar PEN
      const tcInput = document.getElementById('tipoCambio');
      const tc = parseFloat(tcInput?.value) || 3.40;
      
      const totUSD = classes.reduce((a,c)=>a+(sumsUSD[c]||0),0) || 1;
      const totPEN = classes.reduce((a,c)=>a+(sumsPEN[c]||0),0) || 1;
      
      // Calcular Consolidado (USD + PEN dolarizado)
      const sumsConsolidado = {};
      classes.forEach(c => {
        sumsConsolidado[c] = (sumsUSD[c] || 0) + ((sumsPEN[c] || 0) / tc);
      });
      const totConsolidado = classes.reduce((a,c)=>a+(sumsConsolidado[c]||0),0) || 1;
      
      const dataUSD = classes.map(c => totUSD>0 ? (sumsUSD[c]||0)/totUSD*100 : 0);
      const dataPEN = classes.map(c => totPEN>0 ? (sumsPEN[c]||0)/totPEN*100 : 0);
      const dataConsolidado = classes.map(c => totConsolidado>0 ? (sumsConsolidado[c]||0)/totConsolidado*100 : 0);
      
      charts.grouped = new Chart(ctx, {
        type: 'bar',
        data: { 
          labels: classes, 
          datasets: [
            { label: 'USD', data: dataUSD, backgroundColor: '#060E46' },
            { label: 'PEN', data: dataPEN, backgroundColor: '#9694FF' },
            { label: 'Consolidado', data: dataConsolidado, backgroundColor: '#CAD1D8' }
          ]
        },
        options: {
          responsive: true, 
          maintainAspectRatio: false,
          plugins: { 
            legend: { 
              display: true, 
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13 }
              }
            },
            datalabels: { 
              anchor: 'end', 
              align: 'end', 
              formatter: (v) => v.toFixed(1), 
              color: '#333', 
              font: { weight: 'bold', size: 13 } 
            } 
          },
          scales: { 
            x: { 
              grid: { display: false },
              ticks: {
                font: { size: 13 }
              }
            }, 
            y: { 
              beginAtZero: true, 
              max: 100, 
              grid: { display: false }, 
              ticks: { 
                callback: (v) => v,
                font: { size: 13 }
              } 
            } 
          }
        },
        plugins: [ChartDataLabels]
      });
    }
    function renderDonut(canvasId, totUSD, totPEN){
      const canvas = document.getElementById(canvasId);
      if(!canvas) return;
      const ctx = canvas.getContext('2d');
      if(charts.donut) charts.donut.destroy();
      const total = (toNum(totUSD) + toNum(totPEN));
      const pctUSD = total>0 ? (toNum(totUSD)/total*100) : 0;
      const pctPEN = total>0 ? (toNum(totPEN)/total*100) : 0;
      charts.donut = new Chart(ctx, {
        type:'doughnut',
        data:{ 
          labels:['USD','PEN'], 
          datasets:[{ 
            data:[pctUSD,pctPEN], 
            backgroundColor:['#060E46','#9694FF'],
            borderWidth: 2,
            borderColor: '#fff'
          }] 
        },
        options:{ 
          responsive:true, 
          maintainAspectRatio:false,
          cutout: '65%',
          plugins:{ 
            legend:{ 
              display:true, 
              position:'bottom', 
              labels:{ 
                boxWidth:15, 
                padding:12, 
                font:{ size:13 } 
              } 
            }, 
            datalabels:{ 
              formatter:(v)=>v.toFixed(1), 
              color:'#fff', 
              font:{weight:'bold', size:13} 
            } 
          } 
        },
        plugins:[ChartDataLabels]
      });
    }

    function renderTablaConsolidada(classCurrencyTable, totalDolarizadoGlobal){
      const tb = document.getElementById('tablaGuiaBodyConsolidada');
      if(!tb) return;
      tb.innerHTML = '';
      const CLASES = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];
      const fmtUSD0 = v => fmtMoney(v,'USD');
      const fmtPEN0 = v => fmtMoney(v,'PEN');
      CLASES.forEach(c=>{
        const row = classCurrencyTable[c] || { monto_usd_nativo:0, monto_pen_nativo:0, total_dolarizado:0 };
        const peso = totalDolarizadoGlobal>0 ? (row.total_dolarizado/totalDolarizadoGlobal*100) : 0;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="left">${c}</td>
          <td class="num">${fmtUSD0(row.monto_usd_nativo||0)}</td>
          <td class="num">${fmtPEN0(row.monto_pen_nativo||0)}</td>
          <td class="num">${fmtUSD0(row.total_dolarizado||0)}</td>
          <td class="num">${peso === 0 ? ' - ' : (peso.toFixed(1) + '%')}</td>`;
        tb.appendChild(tr);
      });
      const totUSD = Object.values(classCurrencyTable).reduce((a,b)=>a+toNum(b.monto_usd_nativo),0);
      const totPEN = Object.values(classCurrencyTable).reduce((a,b)=>a+toNum(b.monto_pen_nativo),0);
      const trTot = document.createElement('tr');
      trTot.className='row-total';
      trTot.innerHTML = `
        <td class="left"><strong>Total</strong></td>
        <td class="num"><strong>${fmtUSD0(totUSD)}</strong></td>
        <td class="num"><strong>${fmtPEN0(totPEN)}</strong></td>
        <td class="num"><strong>${fmtUSD0(totalDolarizadoGlobal||0)}</strong></td>
        <td class="num"><strong>100.0%</strong></td>`;
      tb.appendChild(trTot);
    }

    // =========================
    // Posiciones
    // =========================
    
    // --- Normalizador y prioridad de Vehículo (orden requerido) ---
    function _strip(s){ return String(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,''); }
    function _norm(s){ return _strip(s).toUpperCase(); }

    // Prioridad (0 = primero). Ajusta expresiones si tus etiquetas exactas difieren.
    const VEH_PRIORITY = [
      /\bCUENTAS?\b/,                                    // 1) Cuentas (vehículo)
      /\bDPF\b|PLAZO|DEPOSITO/,                         // 2) DPF
      /FONDO\s+MUTUO/,                                  // 3) Fondo Mutuo
      /FONDO\s+CERRADO/,                                // 4) Fondo Cerrado
      /\bETF\b/,                                        // 5) ETF
      /\bREIT\b/,                                       // 6) REIT
      /\bBEST\b/,                                       // 7) BEST
      /SMART\s*DEPOSIT/,                                // 8) Smart Deposit
      /\bBONO\b|BOND|RENTA\s*FIJA|DEUDA/,               // 9) Bonos
      /PAPELES?\s*COMERCIALES?/,                        // 10) Papeles Comerciales
      /ACCION|EQUITY/                                   // 11) Acciones
      // 12) cualquier otro: por default
    ];

    function vehRank(rawVeh){
      const v = _norm(rawVeh);
      for (let i = 0; i < VEH_PRIORITY.length; i++) {
        if (VEH_PRIORITY[i].test(v)) return i;
      }
      return VEH_PRIORITY.length; // "otros"
    }

    // Comparador principal por Vehículo; fallback: nombre
    function compareByVehiculo(a, b){
      // Fallback de 'vehiculo' desde subproducto si está vacío
      const vehA = a.vehiculo || (a._subn ? ACT.product_by_subprod_name.get(a._subn) : '');
      const vehB = b.vehiculo || (b._subn ? ACT.product_by_subprod_name.get(b._subn) : '');
      const ra = vehRank(vehA), rb = vehRank(vehB);
      if (ra !== rb) return ra - rb;

      // Si empatan por Vehículo, ordena por nombre (estándar)
      return String(a.nombre||'').localeCompare(String(b.nombre||''), 'es');
    }

    // Helper: detectar si es posición nueva (minimodales)
    function isNewHoldingRow(r){
      const id = String(r?._rid || '');
      return id.includes('-OA-') || id.includes('-BOND-') || id.includes('-DPF-');
    }

    function compareByRegionThenVehiculo(a, b){
      // 1. Inicial vs Nuevo (iniciales primero)
      const esNuevoA = isNewHoldingRow(a);
      const esNuevoB = isNewHoldingRow(b);
      if (esNuevoA !== esNuevoB) return esNuevoA ? 1 : -1;

      // 2. Por vehículo (Cuentas, Fondo Mutuo, DPF, ETF, Bonos, Acciones, BEST, Otros)
      const vv = compareByVehiculo(a, b);
      if (vv !== 0) return vv;

      // 3. Por región/PM (dentro de cada vehículo)
      const ra = _rankPM(a.clase, _pmOfHolding(a));
      const rb = _rankPM(b.clase, _pmOfHolding(b));
      if (ra !== rb) return ra - rb;

      // 4. Por nombre (alfabético)
      const na = String(a.nombre || '');
      const nb = String(b.nombre || '');
      return na.localeCompare(nb, 'es', {sensitivity:'base'});
    }

    // Para ordenar los GRUPOS (subclases) dentro de cada clase
    function compareRegionGroups(clase, labelA, labelB){
      const ra = _rankPM(clase, labelA);
      const rb = _rankPM(clase, labelB);
      if (ra !== rb) return ra - rb;
      return String(labelA||'').localeCompare(String(labelB||''), 'es', {sensitivity:'base'});
    }

    function groupBy(arr, keyFn){
      const m = new Map();
      for (const x of arr){
        const k = keyFn(x);
        const a = m.get(k) || [];
        a.push(x);
        m.set(k, a);
      }
      return m;
    }

    function renderHoldingsTables(holdingsByCurrency){
      const ORDER = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Fija LP","Renta Variable","Derivados","Alternativo"];
      const tables = [
        { cur:'USD', bodyId:'holdBodyUSD' },
        { cur:'PEN', bodyId:'holdBodyPEN' },
        { cur:'TOTAL', bodyId:'holdBodyTotal' }
      ];

      tables.forEach(({cur, bodyId})=>{
        const currencyForFormat = (cur === 'TOTAL') ? 'USD' : cur;
        
        const tb = document.getElementById(bodyId);
        if(!tb) return;
        tb.innerHTML = '';

        // Obtener filas según la moneda
        let rows;
        let tcPenUsd = 1; // Tipo de cambio para conversión

        if (cur === 'TOTAL') {
          // Combinar USD + PEN y convertir todo a USD
          const tcInput = document.getElementById('tipoCambio');
          tcPenUsd = parseFloat(tcInput?.value) || 3.40;
          
          const rowsUSDRaw = (holdingsByCurrency['USD'] || []).filter(r => toNum(r.valor_mercado) >= 0);
          const rowsPEN = (holdingsByCurrency['PEN'] || []).filter(r => toNum(r.valor_mercado) >= 0);
          
          // Agregar _originalMoneda a filas USD
          const rowsUSD = rowsUSDRaw.map(r => ({
            ...r,
            _originalMoneda: 'USD'
          }));
          
          // Crear copias de filas PEN SIN convertir valor_mercado (se convierte solo para totales/pesos)
          const rowsPENConverted = rowsPEN.map(r => ({
            ...r,
            _originalMoneda: 'PEN',
            _valorMercadoUSD: toNum(r.valor_mercado) / tcPenUsd // Guardar valor convertido para cálculos
          }));
          
          rows = [...rowsUSD, ...rowsPENConverted];
        } else {
          rows = (holdingsByCurrency[cur] || []).filter(r => toNum(r.valor_mercado) >= 0);
        }
        if(rows.length===0){
          const tr = document.createElement('tr');
          tr.innerHTML = `<td class="center muted" colspan="10">No hay activos en ${cur}</td>`;
          tb.appendChild(tr);
          return;
        }

        const isCashProd = (sub)=>{ const p = sub ? ACT.product_by_subprod_name.get(sub) : ''; return p==='CUENTA AHORRO' || p==='CUENTA CORRIENTE'; };
        const isCTSProd  = (sub)=>{ const p = sub ? ACT.product_by_subprod_name.get(sub) : ''; return p==='CTS'; };
        const netFromCashMgmt = (sub)=>{
          const ap  = toNum(APORTES[cur].get(sub) || 0);
          const fx  = (toNum(FX_IN[cur].get(sub) || 0) - toNum(FX_OUT[cur].get(sub) || 0));
          const asg = toNum(ASIG[cur].get(sub) || 0);
          return ap + fx - asg;
        };
        const cvFor = (r)=> {
          if (cur === 'TOTAL') {
            // Para TOTAL, usar la moneda original del registro
            const moneda = r._originalMoneda || r.Moneda;
            return toNum(edits[moneda]?.get(r._rid)) || 0;
          }
          return toNum(edits[cur]?.get(r._rid)) || 0;
        };

        const rebalanceoFor = (r)=>{
          const sub = r._subn || '';
          const moneda = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda) : cur;
          if (esCuentaFondeable(r) && edits[moneda]?.has(r._rid)) {
            return cvFor(r);
          }
          return isCashProd(sub) ? netFromCashMgmt(sub) : cvFor(r);
        };

        const montoFinalOf = (r)=>{
          const base = toNum(r.valor_mercado);
          const sub  = r._subn || '';
          const moneda = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda) : cur;
          // Si es cuenta fondeable con edits, usar edits
          if (esCuentaFondeable(r) && edits[moneda]?.has(r._rid)) {
            return base + cvFor(r);
          }
          // Si es cuenta normal (CUENTA AHORRO/CORRIENTE), usar cash mgmt
          return isCashProd(sub) ? (base + netFromCashMgmt(sub)) : (base + cvFor(r));
        };

        // Para TOTAL: usar valor dolarizado en cálculos de totales
        const valorParaTotal = (r) => {
          if (cur === 'TOTAL' && r._originalMoneda === 'PEN') {
            return r._valorMercadoUSD || (toNum(r.valor_mercado) / tcPenUsd);
          }
          return toNum(r.valor_mercado);
        };
        
        const totalValor = rows.reduce((a,r)=> a + valorParaTotal(r), 0);
        const totalFinal = rows.reduce((a,r)=> {
          const mf = montoFinalOf(r);
          if (cur === 'TOTAL' && r._originalMoneda === 'PEN') {
            return a + mf / tcPenUsd;
          }
          return a + mf;
        }, 0);
        const sumCV = (rs) => rs.reduce((a,r)=> {
          const reb = rebalanceoFor(r);
          if (cur === 'TOTAL' && r._originalMoneda === 'PEN') {
            return a + reb / tcPenUsd;
          }
          return a + reb;
        }, 0);

        let totalCompraVenta = 0;
        let totalMontoFinal  = 0;

        ORDER.forEach(cls=>{
          const g = rows.filter(r => r.clase === cls);
          if(!g.length) return;

          // Subtotales por clase (para TOTAL: usar valores dolarizados)
          const subValor = g.reduce((a,r)=> a + valorParaTotal(r), 0);
          const subCV    = g.reduce((a,r)=> {
            const reb = rebalanceoFor(r);
            if (cur === 'TOTAL' && r._originalMoneda === 'PEN') {
              return a + reb / tcPenUsd;
            }
            return a + reb;
          }, 0);
          const subFinal = g.reduce((a,r)=> {
            const mf = montoFinalOf(r);
            if (cur === 'TOTAL' && r._originalMoneda === 'PEN') {
              return a + mf / tcPenUsd;
            }
            return a + mf;
          }, 0);
          const subPeso       = totalValor > 0 ? (subValor/totalValor*100) : 0;
          const subPesoFinal  = totalFinal > 0 ? (subFinal/totalFinal*100) : 0;

          // Calcular monto sugerido del modelo
          const perfilActual = document.getElementById('perfil')?.value || 'Moderado';
          const modelo = getModelForPerfil(perfilActual);
          const pctModelo = modelo[cls] || 0;
          const montoSugerido = (totalValor * pctModelo / 100);

          const trSub = document.createElement('tr');
          trSub.className = 'row-sub';
          trSub.innerHTML = `
            <td class="left">${cls}</td>
            <td colspan="2" class="left" style="color:#001391;padding-left:16px;">
              <span style="font-weight:600;">Monto Sugerido:</span> 
              <span style="font-weight:700;">${fmtMoney(montoSugerido, currencyForFormat)}</span> 
              <span style="font-weight:600;">(${pctModelo.toFixed(1)}%)</span>
            </td>
            <td class="center"></td>
            <td class="num center">${fmtMoney(subValor, currencyForFormat)}</td>
            <td class="num center">${subPeso===0 ? ' - ' : (subPeso.toFixed(1)+'%')}</td>
            <td class="center"></td>
            <td class="num center">${fmtMoney(subFinal, currencyForFormat)}</td>
            <td class="num center">${subPesoFinal===0 ? ' - ' : (subPesoFinal.toFixed(1)+'%')}</td>
            <td class="num">${fmtMoney(subCV, currencyForFormat)}</td>
            <td></td>
            <td></td>`;
          tb.appendChild(trSub);

          // Ordenar directamente por: Inicial/Nuevo → Vehículo → Región → Nombre
          g.sort(compareByRegionThenVehiculo);
          
          g.forEach(r=>{
              // Para peso: usar valor dolarizado si es TOTAL
              const valorParaPeso = (cur === 'TOTAL' && r._originalMoneda === 'PEN') 
                ? (r._valorMercadoUSD || toNum(r.valor_mercado) / tcPenUsd) 
                : toNum(r.valor_mercado);
              const peso      = totalValor  > 0 ? (valorParaPeso/totalValor*100) : 0;
              const mov       = rebalanceoFor(r);
              const mf        = montoFinalOf(r);
              // Para peso final: usar valor dolarizado si es TOTAL
              const mfParaPeso = (cur === 'TOTAL' && r._originalMoneda === 'PEN') ? mf / tcPenUsd : mf;
              const pesoFinal = totalFinal   > 0 ? (mfParaPeso/totalFinal*100) : 0;
              
              // Moneda para formato de esta fila
              const monedaFila = (cur === 'TOTAL') ? (r._originalMoneda || 'USD') : cur;
              const sub       = r._subn || '';
              const prod      = sub ? ACT.product_by_subprod_name.get(sub) : '';
              
              // Determinar moneda para edits (TOTAL usa moneda original)
              const moneda = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda) : cur;

              const vehTxt   = String(r.vehiculo || '').toUpperCase();
              const isBond   = !!r.isBond || vehTxt.includes('BONO');
              const isCash   = (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE');
              const isCTS    = (prod === 'CTS');
              const isFondoCerrado = /FONDO\s*CERRADO/.test(vehTxt);
              const isBEST         = /\bBEST\b/.test(vehTxt);
              const isSmartDeposit = /SMART\s*DEPOSIT/.test(vehTxt);
              const { gprod } = _prodVehGroupOf(r);
              const isCLN = (gprod === 'CLN');
              const isNuevoCLN = isCLN && r._rid && r._rid.includes('-OA-');
              const isAutocall = (gprod === 'Autocall');
              const isNuevoAutocall = isAutocall && r._rid && r._rid.includes('-OA-');
              const isTwinWin = (gprod === 'Twin Win');
              const isNuevoTwinWin = isTwinWin && r._rid && r._rid.includes('-OA-');
              const isReadOnly = isCash || isCTS || isBond || isFondoCerrado || (isBEST && !isNuevoCLN && !isNuevoAutocall && !isNuevoTwinWin) || isSmartDeposit;

              const fechaDisplay = (isCash || prod === 'CTS') ? '' : String(r.fecha_compra || '');

              // Lógica especial para DPF de Asesor360
              const isDPFFromA360 = isCuentaAPlazo(r) && !r._rid?.includes('-OA-');
              const dpfRoto = isDPFFromA360 && mov < 0;

              const rebCell = isReadOnly
                ? `<span class="locked">${fmtMoney(mov, currencyForFormat)}</span>`
                : isDPFFromA360
                  ? `<span class="locked">${dpfRoto ? fmtMoney(mov, currencyForFormat) : '-'}</span>`
                  : esCuentaFondeable(r)
                    ? `<span class="cuenta-fondeo-display" style="display:block;width:100px;text-align:right;padding:4px 6px;color:${edits[moneda]?.has(r._rid) && edits[moneda]?.get(r._rid) < 0 ? '#dc2626' : '#16a34a'};font-weight:500;">
                         ${edits[moneda]?.has(r._rid) ? moneyByCur(edits[moneda]?.get(r._rid), currencyForFormat) : ''}
                       </span>`
                  : `<input type="text" class="cv-input" data-cur="${moneda}" data-id="${r._rid}"
                           inputmode="numeric" autocomplete="off"
                           style="width:100px;text-align:right;padding:4px 6px;"
                           value="${edits[moneda]?.has(r._rid) ? Number(edits[moneda]?.get(r._rid)).toLocaleString('en-US',{maximumFractionDigits:0,useGrouping:true}) : ''}"
                           placeholder="0">`;
              const pfCell = (isReadOnly || isDPFFromA360)
                ? `<span class="locked">${pesoFinal===0 ? ' - ' : (pesoFinal.toFixed(1)+'%')}</span>`
                : `<input type="number" step="0.1" inputmode="decimal" autocomplete="off"
                         class="pf-input"
                         data-cur="${moneda}" data-id="${r._rid}"
                         style="width:60px; text-align:right; padding:4px 6px;"
                         value="${totalFinal>0 ? pesoFinal.toFixed(1) : ''}">`;

              const esNuevo = isNewHoldingRow(r);
              const esCuenta = esCuentaFondeable(r);
              const estaActiva = CUENTA_ACTIVA[moneda] && CUENTA_ACTIVA[moneda]._rid === r._rid;
              
              // Calcular saldo de cuenta para el switch
              const saldoCuenta = esCuenta ? (toNum(r.valor_mercado) + (toNum(edits[moneda]?.get(r._rid)) || 0)) : 0;
              
              // Los bonos solo se eliminan desde el mini-modal, no desde holdings principal
              const esBono = String(r._rid || '').includes('-BOND-');
              const btnEliminar = (esNuevo && !esBono)
                ? `<button class="icon-btn btn-eliminar-holding" data-cur="${moneda}" data-id="${r._rid}" title="Eliminar" aria-label="Eliminar">&#10005;</button>`
                : '';
              
              const btnActivacion = esCuenta
                ? `<label class="switch">
                     <input type="checkbox" ${estaActiva ? 'checked' : ''} ${saldoCuenta <= 0 ? 'disabled' : ''} 
                            onchange="toggleCuentaActiva(this, '${r._rid}', '${moneda}')">
                     <span class="slider"></span>
                   </label>`
                : isDPFFromA360
                  ? (dpfRoto
                      ? `<button class="btn-renovar-dpf" data-cur="${moneda}" data-id="${r._rid}" style="background:transparent;border:none;cursor:pointer;font-size:16px;color:#001391;padding:4px 8px;border-radius:4px;" title="Deshacer rotura de DPF">&#8634;</button>`
                      : `<button class="btn-romper-dpf" data-cur="${moneda}" data-id="${r._rid}" data-valor="${r.valor_mercado}" 
                               style="padding:4px 8px;font-size:11px;background:transparent;color:#001391;border:none;cursor:pointer;border-radius:4px;${!CUENTA_ACTIVA[moneda] ? 'opacity:0.4;cursor:not-allowed;' : ''}" 
                               ${!CUENTA_ACTIVA[moneda] ? 'disabled' : ''}>&#10005;</button>`)
                  : btnEliminar;
              
              const concentracion = '';
              
              // Obtener subclasificación (MISMA lógica que Renta Fija/Variable - líneas 3750-3787)
              let subclasificacion = '-';
              const esBonoNuevo = r._rid?.includes('-BOND-');
              const vehiculo = String(r.vehiculo || '').toUpperCase();
              
              // Hardcoded: CUENTA AHORRO, CUENTA CORRIENTE y CTS
              // (sub y prod ya están declaradas arriba en línea 2946-2947)
              if (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE' || prod === 'CTS') {
                subclasificacion = 'Cash y Equivalentes';
              } else if (vehiculo.includes('DPF') && !esNuevo) {
                // DPF inicial: hardcoded
                subclasificacion = 'Cash y Equivalentes';
              } else if (esNuevo && !esBonoNuevo) {
                // Minimodal Agregar Activos: ACTIVOS2.efsub
                const meta = (window.ACTIVOS2 || []).find(a => {
                  if (vehiculo.includes('ETF')) return a.isin === r._isin;
                  if (vehiculo.includes('BEST')) {
                    if (r._isin && a.isin === r._isin) return true;
                    if (a.inst === r.nombre) return true;
                    if (a.veh?.toUpperCase().includes('BEST') && r.grupo && a.grupo?.toUpperCase() === r.grupo?.toUpperCase()) return true;
                    return false;
                  }
                  if (vehiculo.includes('DPF')) return a.veh?.toUpperCase().includes('DPF');
                  if (r.Producto === 'FONDOS MUTUOS') return a.codSub === r._codSub;
                  return false;
                });
                subclasificacion = meta?.subclasificacion || meta?.efsub || r.subclase || '-';
              } else if (esBonoNuevo) {
                // Bono agregado por minimodal: BONDS_RAW.subclasificación
                const bondData = (window.BONDS_RAW || []).find(b => b.bono === r.nombre || b.isin === r._isin);
                subclasificacion = bondData?.['subclasificación'] || '-';
              } else {
                // Posición inicial: ACTIVOS_RAW.subclasificación
                let matchActivos;
                if (r.Producto === 'FONDOS MUTUOS') {
                  // Fondos: match por codsubproducto
                  matchActivos = (window.ACTIVOS_RAW || []).find(a => a.codsubproducto === r._codSub);
                } else {
                  // Otros: match por ISIN
                  matchActivos = (window.ACTIVOS_RAW || []).find(a => a.isin === r._isin);
                }
                subclasificacion = matchActivos?.['subclasificación'] || r.subclase || '-';
              }
              
              // Modificar nombre para DPF: incluir moneda
              let nombreDisplay = String(r.nombre || '');
              const vehCheck = String(r.vehiculo || '').toUpperCase();
              if (vehCheck.includes('DPF') && cur === 'TOTAL') {
                const monedaDPF = r._originalMoneda || r.Moneda || 'USD';
                if (nombreDisplay.startsWith('DPF ')) {
                  nombreDisplay = `DPF ${monedaDPF} ` + nombreDisplay.substring(4);
                } else if (nombreDisplay.startsWith('DPF')) {
                  nombreDisplay = `DPF ${monedaDPF}` + nombreDisplay.substring(3);
                }
              }
              
              const tr = document.createElement('tr');
              tr.classList.add('indent-2');
              tr.innerHTML = `
                <td class="left td-nombre">${nombreDisplay}</td>
                <td>${String(r.vehiculo || '')}</td>
                <td>${subclasificacion}</td>
                <td class="center">${fechaDisplay}</td>
                <td class="num center">${fmtMoney(r.valor_mercado, monedaFila)}</td>
                <td class="num center">${peso===0 ? ' - ' : (peso.toFixed(1)+'%')}</td>
                <td class="num center">${fmtMoney(r.saldoRetenido || 0, monedaFila)}</td>
                <td class="num center" data-final="${cur}:${r._rid}">
                  ${fmtMoney(mf, monedaFila)}
                </td>
                <td class="num center">${pfCell}</td>
                <td class="num">${rebCell}</td>
                <td class="center" data-rid="${r._rid}" data-tipo="activacion">${btnActivacion}</td>
                <td class="center">${concentracion}</td>`;
              tb.appendChild(tr);
            });

          totalCompraVenta += subCV;
          totalMontoFinal  += subFinal;
        });

        // Totales
        const totPeso      = totalValor > 0 ? 100 : 0;
        const totPesoFinal = totalFinal > 0 ? 100 : 0;
        const trTot = document.createElement('tr');
        trTot.className='row-total';
        trTot.innerHTML = `
          <td class="left"><strong>Total ${cur}</strong></td>
          <td></td><td></td><td class="center"></td>
          <td class="num center"><strong>${fmtMoney(totalValor, currencyForFormat)}</strong></td>
          <td class="num center"><strong>${totPeso===0 ? ' - ' : '100.0%'}</strong></td>
          <td class="center"></td>
          <td class="num center"><strong>${fmtMoney(totalMontoFinal, currencyForFormat)}</strong></td>
          <td class="num center"><strong>${totPesoFinal===0 ? ' - ' : '100.0%'}</strong></td>
          <td class="num"><strong>${fmtMoney(totalCompraVenta, currencyForFormat)}</strong></td>
          <td></td>
          <td></td>`;
        tb.appendChild(trTot);
      });

      // Event listeners para botones DPF
      document.querySelectorAll('.btn-romper-dpf').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const cur = btn.dataset.cur;
          
          // Validar que haya cuenta activa
          if (!CUENTA_ACTIVA[cur]) {
            alert('Debe activar una cuenta antes de romper el DPF');
            return;
          }
          
          const id = btn.dataset.id;
          const valor = Number(btn.dataset.valor);
          
          // Vender DPF
          edits[cur].set(id, -valor);
          
          // Depositar dinero en cuenta activa Y trackear
          const cuentaActiva = CUENTA_ACTIVA[cur];
          if (cuentaActiva) {
            const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
            edits[cur].set(cuentaActiva._rid, editCuenta + valor);
            
            // Trackear: registrar que este DPF depositó en esta cuenta
            FONDEO_TRACKING[cur].set(id, { 
              cuentaRid: cuentaActiva._rid, 
              monto: -valor, // negativo porque es una venta
              tipo: 'dpf-roto'
            });
            
          }
          
          renderHoldingsTables(LAST_HOLDINGS);
      renderRentaFijaTables();
          renderPortafolioBonos();
          renderCashBars();
        });
      });

      document.querySelectorAll('.btn-renovar-dpf').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const cur = btn.dataset.cur;
          const id = btn.dataset.id;
          
          // Obtener el valor del DPF roto
          const row = (LAST_HOLDINGS[cur] || []).find(r => r._rid === id);
          const valor = toNum(row?.valor_mercado) || 0;
          
          // Obtener tracking para saber de qué cuenta salió
          const tracking = FONDEO_TRACKING[cur].get(id);
          
          if (tracking && tracking.cuentaRid) {
            // Devolver dinero a la cuenta ORIGINAL
            const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
            edits[cur].set(tracking.cuentaRid, editCuenta - valor);
            
            // Limpiar tracking
            FONDEO_TRACKING[cur].delete(id);
            
          }
          
          // Deshacer venta del DPF
          edits[cur].delete(id);
          
          renderHoldingsTables(LAST_HOLDINGS);
      renderRentaFijaTables();
          renderPortafolioBonos();
          renderCashBars();
        });
      });

      document.querySelectorAll('.btn-eliminar-holding').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const cur = btn.dataset.cur;
          const id = btn.dataset.id;
          
          // 1. DEVOLVER DINERO A LA CUENTA si hay tracking
          const tracking = FONDEO_TRACKING[cur].get(id);
          
          if (tracking && tracking.cuentaRid && tracking.monto > 0) {
            // Devolver el monto a la cuenta original
            const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
            edits[cur].set(tracking.cuentaRid, editCuenta + tracking.monto);
            
            // Limpiar tracking
            FONDEO_TRACKING[cur].delete(id);
          }
          
          // 2. Eliminar de LAST_HOLDINGS
          const idx = LAST_HOLDINGS[cur].findIndex(r => r._rid === id);
          if (idx >= 0) {
            LAST_HOLDINGS[cur].splice(idx, 1);
          }
          
          // 3. Eliminar edits asociados
          edits[cur].delete(id);
          
          // 4. Re-renderizar
          renderHoldingsTables(LAST_HOLDINGS);
          renderRentaFijaTables();
          renderPortafolioBonos();
          renderRentaVariableTables();
          renderPortafolioTables();
          renderCashBars();
        });
      });

      // Delegación: commit solo con Enter o al salir del input
      const hook = (tableId, cur) => {
        const table = document.getElementById(tableId);
        if (!table || table._wired) return;
        table._wired = true;

        // Helper: commit de Compra/Venta
        function commitCV(inputEl) {
          const id  = inputEl.dataset.id;
          // Usar moneda del input (no del closure) para soportar tab Total
          const cur = inputEl.dataset.cur || 'USD';
          const row = (LAST_HOLDINGS[cur] || []).find(x => x._rid === id);

          // Guardar vehículo
          const vehTxt = String(row?.vehiculo || '').toUpperCase();
          const isBond = !!row?.isBond || vehTxt.includes('BONO');

          // Ilíquidos / bloqueados (excepto CLN nuevos)
          const { gprod } = _prodVehGroupOf(row);
          const isNuevoCLN = (gprod === 'CLN') && row._rid && row._rid.includes('-OA-');
          const isNuevoAutocall = (gprod === 'Autocall') && row._rid && row._rid.includes('-OA-');
          const isNuevoTwinWin = (gprod === 'Twin Win') && row._rid && row._rid.includes('-OA-');
          if ((vehTxt.includes('FONDO CERRADO') || (/\bBEST\b/.test(vehTxt) && !isNuevoCLN && !isNuevoAutocall && !isNuevoTwinWin) || /SMART\s*DEPOSIT/.test(vehTxt))) { 
            inputEl.value = ''; 
            return; 
          }
          if (isBond) { inputEl.value = ''; return; } // bonos: solo por su mini-modal
          const sub = row ? row._subn : '';
          const prod = sub ? ACT.product_by_subprod_name.get(sub) : '';
          if (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE') { inputEl.value = ''; return; }

          // Leer número
          let v = Number(String(inputEl.value).replace(/,/g, ''));

          // ► Regla de mínimo (compras > 0)
          const minInv = minInvestForRow(row);
          if (Number.isFinite(v) && v > 0 && minInv > 0 && v < minInv) {
            v = minInv;                                   // forzar al mínimo
            inputEl.setCustomValidity(`Mínimo por ficha: ${minInv.toLocaleString('en-US')}`);
            inputEl.reportValidity();
          } else {
            inputEl.setCustomValidity('');
          }

          // Si es CLN, Autocall o Twin Win nuevo y v > 0, mostrar popup
          const { gprod: gprodCLN } = _prodVehGroupOf(row);
          const isNuevoCLN2 = (gprodCLN === 'CLN') && row._rid && row._rid.includes('-OA-');
          const isNuevoAutocall2 = (gprodCLN === 'Autocall') && row._rid && row._rid.includes('-OA-');
          const isNuevoTwinWin2 = (gprodCLN === 'Twin Win') && row._rid && row._rid.includes('-OA-');
          if ((isNuevoCLN2 || isNuevoAutocall2 || isNuevoTwinWin2) && v > 0 && Number.isFinite(v)) {
            mostrarPopupCLN(row, cur, v, inputEl);
            return;
          }

          // === SISTEMA DE FONDEO CON TRACKING ===
          
          // Obtener valor anterior
          const valorAnterior = toNum(edits[cur].get(id)) || 0;
          const delta = v - valorAnterior;
          
          // VALIDAR CUENTA ACTIVA PARA VENTAS (cuando no hay tracking)
          if (delta < 0) {
            const tracking = FONDEO_TRACKING[cur].get(id);
            if (!tracking && !CUENTA_ACTIVA[cur]) {
              mostrarPopupSeleccionCuenta(cur, function() {
                inputEl.dispatchEvent(new Event('change', { bubbles: true }));
              });
              inputEl.value = valorAnterior > 0 ? valorAnterior.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
              return;
            }
          }
          
          if (delta > 0) {
            // COMPRA: necesita fondos de cuenta activa
            const cuentaActiva = CUENTA_ACTIVA[cur];
            
            if (!cuentaActiva) {
              mostrarPopupSeleccionCuenta(cur, function() {
                inputEl.dispatchEvent(new Event('change', { bubbles: true }));
              });
              inputEl.value = '';
              return;
            }
            
            const rowCuenta = (LAST_HOLDINGS[cur] || []).find(r => r._rid === cuentaActiva._rid);
            if (!rowCuenta) {
              alert('Error: No se encontró la cuenta activa.');
              inputEl.value = '';
              return;
            }
            
            const valorCuenta = toNum(rowCuenta.valor_mercado);
            const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
            const saldoCuenta = valorCuenta + editCuenta;
            
            if (delta > saldoCuenta) {
              // Usar todo el saldo disponible
              const montoEjecutado = valorAnterior + saldoCuenta;
              v = montoEjecutado;
              
              // Descontar todo el saldo de la cuenta
              edits[cur].set(cuentaActiva._rid, editCuenta - saldoCuenta);
              
              // Trackear
              const tracking = FONDEO_TRACKING[cur].get(id) || { cuentaRid: cuentaActiva._rid, monto: 0 };
              tracking.monto += saldoCuenta;
              FONDEO_TRACKING[cur].set(id, tracking);
              
              // Mostrar popup
              alert('Saldo Insuficiente: Compra ejecutada hasta agotar saldo');
              
              // Continuar con la ejecución (no hacer return)
            } else {
              // Hay fondos suficientes, descontar normalmente
              edits[cur].set(cuentaActiva._rid, editCuenta - delta);
              
              const tracking = FONDEO_TRACKING[cur].get(id) || { cuentaRid: cuentaActiva._rid, monto: 0 };
              tracking.monto += delta;
              FONDEO_TRACKING[cur].set(id, tracking);
            }
            
          } else if (delta < 0) {
            // REDUCCIÓN/VENTA: validar que Monto Final no sea negativo
            const valorActual = toNum(row.valor_mercado);
            const montoFinalPropuesto = valorActual + v;
            
            // Si el Monto Final sería negativo, ajustar v al máximo vendible
            if (montoFinalPropuesto < 0) {
              v = -valorActual; // Vender exactamente hasta llegar a 0
            }
            
            // Recalcular delta con el v ajustado
            const deltaReal = v - valorAnterior;
            
            // Procesar devolución a cuenta de origen solo si hay venta real
            if (deltaReal < 0) {
              const tracking = FONDEO_TRACKING[cur].get(id);
              
              if (tracking && tracking.cuentaRid) {
                // Devolver a la cuenta original
                const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
                edits[cur].set(tracking.cuentaRid, editCuenta + Math.abs(deltaReal));
                
                // Actualizar tracking
                tracking.monto += deltaReal; // deltaReal es negativo, así que resta
                
                if (tracking.monto <= 0) {
                  FONDEO_TRACKING[cur].delete(id); // Ya no hay fondeo
                } else {
                  FONDEO_TRACKING[cur].set(id, tracking);
                }
                
                
              } else {
                // No hay tracking (venta de activo original): va a cuenta activa
                const cuentaActiva = CUENTA_ACTIVA[cur];
                
                if (cuentaActiva) {
                  const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
                  edits[cur].set(cuentaActiva._rid, editCuenta + Math.abs(deltaReal));
                }
              }
            }
          }
          // Si delta === 0, no hacer nada
          
          // Guardar edición en el activo
          if (Number.isFinite(v)) edits[cur].set(id, v); else edits[cur].delete(id);

          // Mostrar formateado
          inputEl.value = Number.isFinite(v) && v !== 0
            ? Number(v).toLocaleString('en-US',{maximumFractionDigits:0,useGrouping:true}) : '';

          renderHoldingsTables(LAST_HOLDINGS);
          renderRentaFijaTables();
          renderPortafolioBonos();
          renderRentaVariableTables();
          renderPortafolioTables();
          renderCashBars();
        }

        // Mostrar popup de configuración para CLN
        function mostrarPopupCLN(row, cur, monto, inputEl) {
          const popup = document.getElementById('popupCLNConfig');
          if (!popup) { 
            alert('Popup CLN no encontrado. Verifica que agregaste el HTML del popup.');
            return; 
          }
          
          // Obtener datos del archivo Otros Activos
          const metaActivo = (ACTIVOS2 || []).find(a => {
            // Match por ISIN
            if (row._isin && a.isin === row._isin) return true;
            // Match por nombre normalizado
            if (normTxt(a.inst) === normTxt(row.nombre)) return true;
            // Match por vehículo BEST y grupo
            if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
            return false;
          });
          
          // Buscar cupón/tasa
          const cuponRaw = metaActivo?._cupon || metaActivo?._tasa || '';
          const tasaDefault = cuponRaw ? parseFloat(String(cuponRaw).replace('%', '').trim()) : 0;
          
          // Obtener fechas del archivo
          const fechaInicioDefault = metaActivo?._fecha_inicio || '';
          const fechaFinDefault = metaActivo?._fecha_fin || '';
          
          // Prellenar campos (si ya existen datos guardados, usarlos; si no, usar defaults del archivo)
          const fechaInicioFinal = row.clnFechaInicio || fechaInicioDefault;
          const tasaFinal = row.clnTasaCupon || tasaDefault || '';
          const fechaFinFinal = row.clnFechaFin || fechaFinDefault;
          
          document.getElementById('clnFechaInicio').value = fechaInicioFinal;
          document.getElementById('clnTasaCupon').value = tasaFinal;
          document.getElementById('clnFechaFin').value = fechaFinFinal;
          
          // Mostrar popup primero
          popup.style.display = 'flex';
          
          // DESPUÉS ocultar campo de Tasa Cupón para Twin Win (debe ser después de mostrar el popup)
          setTimeout(() => {
            const { gprod } = _prodVehGroupOf(row);
            const isTwinWin = (gprod === 'Twin Win');
            const tasaInput = document.getElementById('clnTasaCupon');
            const tasaLabel = tasaInput?.previousElementSibling;
            
            if (isTwinWin) {
              if (tasaLabel) tasaLabel.style.display = 'none';
              if (tasaInput) tasaInput.style.display = 'none';
            } else {
              if (tasaLabel) tasaLabel.style.display = 'block';
              if (tasaInput) tasaInput.style.display = 'block';
            }
          }, 0);
          
          // Calcular fecha fin automáticamente
          const inputFechaInicio = document.getElementById('clnFechaInicio');
          inputFechaInicio.onblur = function() {
            const fechaInicioStr = this.value.trim();
            if (!fechaInicioStr) return;
            
            const fechaInicio = parseDMYStrict(fechaInicioStr);
            if (!fechaInicio) return;
            
            // 5 años después
            let fechaFin = new Date(fechaInicio);
            fechaFin.setFullYear(fechaFin.getFullYear() + 5);
            
            // Ajustar al 9 de enero o julio más cercano ANTES de cumplir 5 años
            const mes = fechaFin.getMonth();
            if (mes < 6) {
              fechaFin.setMonth(0); 
              fechaFin.setDate(9);
            } else {
              fechaFin.setMonth(6); 
              fechaFin.setDate(9);
            }
            
            // Ajustar a fecha útil
            const dia = fechaFin.getDay();
            if (dia === 0) fechaFin.setDate(10);
            else if (dia === 6) fechaFin.setDate(11);
            
            const dd = String(fechaFin.getDate()).padStart(2, '0');
            const mm = String(fechaFin.getMonth() + 1).padStart(2, '0');
            const yyyy = fechaFin.getFullYear();
            document.getElementById('clnFechaFin').value = `${dd}/${mm}/${yyyy}`;
          };
          
          // Botón Cancelar
          document.getElementById('clnConfigCancel').onclick = () => {
            popup.style.display = 'none';
            inputEl.value = '';
          };
          
          // Botón Confirmar
          document.getElementById('clnConfigOk').onclick = () => {
            const fechaInicioStr = document.getElementById('clnFechaInicio').value.trim();
            const tasa = parseFloat(document.getElementById('clnTasaCupon').value);
            const fechaFinStr = document.getElementById('clnFechaFin').value.trim();
            
            const { gprod: gprodConfirm } = _prodVehGroupOf(row);
            const isTwinWinConfirm = (gprodConfirm === 'Twin Win');
            if (!fechaInicioStr || (!isTwinWinConfirm && !tasa) || !fechaFinStr) {
              alert('Complete todos los campos');
              return;
            }
            
            // Guardar en el row
            row.clnFechaInicio = fechaInicioStr;
            row.clnTasaCupon = tasa;
            row.clnFechaFin = fechaFinStr;
            
            // SOLO Autocall: guardar tasa como divYield para mostrar en Renta Variable
            const { gprod } = _prodVehGroupOf(row);
            if (gprod === 'Autocall') {
              row.autocallDivYield = tasa; // Guardar para usarlo en renderRentaVariableTables
            }
            
            // Continuar con el commit
            edits[cur].set(row._rid, monto);
            popup.style.display = 'none';
            
            renderHoldingsTables(LAST_HOLDINGS);
            renderRentaFijaTables();
            renderPortafolioBonos();
            renderRentaVariableTables();
            renderPortafolioTables();
            renderCashBars();
          };
          
          inputFechaInicio.focus();
        }

        // Helper: commit de Peso Final
        function commitPF(inputEl) {
          const id = inputEl.dataset.id;
          // Usar moneda del input (no del closure) para soportar tab Total
          const cur = inputEl.dataset.cur || 'USD';
          const rowsAll = LAST_HOLDINGS[cur] || [];
          const row = rowsAll.find(x => x._rid === id);
          if (!row) return;

          // Bloques: Cash, CTS, Bonos
          const isBondVeh = String(row?.vehiculo || '').toUpperCase().includes('BONO');
          if (row?.isBond || isBondVeh) { inputEl.value = ''; return; }
          const sub = row._subn || '';
          const prod = sub ? ACT.product_by_subprod_name.get(sub) : '';
          if (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE' || prod === 'CTS') { inputEl.value = ''; return; }

          const pInput = Number(String(inputEl.value).replace(',', '.')); // %
          if (!Number.isFinite(pInput) || pInput < 0) return;

          // Totales actuales
          const totalFinalNow = rowsAll.reduce((a,r)=>{
            const cv = toNum(edits[cur].get(r._rid)) || 0;
            return a + toNum(r.valor_mercado) + cv;
          }, 0);
          const finalNow_i = toNum(row.valor_mercado) + (toNum(edits[cur].get(id)) || 0);
          const S = totalFinalNow - finalNow_i;
          const p = pInput / 100;

          // Exacto si p<1; fallback proporcional si p>=1
          let newCV = (p < 1) ? (p * S) / (1 - p) : (p * (S + finalNow_i));

          // ► Regla de mínimo (compras > 0)
          const minInv = minInvestForRow(row);
          if (Number.isFinite(newCV) && newCV > 0 && minInv > 0 && newCV < minInv) {
            newCV = minInv;
            inputEl.setCustomValidity(`Mínimo por ficha: ${minInv.toLocaleString('en-US')}`);
            inputEl.reportValidity();
          } else {
            inputEl.setCustomValidity('');
          }

          // === SISTEMA DE FONDEO CON TRACKING PARA % ===
          
          const valorAnterior = toNum(edits[cur].get(id)) || 0;
          const delta = newCV - valorAnterior;
          
          // VALIDAR CUENTA ACTIVA PARA VENTAS (cuando no hay tracking)
          if (delta < 0) {
            const tracking = FONDEO_TRACKING[cur].get(id);
            if (!tracking && !CUENTA_ACTIVA[cur]) {
              mostrarPopupSeleccionCuenta(cur, function() {
                inputEl.dispatchEvent(new Event('change', { bubbles: true }));
              });
              inputEl.value = '';
              return;
            }
          }
          
          if (delta > 0) {
            const cuentaActiva = CUENTA_ACTIVA[cur];
            
            if (!cuentaActiva) {
              mostrarPopupSeleccionCuenta(cur, function() {
                inputEl.dispatchEvent(new Event('change', { bubbles: true }));
              });
              inputEl.value = '';
              return;
            }
            
            const rowCuenta = (LAST_HOLDINGS[cur] || []).find(r => r._rid === cuentaActiva._rid);
            if (!rowCuenta) {
              alert('Error: No se encontró la cuenta activa.');
              inputEl.value = '';
              return;
            }
            
            const valorCuenta = toNum(rowCuenta.valor_mercado);
            const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
            const saldoCuenta = valorCuenta + editCuenta;
            
            if (delta > saldoCuenta) {
              // Usar todo el saldo disponible
              const montoEjecutado = valorAnterior + saldoCuenta;
              newCV = montoEjecutado;
              
              // Descontar todo el saldo de la cuenta
              edits[cur].set(cuentaActiva._rid, editCuenta - saldoCuenta);
              
              // Trackear
              const tracking = FONDEO_TRACKING[cur].get(id) || { cuentaRid: cuentaActiva._rid, monto: 0 };
              tracking.monto += saldoCuenta;
              FONDEO_TRACKING[cur].set(id, tracking);
              
              // Mostrar popup
              alert('Saldo Insuficiente: Compra ejecutada hasta agotar saldo');
              
              // Continuar con la ejecución (no hacer return)
            } else {
              // Hay fondos suficientes, descontar normalmente
              edits[cur].set(cuentaActiva._rid, editCuenta - delta);
              
              const tracking = FONDEO_TRACKING[cur].get(id) || { cuentaRid: cuentaActiva._rid, monto: 0 };
              tracking.monto += delta;
              FONDEO_TRACKING[cur].set(id, tracking);
            }
            
          } else if (delta < 0) {
            // REDUCCIÓN/VENTA: validar que Monto Final no sea negativo
            const valorActual = toNum(row.valor_mercado);
            const montoFinalPropuesto = valorActual + newCV;
            
            // Si el Monto Final sería negativo, ajustar newCV al máximo vendible
            if (montoFinalPropuesto < 0) {
              newCV = -valorActual; // Vender exactamente hasta llegar a 0
            }
            
            // Recalcular delta con el newCV ajustado
            const deltaReal = newCV - valorAnterior;
            
            // Procesar devolución a cuenta de origen solo si hay venta real
            if (deltaReal < 0) {
              const tracking = FONDEO_TRACKING[cur].get(id);
              
              if (tracking && tracking.cuentaRid) {
                const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
                edits[cur].set(tracking.cuentaRid, editCuenta + Math.abs(deltaReal));
                
                tracking.monto += deltaReal;
                
                if (tracking.monto <= 0) {
                  FONDEO_TRACKING[cur].delete(id);
                } else {
                  FONDEO_TRACKING[cur].set(id, tracking);
                }
              } else {
                const cuentaActiva = CUENTA_ACTIVA[cur];
                
                if (cuentaActiva) {
                  const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
                  edits[cur].set(cuentaActiva._rid, editCuenta + Math.abs(deltaReal));
                }
              }
            }
          }

          if (Number.isFinite(newCV)) edits[cur].set(id, newCV);
          else edits[cur].delete(id);

          renderHoldingsTables(LAST_HOLDINGS);
          renderRentaFijaTables();
          renderPortafolioBonos();
          renderRentaVariableTables();
          renderPortafolioTables();
          renderCashBars();
        }

        // 1) Arrow keys para ajustar valores
        table.addEventListener('keydown', (e) => {
          const t = e.target;
          if (t.classList.contains('cv-input')) {
            if (e.key === 'ArrowUp') {
              e.preventDefault();
              const current = Number(String(t.value).replace(/,/g, '')) || 0;
              t.value = Number(current + 10000).toLocaleString('en-US', {maximumFractionDigits:0, useGrouping:true});
            } else if (e.key === 'ArrowDown') {
              e.preventDefault();
              const current = Number(String(t.value).replace(/,/g, '')) || 0;
              t.value = Number(current - 10000).toLocaleString('en-US', {maximumFractionDigits:0, useGrouping:true});
            } else if (e.key === 'Enter') {
              e.preventDefault();
              commitCV(t);
            }
          } else if (t.classList.contains('pf-input')) {
            if (e.key === 'Enter') {
              e.preventDefault();
              commitPF(t);
            }
          }
        });

        // 2) Formatear mientras escribe en Compra/Venta
        table.addEventListener('input', (e) => {
          const t = e.target;
          if (t.classList.contains('cv-input')) {
            const raw = t.value.replace(/,/g, '');
            const num = Number(raw);
            if (raw && !isNaN(num)) {
              t.value = num.toLocaleString('en-US', {maximumFractionDigits:0, useGrouping:true});
            }
          }
        });

        // 3) Confirmar al salir del input
        table.addEventListener('focusout', (e) => {
          const t = e.target;
          if (t.classList.contains('cv-input')) commitCV(t);
          else if (t.classList.contains('pf-input')) commitPF(t);
        });
      };
      hook('tablaHoldUSD', 'USD');
      hook('tablaHoldPEN', 'PEN');
      hook('tablaHoldTotal', 'TOTAL');
      
      // Actualizar círculos morados de violaciones de límites
      if (typeof updateLimitViolationIndicators === 'function') {
        updateLimitViolationIndicators();
      }
    }

    // ========== RENTA FIJA TABLES ==========
    function renderRentaFijaTables() {
      // Escala de ratings para conversión numérica
      const ratingScale = {
        'AAA': 1,
        'AA+': 2, 'AA': 3, 'AA-': 4,
        'A+': 5, 'A': 6, 'A-': 7,
        'BBB+': 8, 'BBB': 9, 'BBB-': 10,
        'BB+': 11, 'BB': 12, 'BB-': 13,
        'B+': 14, 'B': 15, 'B-': 16,
        'CCC+': 17, 'CCC': 18, 'CCC-': 19,
        'CC': 20, 'C': 21, 'D': 22,
        'NR': null
      };
      
      const numeroARating = (num) => {
        const entry = Object.entries(ratingScale).find(([r, n]) => n === Math.round(num));
        return entry ? entry[0] : '-';
      };

      const tables = [
        { cur: 'USD', bodyId: 'rentaFijaBodyUSD' },
        { cur: 'PEN', bodyId: 'rentaFijaBodyPEN' },
        { cur: 'TOTAL', bodyId: 'rentaFijaBodyTotal' }
      ];

      tables.forEach(({ cur, bodyId }) => {
        const tb = document.getElementById(bodyId);
        if (!tb) return;

        tb.innerHTML = '';

        // === LÓGICA PARA TOTAL: combinar USD + PEN dolarizado ===
        let allRows;
        if (cur === 'TOTAL') {
          const tcInput = document.getElementById('tipoCambio');
          const tc = parseFloat(tcInput?.value) || 3.40;
          
          const rowsUSDRaw = (LAST_HOLDINGS['USD'] || []).filter(r => {
            const clase = r.clase || '';
            return clase.includes('Renta Fija');
          });
          
          // Agregar _originalMoneda a filas USD
          const rowsUSD = rowsUSDRaw.map(r => ({
            ...r,
            _originalMoneda: 'USD'
          }));
          
          const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
            const clase = r.clase || '';
            return clase.includes('Renta Fija');
          }).map(r => ({
            ...r,
            valor_mercado: toNum(r.valor_mercado) / tc,
            Moneda: 'USD',
            _originalMoneda: 'PEN'
          }));
          
          allRows = [...rowsUSD, ...rowsPEN];
        } else {
          // Filtrar solo activos de Renta Fija DE ESTA MONEDA
          allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
            const clase = r.clase || '';
            const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
            
            // CRÍTICO: Solo incluir si la moneda coincide con cur
            const esRentaFija = clase.includes('Renta Fija');
            return esRentaFija && moneda === cur;
          });
        }
        
        // Ordenar por tipo de activo: 1.Fondos, 2.ETFs, 3.Bonos, 4.BEST, 5.DPF, 6.Otros
        allRows.sort((a, b) => {
          const tipoOrden = (row) => {
            const veh = String(row.vehiculo || '').toUpperCase();
            const prod = row.Producto;
            
            if (prod === 'FONDOS MUTUOS') return 1;
            if (veh.includes('ETF')) return 2;
            if (veh.includes('BONO')) return 3;
            if (veh.includes('BEST')) return 4;
            if (veh.includes('DPF')) return 5;
            return 6; // Otros
          };
          
          const ordenA = tipoOrden(a);
          const ordenB = tipoOrden(b);
          
          if (ordenA !== ordenB) return ordenA - ordenB;
          
          // Si son del mismo tipo, ordenar alfabéticamente por nombre
          return (a.nombre || '').localeCompare(b.nombre || '', 'es');
        });
        
        // Separar bonos del resto
        const bonos = allRows.filter(r => {
          const vehiculo = String(r.vehiculo || '').toUpperCase();
          return vehiculo.includes('BONO');
        });
        
        const rows = allRows.filter(r => {
          const vehiculo = String(r.vehiculo || '').toUpperCase();
          return !vehiculo.includes('BONO');
        });

        if (rows.length === 0 && bonos.length === 0) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td class="center muted" colspan="10">No hay activos de Renta Fija en ${cur}</td>`;
          tb.appendChild(tr);
          return;
        }

        // Tipo de cambio para conversiones
        const tcParaTotal = (cur === 'TOTAL') ? (parseFloat(document.getElementById('tipoCambio')?.value) || 3.40) : 1;
        
        // Calcular total para pesos (GIPS para bonos, normal para otros)
        const totalValor = allRows.reduce((a, r) => {
          const vehiculo = String(r.vehiculo || '').toUpperCase();
          const esBono = vehiculo.includes('BONO');
          
          // Determinar moneda original del activo
          const monedaActivo = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda || 'USD') : cur;
          
          if (esBono) {
            // GIPS para bonos
            const isinHolding = normIsin(r._isin || r.isin);
            const b = BONDS.find(x => normIsin(x.ISIN) === isinHolding && (x.Moneda || 'USD') === monedaActivo);
            
            if (b) {
              const nominalInicial = currentNominalFromHoldings(monedaActivo, b.id);
              const buyN = lotNom(b.id, 'buy') || 0;
              const sellN = lotNom(b.id, 'sell') || 0;
              const netNom = nominalInicial + buyN - sellN;
              
              if (netNom > 0) {
                const precioLimpio = toNum(b.Precio) || 0;
                const AI = accruedPxPts(b, getAsOfDate());
                let valorBono = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
                
                // Convertir PEN a USD si es TOTAL
                if (cur === 'TOTAL' && monedaActivo === 'PEN') {
                  valorBono = valorBono / tcParaTotal;
                }
                return a + valorBono;
              }
            }
            return a;
          } else {
            // Normal para otros activos
            const base = toNum(r.valor_mercado);
            const monedaEdit = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda || 'USD') : cur;
            const edit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(r._rid) || 0) : 0;
            return a + base + edit;
          }
        }, 0);

        // Renderizar cada instrumento
        rows.forEach(row => {
          const tr = document.createElement('tr');
          
          // Modificar nombre para DPF: incluir moneda
          let nombre = row.nombre || '-';
          const vehiculoCheck = String(row.vehiculo || '').toUpperCase();
          if (vehiculoCheck.includes('DPF') && cur === 'TOTAL') {
            const monedaDPF = row._originalMoneda || row.Moneda || 'USD';
            // Insertar moneda después de "DPF"
            if (nombre.startsWith('DPF ')) {
              nombre = `DPF ${monedaDPF} ` + nombre.substring(4);
            } else if (nombre.startsWith('DPF')) {
              nombre = `DPF ${monedaDPF}` + nombre.substring(3);
            }
          }
          let subclasificacion = '-';
          let region = '-';
          let exposicion = '-';
          
          // Determinar tipo de activo
          const vehiculo = String(row.vehiculo || '').toUpperCase();
          const isETF = vehiculo.includes('ETF');
          const esNuevo = row._rid?.includes('-OA-');
          
          // Variables para datos
          let vol = '-';
          let patrimonio = '-';
          let holdings = '-';
          let rating = '-';
          let duracion = '-';
          let ytw = '-';
          
          // === LÓGICA PARA ETF ===
          if (isETF && row.Producto === 'CUENTA VALOR') {
            
            if (esNuevo) {
              // ETF agregado manualmente: buscar en ACTIVOS2
              const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
              if (meta) {
                vol = meta._vol ? `${meta._vol.toFixed(1)}%` : '-';
                patrimonio = meta._patrimonio ? meta._patrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                rating = meta.rating || '-';
                duracion = meta._dur ? meta._dur.toFixed(2) : '-';
                ytw = meta._tasa ? `${meta._tasa.toFixed(2)}%` : '-';
              }
            } else {
              // ETF de posición inicial: buscar en ACTIVOS_RAW
              const isin = row._isin;
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === isin);
              if (matchActivos) {
                const volRaw = String(matchActivos.vol || '').trim();
                const patrimonioRaw = String(matchActivos.patrimonio || '').trim();
                const holdingsRaw = String(matchActivos.nholdings || '').trim();
                const ratingRaw = String(matchActivos.rating || '').trim();
                const duracionRaw = String(matchActivos.duracion || '').trim();
                const tasaRaw = String(matchActivos.tasa || '').trim();
                
                vol = volRaw ? `${parseFloat(volRaw).toFixed(1)}%` : '-';
                patrimonio = patrimonioRaw ? parseFloat(patrimonioRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                rating = ratingRaw || '-';
                duracion = duracionRaw ? parseFloat(duracionRaw).toFixed(2) : '-';
                ytw = tasaRaw ? `${parseFloat(tasaRaw).toFixed(2)}%` : '-';
              }
            }
          } else if (vehiculo.includes('BEST') && row.Producto === 'CUENTA VALOR') {
            // === LÓGICA PARA BEST (CLN) ===
            if (esNuevo) {
              // BEST agregado manualmente
              vol = '-';
              patrimonio = '-';
              
              const meta = (ACTIVOS2 || []).find(a => {
                // Primero intentar match por ISIN (solo si no está vacío)
                if (row._isin && a.isin === row._isin) return true;
                // Luego por nombre exacto
                if (a.inst === row.nombre) return true;
                return false;
              });
              if (meta) {
                holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '250';
                rating = meta.rating ? String(meta.rating).trim() : '-';
                duracion = meta._dur ? meta._dur.toFixed(2) : '-';
              } else {
                rating = '-';
              }
              
              // Región: tomar de ACTIVOS2 campo "geo"
              region = meta?.geo || row.region || '-';
              
              // YTW: tasa guardada al agregar (campo clnTasaCupon)
              ytw = row.clnTasaCupon ? `${parseFloat(row.clnTasaCupon).toFixed(2)}%` : '-';
              
            } else {
              // BEST de posición inicial
              vol = '-';
              patrimonio = '-';
              
              const isin = row._isin;
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === isin);
              if (matchActivos) {
                // Rating del match por ISIN
                const ratingRaw = String(matchActivos.rating || '').trim();
                rating = ratingRaw || '-';
                
                const holdingsRaw = String(matchActivos.nholdings || '').trim();
                const cuponRaw = String(matchActivos.cupon || '').trim();
                
                holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                ytw = cuponRaw ? `${parseFloat(cuponRaw).toFixed(2)}%` : '-';
              } else {
                // Si no hay match, dejar en blanco
                rating = '-';
              }
              
              // Duración: calcular desde fechavcto hasta hoy
              if (row.fechavcto) {
                const parseDMY = (s) => {
                  const parts = String(s).split('/');
                  if (parts.length !== 3) return null;
                  const d = parseInt(parts[0], 10);
                  const m = parseInt(parts[1], 10) - 1;
                  const y = parseInt(parts[2], 10);
                  return new Date(y, m, d);
                };
                
                const fechaVcto = parseDMY(row.fechavcto);
                if (fechaVcto) {
                  const hoy = new Date();
                  const diffMs = fechaVcto - hoy;
                  const diffDias = Math.round(diffMs / (1000 * 60 * 60 * 24));
                  const diffAnios = (diffDias / 365);
                  duracion = diffAnios.toFixed(2);
                }
              }
            }
            
          } else if (row.Producto === 'FONDOS MUTUOS') {
            // === LÓGICA PARA FONDOS MUTUOS ===
            // Tanto iniciales como nuevos usan ACTIVOS2 (match por codSub)
            const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
            
            if (meta) {
              vol = meta._vol ? `${meta._vol.toFixed(2)}%` : '-';
              patrimonio = meta._patrimonio ? meta._patrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
              holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
              rating = meta.rating || '-';
              duracion = meta._dur ? meta._dur.toFixed(2) : '-';
              ytw = meta._tasa ? `${meta._tasa.toFixed(2)}%` : '-';
            }
            
          } else if (vehiculo.includes('BONO')) {
            // === LÓGICA PARA BONOS ===
            vol = '-';
            patrimonio = '-';
            holdings = '1';
            
            const esNuevo = row._rid?.includes('-BOND-');
            
            if (esNuevo) {
              // Bono agregado desde minimodal: buscar en BONDS_BY_ISIN
              if (typeof BONDS_BY_ISIN !== 'undefined') {
                const bondData = BONDS_BY_ISIN.get(row._isin);
                if (bondData) {
                  rating = bondData.rating || '-';
                  duracion = bondData.duracion ? parseFloat(bondData.duracion).toFixed(2) : '-';
                  ytw = bondData.tasa ? `${parseFloat(bondData.tasa).toFixed(2)}%` : '-';
                }
              }
            } else {
              // Bono de posición inicial: buscar en ACTIVOS_RAW
              const isin = row._isin;
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === isin);
              if (matchActivos) {
                const ratingRaw = String(matchActivos.rating || '').trim();
                const duracionRaw = String(matchActivos.duracion || '').trim();
                const tasaRaw = String(matchActivos.tasa || '').trim();
                
                rating = ratingRaw || '-';
                duracion = duracionRaw ? parseFloat(duracionRaw).toFixed(2) : '-';
                ytw = tasaRaw ? `${parseFloat(tasaRaw).toFixed(2)}%` : '-';
              }
            }
            
          } else if (vehiculo.includes('DPF')) {
            // === LÓGICA PARA DPF ===
            const esNuevo = row._rid?.includes('-OA-');
            
            if (esNuevo) {
              // DPF agregado manualmente
              vol = '-';
              patrimonio = '-';
              holdings = '1';
              
              // Rating: buscar en ACTIVOS2 (Otros Activos) el DPF correspondiente
              const meta = (ACTIVOS2 || []).find(a => a.veh?.toUpperCase().includes('DPF'));
              rating = meta?.rating ? String(meta.rating).trim() : 'BBB+';
              
              // Duración: calcular desde fechavcto hasta hoy
              if (row.fechavcto) {
                const parseDMY = (s) => {
                  const parts = String(s).split('/');
                  if (parts.length !== 3) return null;
                  const d = parseInt(parts[0], 10);
                  const m = parseInt(parts[1], 10) - 1;
                  const y = parseInt(parts[2], 10);
                  return new Date(y, m, d);
                };
                
                const fechaVcto = parseDMY(row.fechavcto);
                if (fechaVcto) {
                  const hoy = new Date();
                  const diffMs = fechaVcto - hoy;
                  const diffDias = Math.round(diffMs / (1000 * 60 * 60 * 24));
                  const diffAnios = (diffDias / 365);
                  duracion = diffAnios.toFixed(2);
                }
              }
              
              // YTW: extraer del nombre (tiene formato "- X.XX%")
              const tasaMatch = row.nombre.match(/(\d+\.?\d*)%/);
              ytw = tasaMatch ? `${parseFloat(tasaMatch[1]).toFixed(2)}%` : '-';
              
            } else {
              // DPF de posición inicial
              vol = '-';
              patrimonio = '-';
              holdings = '1';
              // Rating: buscar el primer CUENTA A PLAZO en ACTIVOS_RAW con rating
              const cuentaPlazoConRating = (ACTIVOS_RAW || []).find(a => 
                a.producto?.toUpperCase().includes('PLAZO') && 
                String(a.rating || '').trim() !== ''
              );
              rating = cuentaPlazoConRating?.rating ? String(cuentaPlazoConRating.rating).trim() : 'BBB+';
              
              // Duración: calcular desde fechavcto hasta hoy
              if (row.fechavcto) {
                const parseDMY = (s) => {
                  const parts = String(s).split('/');
                  if (parts.length !== 3) return null;
                  const d = parseInt(parts[0], 10);
                  const m = parseInt(parts[1], 10) - 1;
                  const y = parseInt(parts[2], 10);
                  return new Date(y, m, d);
                };
                
                const fechaVcto = parseDMY(row.fechavcto);
                if (fechaVcto) {
                  const hoy = new Date();
                  const diffMs = fechaVcto - hoy;
                  const diffDias = Math.round(diffMs / (1000 * 60 * 60 * 24));
                  const diffAnios = (diffDias / 365);
                  duracion = diffAnios.toFixed(2);
                }
              }
              
              // YTW: tasa del row
              const tasaRaw = row.tasa;
              ytw = tasaRaw ? `${parseFloat(tasaRaw).toFixed(2)}%` : '-';
            }
            
          } else if (vehiculo.includes('SMART DEPOSIT') || vehiculo.includes('SMART_DEPOSIT')) {
            // === LÓGICA PARA SMART DEPOSIT ===
            const esNuevo = row._rid?.includes('-OA-');
            
            vol = '-';
            patrimonio = '-';
            holdings = '1';
            
            // Rating: buscar en ACTIVOS_RAW o ACTIVOS2, o BBB+ por defecto
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => a.veh?.toUpperCase().includes('SMART'));
              rating = meta?.rating ? String(meta.rating).trim() : 'BBB+';
            } else {
              const smartConRating = (ACTIVOS_RAW || []).find(a => 
                a.producto?.toUpperCase().includes('SMART') && 
                String(a.rating || '').trim() !== ''
              );
              rating = smartConRating?.rating ? String(smartConRating.rating).trim() : 'BBB+';
            }
            
            // Duración: calcular desde fecha vencimiento hasta hoy
            const fechaVctoRaw = row.fechavcto || row['Fecha Fin'] || row.fechaFin;
            if (fechaVctoRaw) {
              const parseDMY = (s) => {
                const parts = String(s).split('/');
                if (parts.length !== 3) return null;
                const d = parseInt(parts[0], 10);
                const m = parseInt(parts[1], 10) - 1;
                const y = parseInt(parts[2], 10);
                return new Date(y, m, d);
              };
              
              const fechaVcto = parseDMY(fechaVctoRaw);
              if (fechaVcto) {
                const hoy = new Date();
                const diffMs = fechaVcto - hoy;
                const diffDias = Math.round(diffMs / (1000 * 60 * 60 * 24));
                const diffAnios = (diffDias / 365);
                duracion = diffAnios.toFixed(2);
              }
            } else {
              duracion = '-';
            }
            
            // YTW: de Tasa (A360 o Otros Activos)
            const tasaRaw = row.tasa || row.Tasa;
            if (tasaRaw) {
              const tasaNum = parseFloat(String(tasaRaw).replace('%', ''));
              ytw = !isNaN(tasaNum) ? `${tasaNum.toFixed(2)}%` : '-';
            } else {
              ytw = '-';
            }
            
          } else {
            // OTROS ACTIVOS: usar valores por defecto del row
            rating = row.rating || '-';
            duracion = row.duracion || row.duration || '-';
            ytw = row.ytw || row.yield || '-';
          }
          
          // === ASIGNAR SUBCLASIFICACIÓN Y REGIÓN ===
          const esBonoNuevo = row._rid?.includes('-BOND-');
          
          // SUBCLASIFICACIÓN
          if (vehiculo.includes('SMART DEPOSIT') || vehiculo.includes('SMART_DEPOSIT')) {
            // SMART DEPOSIT: hardcoded
            subclasificacion = 'Cash y Equivalentes';
          } else if (vehiculo.includes('DPF') && !esNuevo) {
            // DPF inicial: hardcoded
            subclasificacion = 'Cash y Equivalentes';
          } else if (esNuevo && !esBonoNuevo) {
            // Minimodal Agregar Activos: ACTIVOS2.efsub
            const meta = (ACTIVOS2 || []).find(a => {
              if (vehiculo.includes('ETF')) return a.isin === row._isin;
              if (vehiculo.includes('BEST')) {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              }
              if (vehiculo.includes('DPF')) return a.veh?.toUpperCase().includes('DPF');
              if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
              return false;
            });
            subclasificacion = meta?.subclasificacion || meta?.efsub || row.subclase || '-';
          } else if (esBonoNuevo) {
            // Bono agregado por minimodal: BONDS_BY_ISIN.subclasificación
            if (typeof BONDS_BY_ISIN !== 'undefined') {
              const bondData = BONDS_BY_ISIN.get(row._isin);
              subclasificacion = bondData?.['subclasificación'] || '-';
            }
          } else {
            // Posición inicial: ACTIVOS_RAW.subclasificación
            let matchActivos;
            
            if (row.Producto === 'FONDOS MUTUOS') {
              // Fondos: match por codsubproducto
              matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
            } else {
              // Otros: match por ISIN
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            }
            
            subclasificacion = matchActivos?.['subclasificación'] || row.subclase || '-';
          }
          
          // REGIÓN
          if (esNuevo && !esBonoNuevo) {
            // Minimodal Agregar Activos: ACTIVOS2.geo
            const meta = (ACTIVOS2 || []).find(a => {
              if (vehiculo.includes('ETF')) return a.isin === row._isin;
              if (vehiculo.includes('BEST')) {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              }
              if (vehiculo.includes('DPF')) return a.veh?.toUpperCase().includes('DPF');
              if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
              return false;
            });
            region = meta?.geo || row.region || '-';
          } else if (esBonoNuevo) {
            // Bono agregado por minimodal: BONDS_BY_ISIN.subclase (para región)
            if (typeof BONDS_BY_ISIN !== 'undefined') {
              const bondData = BONDS_BY_ISIN.get(row._isin);
              region = bondData?.subclase || '-';
            }
          } else {
            // Posición inicial: ACTIVOS_RAW.region
            let matchActivos;
            
            if (row.Producto === 'FONDOS MUTUOS') {
              // Fondos: match por codsubproducto
              matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
            } else {
              // Otros: match por ISIN
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            }
            
            region = matchActivos?.region || row.region || '-';
          }
          
          // EXPOSICIÓN
          if (vehiculo.includes('SMART DEPOSIT') || vehiculo.includes('SMART_DEPOSIT')) {
            // SMART DEPOSIT: buscar en ACTIVOS_RAW o ACTIVOS2
            const esNuevoSmart = row._rid?.includes('-OA-');
            if (esNuevoSmart) {
              const meta = (ACTIVOS2 || []).find(a => a.veh?.toUpperCase().includes('SMART'));
              exposicion = meta?.expo || 'Depósitos';
            } else {
              const smartMeta = (ACTIVOS_RAW || []).find(a => a.producto?.toUpperCase().includes('SMART'));
              exposicion = smartMeta?.exposicion || 'Depósitos';
            }
          } else if (vehiculo.includes('DPF')) {
            // DPF (inicial o nuevo): siempre hardcoded
            exposicion = 'Depósitos';
          } else if (esNuevo && !esBonoNuevo) {
            // Minimodal Agregar Activos: ACTIVOS2.expo
            const meta = (ACTIVOS2 || []).find(a => {
              if (vehiculo.includes('ETF')) return a.isin === row._isin;
              if (vehiculo.includes('BEST')) {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              }
              if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
              return false;
            });
            exposicion = meta?.expo || '-';
          } else if (esBonoNuevo) {
            // Bonos: no aplica, se usa en Pool
            exposicion = '-';
          } else {
            // Posición inicial: ACTIVOS_RAW.exposicion
            let matchActivos;
            
            if (row.Producto === 'FONDOS MUTUOS') {
              // Fondos: match por codsubproducto
              matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
            } else if (vehiculo.includes('DPF')) {
              // DPF: hardcoded (no leer de ACTIVOS_RAW)
              matchActivos = null; // No buscar, se usa hardcoded arriba
            } else {
              // Otros: match por ISIN
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            }
            
            exposicion = matchActivos?.exposicion || '-';
          }
          
          const valorBase = toNum(row.valor_mercado);
          const monedaEdit = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
          const valorEdit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(row._rid) || 0) : 0;
          const valorMercado = valorBase + valorEdit;
          const peso = totalValor > 0 ? (valorMercado / totalValor * 100).toFixed(1) + '%' : '-';

          tr.innerHTML = `
            <td class="left">${nombre}</td>
            <td class="left">${region}</td>
            <td class="left">${subclasificacion}</td>
            <td class="left">${exposicion}</td>
            <td class="center">${vol}</td>
            <td class="center">${patrimonio}</td>
            <td class="center">${holdings}</td>
            <td class="center">${rating}</td>
            <td class="center">${duracion}</td>
            <td class="center">${ytw}</td>
            <td class="num center">${peso}</td>
          `;
          
          tb.appendChild(tr);
        });
        
        // === AGREGAR FILA(S) DE POOL BONOS DIRECTOS ===
        if (bonos.length > 0) {
          // Para TOTAL: separar bonos por moneda y crear dos filas
          const monedasPool = (cur === 'TOTAL') ? ['USD', 'PEN'] : [cur];
          
          monedasPool.forEach(monedaPool => {
            // Filtrar bonos de esta moneda
            const bonosMoneda = bonos.filter(bono => {
              const monedaBono = (cur === 'TOTAL') ? (bono._originalMoneda || bono.Moneda || 'USD') : cur;
              return monedaBono === monedaPool;
            });
            
            if (bonosMoneda.length === 0) return;
            
            const trBonos = document.createElement('tr');
            
            let totalValorBonos = 0;
            let sumaRatingWeighted = 0;
            let sumaDuracionWeighted = 0;
            let sumaYTWWeighted = 0;
            let countRating = 0;
            
            bonosMoneda.forEach(bono => {
              // Calcular valor de mercado GIPS: (Precio × Nominal Neto / 100) + Intereses Corridos
              const isinHolding = normIsin(bono._isin || bono.isin);
              const monedaBono = (cur === 'TOTAL') ? (bono._originalMoneda || bono.Moneda || 'USD') : cur;
              const b = BONDS.find(x => normIsin(x.ISIN) === isinHolding && (x.Moneda || 'USD') === monedaBono);
              
              let valorFinal = 0;
              
              if (b) {
                const nominalInicial = currentNominalFromHoldings(monedaBono, b.id);
                const buyN = lotNom(b.id, 'buy') || 0;
                const sellN = lotNom(b.id, 'sell') || 0;
                const netNom = nominalInicial + buyN - sellN;
                
                if (netNom > 0) {
                  const precioLimpio = toNum(b.Precio) || 0;
                  const AI = accruedPxPts(b, getAsOfDate());
                  valorFinal = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
                  
                  // Para TOTAL: convertir PEN a USD para el peso
                  if (cur === 'TOTAL' && monedaBono === 'PEN') {
                    const tcInput = document.getElementById('tipoCambio');
                    const tc = parseFloat(tcInput?.value) || 3.40;
                    valorFinal = valorFinal / tc;
                  }
                }
              }
              
              if (valorFinal <= 0) return;
              
              totalValorBonos += valorFinal;
              
              // Obtener rating, duración, ytw
              const esNuevo = bono._rid?.includes('-BOND-');
              let rating, duracion, ytw;
              
              if (esNuevo && typeof BONDS_BY_ISIN !== 'undefined') {
                const bondData = BONDS_BY_ISIN.get(bono._isin);
                rating = bondData?.rating;
                duracion = bondData?.duracion;
                ytw = bondData?.tasa;
              } else {
                const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === bono._isin);
                rating = String(matchActivos?.rating || '').trim();
                duracion = String(matchActivos?.duracion || '').trim();
                ytw = String(matchActivos?.tasa || '').trim();
              }
              
              // Rating ponderado
              if (rating && ratingScale[rating] !== undefined && ratingScale[rating] !== null) {
                sumaRatingWeighted += ratingScale[rating] * valorFinal;
                countRating += valorFinal;
              }
              
              // Duración ponderada
              if (duracion) {
                const dur = parseFloat(duracion);
                if (!isNaN(dur)) {
                  sumaDuracionWeighted += dur * valorFinal;
                }
              }
              
              // YTW ponderado
              if (ytw) {
                const y = parseFloat(ytw);
                if (!isNaN(y)) {
                  sumaYTWWeighted += y * valorFinal;
                }
              }
            });
            
            if (totalValorBonos <= 0) return;
            
            const ratingPromedio = countRating > 0 ? numeroARating(sumaRatingWeighted / countRating) : '-';
            const duracionPromedio = totalValorBonos > 0 ? (sumaDuracionWeighted / totalValorBonos).toFixed(2) : '-';
            const ytwPromedio = totalValorBonos > 0 ? `${(sumaYTWWeighted / totalValorBonos).toFixed(2)}%` : '-';
            const pesoBonos = totalValor > 0 ? (totalValorBonos / totalValor * 100).toFixed(1) + '%' : '-';
            
            // Nombre del pool: incluir moneda si es TOTAL
            const nombrePool = (cur === 'TOTAL') ? `Pool Bonos Directos ${monedaPool}` : 'Pool Bonos Directos';
            
            trBonos.innerHTML = `
              <td class="left">${nombrePool}</td>
              <td class="left">Emergentes</td>
              <td class="left">Latinoamerica</td>
              <td class="left">Latam Corps</td>
              <td class="center">-</td>
              <td class="center">-</td>
              <td class="center">${bonosMoneda.length}</td>
              <td class="center">${ratingPromedio}</td>
              <td class="center">${duracionPromedio}</td>
              <td class="center">${ytwPromedio}</td>
              <td class="num center">${pesoBonos}</td>
            `;
            
            tb.appendChild(trBonos);
          });
        }
        
        // === CALCULAR PROMEDIOS PONDERADOS PARA FILA TOTAL ===
        let sumaRatingWeighted = 0;
        let sumaDuracionWeighted = 0;
        let sumaYTWWeighted = 0;
        let sumaValoresRating = 0;
        let sumaValoresDuracion = 0;
        let sumaValoresYTW = 0;
        
        // Procesar cada activo (incluye bonos, ETFs, Fondos, BEST, DPF)
        allRows.forEach(row => {
          const vehiculo = String(row.vehiculo || '').toUpperCase();
          const esNuevo = row._rid?.includes('-OA-');
          const esBono = vehiculo.includes('BONO');
          
          // Si es bono, skip (ya están en Pool Bonos Directos)
          if (esBono) return;
          
          const valorBase = toNum(row.valor_mercado);
          const monedaEdit = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
          const valorEdit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(row._rid) || 0) : 0;
          const valorFinal = valorBase + valorEdit;
          
          if (valorFinal <= 0) return;
          
          let rating, duracion, ytw;
          
          // Obtener valores según tipo de activo
          if (vehiculo.includes('ETF') && row.Producto === 'CUENTA VALOR') {
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
              rating = meta?.rating;
              duracion = meta?._dur;
              ytw = meta?._tasa;
            } else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
              rating = String(matchActivos?.rating || '').trim();
              duracion = String(matchActivos?.duracion || '').trim();
              ytw = String(matchActivos?.tasa || '').trim();
            }
          } else if (vehiculo.includes('BEST') && row.Producto === 'CUENTA VALOR') {
            let matchActivos = null;
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              });
              rating = meta?.rating;
              duracion = meta?._dur;
            } else {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
              rating = String(matchActivos?.rating || '').trim();
              duracion = String(matchActivos?.duracion || '').trim();
            }
            // YTW del row para BEST
            ytw = row.clnTasaCupon || String(matchActivos?.cupon || '').trim();
            
            // Duración calculada desde fechavcto
            if (row.fechavcto) {
              const parseDMY = (s) => {
                const parts = String(s).split('/');
                if (parts.length !== 3) return null;
                const d = parseInt(parts[0], 10);
                const m = parseInt(parts[1], 10) - 1;
                const y = parseInt(parts[2], 10);
                return new Date(y, m, d);
              };
              const fechaVcto = parseDMY(row.fechavcto);
              if (fechaVcto) {
                const hoy = new Date();
                const diffDias = Math.round((fechaVcto - hoy) / (1000 * 60 * 60 * 24));
                duracion = (diffDias / 365).toFixed(2);
              }
            }
          } else if (row.Producto === 'FONDOS MUTUOS') {
            const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
            rating = meta?.rating;
            duracion = meta?._dur;
            ytw = meta?._tasa;
          } else if (vehiculo.includes('DPF')) {
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => a.veh?.toUpperCase().includes('DPF'));
              rating = meta?.rating;
            } else {
              const cuentaPlazoConRating = (ACTIVOS_RAW || []).find(a => 
                a.producto?.toUpperCase().includes('PLAZO') && 
                String(a.rating || '').trim() !== ''
              );
              rating = cuentaPlazoConRating?.rating;
            }
            
            // Duración calculada desde fechavcto
            if (row.fechavcto) {
              const parseDMY = (s) => {
                const parts = String(s).split('/');
                if (parts.length !== 3) return null;
                const d = parseInt(parts[0], 10);
                const m = parseInt(parts[1], 10) - 1;
                const y = parseInt(parts[2], 10);
                return new Date(y, m, d);
              };
              const fechaVcto = parseDMY(row.fechavcto);
              if (fechaVcto) {
                const hoy = new Date();
                const diffDias = Math.round((fechaVcto - hoy) / (1000 * 60 * 60 * 24));
                duracion = (diffDias / 365).toFixed(2);
              }
            }
            
            // YTW del row
            if (esNuevo) {
              const tasaMatch = row.nombre.match(/(\d+\.?\d*)%/);
              ytw = tasaMatch ? tasaMatch[1] : null;
            } else {
              ytw = row.tasa;
            }
          }
          
          // Rating ponderado con look-through
          const vehiculoUpper = vehiculo.toUpperCase();
          const isETF = vehiculoUpper.includes('ETF');
          const isFondo = row.Producto === 'FONDOS MUTUOS';

          // Intentar usar look-through si hay datos de RATINGS
          let usedLookThrough = false;

          if (RATINGS.loaded && (isETF || isFondo)) {
            let ratingsMap = null;
            
            if (isETF) {
              const isin = normIsin(row._isin);
              if (isin) ratingsMap = RATINGS.by_isin.get(isin);
            } else if (isFondo) {
              const codp = normCodprod(row._codSub);
              if (codp && codp !== '0') ratingsMap = RATINGS.by_codprod.get(codp);
            }
            
            if (ratingsMap) {
              // Distribuir valor según exposiciones por rating
              Object.entries(ratingsMap).forEach(([ratingKey, pct]) => {
                if (pct > 0 && ratingScale[ratingKey] !== undefined && ratingScale[ratingKey] !== null) {
                  const exposicion = (valorFinal * pct) / 100;
                  sumaRatingWeighted += ratingScale[ratingKey] * exposicion;
                  sumaValoresRating += exposicion;
                }
              });
              usedLookThrough = true;
            }
          }

          // Fallback: usar rating único si no hay look-through
          if (!usedLookThrough && rating && ratingScale[String(rating).trim()] !== undefined && ratingScale[String(rating).trim()] !== null) {
            sumaRatingWeighted += ratingScale[String(rating).trim()] * valorFinal;
            sumaValoresRating += valorFinal;
          }
          
          // Duración ponderada
          if (duracion) {
            const dur = parseFloat(duracion);
            if (!isNaN(dur) && isFinite(dur)) {
              sumaDuracionWeighted += dur * valorFinal;
              sumaValoresDuracion += valorFinal;
            }
          }
          
          // YTW ponderado
          if (ytw) {
            const y = parseFloat(ytw);
            if (!isNaN(y) && isFinite(y)) {
              sumaYTWWeighted += y * valorFinal;
              sumaValoresYTW += valorFinal;
            }
          }
        });
        
        // Agregar Pool Bonos a los totales
        if (bonos.length > 0) {
          let totalValorBonos = 0;
          let sumaRatingBonos = 0;
          let sumaDuracionBonos = 0;
          let sumaYTWBonos = 0;
          let countRatingBonos = 0;
          
          bonos.forEach(bono => {
            // Calcular valor de mercado GIPS: (Precio × Nominal Neto / 100) + Intereses Corridos
            const isinHolding = normIsin(bono._isin || bono.isin);
            const b = BONDS.find(x => normIsin(x.ISIN) === isinHolding);
            
            let valorFinal = 0;
            
            if (b) {
              const nominalInicial = currentNominalFromHoldings(cur, b.id);
              const buyN = lotNom(b.id, 'buy') || 0;
              const sellN = lotNom(b.id, 'sell') || 0;
              const netNom = nominalInicial + buyN - sellN;
              
              if (netNom > 0) {
                const precioLimpio = toNum(b.Precio) || 0;
                const AI = accruedPxPts(b, getAsOfDate());
                valorFinal = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
              }
            }
            
            if (valorFinal <= 0) return;
            
            totalValorBonos += valorFinal;
            
            const esNuevo = bono._rid?.includes('-BOND-');
            let rating, duracion, ytw;
            
            if (esNuevo && typeof BONDS_BY_ISIN !== 'undefined') {
              const bondData = BONDS_BY_ISIN.get(bono._isin);
              rating = bondData?.rating;
              duracion = bondData?.duracion;
              ytw = bondData?.tasa;
            } else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === bono._isin);
              rating = String(matchActivos?.rating || '').trim();
              duracion = String(matchActivos?.duracion || '').trim();
              ytw = String(matchActivos?.tasa || '').trim();
            }
            
            if (rating && ratingScale[rating] !== undefined && ratingScale[rating] !== null) {
              sumaRatingBonos += ratingScale[rating] * valorFinal;
              countRatingBonos += valorFinal;
            }
            
            if (duracion) {
              const dur = parseFloat(duracion);
              if (!isNaN(dur)) sumaDuracionBonos += dur * valorFinal;
            }
            
            if (ytw) {
              const y = parseFloat(ytw);
              if (!isNaN(y)) sumaYTWBonos += y * valorFinal;
            }
          });
          
          // Agregar bonos a totales
          sumaRatingWeighted += sumaRatingBonos;
          sumaValoresRating += countRatingBonos;
          sumaDuracionWeighted += sumaDuracionBonos;
          sumaValoresDuracion += totalValorBonos;
          sumaYTWWeighted += sumaYTWBonos;
          sumaValoresYTW += totalValorBonos;
        }
        
        const ratingTotal = sumaValoresRating > 0 ? numeroARating(sumaRatingWeighted / sumaValoresRating) : '-';
        const duracionTotal = sumaValoresDuracion > 0 ? (sumaDuracionWeighted / sumaValoresDuracion).toFixed(2) : '-';
        const ytwTotal = sumaValoresYTW > 0 ? `${(sumaYTWWeighted / sumaValoresYTW).toFixed(2)}%` : '-';
        
        // === FILA TOTAL ===
        if (rows.length > 0) {
          // Calcular totales
          let totalPatrimonio = 0;
          let totalHoldings = 0;
          
          // Función auxiliar para extraer valor numérico de holdings (remueve separadores de miles)
          const parseHoldings = (holdingsStr) => {
            if (!holdingsStr || holdingsStr === '-') return 0;
            // Remover separadores de miles y parsear
            const cleaned = String(holdingsStr).replace(/,/g, '');
            return parseFloat(cleaned) || 0;
          };
          
          rows.forEach(row => {
            const vehiculo = String(row.vehiculo || '').toUpperCase();
            const isETF = vehiculo.includes('ETF');
            const isBEST = vehiculo.includes('BEST') && row.Producto === 'CUENTA VALOR';
            const isFondoMutuo = row.Producto === 'FONDOS MUTUOS';
            const isBono = vehiculo.includes('BONO');
            const isDPF = vehiculo.includes('DPF');
            const esNuevo = row._rid?.includes('-OA-') || row._rid?.includes('-BOND-');
            
            // Sumar Patrimonio (ETFs y Fondos Mutuos)
            if (isETF && row.Producto === 'CUENTA VALOR') {
              if (esNuevo) {
                const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
                if (meta && meta._patrimonio) {
                  totalPatrimonio += Number(meta._patrimonio) || 0;
                }
              } else {
                const isin = row._isin;
                const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === isin);
                if (matchActivos) {
                  const patrimonioRaw = String(matchActivos.patrimonio || '').trim();
                  if (patrimonioRaw) {
                    totalPatrimonio += parseFloat(patrimonioRaw) || 0;
                  }
                }
              }
            } else if (isFondoMutuo) {
              const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
              if (meta && meta._patrimonio) {
                totalPatrimonio += Number(meta._patrimonio) || 0;
              }
            }
            
            // Sumar Holdings (todos los tipos de activos)
            if (isETF && row.Producto === 'CUENTA VALOR') {
              if (esNuevo) {
                const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
                if (meta && meta._n_holdings) {
                  totalHoldings += Number(meta._n_holdings) || 0;
                }
              } else {
                const isin = row._isin;
                const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === isin);
                if (matchActivos) {
                  const holdingsRaw = String(matchActivos.nholdings || '').trim();
                  if (holdingsRaw) {
                    totalHoldings += parseFloat(holdingsRaw) || 0;
                  }
                }
              }
            } else if (isBEST) {
              if (esNuevo) {
                const meta = (ACTIVOS2 || []).find(a => {
                  if (row._isin && a.isin === row._isin) return true;
                  if (a.inst === row.nombre) return true;
                  return false;
                });
                if (meta && meta._n_holdings) {
                  totalHoldings += Number(meta._n_holdings) || 0;
                } else {
                  totalHoldings += 250; // Valor por defecto
                }
              } else {
                const isin = row._isin;
                const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === isin);
                if (matchActivos) {
                  const holdingsRaw = String(matchActivos.nholdings || '').trim();
                  if (holdingsRaw) {
                    totalHoldings += parseFloat(holdingsRaw) || 0;
                  }
                }
              }
            } else if (isFondoMutuo) {
              const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
              if (meta && meta._n_holdings) {
                totalHoldings += Number(meta._n_holdings) || 0;
              }
            } else if (isBono) {
              // BONOS siempre tienen holdings = 1
              totalHoldings += 1;
            } else if (isDPF) {
              // DPF siempre tienen holdings = 1
              totalHoldings += 1;
            }
          });
          
          const totalPatrimonioStr = totalPatrimonio > 0 ? totalPatrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
          const totalHoldingsStr = totalHoldings > 0 ? totalHoldings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
          
          const trTotal = document.createElement('tr');
          trTotal.className = 'row-total';
          trTotal.innerHTML = `
            <td class="left" style="font-weight:700">Total</td>
            <td class="left"></td>
            <td class="left"></td>
            <td class="left"></td>
            <td></td>
            <td class="center"></td>
            <td class="center" style="font-weight:700">${totalHoldingsStr}</td>
            <td class="center" style="font-weight:700">${ratingTotal}</td>
            <td class="center" style="font-weight:700">${duracionTotal}</td>
            <td class="center" style="font-weight:700">${ytwTotal}</td>
            <td class="num center" style="font-weight:700">100.0%</td>
          `;
          tb.appendChild(trTotal);
        }
        
        // Sufijo para IDs de canvas (Total en vez de TOTAL)
        const canvasSuffix = (cur === 'TOTAL') ? 'Total' : cur;
        
        // Renderizar gráfico de ratings
        if (RATINGS.loaded) {
          const ratingsResult = calculateRatingsDecomposition(cur);
          const chartId = 'ratingsChart' + canvasSuffix;
          renderRatingsChart(chartId, ratingsResult.ratings, ratingsResult.igPercent, ratingsResult.hyPercent);
        }
        
        // Renderizar gráfico de sectores
        if (SECTORES.loaded) {
          const sectoresData = calculateSectoresDecomposition(cur);
          const chartId = 'sectoresChart' + canvasSuffix;
          renderSectoresChart(chartId, sectoresData);
        }
        
        // Renderizar gráfico de subclasificación
        const subclasData = calculateSubclasificacionDecomposition(cur);
        const subclasChartId = 'subclasificacionChart' + canvasSuffix;
        renderSubclasificacionChart(subclasChartId, subclasData);
        
        // Renderizar gráfico scatter Duración vs YTW
        const scatterChartId = 'scatterRFChart' + canvasSuffix;
        renderScatterRFChart(scatterChartId, cur);
      });
    }

    // =========================
    // Gráfico de Descomposición por Rating
    // =========================
    function calculateRatingsDecomposition(cur) {
      // === LÓGICA PARA TOTAL: combinar USD + PEN dolarizado ===
      let allRows;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const rowsUSD = (LAST_HOLDINGS['USD'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        });
        
        const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        }).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        allRows = [...rowsUSD, ...rowsPEN];
      } else {
        // Filtrar solo activos de Renta Fija de esta moneda
        allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
          const clase = r.clase || '';
          const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
          const esRentaFija = clase.includes('Renta Fija');
          return esRentaFija && moneda === cur;
        });
      }
      
      // Acumulador de exposición por rating
      const ratingExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        const producto = row.Producto;
        const esBono = vehiculo.includes('BONO');
        const isETF = vehiculo.includes('ETF');
        const isFondo = (producto === 'FONDOS MUTUOS');
        
        // Calcular valor de mercado del activo
        let valorMercado = 0;
        
        if (esBono) {
          // Para bonos: usar metodología GIPS
          // Match por ISIN (no por nombre)
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (!bondData) return;
          
          // Calcular nominal neto (inicial + operaciones)
          const lots = state.bondLots[bondData.id];
          const buyNom = lots?.buy?.nominal || 0;
          const sellNom = lots?.sell?.nominal || 0;
          
          // Nominal inicial (solo para bonos del A360)
          let nominalInicial = 0;
          if (!row._rid?.includes('-BOND-')) {
            nominalInicial = toNum(row._nominalHint) || 0;
          }
          
          const netNom = nominalInicial + buyNom - sellNom;
          
          if (netNom > 0) {
            const precioLimpio = toNum(bondData.Precio) || 0;
            const AI = accruedPxPts(bondData, getAsOfDate());
            valorMercado = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
            
            // Para bonos: usar el rating del bono directamente
            const rating = (bondData.Rating || 'NR').toUpperCase().trim();
            if (rating && valorMercado > 0) {
              ratingExposure[rating] = (ratingExposure[rating] || 0) + valorMercado;
              totalValor += valorMercado;
            }
          }
        } else {
          // Para TODOS los demás activos: valor base + edits
          const base = toNum(row.valor_mercado);
          const monedaEdit = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
          const edit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(row._rid) || 0) : 0;
          valorMercado = base + edit;
          
          if (valorMercado <= 0) return;
          
          // Intentar look-through primero (ETFs, Fondos y BEST)
          let ratingsMap = null;
          const vehiculoUpper = vehiculo.toUpperCase();
          const isBEST = vehiculoUpper.includes('BEST');
          
          if (RATINGS.loaded) {
            if (isETF || isBEST) {
              // ETF o BEST: buscar por ISIN
              const isin = normIsin(row._isin);
              if (isin) ratingsMap = RATINGS.by_isin.get(isin);
            } else if (isFondo) {
              // Fondo: buscar por CodSubproducto
              const codp = normCodprod(row._codSub);
              if (codp && codp !== '0') ratingsMap = RATINGS.by_codprod.get(codp);
            }
          }
          
          if (ratingsMap) {
            // Look-through: distribuir según exposiciones
            Object.entries(ratingsMap).forEach(([rating, pct]) => {
              if (pct > 0) {
                const exposicion = (valorMercado * pct) / 100;
                ratingExposure[rating] = (ratingExposure[rating] || 0) + exposicion;
              }
            });
            totalValor += valorMercado;
          } else {
            // Fallback: buscar rating único para TODOS los tipos de activos
            let ratingUnico = null;
            const vehiculoUpper = vehiculo.toUpperCase();
            const esNuevo = row._rid?.includes('-OA-');
            
            // BEST (CLN)
            if (vehiculoUpper.includes('BEST')) {
              if (esNuevo) {
                const meta = (ACTIVOS2 || []).find(a => {
                  if (row._isin && a.isin === row._isin) return true;
                  if (a.inst === row.nombre) return true;
                  return false;
                });
                ratingUnico = meta?.rating;
              } else {
                const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
                ratingUnico = String(matchActivos?.rating || '').trim();
              }
            }
            // ETF sin look-through
            else if (isETF) {
              if (esNuevo) {
                const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
                ratingUnico = meta?.rating;
              } else {
                const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
                ratingUnico = String(matchActivos?.rating || '').trim();
              }
            }
            // Fondo sin look-through
            else if (isFondo) {
              const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
              ratingUnico = meta?.rating;
            }
            // DPF
            else if (vehiculoUpper.includes('DPF')) {
              if (esNuevo) {
                const meta = (ACTIVOS2 || []).find(a => a.veh?.toUpperCase().includes('DPF'));
                ratingUnico = meta?.rating;
              } else {
                const cuentaPlazoConRating = (ACTIVOS_RAW || []).find(a => 
                  a.producto?.toUpperCase().includes('PLAZO') && 
                  String(a.rating || '').trim() !== ''
                );
                ratingUnico = cuentaPlazoConRating?.rating;
              }
              // Fallback hardcodeado: DPF siempre BBB+
              if (!ratingUnico || ratingUnico === '-' || ratingUnico === '') {
                ratingUnico = 'BBB+';
              }
            }
            // Cualquier otro activo
            else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
              ratingUnico = String(matchActivos?.rating || '').trim();
            }
            
            // Si encontramos rating, tratarlo como 100% en ese rating
            if (ratingUnico && ratingUnico !== '-' && ratingUnico !== '') {
              const ratingKey = String(ratingUnico).toUpperCase().trim();
              ratingExposure[ratingKey] = (ratingExposure[ratingKey] || 0) + valorMercado;
              totalValor += valorMercado;
            }
            // Si no hay rating, el activo no entra en el cálculo (skip)
          }
        }
      });
      
      // Convertir a porcentajes
      const ratingsPercentages = {};
      let igValor = 0;
      let hyValor = 0;
      
      // Clasificar ratings en IG e HY
      const igRatings = ['AAA+', 'AAA', 'AAA-', 'AA+', 'AA', 'AA-', 'A+', 'A', 'A-', 'BBB+', 'BBB', 'BBB-'];
      const hyRatings = ['BB+', 'BB', 'BB-', 'B+', 'B', 'B-', 'CCC+', 'CCC', 'CCC-', 'CC+', 'CC', 'CC-', 'C+', 'C', 'C-'];
      
      if (totalValor > 0) {
        Object.entries(ratingExposure).forEach(([rating, valor]) => {
          const ratingUpper = rating.toUpperCase().trim();
          ratingsPercentages[rating] = (valor / totalValor) * 100;
          
          if (igRatings.includes(ratingUpper)) {
            igValor += valor;
          } else if (hyRatings.includes(ratingUpper)) {
            hyValor += valor;
          }
        });
      }
      
      const igPercent = totalValor > 0 ? (igValor / totalValor) * 100 : 0;
      const hyPercent = totalValor > 0 ? (hyValor / totalValor) * 100 : 0;
      
      return {
        ratings: ratingsPercentages,
        igPercent: igPercent,
        hyPercent: hyPercent
      };
    }

    function renderRatingsChart(canvasId, ratingsData, igPercent, hyPercent) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      // Destruir gráfico anterior si existe
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      // Eliminar leyenda anterior si existe
      const chartWrapper = canvas.closest('.chart-wrapper');
      if (chartWrapper) {
        const existingLegend = chartWrapper.querySelector('.ratings-legend');
        if (existingLegend) existingLegend.remove();
      }
      
      // Si no hay datos, mostrar mensaje
      if (!ratingsData || Object.keys(ratingsData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de ratings disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      // Orden jerárquico de ratings (de mejor a peor)
      const ratingOrder = [
        'AAA+', 'AAA', 'AAA-',
        'AA+', 'AA', 'AA-',
        'A+', 'A', 'A-',
        'BBB+', 'BBB', 'BBB-',
        'BB+', 'BB', 'BB-',
        'B+', 'B', 'B-',
        'CCC+', 'CCC', 'CCC-',
        'CC+', 'CC', 'CC-',
        'C+', 'C', 'C-',
        'NR'
      ];
      
      // Filtrar solo ratings con exposición y ordenar por jerarquía
      const sortedRatings = ratingOrder
        .filter(rating => ratingsData[rating] && ratingsData[rating] > 0)
        .map(rating => [rating, ratingsData[rating]]);
      
      const labels = sortedRatings.map(([rating]) => rating);
      const data = sortedRatings.map(([, pct]) => pct);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Exposición (%)',
            data: data,
            backgroundColor: '#001391',
            maxBarThickness: 30,
            categoryPercentage: 0.95,
            barPercentage: 0.94
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            datalabels: {
              anchor: 'end',
              align: 'end',
              formatter: (value) => value.toFixed(2),
              color: '#333',
              font: { weight: 'bold', size: 13 }
            }
          },
          scales: {
            x: {
              beginAtZero: true,
              grid: { display: false },
              ticks: { 
                callback: (value) => value,
                font: { size: 13 }
              }
            },
            y: {
              grid: { display: false },
              ticks: {
                font: { size: 13, weight: 'normal' }
              }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
      
      // Agregar leyenda IG/HY en la parte inferior derecha
      if (chartWrapper) {
        const legend = document.createElement('div');
        legend.className = 'ratings-legend';
        legend.style.cssText = 'position: absolute; bottom: 65px; right: 10px; background: transparent; border: none; padding: 8px 12px; font-size: 13px; z-index: 10;';
        
        legend.innerHTML = `
          <div style="display: flex; flex-direction: column; gap: 4px;">
            <div style="display: flex; justify-content: space-between; gap: 12px;">
              <span style="font-weight: 600; color: #070E46;">Investment Grade:</span>
              <span style="font-weight: 600; color: #001391;">${igPercent.toFixed(2)}%</span>
            </div>
            <div style="display: flex; justify-content: space-between; gap: 12px;">
              <span style="font-weight: 600; color: #070E46;">High Yield:</span>
              <span style="font-weight: 600; color: #001391;">${hyPercent.toFixed(2)}%</span>
            </div>
          </div>
        `;
        
        chartWrapper.style.position = 'relative';
        chartWrapper.appendChild(legend);
      }
    }

    // =========================
    // Gráfico de Descomposición por Sector
    // =========================
    function calculateSectoresDecomposition(cur) {
      // === LÓGICA PARA TOTAL: combinar USD + PEN dolarizado ===
      let allRows;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const rowsUSD = (LAST_HOLDINGS['USD'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        });
        
        const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        }).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        allRows = [...rowsUSD, ...rowsPEN];
      } else {
        allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
          const clase = r.clase || '';
          const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
          const esRentaFija = clase.includes('Renta Fija');
          return esRentaFija && moneda === cur;
        });
      }
      
      const sectorExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        const producto = row.Producto;
        const esBono = vehiculo.includes('BONO');
        const isETF = vehiculo.includes('ETF');
        const isFondo = (producto === 'FONDOS MUTUOS');
        
        let valorMercado = 0;
        
        if (esBono) {
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (!bondData) return;
          
          const lots = state.bondLots[bondData.id];
          const buyNom = lots?.buy?.nominal || 0;
          const sellNom = lots?.sell?.nominal || 0;
          let nominalInicial = 0;
          if (!row._rid?.includes('-BOND-')) {
            nominalInicial = toNum(row._nominalHint) || 0;
          }
          const netNom = nominalInicial + buyNom - sellNom;
          
          if (netNom > 0) {
            const precioLimpio = toNum(bondData.Precio) || 0;
            const AI = accruedPxPts(bondData, getAsOfDate());
            valorMercado = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
            
            const sector = (bondData.Sector || 'Other').trim();
            if (sector && valorMercado > 0) {
              sectorExposure[sector] = (sectorExposure[sector] || 0) + valorMercado;
              totalValor += valorMercado;
            }
          }
        } else {
          const base = toNum(row.valor_mercado);
          const monedaEdit = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
          const edit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(row._rid) || 0) : 0;
          valorMercado = base + edit;
          
          if (valorMercado <= 0) return;
          
          let sectoresMap = null;
          const vehiculoUpper = vehiculo.toUpperCase();
          const isBEST = vehiculoUpper.includes('BEST');
          
          if (SECTORES.loaded) {
            if (isETF || isBEST) {
              const isin = normIsin(row._isin);
              if (isin) sectoresMap = SECTORES.by_isin.get(isin);
            } else if (isFondo) {
              const codp = normCodprod(row._codSub);
              if (codp && codp !== '0') sectoresMap = SECTORES.by_codprod.get(codp);
            }
          }
          
          if (sectoresMap) {
            Object.entries(sectoresMap).forEach(([sector, pct]) => {
              if (pct > 0) {
                const exposicion = (valorMercado * pct) / 100;
                sectorExposure[sector] = (sectorExposure[sector] || 0) + exposicion;
              }
            });
            totalValor += valorMercado;
          } else {
            if (vehiculoUpper.includes('DPF')) {
              sectorExposure['Financials'] = (sectorExposure['Financials'] || 0) + valorMercado;
              totalValor += valorMercado;
            }
          }
        }
      });
      
      const sectoresPercentages = {};
      if (totalValor > 0) {
        Object.entries(sectorExposure).forEach(([sector, valor]) => {
          sectoresPercentages[sector] = (valor / totalValor) * 100;
        });
      }
      
      return sectoresPercentages;
    }

    function renderSectoresChart(canvasId, sectoresData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!sectoresData || Object.keys(sectoresData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de sectores disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const sortedSectores = Object.entries(sectoresData)
        .sort((a, b) => b[1] - a[1]);
      
      const labels = sortedSectores.map(([sector]) => sector);
      const data = sortedSectores.map(([, pct]) => pct);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Exposición (%)',
            data: data,
            backgroundColor: '#85C8FF',
            barThickness: 20,
            categoryPercentage: 0.7,
            barPercentage: 0.8
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            datalabels: {
              anchor: 'end',
              align: 'end',
              formatter: (value) => value.toFixed(2),
              color: '#333',
              font: { weight: 'bold', size: 13 }
            }
          },
          scales: {
            x: {
              beginAtZero: true,
              grid: { display: false },
              ticks: { 
                callback: (value) => value,
                font: { size: 13 }
              }
            },
            y: {
              grid: { display: false },
              ticks: {
                font: { size: 13, weight: 'normal' }
              }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // =========================
    // Gráfico de Descomposición por Subclasificación
    // =========================
    function calculateSubclasificacionDecomposition(cur) {
      // === LÓGICA PARA TOTAL: combinar USD + PEN dolarizado ===
      let allRows;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const rowsUSD = (LAST_HOLDINGS['USD'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        });
        
        const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        }).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        allRows = [...rowsUSD, ...rowsPEN];
      } else {
        allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
          const clase = r.clase || '';
          const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
          const esRentaFija = clase.includes('Renta Fija');
          return esRentaFija && moneda === cur;
        });
      }
      
      const subclasExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        const esBono = vehiculo.includes('BONO');
        
        let valorMercado = 0;
        let subclasificacion = null;
        
        if (esBono) {
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (!bondData) return;
          
          const lots = state.bondLots[bondData.id];
          const buyNom = lots?.buy?.nominal || 0;
          const sellNom = lots?.sell?.nominal || 0;
          let nominalInicial = 0;
          if (!row._rid?.includes('-BOND-')) {
            nominalInicial = toNum(row._nominalHint) || 0;
          }
          const netNom = nominalInicial + buyNom - sellNom;
          
          if (netNom > 0) {
            const precioLimpio = toNum(bondData.Precio) || 0;
            const AI = accruedPxPts(bondData, getAsOfDate());
            valorMercado = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
            
            // Buscar en ACTIVOS_RAW
            const match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isinHolding);
            subclasificacion = match?.subclasificación || 'Other';
          }
        } else {
          const base = toNum(row.valor_mercado);
          const monedaEdit = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
          const edit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(row._rid) || 0) : 0;
          valorMercado = base + edit;
          
          if (valorMercado > 0) {
            const isin = normIsin(row._isin);
            const codSub = normCodprod(row._codSub);
            
            let match = null;
            if (isin) {
              match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
            }
            if (!match && codSub && codSub !== '0') {
              match = (ACTIVOS_RAW || []).find(a => normCodprod(a.codsubproducto) === codSub);
            }
            
            // Para DPF y SMART DEPOSIT sin match, usar fallback
            if (!match && (vehiculo.includes('DPF') || vehiculo.includes('SMART DEPOSIT') || vehiculo.includes('SMART_DEPOSIT'))) {
              subclasificacion = 'Cash y Equivalentes';
            } else {
              subclasificacion = match?.subclasificación || 'Other';
            }
          }
        }
        
        if (subclasificacion && valorMercado > 0) {
          const key = subclasificacion.trim();
          subclasExposure[key] = (subclasExposure[key] || 0) + valorMercado;
          totalValor += valorMercado;
        }
      });
      
      const subclasPercentages = {};
      if (totalValor > 0) {
        Object.entries(subclasExposure).forEach(([subclas, valor]) => {
          subclasPercentages[subclas] = (valor / totalValor) * 100;
        });
      }
      
      return subclasPercentages;
    }

    function renderSubclasificacionChart(canvasId, subclasData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!subclasData || Object.keys(subclasData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de subclasificación disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const subclasOrder = ['IG Desarrollados', 'HY Desarrollados', 'Global EM', 'Latinoamerica', 'Cash y Equivalentes', 'Other'];
      
      const sortedSubclas = Object.entries(subclasData)
        .sort((a, b) => {
          const indexA = subclasOrder.indexOf(a[0]);
          const indexB = subclasOrder.indexOf(b[0]);
          const orderA = indexA === -1 ? 999 : indexA;
          const orderB = indexB === -1 ? 999 : indexB;
          return orderA - orderB;
        });
      
      const labels = sortedSubclas.map(([subclas]) => subclas);
      const data = sortedSubclas.map(([, pct]) => pct);
      
      const colors = ['#001391', '#9694FF', '#060E46', '#CAD1D8', '#85C8FF', '#FFE761'];
      const backgroundColors = labels.map((_, i) => colors[i % colors.length]);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: backgroundColors,
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '65%',
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13, weight: 'normal' }
              }
            },
            datalabels: {
              color: '#fff',
              font: { weight: 'bold', size: 13 },
              formatter: (value) => value.toFixed(1)
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // =========================
    // Gráfico de Descomposición por Región
    // =========================
    function calculateRegionDecomposition(cur) {
      // === LÓGICA PARA TOTAL: combinar USD + PEN dolarizado ===
      let allRows;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const rowsUSD = (LAST_HOLDINGS['USD'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        });
        
        const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        }).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        allRows = [...rowsUSD, ...rowsPEN];
      } else {
        allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
          const clase = r.clase || '';
          const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
          const esRentaFija = clase.includes('Renta Fija');
          return esRentaFija && moneda === cur;
        });
      }
      
      const regionExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        const esBono = vehiculo.includes('BONO');
        
        let valorMercado = 0;
        let region = null;
        
        if (esBono) {
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (!bondData) return;
          
          const lots = state.bondLots[bondData.id];
          const buyNom = lots?.buy?.nominal || 0;
          const sellNom = lots?.sell?.nominal || 0;
          let nominalInicial = 0;
          if (!row._rid?.includes('-BOND-')) {
            nominalInicial = toNum(row._nominalHint) || 0;
          }
          const netNom = nominalInicial + buyNom - sellNom;
          
          if (netNom > 0) {
            const precioLimpio = toNum(bondData.Precio) || 0;
            const AI = accruedPxPts(bondData, getAsOfDate());
            valorMercado = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
            
            // Buscar en ACTIVOS_RAW
            const match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isinHolding);
            region = match?.region || 'Other';
          }
        } else {
          const base = toNum(row.valor_mercado);
          const monedaEdit = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
          const edit = (edits && edits[monedaEdit]) ? (edits[monedaEdit].get(row._rid) || 0) : 0;
          valorMercado = base + edit;
          
          if (valorMercado > 0) {
            const isin = normIsin(row._isin);
            const codSub = normCodprod(row._codSub);
            
            let match = null;
            if (isin) {
              match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
            }
            if (!match && codSub && codSub !== '0') {
              match = (ACTIVOS_RAW || []).find(a => normCodprod(a.codsubproducto) === codSub);
            }
            
            // Para DPF y SMART DEPOSIT sin match, usar fallback
            if (!match && (vehiculo.includes('DPF') || vehiculo.includes('SMART DEPOSIT') || vehiculo.includes('SMART_DEPOSIT'))) {
              region = 'Emergentes';
            } else {
              region = match?.region || 'Other';
            }
          }
        }
        
        if (region && valorMercado > 0) {
          const key = region.trim();
          regionExposure[key] = (regionExposure[key] || 0) + valorMercado;
          totalValor += valorMercado;
        }
      });
      
      const regionPercentages = {};
      if (totalValor > 0) {
        Object.entries(regionExposure).forEach(([reg, valor]) => {
          regionPercentages[reg] = (valor / totalValor) * 100;
        });
      }
      
      return regionPercentages;
    }

    function renderRegionChart(canvasId, regionData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!regionData || Object.keys(regionData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de región disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const regionOrder = ['Global', 'Norteamerica', 'EAFE', 'Emergentes', 'Other'];
      
      const sortedRegion = Object.entries(regionData)
        .sort((a, b) => {
          const indexA = regionOrder.indexOf(a[0]);
          const indexB = regionOrder.indexOf(b[0]);
          const orderA = indexA === -1 ? 999 : indexA;
          const orderB = indexB === -1 ? 999 : indexB;
          return orderA - orderB;
        });
      
      const labels = sortedRegion.map(([region]) => region);
      const data = sortedRegion.map(([, pct]) => pct);
      
      const colors = ['#001391', '#9694FF', '#060E46', '#CAD1D8', '#85C8FF', '#FFE761'];
      const backgroundColors = labels.map((_, i) => colors[i % colors.length]);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: backgroundColors,
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '65%',
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13, weight: 'normal' }
              }
            },
            datalabels: {
              color: '#fff',
              font: { weight: 'bold', size: 13 },
              formatter: (value) => value.toFixed(1)
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // =========================
    // Gráfico Scatter: Duración vs YTW por Vehículo
    // =========================
    function renderScatterRFChart(canvasId, cur) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      // Colores por orden de aparición
      const COLORS_BY_ORDER = ['#060E46', '#9694FF', '#85C8FF', '#CAD1D8', '#FFE761', '#6a737d', '#001391', '#85C8FF'];
      
      // Obtener datos de LAST_HOLDINGS según moneda
      let allRows;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const rowsUSD = (LAST_HOLDINGS['USD'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        }).map(r => ({ ...r, _originalMoneda: 'USD' }));
        
        const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
          const clase = r.clase || '';
          return clase.includes('Renta Fija');
        }).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          _originalMoneda: 'PEN'
        }));
        
        allRows = [...rowsUSD, ...rowsPEN];
      } else {
        allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
          const clase = r.clase || '';
          const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
          return clase.includes('Renta Fija') && moneda === cur;
        });
      }
      
      // Agrupar datos por vehículo
      const dataByVehicle = {};
      
      allRows.forEach(row => {
        const vehiculoRaw = String(row.vehiculo || '').toUpperCase();
        const monedaActivo = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda || 'USD') : cur;
        
        let vehiculo = 'OTHER';
        if (vehiculoRaw.includes('BONO')) vehiculo = 'BONO';
        else if (vehiculoRaw.includes('FONDO') || row.Producto === 'FONDOS MUTUOS') vehiculo = 'FONDO MUTUO';
        else if (vehiculoRaw.includes('ETF')) vehiculo = 'ETF';
        else if (vehiculoRaw.includes('DPF')) vehiculo = 'DPF';
        else if (vehiculoRaw.includes('SMART')) return; // Excluir SMART DEPOSIT
        else if (vehiculoRaw.includes('BEST')) vehiculo = 'BEST';
        
        let dur = null;
        let ytw = null;
        let nombre = row.nombre || '';
        
        // === BONOS: obtener datos de BONDS ===
        if (vehiculo === 'BONO') {
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (bondData) {
            // Verificar que tiene nominal activo
            const nominalInicial = currentNominalFromHoldings(monedaActivo, bondData.id);
            const buyN = lotNom(bondData.id, 'buy') || 0;
            const sellN = lotNom(bondData.id, 'sell') || 0;
            const netNom = nominalInicial + buyN - sellN;
            
            if (netNom > 0) {
              dur = bDur(bondData);
              ytw = bYTM(bondData);
              nombre = bNombre(bondData) || nombre;
            }
          }
        }
        // === ETF: obtener de ACTIVOS_RAW o ACTIVOS2 ===
        else if (vehiculo === 'ETF') {
          const esNuevo = row._rid?.includes('-OA-');
          if (esNuevo) {
            const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
            if (meta) {
              dur = meta._dur || null;
              ytw = meta._tasa || null;
            }
          } else {
            const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            if (matchActivos) {
              dur = parseFloat(matchActivos.duracion) || null;
              ytw = parseFloat(matchActivos.tasa) || null;
            }
          }
        }
        // === FONDO MUTUO: obtener de ACTIVOS2 ===
        else if (vehiculo === 'FONDO MUTUO') {
          const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
          if (meta) {
            dur = meta._dur || null;
            ytw = meta._tasa || null;
          }
        }
        // === BEST: calcular duración desde fechavcto, ytw de cupón ===
        else if (vehiculo === 'BEST') {
          if (row.fechavcto) {
            const parseDMY = (s) => {
              const parts = String(s).split('/');
              if (parts.length !== 3) return null;
              const d = parseInt(parts[0], 10);
              const m = parseInt(parts[1], 10) - 1;
              const y = parseInt(parts[2], 10);
              return new Date(y, m, d);
            };
            const fechaVcto = parseDMY(row.fechavcto);
            if (fechaVcto) {
              const hoy = new Date();
              const diffMs = fechaVcto - hoy;
              dur = diffMs / (1000 * 60 * 60 * 24 * 365);
            }
          }
          // YTW de cupón
          if (row.clnTasaCupon) {
            ytw = parseFloat(row.clnTasaCupon);
          } else {
            const esNuevo = row._rid?.includes('-OA-');
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin || a.inst === row.nombre);
              if (meta) ytw = meta._tasa || null;
            } else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
              if (matchActivos) ytw = parseFloat(matchActivos.cupon) || null;
            }
          }
        }
        // === DPF: calcular duración desde fechavcto, ytw de tasa ===
        else if (vehiculo === 'DPF') {
          if (row.fechavcto) {
            const parseDMY = (s) => {
              const parts = String(s).split('/');
              if (parts.length !== 3) return null;
              const d = parseInt(parts[0], 10);
              const m = parseInt(parts[1], 10) - 1;
              const y = parseInt(parts[2], 10);
              return new Date(y, m, d);
            };
            const fechaVcto = parseDMY(row.fechavcto);
            if (fechaVcto) {
              const hoy = new Date();
              const diffMs = fechaVcto - hoy;
              dur = diffMs / (1000 * 60 * 60 * 24 * 365);
            }
          }
          // Tasa del DPF: buscar por _subn en ACTIVOS2
          const subn = (row._subn || '').toLowerCase();
          const meta = (ACTIVOS2 || []).find(a => 
            a.prod === 'CUENTA A PLAZO' && 
            (a.inst || '').toLowerCase() === subn
          );
          if (meta && meta._tasa) {
            ytw = meta._tasa;
          } else {
            // Fallback: extraer tasa del nombre (ej: "3.00%")
            const match = (row.nombre || '').match(/(\d+\.?\d*)%/);
            if (match) ytw = parseFloat(match[1]);
          }
        }
        
        // Solo agregar si tenemos ambos valores
        if (dur !== null && ytw !== null && isFinite(dur) && isFinite(ytw) && dur > 0) {
          if (!dataByVehicle[vehiculo]) {
            dataByVehicle[vehiculo] = [];
          }
          dataByVehicle[vehiculo].push({
            x: dur,
            y: ytw,
            nombre: nombre
          });
        }
      });
      
      // Si no hay datos, mostrar mensaje
      if (Object.keys(dataByVehicle).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de Duración/YTW disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      // Crear datasets por vehículo
      const datasets = [];
      const vehicleOrder = ['BONO', 'FONDO MUTUO', 'ETF', 'BEST', 'DPF', 'OTHER'];
      
      let colorIndex = 0;
      vehicleOrder.forEach(veh => {
        if (dataByVehicle[veh] && dataByVehicle[veh].length > 0) {
          const color = COLORS_BY_ORDER[colorIndex % COLORS_BY_ORDER.length];
          colorIndex++;
          datasets.push({
            label: veh === 'FONDO MUTUO' ? 'Fondo Mutuo' : 
                   veh === 'SMART DEPOSIT' ? 'Smart Deposit' :
                   veh === 'BONO' ? 'Bono' :
                   veh, // ETF, BEST, DPF se quedan en mayúsculas
            data: dataByVehicle[veh],
            type: 'scatter',
            showLine: false,
            borderWidth: 0,
            pointRadius: 6,
            pointHoverRadius: 8,
            pointBackgroundColor: color,
            pointBorderColor: color
          });
        }
      });
      
      // Calcular rangos de ejes
      const allPoints = Object.values(dataByVehicle).flat();
      let xMin = 0;
      let xMax = Math.max(1, Math.ceil(Math.max(...allPoints.map(p => p.x))));
      let yMax = Math.max(1, Math.ceil(Math.max(...allPoints.map(p => p.y))));
      
      // Paso dinámico para Y
      const yStep = yMax <= 5 ? 1 : yMax <= 10 ? 2 : yMax <= 20 ? 5 : 10;
      yMax = Math.ceil(yMax / yStep) * yStep;
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'scatter',
        data: { datasets: datasets },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          parsing: false,
          layout: { padding: { top: 18 } },
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                usePointStyle: true,
                pointStyle: 'circle',
                boxWidth: 8,
                padding: 12,
                font: { size: 12 }
              }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const point = context.raw;
                  return `${point.nombre}: Dur ${point.x.toFixed(2)}, YTW ${point.y.toFixed(2)}%`;
                }
              }
            },
            datalabels: {
              display: false
            }
          },
          scales: {
            x: {
              type: 'linear',
              position: 'bottom',
              min: xMin,
              max: xMax,
              title: {
                display: true,
                text: 'Duración (años)',
                font: { size: 12, weight: 'normal' },
                color: '#333'
              },
              grid: { 
                display: true,
                color: '#e1e4e8'
              },
              ticks: {
                font: { size: 11 },
                stepSize: xMax <= 5 ? 1 : xMax <= 10 ? 2 : 5
              }
            },
            y: {
              type: 'linear',
              position: 'left',
              min: 0,
              max: yMax,
              title: {
                display: true,
                text: 'YTW (%)',
                font: { size: 12, weight: 'normal' },
                color: '#333'
              },
              grid: { 
                display: true,
                color: '#e1e4e8'
              },
              ticks: {
                font: { size: 11 },
                stepSize: yStep,
                callback: (v) => v
              }
            }
          }
        }
      });
    }

    // =========================
    // Renta Variable - Descomposición por Sector
    // =========================
    function calculateSectoresRVDecomposition(cur) {
      // Combinar USD+PEN si es TOTAL
      let holdings;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const holdingsUSD = LAST_HOLDINGS['USD'] || [];
        const holdingsPEN = (LAST_HOLDINGS['PEN'] || []).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        holdings = [...holdingsUSD, ...holdingsPEN];
      } else {
        holdings = LAST_HOLDINGS[cur] || [];
      }
      
      const allRows = holdings.filter(r => {
        const clase = r.clase || '';
        const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
        const esRentaVariable = clase.includes('Renta Variable');
        return esRentaVariable && (cur === 'TOTAL' || moneda === cur);
      });
      
      const sectorExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        
        // Ignorar SMART DEPOSIT
        if (vehiculo.includes('SMART DEPOSIT')) return;
        
        const base = toNum(row.valor_mercado);
        const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
        const edit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
        const valorMercado = base + edit;
        
        if (valorMercado <= 0) return;
        const producto = row.Producto;
        const isETF = vehiculo.includes('ETF');
        const isFondo = (producto === 'FONDOS MUTUOS');
        const isBEST = vehiculo.includes('BEST');
        const isAccion = vehiculo.includes('ACCION') || vehiculo.includes('EQUITY');
        
        // Caso 1: Acción directa - usar GICS_1 de Activos.csv (100%)
        if (isAccion) {
          const isin = normIsin(row._isin);
          let sector = null;
          
          if (isin) {
            const match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
            sector = match?.GICS_1 || match?.gics_1 || match?.Gics_1;
          }
          
          if (sector) {
            sectorExposure[sector] = (sectorExposure[sector] || 0) + valorMercado;
            totalValor += valorMercado;
          }
          return;
        }
        
        // Caso 2: ETFs, Fondos Mutuos, BEST - usar look-through de SECTORES.csv
        let sectoresMap = null;
        
        if (SECTORES.loaded) {
          if (isETF || isBEST) {
            const isin = normIsin(row._isin);
            if (isin) sectoresMap = SECTORES.by_isin.get(isin);
          } else if (isFondo) {
            const codp = normCodprod(row._codSub);
            if (codp && codp !== '0') sectoresMap = SECTORES.by_codprod.get(codp);
          }
        }
        
        if (sectoresMap) {
          Object.entries(sectoresMap).forEach(([sector, pct]) => {
            if (pct > 0) {
              const exposicion = (valorMercado * pct) / 100;
              sectorExposure[sector] = (sectorExposure[sector] || 0) + exposicion;
            }
          });
          totalValor += valorMercado;
        }
      });
      
      const sectoresPercentages = {};
      if (totalValor > 0) {
        Object.entries(sectorExposure).forEach(([sector, valor]) => {
          sectoresPercentages[sector] = (valor / totalValor) * 100;
        });
      }
      
      return sectoresPercentages;
    }

    function renderSectoresRVChart(canvasId, sectoresData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!sectoresData || Object.keys(sectoresData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de sectores disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const sortedSectores = Object.entries(sectoresData)
        .sort((a, b) => b[1] - a[1]);
      
      const labels = sortedSectores.map(([sector]) => sector);
      const data = sortedSectores.map(([, pct]) => pct);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Exposición (%)',
            data: data,
            backgroundColor: '#001391',
            barThickness: 20,
            categoryPercentage: 0.7,
            barPercentage: 0.8
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            datalabels: {
              anchor: 'end',
              align: 'end',
              formatter: (value) => value.toFixed(2),
              color: '#333',
              font: { weight: 'bold', size: 13 }
            }
          },
          scales: {
            x: {
              beginAtZero: true,
              grid: { display: false },
              ticks: { 
                callback: (value) => value,
                font: { size: 13 }
              }
            },
            y: {
              grid: { display: false },
              ticks: {
                font: { size: 13, weight: 'normal' }
              }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // Normalizar nombres: espacios y mayúsculas/minúsculas
    function normalizeCompanyName(name) {
      if (!name) return '';
      
      // Trim y convertir a uppercase para normalización
      let normalized = String(name).trim().toUpperCase();
      
      // Remover espacios múltiples
      normalized = normalized.replace(/\s+/g, ' ');
      
      return normalized;
    }

    // =========================
    // Renta Variable - Top 10 Holdings
    // =========================
    function calculateTop10Holdings(cur) {
      // Combinar USD+PEN si es TOTAL
      let holdings;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const holdingsUSD = LAST_HOLDINGS['USD'] || [];
        const holdingsPEN = (LAST_HOLDINGS['PEN'] || []).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        holdings = [...holdingsUSD, ...holdingsPEN];
      } else {
        holdings = LAST_HOLDINGS[cur] || [];
      }
      
      const allRows = holdings.filter(r => {
        const clase = r.clase || '';
        const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
        const esRentaVariable = clase.includes('Renta Variable');
        return esRentaVariable && (cur === 'TOTAL' || moneda === cur);
      });
      
      const holdingsMap = new Map();
      let totalValorRV = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        
        // Ignorar SMART DEPOSIT
        if (vehiculo.includes('SMART DEPOSIT')) return;
        
        const base = toNum(row.valor_mercado);
        const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
        const edit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
        const valorMercado = base + edit;
        
        if (valorMercado <= 0) return;
        totalValorRV += valorMercado;
        
        const producto = row.Producto;
        const isETF = vehiculo.includes('ETF');
        const isFondo = (producto === 'FONDOS MUTUOS');
        const isBEST = vehiculo.includes('BEST');
        const isAccion = vehiculo.includes('ACCION') || vehiculo.includes('EQUITY');
        
        // Caso 1: Acción directa - usar diccionario como nombre
        if (isAccion) {
          const isin = normIsin(row._isin);
          // Buscar nombre en diccionario, o usar nombre del row
          let nombreAccion = null;
          if (isin && ACT.dict_by_isin) {
            nombreAccion = ACT.dict_by_isin.get(isin);
          }
          if (!nombreAccion) {
            // Fallback: usar subproducto o nombre
            nombreAccion = row._subn || row.nombre || 'Acción Desconocida';
          }
          
          const nombreNormalizado = normalizeCompanyName(nombreAccion);
          const current = holdingsMap.get(nombreNormalizado) || 0;
          holdingsMap.set(nombreNormalizado, current + valorMercado);
          return; // Ya procesamos esta acción
        }
        
        // Caso 2: ETFs, Fondos Mutuos, BEST - usar Holdings.csv
        if (!HOLDINGS.loaded) return;
        
        let holdingsList = null;
        
        if (isETF || isBEST) {
          const isin = normIsin(row._isin);
          if (isin) holdingsList = HOLDINGS.by_isin.get(isin);
        } else if (isFondo) {
          const codp = normCodprod(row._codSub);
          if (codp && codp !== '0') holdingsList = HOLDINGS.by_codprod.get(codp);
        }
        
        if (holdingsList && Array.isArray(holdingsList)) {
          holdingsList.forEach(h => {
            const exposicion = (valorMercado * h.peso) / 100;
            const nombreNormalizado = normalizeCompanyName(h.nombre);
            
            // Si ya existe, sumar; si no, agregar con el nombre normalizado
            const current = holdingsMap.get(nombreNormalizado) || 0;
            holdingsMap.set(nombreNormalizado, current + exposicion);
          });
        }
      });
      
      const holdingsPercentages = {};
      if (totalValorRV > 0) {
        holdingsMap.forEach((valor, nombre) => {
          holdingsPercentages[nombre] = (valor / totalValorRV) * 100;
        });
      }
      
      const sorted = Object.entries(holdingsPercentages)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 10);
      
      const result = {};
      sorted.forEach(([nombre, pct]) => {
        result[nombre] = pct;
      });
      
      return result;
    }

    function renderTop10HoldingsChart(canvasId, holdingsData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      // Eliminar leyenda anterior si existe
      const chartWrapper = canvas.closest('.chart-wrapper');
      if (chartWrapper) {
        const existingLegend = chartWrapper.querySelector('.top10-holdings-legend');
        if (existingLegend) existingLegend.remove();
      }
      
      if (!holdingsData || Object.keys(holdingsData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de holdings disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const labels = Object.keys(holdingsData);
      const data = Object.values(holdingsData);
      
      // Calcular suma total del Top 10 Holdings
      const totalPercent = data.reduce((sum, val) => sum + val, 0);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Peso (%)',
            data: data,
            backgroundColor: '#85C8FF',
            barThickness: 20,
            categoryPercentage: 0.7,
            barPercentage: 0.8
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            datalabels: {
              anchor: 'end',
              align: 'end',
              formatter: (value) => value.toFixed(2),
              color: '#333',
              font: { weight: 'bold', size: 13 }
            }
          },
          scales: {
            x: {
              beginAtZero: true,
              grid: { display: false },
              ticks: { 
                callback: (value) => value,
                font: { size: 13 }
              }
            },
            y: {
              grid: { display: false },
              ticks: {
                font: { size: 13, weight: 'normal' },
                autoSkip: false
              }
            }
          },
          layout: {
            padding: {
              left: 5,
              right: 30,
              top: 5,
              bottom: 5
            }
          }
        },
        plugins: [ChartDataLabels]
      });
      
      // Agregar leyenda Top 10 Holdings en la parte inferior derecha
      if (chartWrapper) {
        const legend = document.createElement('div');
        legend.className = 'top10-holdings-legend';
        legend.style.cssText = 'position: absolute; bottom: 65px; right: 10px; background: transparent; border: none; padding: 8px 12px; font-size: 13px; z-index: 10;';
        
        legend.innerHTML = `
          <div style="display: flex; justify-content: space-between; gap: 12px;">
            <span style="font-weight: 600; color: #070E46;">Top 10 Holdings:</span>
            <span style="font-weight: 600; color: #001391;">${totalPercent.toFixed(2)}%</span>
          </div>
        `;
        
        chartWrapper.style.position = 'relative';
        chartWrapper.appendChild(legend);
      }
    }

    // =========================
    // Renta Variable - Descomposición por Región (con look-through, DONUT)
    // =========================
    function calculateRegionRVDecomposition(cur) {
      // Combinar USD+PEN si es TOTAL
      let holdings;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const holdingsUSD = LAST_HOLDINGS['USD'] || [];
        const holdingsPEN = (LAST_HOLDINGS['PEN'] || []).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        holdings = [...holdingsUSD, ...holdingsPEN];
      } else {
        holdings = LAST_HOLDINGS[cur] || [];
      }
      
      const allRows = holdings.filter(r => {
        const clase = r.clase || '';
        const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
        const esRentaVariable = clase.includes('Renta Variable');
        return esRentaVariable && (cur === 'TOTAL' || moneda === cur);
      });
      
      const regionExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        
        // Ignorar SMART DEPOSIT
        if (vehiculo.includes('SMART DEPOSIT')) return;
        
        const base = toNum(row.valor_mercado);
        const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
        const edit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
        const valorMercado = base + edit;
        
        if (valorMercado <= 0) return;
        
        const producto = row.Producto;
        const isETF = vehiculo.includes('ETF');
        const isFondo = (producto === 'FONDOS MUTUOS');
        const isBEST = vehiculo.includes('BEST');
        const isAccion = vehiculo.includes('ACCION') || vehiculo.includes('EQUITY');
        
        // Caso 1: Acción directa - usar Region de Activos.csv (100%)
        if (isAccion) {
          const isin = normIsin(row._isin);
          let region = null;
          
          if (isin) {
            const match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
            region = match?.Region || match?.region;
          }
          
          if (region) {
            regionExposure[region] = (regionExposure[region] || 0) + valorMercado;
            totalValor += valorMercado;
          }
          return;
        }
        
        // Caso 2: ETFs, Fondos Mutuos, BEST - usar look-through de REGION_RV.csv
        let regionMap = null;
        
        if (REGION_RV.loaded) {
          if (isETF || isBEST) {
            const isin = normIsin(row._isin);
            if (isin) regionMap = REGION_RV.by_isin.get(isin);
          } else if (isFondo) {
            const codp = normCodprod(row._codSub);
            if (codp && codp !== '0') regionMap = REGION_RV.by_codprod.get(codp);
          }
        }
        
        if (regionMap) {
          Object.entries(regionMap).forEach(([region, pct]) => {
            if (pct > 0) {
              const exposicion = (valorMercado * pct) / 100;
              regionExposure[region] = (regionExposure[region] || 0) + exposicion;
            }
          });
          totalValor += valorMercado;
        }
      });
      
      const regionPercentages = {};
      if (totalValor > 0) {
        Object.entries(regionExposure).forEach(([region, valor]) => {
          regionPercentages[region] = (valor / totalValor) * 100;
        });
      }
      
      return regionPercentages;
    }

    function renderRegionRVChart(canvasId, regionData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!regionData || Object.keys(regionData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de región disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      // Orden específico para regiones
      const regionOrder = ['North America', 'Europe', 'Asia ex Pacific', 'Pacific', 'Latin America', 'Africa', 'Middle East'];
      
      const sortedRegion = Object.entries(regionData)
        .sort((a, b) => {
          const indexA = regionOrder.indexOf(a[0]);
          const indexB = regionOrder.indexOf(b[0]);
          const orderA = indexA === -1 ? 999 : indexA;
          const orderB = indexB === -1 ? 999 : indexB;
          return orderA - orderB;
        });
      
      const labels = sortedRegion.map(([region]) => region);
      const data = sortedRegion.map(([, pct]) => pct);
      
      const colors = ['#001391', '#9694FF', '#060E46', '#CAD1D8', '#85C8FF', '#FFE761'];
      const backgroundColors = labels.map((_, i) => colors[i % colors.length]);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: backgroundColors,
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '65%',
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13 }
              }
            },
            datalabels: {
              color: '#fff',
              font: { weight: 'bold', size: 13 },
              formatter: (value) => value.toFixed(1)
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // =========================
    // Renta Variable - Descomposición por Subclasificación (IGUAL que RF, DONUT)
    // =========================
    function calculateSubclasificacionRVDecomposition(cur) {
      const allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
        const clase = r.clase || '';
        const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
        const esRentaVariable = clase.includes('Renta Variable');
        return esRentaVariable && moneda === cur;
      });
      
      const subclasExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        
        // Ignorar SMART DEPOSIT
        if (vehiculo.includes('SMART DEPOSIT')) return;
        
        const base = toNum(row.valor_mercado);
        const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
        const edit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
        const valorMercado = base + edit;
        
        if (valorMercado <= 0) return;
        
        let subclasificacion = null;
        
        // Buscar en ACTIVOS_RAW
        const isin = normIsin(row._isin);
        const codSub = normCodprod(row._codSub);
        
        let match = null;
        if (isin) {
          match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
        }
        if (!match && codSub && codSub !== '0') {
          match = (ACTIVOS_RAW || []).find(a => normCodprod(a.codsubproducto) === codSub);
        }
        
        subclasificacion = match?.subclasificación || 'Other';
        
        if (subclasificacion && valorMercado > 0) {
          const key = subclasificacion.trim();
          subclasExposure[key] = (subclasExposure[key] || 0) + valorMercado;
          totalValor += valorMercado;
        }
      });
      
      const subclasPercentages = {};
      if (totalValor > 0) {
        Object.entries(subclasExposure).forEach(([subclas, valor]) => {
          subclasPercentages[subclas] = (valor / totalValor) * 100;
        });
      }
      
      return subclasPercentages;
    }

    function renderSubclasificacionRVChart(canvasId, subclasData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!subclasData || Object.keys(subclasData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de subclasificación disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      // Orden específico para subclasificación (mismo que RF)
      const subclasOrder = ['IG Desarrollados', 'HY Desarrollados', 'Global EM', 'Latinoamerica', 'Cash y Equivalentes', 'Other'];
      
      const sortedSubclas = Object.entries(subclasData)
        .sort((a, b) => {
          const indexA = subclasOrder.indexOf(a[0]);
          const indexB = subclasOrder.indexOf(b[0]);
          const orderA = indexA === -1 ? 999 : indexA;
          const orderB = indexB === -1 ? 999 : indexB;
          return orderA - orderB;
        });
      
      const labels = sortedSubclas.map(([subclas]) => subclas);
      const data = sortedSubclas.map(([, pct]) => pct);
      
      const colors = ['#001391', '#9694FF', '#060E46', '#CAD1D8', '#85C8FF', '#FFE761'];
      const backgroundColors = labels.map((_, i) => colors[i % colors.length]);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: backgroundColors,
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '65%',
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13 }
              }
            },
            datalabels: {
              color: '#fff',
              font: { weight: 'bold', size: 13 },
              formatter: (value) => value.toFixed(1)
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    function calculateVehiculoRVDecomposition(cur) {
      // Combinar USD+PEN si es TOTAL
      let holdings;
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const holdingsUSD = LAST_HOLDINGS['USD'] || [];
        const holdingsPEN = (LAST_HOLDINGS['PEN'] || []).map(r => ({
          ...r,
          valor_mercado: toNum(r.valor_mercado) / tc,
          Moneda: 'USD',
          _originalMoneda: 'PEN'
        }));
        
        holdings = [...holdingsUSD, ...holdingsPEN];
      } else {
        holdings = LAST_HOLDINGS[cur] || [];
      }
      
      const allRows = holdings.filter(r => {
        const clase = r.clase || '';
        const moneda = r.Moneda || (r._rid?.startsWith('PEN') ? 'PEN' : 'USD');
        const esRentaVariable = clase.includes('Renta Variable');
        return esRentaVariable && (cur === 'TOTAL' || moneda === cur);
      });
      
      const vehiculoExposure = {};
      let totalValor = 0;
      
      allRows.forEach(row => {
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        
        const base = toNum(row.valor_mercado);
        const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
        const edit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
        const valorMercado = base + edit;
        
        if (valorMercado <= 0) return;
        
        let categoria = null;
        
        // Si es BEST, usar grupoproducto
        if (vehiculo.includes('BEST')) {
          const isin = normIsin(row._isin);
          const codSub = normCodprod(row._codSub);
          
          let match = null;
          if (isin) {
            match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
          }
          if (!match && codSub && codSub !== '0') {
            match = (ACTIVOS_RAW || []).find(a => normCodprod(a.codsubproducto) === codSub);
          }
          
          categoria = match?.grupoproducto || 'BEST';
        }
        // Si es SMART, usar "SMART Deposit"
        else if (vehiculo.includes('SMART')) {
          categoria = 'SMART Deposit';
        }
        // Para otros, buscar en ACTIVOS_RAW o usar vehículo de LAST_HOLDINGS
        else {
          const isin = normIsin(row._isin);
          const codSub = normCodprod(row._codSub);
          
          let match = null;
          if (isin) {
            match = (ACTIVOS_RAW || []).find(a => normIsin(a.isin) === isin);
          }
          if (!match && codSub && codSub !== '0') {
            match = (ACTIVOS_RAW || []).find(a => normCodprod(a.codsubproducto) === codSub);
          }
          
          categoria = match?.vehiculo || row.vehiculo || 'Other';
        }
        
        if (categoria && valorMercado > 0) {
          const key = String(categoria).trim();
          vehiculoExposure[key] = (vehiculoExposure[key] || 0) + valorMercado;
          totalValor += valorMercado;
        }
      });
      
      const vehiculoPercentages = {};
      if (totalValor > 0) {
        Object.entries(vehiculoExposure).forEach(([vehiculo, valor]) => {
          vehiculoPercentages[vehiculo] = (valor / totalValor) * 100;
        });
      }
      
      return vehiculoPercentages;
    }

    function renderVehiculoRVChart(canvasId, vehiculoData) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!vehiculoData || Object.keys(vehiculoData).length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de vehículo disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      // Orden específico para vehículos
      const vehiculoOrder = ['Fondo Mutuo', 'ETF', 'Twin Win', 'Autocall', 'SMART Deposit'];
      
      const sortedVehiculo = Object.entries(vehiculoData)
        .sort((a, b) => {
          const indexA = vehiculoOrder.indexOf(a[0]);
          const indexB = vehiculoOrder.indexOf(b[0]);
          const orderA = indexA === -1 ? 999 : indexA;
          const orderB = indexB === -1 ? 999 : indexB;
          return orderA - orderB;
        });
      
      const labels = sortedVehiculo.map(([vehiculo]) => vehiculo);
      const data = sortedVehiculo.map(([, pct]) => pct);
      
      const colors = ['#001391', '#9694FF', '#060E46', '#CAD1D8', '#85C8FF', '#FFE761'];
      const backgroundColors = labels.map((_, i) => colors[i % colors.length]);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: backgroundColors,
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '65%',
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13 }
              }
            },
            datalabels: {
              color: '#fff',
              font: { weight: 'bold', size: 13 },
              formatter: (value) => value.toFixed(1)
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    function renderPortafolioBonos() {

      const asOf = getAsOfDate();



      const ratingScale = {

        'AAA': 1, 'AA+': 2, 'AA': 3, 'AA-': 4,

        'A+': 5, 'A': 6, 'A-': 7,

        'BBB+': 8, 'BBB': 9, 'BBB-': 10,

        'BB+': 11, 'BB': 12, 'BB-': 13,

        'B+': 14, 'B': 15, 'B-': 16,

        'CCC+': 17, 'CCC': 18, 'CCC-': 19,

        'CC': 20, 'C': 21, 'D': 22,

        'NR': null

      };



      const numeroARating = (num) => {

        if (num === null || isNaN(num)) return '-';

        const entry = Object.entries(ratingScale).find(([r, n]) => n === Math.round(num));

        return entry ? entry[0] : '-';

      };



      const tables = [

        { cur: 'USD', bodyId: 'portafolioBondosBodyUSD' },

        { cur: 'PEN', bodyId: 'portafolioBondosBodyPEN' },

        { cur: 'TOTAL', bodyId: 'portafolioBondosBodyTotal' }

      ];



      tables.forEach(({ cur, bodyId }) => {

        const tb = document.getElementById(bodyId);

        if (!tb) return;



        tb.innerHTML = '';



        // Tipo de cambio para conversión

        const tcInput = document.getElementById('tipoCambio');

        const tc = parseFloat(tcInput?.value) || 3.40;



        // Obtener todos los bonos de esta moneda con nominal > 0

        const allBonds = [];

        

        // Determinar qué monedas procesar

        const monedasAProcesar = (cur === 'TOTAL') ? ['USD', 'PEN'] : [cur];



        // 1. Bonos de posiciones iniciales (LAST_HOLDINGS)

        monedasAProcesar.forEach(moneda => {

          const rows = (LAST_HOLDINGS[moneda] || []).filter(r => {

            const vehiculo = String(r.vehiculo || '').toUpperCase();

            return vehiculo.includes('BONO');

          });



          rows.forEach(row => {

            const isinHolding = normIsin(row._isin || row.isin);

            const monedaBono = (cur === 'TOTAL') ? moneda : cur;

            const b = BONDS.find(x => (x.Moneda || 'USD') === monedaBono && normIsin(x.ISIN) === isinHolding);

            if (!b) return;



            const nominalInicial = currentNominalFromHoldings(monedaBono, b.id);

            const buyN = lotNom(b.id, 'buy');

            const sellN = lotNom(b.id, 'sell');

            const netNom = nominalInicial + (buyN || 0) - (sellN || 0);



            if (netNom <= 0) return;



            // esInicial = true solo si NO es bono agregado desde minimodal

            const esBonoNuevo = row._rid?.includes('-BOND-');



            allBonds.push({

              bond: b,

              nominalInicial: nominalInicial,

              nominalFinal: netNom,

              esInicial: !esBonoNuevo,

              precPromedio: row._precPromedio || 0,

              row: row,

              _originalMoneda: monedaBono

            });

          });

        }); // Cierre de monedasAProcesar.forEach



        // 2. Bonos nuevos agregados desde minimodal (no están en posiciones iniciales)

        state.cartera.forEach(r => {

          const b = BONDS.find(x => x.id === r.bondId);

          if (!b) return;

          

          const monedaBono = b.Moneda || 'USD';

          // Para TOTAL: incluir ambas monedas. Para USD/PEN: solo la específica

          if (cur !== 'TOTAL' && monedaBono !== cur) return;



          const yaExiste = allBonds.some(item => item.bond.id === b.id);

          if (yaExiste) return;



          const buyN = lotNom(b.id, 'buy');

          const sellN = lotNom(b.id, 'sell');

          const netNom = (buyN || 0) - (sellN || 0);



          if (netNom <= 0) return;



          allBonds.push({

            bond: b,

            nominalInicial: 0,

            nominalFinal: netNom,

            esInicial: false,

            precPromedio: 0,

            row: null,

            _originalMoneda: monedaBono

          });

        });

        

        if (allBonds.length === 0) {

          const tr = document.createElement('tr');

          const colspanVacio = (cur === 'TOTAL') ? '14' : '13';

          tr.innerHTML = '<td class="center muted" colspan="' + colspanVacio + '">No hay bonos en cartera</td>';

          tb.appendChild(tr);

          return;

        }

        

        // Variables para totales y promedios ponderados

        let totalValorMercado = 0;

        let totalInteresesCorridos = 0;

        let totalInteresesRecibidos = 0;

        let sumYTWPonderado = 0;

        let sumDurPonderado = 0;

        let sumRatingPonderado = 0;

        let totalNominalParaPonderacion = 0;



        // Renderizar cada bono

        allBonds.forEach(item => {

          const { bond: b, nominalInicial, nominalFinal, esInicial, precPromedio } = item;



          // Verificar si es amortizable

          const isin = b.ISIN ? normIsin(b.ISIN) : null;

          const factorRem = calcularFactorRemanente(isin);

          const esAmortizable = factorRem < 1;



          // Calcular Precio Compra

          let precioCompra = 0;

          

          if (esInicial && nominalInicial === nominalFinal) {

            let precioBase = precPromedio / 10;

            if (factorRem < 1 && factorRem > 0) {

              precioCompra = precioBase / factorRem;

            } else {

              precioCompra = precioBase;

            }

          } else if (!esInicial) {

            precioCompra = toNum(b.Precio) || 0;

          } else {

            let precioInicial = precPromedio / 10;

            if (factorRem < 1 && factorRem > 0) {

              precioInicial = precioInicial / factorRem;

            }

            const precioNuevo = toNum(b.Precio) || 0;

            const nominalNuevo = nominalFinal - nominalInicial;

            if (nominalFinal > 0) {

              precioCompra = ((nominalInicial * precioInicial) + (nominalNuevo * precioNuevo)) / nominalFinal;

            }

          }



          // Calcular Precio de Mercado

          let precioMercado = toNum(b.Precio) || 0;

          if (precioMercado === 0 && item.row && item.row.precio_mercado) {

            precioMercado = item.row.precio_mercado;

          }



          // Intereses Corridos

          const AI = accruedPxPts(b, asOf);

          let interesesCorridosDisplay = (nominalFinal * AI) / 100;



          // Precio Limpio y Valor de Mercado

          const precioLimpio = toNum(b.Precio) || 0;

          const valorMercado = (precioLimpio * nominalFinal / 100) + Math.abs(interesesCorridosDisplay);



          // Determinar Fecha Última Compra

          const buyN_check = lotNom(b.id, 'buy') || 0;

          let fechaUltimaCompra = '-';

          if (esInicial) {

            if (buyN_check > 0) {

              fechaUltimaCompra = document.getElementById('fechaDatosInput')?.value || '-';

            } else {

              fechaUltimaCompra = item.row?.fecha_compra || '-';

            }

          } else {

            fechaUltimaCompra = document.getElementById('fechaDatosInput')?.value || '-';

          }



          // Calcular Intereses Recibidos (cupones realmente cobrados)

          let interesesRecibidos = 0;

          if (esInicial && item.row) {

            const fechaReporte = parseDMYStrict(document.getElementById('fechaDatosInput')?.value);

            const fechaCompraOriginal = parseDMYStrict(item.row.fecha_compra);

            

            if (fechaCompraOriginal && fechaReporte && fechaCompraOriginal < fechaReporte) {

              try {

                const fechasCupon = fechasCuponBond(item.row, fechaCompraOriginal, fechaReporte);

                fechasCupon.forEach(fecha => {

                  if (fecha <= fechaReporte) {

                    interesesRecibidos += montoCuponBondEnFecha(item.row, fecha);

                  }

                });

              } catch(e) {}

            }

          }



          // Para TOTAL: convertir valores PEN a USD para acumuladores

          const monedaOrig = item._originalMoneda || (b.Moneda || 'USD');

          const factorConv = (cur === 'TOTAL' && monedaOrig === 'PEN') ? (1 / tc) : 1;



          // Acumular totales (convertidos si es TOTAL)

          totalValorMercado += valorMercado * factorConv;

          totalInteresesCorridos += interesesCorridosDisplay * factorConv;

          totalInteresesRecibidos += interesesRecibidos * factorConv;



          // Obtener Dur/YTW/Rating según origen

          let dur, ytw, rating;

          if (esInicial) {

            const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === (item.row?._isin || b.ISIN));

            dur = parseFloat(matchActivos?.duracion) || 0;

            ytw = parseFloat(matchActivos?.tasa) || 0;

            rating = String(matchActivos?.rating || b.Rating || '').trim();

          } else {

            dur = b.Dur ? Number(b.Dur) : 0;

            ytw = b.YTW != null ? b.YTW : (b.Cup || 0);

            rating = b.Rating || '';

          }

          const ratingNum = ratingScale[rating] || null;



          sumYTWPonderado += ytw * valorMercado * factorConv;

          sumDurPonderado += dur * valorMercado * factorConv;

          if (ratingNum !== null) {

            sumRatingPonderado += ratingNum * valorMercado * factorConv;

          }

          totalNominalParaPonderacion += valorMercado * factorConv;



          // Para TOTAL: NO convertir valores individuales, mostrar en moneda original
          const monedaOriginal = item._originalMoneda || (b.Moneda || 'USD');

          // Valores para display: SIN conversión (moneda original)
          const interesesCorridosConv = interesesCorridosDisplay;
          const valorMercadoConv = valorMercado;
          const interesesRecibidosConv = interesesRecibidos;
          
          // Moneda para mostrar valores: moneda original del bono
          const monedaDisplay = (cur === 'TOTAL') ? monedaOriginal : cur;



          const tr = document.createElement('tr');

          

          if (cur === 'TOTAL') {

            tr.innerHTML = '<td class="left">' + b.id + '</td>' +

              '<td class="left">' + (b.Emisor || '-') + '</td>' +

              '<td class="center">' + (b.Call || '-') + '</td>' +

              '<td class="center">' + (rating || '-') + '</td>' +

              '<td class="center">' + (dur ? dur.toFixed(2) : '-') + '</td>' +

              '<td class="center">' + (ytw ? ytw.toFixed(2) + '%' : '-') + '</td>' +

              '<td class="center">' + (esInicial ? precioCompra.toFixed(2) : '-') + '</td>' +

              '<td class="center">' + precioMercado.toFixed(2) + '</td>' +

              '<td class="center">' + nominalFinal.toLocaleString('en-US') + (esAmortizable ? ' *' : '') + '</td>' +

              '<td class="center">' + moneyByCur(interesesCorridosConv, monedaDisplay) + '</td>' +

              '<td class="center">' + moneyByCur(valorMercadoConv, monedaDisplay) + '</td>' +

              '<td class="center">' + fechaUltimaCompra + '</td>' +

              '<td class="center">' + moneyByCur(interesesRecibidosConv, monedaDisplay) + '</td>' +

              '<td class="center">' + monedaOriginal + '</td>';

          } else {

            tr.innerHTML = '<td class="left">' + b.id + '</td>' +

              '<td class="left">' + (b.Emisor || '-') + '</td>' +

              '<td class="center">' + (b.Call || '-') + '</td>' +

              '<td class="center">' + (rating || '-') + '</td>' +

              '<td class="center">' + (dur ? dur.toFixed(2) : '-') + '</td>' +

              '<td class="center">' + (ytw ? ytw.toFixed(2) + '%' : '-') + '</td>' +

              '<td class="center">' + (esInicial ? precioCompra.toFixed(2) : '-') + '</td>' +

              '<td class="center">' + precioMercado.toFixed(2) + '</td>' +

              '<td class="center">' + nominalFinal.toLocaleString('en-US') + (esAmortizable ? ' *' : '') + '</td>' +

              '<td class="center">' + moneyByCur(interesesCorridosDisplay, cur) + '</td>' +

              '<td class="center">' + moneyByCur(valorMercado, cur) + '</td>' +

              '<td class="center">' + fechaUltimaCompra + '</td>' +

              '<td class="center">' + moneyByCur(interesesRecibidos, cur) + '</td>';

          }

          tb.appendChild(tr);

        });



        // Calcular promedios ponderados

        const ytwPromedio = totalNominalParaPonderacion > 0 ? sumYTWPonderado / totalNominalParaPonderacion : 0;

        const durPromedio = totalNominalParaPonderacion > 0 ? sumDurPonderado / totalNominalParaPonderacion : 0;

        const ratingPromedioNum = totalNominalParaPonderacion > 0 ? sumRatingPonderado / totalNominalParaPonderacion : null;

        const ratingPromedio = numeroARating(ratingPromedioNum);



        // Fila de totales

        const monedaTotales = (cur === 'TOTAL') ? 'USD' : cur;



        const trTotal = document.createElement('tr');

        trTotal.style.fontWeight = '700';

        trTotal.style.backgroundColor = '#F0F0F0';

        

        if (cur === 'TOTAL') {

          trTotal.innerHTML = '<td class="left" colspan="3">TOTAL</td>' +

            '<td class="center">' + ratingPromedio + '</td>' +

            '<td class="center">' + durPromedio.toFixed(2) + '</td>' +

            '<td class="center">' + ytwPromedio.toFixed(2) + '%</td>' +

            '<td class="center" colspan="2"></td>' +

            '<td class="center"></td>' +

            '<td class="center">' + moneyByCur(totalInteresesCorridos, monedaTotales) + '</td>' +

            '<td class="center">' + moneyByCur(totalValorMercado, monedaTotales) + '</td>' +

            '<td class="center"></td>' +

            '<td class="center">' + moneyByCur(totalInteresesRecibidos, monedaTotales) + '</td>' +

            '<td class="center">-</td>';

        } else {

          trTotal.innerHTML = '<td class="left" colspan="3">TOTAL</td>' +

            '<td class="center">' + ratingPromedio + '</td>' +

            '<td class="center">' + durPromedio.toFixed(2) + '</td>' +

            '<td class="center">' + ytwPromedio.toFixed(2) + '%</td>' +

            '<td class="center" colspan="2"></td>' +

            '<td class="center"></td>' +

            '<td class="center">' + moneyByCur(totalInteresesCorridos, cur) + '</td>' +

            '<td class="center">' + moneyByCur(totalValorMercado, cur) + '</td>' +

            '<td class="center"></td>' +

            '<td class="center">' + moneyByCur(totalInteresesRecibidos, cur) + '</td>';

        }

        tb.appendChild(trTotal);



        // Nota para bonos amortizables

        const tieneAmortizables = allBonds.some(item => {

          const isin = item.bond.ISIN ? normIsin(item.bond.ISIN) : null;

          return calcularFactorRemanente(isin) < 1;

        });



        // Notas al pie

        const notas = [];



        if (tieneAmortizables) {

          notas.push('* Nominal actual (post-amortización)');

        }



        notas.push('Precio Compra: Promedio simple entre posiciones iniciales y nuevas inversiones. No aplica metodología FIFO.');

        notas.push('Intereses Recibidos: Cupones cobrados sobre nominal de posición inicial, desde fecha de compra hasta fecha del reporte. No incluye compras/ventas de este rebalanceo.');



        const trNotes = document.createElement('tr');

        const colspanNotas = (cur === 'TOTAL') ? '14' : '13';

        trNotes.innerHTML = '<td colspan="' + colspanNotas + '" style="padding: 8px; font-size: 11px; color: #666; font-style: italic; line-height: 1.6;">' + notas.join('<br>') + '</td>';

        tb.appendChild(trNotes);

      });

    }

    // Renderizar tabla de Operaciones Bonos (compras y ventas)

    function renderOperacionesBonos() {

      const tables = [

        { cur: 'USD', bodyId: 'operacionesBonosBodyUSD', containerId: 'operacionesBonosUSDContainer' },

        { cur: 'PEN', bodyId: 'operacionesBonosBodyPEN', containerId: 'operacionesBonosPENContainer' },

        { cur: 'TOTAL', bodyId: 'operacionesBonosBodyTotal', containerId: 'operacionesBonosTotalContainer' }

      ];

      

      tables.forEach(({ cur, bodyId, containerId }) => {

        const tbody = document.getElementById(bodyId);

        const container = document.getElementById(containerId);

        if (!tbody) return;

        

        tbody.innerHTML = '';

        

        // Tipo de cambio para conversión

        const tcInput = document.getElementById('tipoCambio');

        const tc = parseFloat(tcInput?.value) || 3.40;

        

        // Recopilar operaciones (compras y ventas)

        const operaciones = [];

        

        // Recorrer bonos con operaciones

        for (const r of state.cartera) {

          const b = BONDS.find(x => x.id === r.bondId);

          if (!b) continue;

          

          const monedaBono = b.Moneda || 'USD';

          // Para TOTAL: incluir ambas monedas. Para USD/PEN: solo la específica

          if (cur !== 'TOTAL' && monedaBono !== cur) continue;

          

          const buyN = lotNom(b.id, 'buy') || 0;

          const sellN = lotNom(b.id, 'sell') || 0;

          

          if (buyN === 0 && sellN === 0) continue;

          

          if (buyN > 0) {

            operaciones.push({

              bond: b,

              tipo: 'COMPRA',

              vnOperado: buyN,

              precioOperacion: toNum(getLot(b.id, 'buy').dirty ?? b.Precio ?? 100),

              _originalMoneda: monedaBono

            });

          }

          

          if (sellN > 0) {

            operaciones.push({

              bond: b,

              tipo: 'VENTA',

              vnOperado: sellN,

              precioOperacion: toNum(getLot(b.id, 'sell').dirty ?? b.Precio ?? 100),

              _originalMoneda: monedaBono

            });

          }

        }

        

        // Mostrar/ocultar contenedor

        if (container) {

          container.style.display = operaciones.length > 0 ? 'block' : 'none';

        }

        

        if (operaciones.length === 0) return;

        

        // Renderizar cada operación

        operaciones.forEach(op => {

          const b = op.bond;

          const vnOperado = op.vnOperado;

          const monedaBono = op._originalMoneda || (b.Moneda || 'USD');

          

          // Datos del bono

          const emisor = b.Emisor || '';

          const fechaCall = b.Call || '-';

          const rating = b.Rating || '-';

          const dur = b.Dur ? Number(b.Dur).toFixed(2) : '-';

          const ytw = b.YTW != null ? (Number(b.YTW).toFixed(2) + '%') : '-';

          

          // Precios

          const precioCompra = op.precioOperacion.toFixed(2);

          const precioMercado = (toNum(b.Precio) || 0).toFixed(2);

          

          // Intereses corridos proporcionales al VN operado

          const AI = accruedPxPts(b, getAsOfDate());

          const interesesCorridos = (vnOperado * AI) / 100;

          

          // Monto Total

          const montoTotal = (toNum(b.Precio) * vnOperado / 100) + interesesCorridos;

          

          // Fecha última compra

          let fechaUltimaCompra = '-';

          const rowsParaBuscar = (cur === 'TOTAL') ? (LAST_HOLDINGS[monedaBono] || []) : (LAST_HOLDINGS[cur] || []);

          const rowOriginal = rowsParaBuscar.find(r => 

            /BONO/i.test(String(r.vehiculo || '')) && 

            String(r.nombre || '').toUpperCase().includes(b.id.toUpperCase()) &&

            !r._rid?.includes('-BOND-')

          );

          

          if (op.tipo === 'COMPRA') {

            fechaUltimaCompra = document.getElementById('fechaDatosInput')?.value || '-';

          } else {

            fechaUltimaCompra = rowOriginal?.fecha_compra || '-';

          }

          

          // Cupones Cobrados (sobre VN operado, desde fecha compra hasta fecha reporte)

          let cuponesCobrados = 0;

          if (op.tipo === 'VENTA' && rowOriginal) {

            const fechaReporte = parseDMYStrict(document.getElementById('fechaDatosInput')?.value);

            const fechaCompra = parseDMYStrict(fechaUltimaCompra);

            

            if (fechaCompra && fechaReporte && fechaCompra < fechaReporte) {

              try {

                const tasaAnual = (b.Cup || 0) / 100;

                const frecuencia = b.Freq || 2;

                const cuponPorPago = (vnOperado * tasaAnual) / frecuencia;

                

                const fechasCupon = fechasCuponBond(rowOriginal, fechaCompra, fechaReporte);

                fechasCupon.forEach(fecha => {

                  if (fecha <= fechaReporte) {

                    cuponesCobrados += cuponPorPago;

                  }

                });

              } catch(e) {}

            }

          }

          

          // Para TOTAL: NO convertir valores individuales, mostrar en moneda original
          const interesesCorridosConv = interesesCorridos;
          const montoTotalConv = montoTotal;
          const cuponesCobradosConv = cuponesCobrados;
          
          // Símbolo para mostrar: usar moneda original del bono
          const simboloMoneda = (cur === 'TOTAL') ? (monedaBono === 'PEN' ? 'S/' : '$') : '$';



          const tr = document.createElement('tr');

          

          if (cur === 'TOTAL') {

            tr.innerHTML = '<td class="left">' + b.id + '</td>' +

              '<td class="left">' + emisor + '</td>' +

              '<td class="center">' + fechaUltimaCompra + '</td>' +

              '<td class="center">' + rating + '</td>' +

              '<td class="center">' + dur + '</td>' +

              '<td class="center">' + ytw + '</td>' +

              '<td class="center">' + precioCompra + '</td>' +

              '<td class="center">' + precioMercado + '</td>' +

              '<td class="num center">' + vnOperado.toLocaleString('en-US') + '</td>' +

              '<td class="num center">' + simboloMoneda + Math.abs(interesesCorridosConv).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td>' +

              '<td class="num center">' + simboloMoneda + Math.abs(montoTotalConv).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td>' +

              '<td class="num center">' + (cuponesCobradosConv > 0 ? simboloMoneda + Math.round(cuponesCobradosConv).toLocaleString('en-US') : '-') + '</td>' +

              '<td class="center">' + (op.tipo === 'COMPRA' ? 'Compra' : 'Venta') + '</td>';

          } else {

            tr.innerHTML = '<td class="left">' + b.id + '</td>' +

              '<td class="left">' + emisor + '</td>' +

              '<td class="center">' + fechaUltimaCompra + '</td>' +

              '<td class="center">' + rating + '</td>' +

              '<td class="center">' + dur + '</td>' +

              '<td class="center">' + ytw + '</td>' +

              '<td class="center">' + precioCompra + '</td>' +

              '<td class="center">' + precioMercado + '</td>' +

              '<td class="num center">' + vnOperado.toLocaleString('en-US') + '</td>' +

              '<td class="num center">$' + Math.abs(interesesCorridos).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td>' +

              '<td class="num center">$' + Math.abs(montoTotal).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td>' +

              '<td class="num center">' + (cuponesCobrados > 0 ? '$' + Math.round(cuponesCobrados).toLocaleString('en-US') : '-') + '</td>' +

              '<td class="center">' + (op.tipo === 'COMPRA' ? 'Compra' : 'Venta') + '</td>';

          }

          tbody.appendChild(tr);

        });

      });

    }

    // ========== RENTA VARIABLE TABLES ==========

    function renderRentaVariableTables() {
      const ratingScale = {
        'AAA': 1, 'AA+': 2, 'AA': 3, 'AA-': 4,
        'A+': 5, 'A': 6, 'A-': 7,
        'BBB+': 8, 'BBB': 9, 'BBB-': 10,
        'BB+': 11, 'BB': 12, 'BB-': 13,
        'B+': 14, 'B': 15, 'B-': 16,
        'CCC+': 17, 'CCC': 18, 'CCC-': 19,
        'CC': 20, 'C': 21, 'D': 22,
        'NR': null
      };
      
      const numeroARating = (num) => {
        const entry = Object.entries(ratingScale).find(([r, n]) => n === Math.round(num));
        return entry ? entry[0] : '-';
      };

      const tables = [
        { cur: 'USD', bodyId: 'rentaVariableBodyUSD' },
        { cur: 'PEN', bodyId: 'rentaVariableBodyPEN' },
        { cur: 'TOTAL', bodyId: 'rentaVariableBodyTotal' }
      ];

      tables.forEach(({ cur, bodyId }) => {
        const currencyForFormat = (cur === 'TOTAL') ? 'USD' : cur;
        
        const tb = document.getElementById(bodyId);
        if (!tb) return;

        tb.innerHTML = '';

        // Combinar USD+PEN si es TOTAL
        let allRows;
        if (cur === 'TOTAL') {
          const tcInput = document.getElementById('tipoCambio');
          const tcPenUsd = parseFloat(tcInput?.value) || 3.40;
          
          const rowsUSD = (LAST_HOLDINGS['USD'] || []).filter(r => {
            const clase = r.clase || '';
            return clase === 'Renta Variable' || clase === 'Alternativo';
          });
          
          const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => {
            const clase = r.clase || '';
            return clase === 'Renta Variable' || clase === 'Alternativo';
          });
          
          const rowsPENConverted = rowsPEN.map(r => ({
            ...r,
            valor_mercado: toNum(r.valor_mercado) / tcPenUsd,
            Moneda: 'USD',
            _originalMoneda: 'PEN'
          }));
          
          allRows = [...rowsUSD, ...rowsPENConverted];
        } else {
          allRows = (LAST_HOLDINGS[cur] || []).filter(r => {
            const clase = r.clase || '';
            return clase === 'Renta Variable' || clase === 'Alternativo';
          });
        }

        // Ordenar por tipo: 1.Fondos, 2.ETFs, 3.BEST, 4.Otros
        allRows.sort((a, b) => {
          const tipoOrden = (row) => {
            const veh = String(row.vehiculo || '').toUpperCase();
            const prod = row.Producto;
            
            if (prod === 'FONDOS MUTUOS') return 1;
            if (veh.includes('ETF')) return 2;
            if (veh.includes('BEST')) return 3;
            if (prod === 'DIVAS' || veh.includes('SMART')) return 4;
            return 5;
          };
          
          const ordenA = tipoOrden(a);
          const ordenB = tipoOrden(b);
          
          if (ordenA !== ordenB) return ordenA - ordenB;
          return (a.nombre || '').localeCompare(b.nombre || '', 'es');
        });

        const rows = allRows;

        if (!rows.length) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td class="center muted" colspan="10">No hay activos de Renta Variable en ${cur}</td>`;
          tb.appendChild(tr);
          return;
        }

        // Calcular total para pesos (GIPS para bonos, normal para otros)
        const totalValor = allRows.reduce((a, r) => {
          const vehiculo = String(r.vehiculo || '').toUpperCase();
          const esBono = vehiculo.includes('BONO');
          
          if (esBono) {
            // GIPS para bonos
            const isinHolding = normIsin(r._isin || r.isin);
            const b = BONDS.find(x => normIsin(x.ISIN) === isinHolding);
            
            if (b) {
              const nominalInicial = currentNominalFromHoldings(cur, b.id);
              const buyN = lotNom(b.id, 'buy') || 0;
              const sellN = lotNom(b.id, 'sell') || 0;
              const netNom = nominalInicial + buyN - sellN;
              
              if (netNom > 0) {
                const precioLimpio = toNum(b.Precio) || 0;
                const AI = accruedPxPts(b, getAsOfDate());
                return a + (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
              }
            }
            return a;
          } else {
            // Normal para otros activos
          const base = toNum(r.valor_mercado);
          const moneda = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda) : cur;
          const edit = (edits && edits[moneda]) ? (edits[moneda].get(r._rid) || 0) : 0;
          return a + base + edit;
          }
        }, 0);

        // Renderizar cada instrumento
        rows.forEach(row => {
          const tr = document.createElement('tr');
          
          const nombre = row.nombre || '-';
          let subclasificacion = '-';
          let region = '-';
          let exposicion = '-';
          
          const vehiculo = String(row.vehiculo || '').toUpperCase();
          const esNuevo = row._rid?.includes('-OA-');
          
          let vol = '-';
          let patrimonio = '-';
          let holdings = '-';
          let pe = '-';
          let divYield = '-';
          
          // === LÓGICA PARA ETF ===
          if (vehiculo.includes('ETF') && row.Producto === 'CUENTA VALOR') {
            if (esNuevo) {

              const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);

              if (meta) {

                vol = meta._vol ? `${meta._vol.toFixed(1)}%` : '-';

                patrimonio = meta._patrimonio ? meta._patrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';

                holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';

                pe = meta._pe ? meta._pe.toFixed(2) : '-';

                divYield = meta._div_yield ? `${meta._div_yield.toFixed(2)}%` : '-';

              }

            } else {

              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);

              if (matchActivos) {

                const volRaw = String(matchActivos.vol || '').trim();

                const patrimonioRaw = String(matchActivos.patrimonio || '').trim();

                const holdingsRaw = String(matchActivos.nholdings || '').trim();

                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();

                const divYieldRaw = String(matchActivos.dividendyield || '').trim();

                

                vol = volRaw ? `${parseFloat(volRaw).toFixed(1)}%` : '-';

                patrimonio = patrimonioRaw ? parseFloat(patrimonioRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';

                holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';

                pe = peRaw ? parseFloat(peRaw).toFixed(2) : '-';

                divYield = divYieldRaw ? `${parseFloat(divYieldRaw).toFixed(2)}%` : '-';

              }

            }

            

          } else if (vehiculo.includes('BEST') && row.Producto === 'CUENTA VALOR') {

            

            if (esNuevo) {

              const meta = (ACTIVOS2 || []).find(a => {

                if (row._isin && a.isin === row._isin) return true;

                if (a.inst === row.nombre) return true;

                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;

                return false;

              });
              
              if (meta) {
                vol = meta._vol ? `${meta._vol.toFixed(1)}%` : '-';
                patrimonio = meta._patrimonio ? meta._patrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                pe = meta._pe ? meta._pe.toFixed(2) : '-';
                // Autocall: usar tasa del popup si existe
                if (row.autocallDivYield !== undefined && row.autocallDivYield !== null) {
                  divYield = `${parseFloat(row.autocallDivYield).toFixed(2)}%`;
                } else {
                  divYield = (meta._div_yield !== null && meta._div_yield !== undefined && !isNaN(meta._div_yield)) ? `${meta._div_yield.toFixed(2)}%` : '-';
                }
              }
            } else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
              if (matchActivos) {
                const volRaw = String(matchActivos.vol || '').trim();
                const patrimonioRaw = String(matchActivos.patrimonio || '').trim();
                const holdingsRaw = String(matchActivos.nholdings || '').trim();
                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();
                // Autocalls: usar cupón como Div Yield
                const esAutocall = String(matchActivos.grupoproducto || '').toUpperCase().includes('AUTOCALL');
                const divYieldRaw = esAutocall 
                  ? String(matchActivos.cupon || '').trim() 
                  : String(matchActivos.dividendyield || '').trim();
                
                vol = volRaw ? `${parseFloat(volRaw).toFixed(1)}%` : '-';
                patrimonio = patrimonioRaw ? parseFloat(patrimonioRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                pe = peRaw ? parseFloat(peRaw).toFixed(2) : '-';
                divYield = divYieldRaw ? `${parseFloat(divYieldRaw).toFixed(2)}%` : '-';
              }
            }
          } else if (row.Producto === 'FONDOS MUTUOS') {
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);
              if (meta) {
                vol = meta._vol ? `${meta._vol.toFixed(1)}%` : '-';
                patrimonio = meta._patrimonio ? meta._patrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                pe = meta._pe ? meta._pe.toFixed(2) : '-';
                divYield = meta._div_yield ? `${meta._div_yield.toFixed(2)}%` : '-';
              }
            } else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
              if (matchActivos) {
                const volRaw = String(matchActivos.vol || '').trim();
                const patrimonioRaw = String(matchActivos.patrimonio || '').trim();
                const holdingsRaw = String(matchActivos.nholdings || '').trim();
                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();
                const divYieldRaw = String(matchActivos.dividendyield || '').trim();
                
                vol = volRaw ? `${parseFloat(volRaw).toFixed(1)}%` : '-';
                patrimonio = patrimonioRaw ? parseFloat(patrimonioRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                pe = peRaw ? parseFloat(peRaw).toFixed(2) : '-';
                divYield = divYieldRaw ? `${parseFloat(divYieldRaw).toFixed(2)}%` : '-';
              }
            }
          } else if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => {
                if (a.veh?.toUpperCase().includes('SMART') || a.veh?.toUpperCase().includes('DIVA')) return true;
                if (a.inst === row.nombre) return true;
                return false;
              });
              
              if (meta) {
                vol = meta._vol ? `${meta._vol.toFixed(1)}%` : '-';
                patrimonio = meta._patrimonio ? meta._patrimonio.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = meta._n_holdings ? meta._n_holdings.toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                pe = meta._pe ? meta._pe.toFixed(2) : '-';
                divYield = meta._div_yield ? `${meta._div_yield.toFixed(2)}%` : '-';
              }
            } else {
              // DIVA inicial: buscar en ACTIVOS_RAW por nombre
              const matchActivos = (ACTIVOS_RAW || []).find(a => 
                a.subproducto === row.nombre || 
                (a.vehiculo?.toUpperCase().includes('SMART') && a.subproducto?.includes(row.nombre?.split(' ')[0]))
              );
              
              if (matchActivos) {
                const volRaw = String(matchActivos.vol || '').trim();
                const patrimonioRaw = String(matchActivos.patrimonio || '').trim();
                const holdingsRaw = String(matchActivos.nholdings || '').trim();
                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();
                const divYieldRaw = String(matchActivos.dividendyield || '').trim();
                
                vol = volRaw ? `${parseFloat(volRaw).toFixed(1)}%` : '-';
                patrimonio = patrimonioRaw ? parseFloat(patrimonioRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
                pe = peRaw ? parseFloat(peRaw).toFixed(2) : '-';
                divYield = divYieldRaw ? `${parseFloat(divYieldRaw).toFixed(2)}%` : '-';
              }
            }
} else if (vehiculo.includes('ACCION') || vehiculo.includes('EQUITY')) {
            // Acciones individuales: buscar en ACTIVOS_RAW por ISIN
            const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            if (matchActivos) {
              const volRaw = String(matchActivos.vol || '').trim();
              const patrimonioRaw = String(matchActivos.patrimonio || '').trim();
              const holdingsRaw = String(matchActivos.nholdings || '').trim();
              const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();
              const divYieldRaw = String(matchActivos.dividendyield || '').trim();
              
              vol = volRaw ? `${parseFloat(volRaw).toFixed(1)}%` : '-';
              patrimonio = patrimonioRaw ? parseFloat(patrimonioRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
              holdings = holdingsRaw ? parseFloat(holdingsRaw).toLocaleString('en-US', {maximumFractionDigits: 0}) : '-';
              pe = peRaw ? parseFloat(peRaw).toFixed(2) : '-';
              divYield = divYieldRaw ? `${parseFloat(divYieldRaw).toFixed(2)}%` : '-';
            } else {
              vol = '-';
              patrimonio = '-';
              holdings = '-';
              pe = '-';
              divYield = '-';
            }
          } else {
            vol = row.vol || '-';
            patrimonio = row.patrimonio || '-';
            holdings = row.holdings || '-';
            pe = row.pe || '-';
            divYield = row.divYield || '-';
          }          

          // === ASIGNAR SUBCLASIFICACIÓN, REGIÓN Y EXPOSICIÓN ===
          // SUBCLASIFICACIÓN
          if (esNuevo) {
            const meta = (ACTIVOS2 || []).find(a => {
              if (vehiculo.includes('ETF')) return a.isin === row._isin;
              if (vehiculo.includes('BEST')) {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              }
              if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
              if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
                if (a.veh?.toUpperCase().includes('SMART') || a.veh?.toUpperCase().includes('DIVA')) return true;
                if (a.inst === row.nombre) return true;
                return false;
              }
              return false;
            });
            subclasificacion = meta?.subclasificacion || meta?.efsub || row.subclase || '-';
          } else {
            let matchActivos;
            if (row.Producto === 'FONDOS MUTUOS') {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
            } else if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.subproducto === row.nombre);
            } else {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            }
            subclasificacion = matchActivos?.['subclasificación'] || row.subclase || '-';
          }
          
          // REGIÓN
          if (esNuevo) {
            const meta = (ACTIVOS2 || []).find(a => {
              if (vehiculo.includes('ETF')) return a.isin === row._isin;
              if (vehiculo.includes('BEST')) {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              }
              if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
              if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
                if (a.veh?.toUpperCase().includes('SMART') || a.veh?.toUpperCase().includes('DIVA')) return true;
                if (a.inst === row.nombre) return true;
                return false;
              }
              return false;
            });
            region = meta?.geo || row.region || '-';
          } else {
            let matchActivos;
            if (row.Producto === 'FONDOS MUTUOS') {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
            } else if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.subproducto === row.nombre);
            } else {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            }
            region = matchActivos?.region || row.region || '-';
          }
          
          // EXPOSICIÓN
          if (esNuevo) {
            const meta = (ACTIVOS2 || []).find(a => {
              if (vehiculo.includes('ETF')) return a.isin === row._isin;
              if (vehiculo.includes('BEST')) {
                if (row._isin && a.isin === row._isin) return true;
                if (a.inst === row.nombre) return true;
                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                return false;
              }
              if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
              if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
                if (a.veh?.toUpperCase().includes('SMART') || a.veh?.toUpperCase().includes('DIVA')) return true;
                if (a.inst === row.nombre) return true;
                return false;
              }
              return false;
            });
            exposicion = meta?.expo || '-';
          } else {
            let matchActivos;
            if (row.Producto === 'FONDOS MUTUOS') {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
            } else if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.subproducto === row.nombre);
            } else {
              matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);
            }
            exposicion = matchActivos?.exposicion || '-';
          }
          
          const valorBase = toNum(row.valor_mercado);
          const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
          const valorEdit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
          const valorMercado = valorBase + valorEdit;
          const peso = totalValor > 0 ? (valorMercado / totalValor * 100).toFixed(1) + '%' : '-';

          tr.innerHTML = `
            <td class="left">${nombre}</td>
            <td class="left">${region}</td>
            <td class="left">${subclasificacion}</td>
            <td class="left">${exposicion}</td>
            <td class="center">${vol}</td>
            <td class="center">${patrimonio}</td>
            <td class="center">${holdings}</td>
            <td class="center">${pe}</td>
            <td class="center">${divYield}</td>
            <td class="num center">${peso}</td>
          `;
          
          tb.appendChild(tr);

        });
        
        // === CALCULAR TOTALES PONDERADOS ===
        let sumaPEWeighted = 0;
        let sumaDivYieldWeighted = 0;
        let sumaValoresPE = 0;
        let sumaValoresDivYield = 0;
        let totalHoldings = 0;
        
        rows.forEach(row => {
          const valorBase = toNum(row.valor_mercado);
          const moneda = (cur === 'TOTAL') ? (row._originalMoneda || row.Moneda) : cur;
          const valorEdit = (edits && edits[moneda]) ? (edits[moneda].get(row._rid) || 0) : 0;
          const valorFinal = valorBase + valorEdit;
          
          if (valorFinal <= 0) return;
          
          const vehiculo = String(row.vehiculo || '').toUpperCase();
          const esNuevo = row._rid?.includes('-OA-');
          
          let peVal = null;
          let divYieldVal = null;
          let holdingsVal = null;
          
          // Extraer valores según tipo de activo
          if (vehiculo.includes('ETF') && row.Producto === 'CUENTA VALOR') {
            if (esNuevo) {
              const meta = (ACTIVOS2 || []).find(a => a.isin === row._isin);
              if (meta) {
                peVal = meta._pe;
                divYieldVal = meta._div_yield;
                holdingsVal = meta._n_holdings;
              }
            } else {
              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);

              if (matchActivos) {

                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();

                const divYieldRaw = String(matchActivos.dividendyield || '').trim();

                const holdingsRaw = String(matchActivos.nholdings || '').trim();

                

                peVal = peRaw ? parseFloat(peRaw) : null;

                divYieldVal = divYieldRaw ? parseFloat(divYieldRaw) : null;

                holdingsVal = holdingsRaw ? parseFloat(holdingsRaw) : null;

              }

            }

          } else if (vehiculo.includes('BEST') && row.Producto === 'CUENTA VALOR') {

            if (esNuevo) {

              const meta = (ACTIVOS2 || []).find(a => {

                if (row._isin && a.isin === row._isin) return true;

                if (a.inst === row.nombre) return true;

                if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;

                return false;

              });

              if (meta) {

                peVal = meta._pe;

                divYieldVal = meta._div_yield;

                holdingsVal = meta._n_holdings;

              }

            } else {

              const matchActivos = (ACTIVOS_RAW || []).find(a => a.isin === row._isin);

              if (matchActivos) {

                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();

                const divYieldRaw = String(matchActivos.dividendyield || '').trim();

                const holdingsRaw = String(matchActivos.nholdings || '').trim();

                

                peVal = peRaw ? parseFloat(peRaw) : null;

                divYieldVal = divYieldRaw ? parseFloat(divYieldRaw) : null;

                holdingsVal = holdingsRaw ? parseFloat(holdingsRaw) : null;

              }

            }

          } else if (row.Producto === 'FONDOS MUTUOS') {

            if (esNuevo) {

              const meta = (ACTIVOS2 || []).find(a => a.codSub === row._codSub);

              if (meta) {

                peVal = meta._pe;

                divYieldVal = meta._div_yield;

                holdingsVal = meta._n_holdings;

              }

            } else {

              const matchActivos = (ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);

              if (matchActivos) {

                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();

                const divYieldRaw = String(matchActivos.dividendyield || '').trim();

                const holdingsRaw = String(matchActivos.nholdings || '').trim();

                

                peVal = peRaw ? parseFloat(peRaw) : null;

                divYieldVal = divYieldRaw ? parseFloat(divYieldRaw) : null;

                holdingsVal = holdingsRaw ? parseFloat(holdingsRaw) : null;

              }

            }

          } else if (row.Producto === 'DIVAS' || vehiculo.includes('SMART')) {

            if (esNuevo) {

              const meta = (ACTIVOS2 || []).find(a => {

                if (a.veh?.toUpperCase().includes('SMART') || a.veh?.toUpperCase().includes('DIVA')) return true;

                if (a.inst === row.nombre) return true;

                return false;

              });

              if (meta) {

                peVal = meta._pe;

                divYieldVal = meta._div_yield;

                holdingsVal = meta._n_holdings;

              }

            } else {

              const matchActivos = (ACTIVOS_RAW || []).find(a => a.subproducto === row.nombre);

              if (matchActivos) {

                const peRaw = String(matchActivos['p/e'] || matchActivos.pe || '').trim();

                const divYieldRaw = String(matchActivos.dividendyield || '').trim();
                const holdingsRaw = String(matchActivos.nholdings || '').trim();
                
                peVal = peRaw ? parseFloat(peRaw) : null;
                divYieldVal = divYieldRaw ? parseFloat(divYieldRaw) : null;
                holdingsVal = holdingsRaw ? parseFloat(holdingsRaw) : null;
              }
            }
          }
          
          // P/E ponderado
          if (peVal !== null && !isNaN(peVal) && isFinite(peVal) && peVal > 0) {
            sumaPEWeighted += peVal * valorFinal;
            sumaValoresPE += valorFinal;
          }
          
          // Div Yield ponderado
          if (divYieldVal !== null && !isNaN(divYieldVal) && isFinite(divYieldVal)) {
            sumaDivYieldWeighted += divYieldVal * valorFinal;
            sumaValoresDivYield += valorFinal;
          }
          
          // Holdings suma
          if (holdingsVal !== null && !isNaN(holdingsVal) && isFinite(holdingsVal)) {
            totalHoldings += holdingsVal;
          }
        });
        
        const peTotal = sumaValoresPE > 0 ? (sumaPEWeighted / sumaValoresPE).toFixed(2) : '-';
        const divYieldTotal = sumaValoresDivYield > 0 ? `${(sumaDivYieldWeighted / sumaValoresDivYield).toFixed(2)}%` : '-';
        const holdingsTotal = totalHoldings > 0 ? Math.round(totalHoldings).toLocaleString('en-US') : '-';
        
        // Fila TOTAL
        const trTotal = document.createElement('tr');
        trTotal.className = 'row-total';
        trTotal.innerHTML = `
            <td class="left" style="font-weight:700">Total</td>
            <td class="left"></td>
            <td class="left"></td>
            <td class="left"></td>
            <td></td>
            <td class="center"></td>
            <td class="center" style="font-weight:700">${holdingsTotal}</td>
            <td class="center" style="font-weight:700">${peTotal}</td>
            <td class="center" style="font-weight:700">${divYieldTotal}</td>
            <td class="num center" style="font-weight:700">100.0%</td>
          `;

        tb.appendChild(trTotal);
      });
      
      // Renderizar gráficos de sectores RV
      ['USD', 'PEN', 'Total'].forEach(cur => {
        const moneda = (cur === 'Total') ? 'TOTAL' : cur;
        
        if (SECTORES.loaded) {
          const sectoresRVData = calculateSectoresRVDecomposition(moneda);
          renderSectoresRVChart(`sectoresRVChart${cur}`, sectoresRVData);
        }
        
        if (HOLDINGS.loaded) {
          const top10Data = calculateTop10Holdings(moneda);
          renderTop10HoldingsChart(`top10HoldingsChart${cur}`, top10Data);
        }
      });
      
      // Renderizar gráficos de región y subclasificación RV
      ['USD', 'PEN', 'Total'].forEach(cur => {
        const moneda = (cur === 'Total') ? 'TOTAL' : cur;
        
        if (REGION_RV.loaded) {
          const regionRVData = calculateRegionRVDecomposition(moneda);
          renderRegionRVChart(`regionRVChart${cur}`, regionRVData);
        }
        
        if (ACTIVOS_RAW && ACTIVOS_RAW.length > 0) {
          const vehiculoRVData = calculateVehiculoRVDecomposition(moneda);
          renderVehiculoRVChart(`vehiculoRVChart${cur}`, vehiculoRVData);
        }
      });
    }

    function renderPortafolioTables() {
      const tables = [
        { cur: 'USD', bodyId: 'portafolioBodyUSD' },
        { cur: 'PEN', bodyId: 'portafolioBodyPEN' },
        { cur: 'TOTAL', bodyId: 'portafolioBodyTotal' }
      ];

      // Orden de clases (mismo que Posiciones)
      const ORDER = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Fija LP","Renta Variable","Derivados","Alternativo"];

      tables.forEach(({ cur, bodyId }) => {
        const currencyForFormat = (cur === 'TOTAL') ? 'USD' : cur;
        
        const tbody = document.getElementById(bodyId);
        if (!tbody) return;

        tbody.innerHTML = '';

        // Obtener TODOS los activos de esta moneda
        let allRows;
        if (cur === 'TOTAL') {
          // Combinar USD + PEN convertido a USD
          const tcInput = document.getElementById('tipoCambio');
          const tcPenUsd = parseFloat(tcInput?.value) || 3.40;
          
          const rowsUSDRaw = (LAST_HOLDINGS['USD'] || []).filter(r => toNum(r.valor_mercado) >= 0);
          const rowsPEN = (LAST_HOLDINGS['PEN'] || []).filter(r => toNum(r.valor_mercado) >= 0);
          
          // Agregar _originalMoneda a filas USD
          const rowsUSD = rowsUSDRaw.map(r => ({
            ...r,
            _originalMoneda: 'USD'
          }));
          
          const rowsPENConverted = rowsPEN.map(r => ({
            ...r,
            _originalMoneda: 'PEN',
            _valorMercadoUSD: toNum(r.valor_mercado) / tcPenUsd
          }));
          
          allRows = [...rowsUSD, ...rowsPENConverted];
        } else {
          allRows = (LAST_HOLDINGS[cur] || []).filter(r => toNum(r.valor_mercado) >= 0);
        }

        if (allRows.length === 0) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td class="center muted" colspan="6">No hay activos en ${cur}</td>`;
          tbody.appendChild(tr);
          return;
        }

        // Tipo de cambio para cálculos de peso
        const tcParaTotal = (cur === 'TOTAL') ? (parseFloat(document.getElementById('tipoCambio')?.value) || 3.40) : 1;
        
        // Calcular monto final y total
        const rowsWithFinal = allRows.map(r => {
          const base = toNum(r.valor_mercado);
          const moneda = (cur === 'TOTAL') ? (r._originalMoneda || r.Moneda || 'USD') : cur;
          const rebalanceo = (edits && edits[moneda]) ? (edits[moneda].get(r._rid) || 0) : 0;
          const montoFinal = base + rebalanceo;
          // Valor dolarizado para cálculo de peso (solo se usa en TOTAL)
          const montoFinalUSD = (cur === 'TOTAL' && moneda === 'PEN') ? montoFinal / tcParaTotal : montoFinal;
          const rebalanceoUSD = (cur === 'TOTAL' && moneda === 'PEN') ? rebalanceo / tcParaTotal : rebalanceo;
          return { ...r, rebalanceo, montoFinal, montoFinalUSD, rebalanceoUSD, _monedaFila: moneda };
        }).filter(r => {
          // Activos nuevos (minimodal): solo mostrar si tienen monto > 0
          const esNuevo = r._rid?.includes('-OA-') || r._rid?.includes('-BOND-');
          if (esNuevo && r.montoFinal <= 0) return false;
          // Activos del A360: siempre mostrar
          return true;
        });

        const totalFinal = rowsWithFinal.reduce((sum, r) => sum + (r.montoFinalUSD || r.montoFinal), 0);

        // Agrupar por clase de activo
        ORDER.forEach(cls => {
          let g = rowsWithFinal.filter(r => r.clase === cls);
          if (!g.length) return;

          // Ordenar dentro de cada clase:
          // 1. Por tipo de cambio: sin cambios (0), ingresos (+), salidas (-)
          // 2. Dentro de cada grupo: mismo orden que Rebalanceo
          g = g.sort((a, b) => {
            // 1. Tipo de cambio
            const tipoA = a.rebalanceo === 0 ? 0 : (a.rebalanceo > 0 ? 1 : 2);
            const tipoB = b.rebalanceo === 0 ? 0 : (b.rebalanceo > 0 ? 1 : 2);
            if (tipoA !== tipoB) return tipoA - tipoB;
            
            // 2. Inicial vs Nuevo (iniciales primero)
            const esNuevoA = a._rid?.includes('-OA-') || a._rid?.includes('-BOND-') || a._rid?.includes('-DPF-');
            const esNuevoB = b._rid?.includes('-OA-') || b._rid?.includes('-BOND-') || b._rid?.includes('-DPF-');
            if (esNuevoA !== esNuevoB) return esNuevoA ? 1 : -1;
            
            // 3. Por vehículo
            const vehComp = compareByVehiculo(a, b);
            if (vehComp !== 0) return vehComp;
            
            // 4. Por región/PM
            const ra = _rankPM(a.clase, _pmOfHolding(a));
            const rb = _rankPM(b.clase, _pmOfHolding(b));
            if (ra !== rb) return ra - rb;
            
            // 5. Por nombre (alfabético)
            return String(a.nombre || '').localeCompare(String(b.nombre || ''), 'es', {sensitivity:'base'});
          });

          // Subtotales por clase (usar valores dolarizados para TOTAL)
          const subFinal = g.reduce((sum, r) => sum + (r.montoFinalUSD || r.montoFinal), 0);
          const subRebalanceo = g.reduce((sum, r) => sum + (r.rebalanceoUSD || r.rebalanceo), 0);
          const subPeso = totalFinal > 0 ? (subFinal / totalFinal * 100) : 0;

          // Fila de subtítulo (clase de activo)
          const trSub = document.createElement('tr');
          trSub.className = 'row-sub';
          trSub.innerHTML = `
            <td class="left">${cls}</td>
            <td></td>
            <td></td>
            <td class="num center">${fmtMoney(subFinal, currencyForFormat)}</td>
            <td class="num center">${subPeso === 0 ? '-' : subPeso.toFixed(1) + '%'}</td>
            <td class="num center">${fmtMoney(subRebalanceo, currencyForFormat)}</td>
          `;
          tbody.appendChild(trSub);

          // Renderizar activos de esta clase (con sangría)
          g.forEach(row => {
            const peso = totalFinal > 0 ? ((row.montoFinalUSD || row.montoFinal) / totalFinal * 100) : 0;
            const monedaFila = (cur === 'TOTAL') ? (row._monedaFila || row._originalMoneda || 'USD') : cur;
            
            // Obtener subclasificación (MISMA lógica que Posiciones - líneas 3000-3040)
            let subclasificacion = '-';
            const esBonoNuevo = row._rid?.includes('-BOND-');
            const vehiculo = String(row.vehiculo || '').toUpperCase();
            const esNuevo = row._rid?.includes('-OA-');
            
            // Hardcoded: CUENTA AHORRO, CUENTA CORRIENTE y CTS
            const sub = row._subn || '';
            const prod = sub ? ACT.product_by_subprod_name.get(sub) : '';
            if (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE' || prod === 'CTS') {
              subclasificacion = 'Cash y Equivalentes';
            } else if (vehiculo.includes('DPF') && !esNuevo) {
              // DPF inicial: hardcoded
              subclasificacion = 'Cash y Equivalentes';
            } else if (esNuevo && !esBonoNuevo) {
              // Minimodal Agregar Activos: ACTIVOS2.efsub
              const meta = (window.ACTIVOS2 || []).find(a => {
                if (vehiculo.includes('ETF')) return a.isin === row._isin;
                if (vehiculo.includes('BEST')) {
                  if (row._isin && a.isin === row._isin) return true;
                  if (a.inst === row.nombre) return true;
                  if (a.veh?.toUpperCase().includes('BEST') && row.grupo && a.grupo?.toUpperCase() === row.grupo?.toUpperCase()) return true;
                  return false;
                }
                if (vehiculo.includes('DPF')) return a.veh?.toUpperCase().includes('DPF');
                if (row.Producto === 'FONDOS MUTUOS') return a.codSub === row._codSub;
                return false;
              });
              subclasificacion = meta?.subclasificacion || meta?.efsub || row.subclase || '-';
            } else if (esBonoNuevo) {
              // Bono agregado por minimodal: BONDS_RAW.subclasificación
              const bondData = (window.BONDS_RAW || []).find(b => b.bono === row.nombre || b.isin === row._isin);
              subclasificacion = bondData?.['subclasificación'] || '-';
            } else {
              // Posición inicial: ACTIVOS_RAW.subclasificación
              let matchActivos;
              if (row.Producto === 'FONDOS MUTUOS') {
                // Fondos: match por codsubproducto
                matchActivos = (window.ACTIVOS_RAW || []).find(a => a.codsubproducto === row._codSub);
              } else {
                // Otros: match por ISIN
                matchActivos = (window.ACTIVOS_RAW || []).find(a => a.isin === row._isin);
              }
              subclasificacion = matchActivos?.['subclasificación'] || row.subclase || '-';
            }
            
            // Modificar nombre para DPF: incluir moneda
            let nombreDisplay = String(row.nombre || '');
            const vehCheck = String(row.vehiculo || '').toUpperCase();
            if (vehCheck.includes('DPF') && cur === 'TOTAL') {
              const monedaDPF = row._monedaFila || row._originalMoneda || 'USD';
              if (nombreDisplay.startsWith('DPF ')) {
                nombreDisplay = `DPF ${monedaDPF} ` + nombreDisplay.substring(4);
              } else if (nombreDisplay.startsWith('DPF')) {
                nombreDisplay = `DPF ${monedaDPF}` + nombreDisplay.substring(3);
              }
            }
            
            const tr = document.createElement('tr');
            tr.classList.add('indent-2');
            tr.innerHTML = `
              <td class="left">${nombreDisplay}</td>
              <td>${String(row.vehiculo || '')}</td>
              <td>${subclasificacion}</td>
              <td class="num center">${fmtMoney(row.montoFinal, monedaFila)}</td>
              <td class="num center">${peso === 0 ? '-' : peso.toFixed(1) + '%'}</td>
              <td class="num center">${fmtMoney(row.rebalanceo, monedaFila)}</td>
            `;
            tbody.appendChild(tr);
          });
        });

        // Fila de TOTAL (siempre en USD para tab TOTAL)
        const totalRebalanceo = rowsWithFinal.reduce((sum, r) => sum + (r.rebalanceoUSD || r.rebalanceo), 0);
        const trTotal = document.createElement('tr');
        trTotal.className = 'row-total';
        trTotal.innerHTML = `
          <td class="left"><strong>TOTAL</strong></td>
          <td></td>
          <td></td>
          <td class="num center"><strong>${fmtMoney(totalFinal, currencyForFormat)}</strong></td>
          <td class="num center"><strong>100.0%</strong></td>
          <td class="num center"><strong>${fmtMoney(totalRebalanceo, currencyForFormat)}</strong></td>
        `;
        tbody.appendChild(trTotal);
      });
      
      // Renderizar Asset Allocation con perfil por defecto
      const perfilDefault = document.getElementById('perfil')?.value || 'Moderado';
      ['USD', 'PEN', 'Total'].forEach(cur => {
        // Para Total, usar 'TOTAL' para combinar USD + PEN
        const moneda = (cur === 'Total') ? 'TOTAL' : cur;
        
        const aaData = calculateAssetAllocation(moneda, perfilDefault);
        renderAssetAllocationChart(`sectoresPFChart${cur}`, aaData);
        
        // Renderizar Asset Allocation Nivel 2 con perfil por defecto
        const aaL2Data = calculateAssetAllocationL2(moneda, perfilDefault);
        renderAssetAllocationL2Chart(`assetAllocationL2Chart${cur}`, aaL2Data);
      });
      
      // Renderizar Maturity Wall después de que ACTIVOS2 esté disponible
      setTimeout(async () => {
        try {
          await renderMaturityWallPFChart('maturityWallPFChartUSD', 'USD');
          await renderMaturityWallPFChart('maturityWallPFChartPEN', 'PEN');
          await renderMaturityWallPFChart('maturityWallPFChartTotal', 'TOTAL');
        } catch (error) {
          console.error('Error renderizando Maturity Wall PF:', error);
        }
      }, 100);
    }

    // =========================
    // Portafolio Final - Asset Allocation
    // =========================
    function calculateAssetAllocation(cur, perfil) {
      // Si es TOTAL, combinar USD + PEN
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        const built = buildFromRows(A360ByCode.get(CURRENT_CODE) || []);
        const classTable = built.classTable;
        const totalDolarizado = built.totalDolarizado;
        
        const CLASES = ["Liquidez", "Renta Fija CP", "Renta Fija MP", "Renta Variable", "Alternativo"];
        
        // Actual (sin edits)
        const actual = CLASES.map(c => {
          const pct = (classTable[c]?.total_dolarizado || 0) / totalDolarizado * 100;
          return pct;
        });
        
        // Modelo
        const modelo = getModelForPerfil(perfil);
        const modeloArr = CLASES.map(c => modelo[c] || 0);
        
        // Propuesto (con edits de USD y PEN)
        const propuesto = {};
        const holdingsUSD = built.holdingsByCurrency['USD'] || [];
        const holdingsPEN = built.holdingsByCurrency['PEN'] || [];
        
        // Sumar USD con edits
        holdingsUSD.forEach(row => {
          const clase = row.clase;
          if (!CLASES.includes(clase)) return;
          const valorActual = toNum(row.valor_mercado);
          const edit = (edits && edits['USD']) ? (edits['USD'].get(row._rid) || 0) : 0;
          const valorPropuesto = valorActual + edit;
          propuesto[clase] = (propuesto[clase] || 0) + valorPropuesto;
        });
        
        // Sumar PEN con edits (convertido a USD)
        holdingsPEN.forEach(row => {
          const clase = row.clase;
          if (!CLASES.includes(clase)) return;
          const valorActual = toNum(row.valor_mercado) / tc;
          const edit = (edits && edits['PEN']) ? (edits['PEN'].get(row._rid) || 0) : 0;
          const editEnUSD = edit / tc;
          const valorPropuesto = valorActual + editEnUSD;
          propuesto[clase] = (propuesto[clase] || 0) + valorPropuesto;
        });
        
        // Calcular total propuesto
        const totalPropuesto = CLASES.reduce((sum, c) => sum + (propuesto[c] || 0), 0);
        
        // Convertir a porcentajes
        const propuestoPct = {};
        CLASES.forEach(clase => {
          propuestoPct[clase] = totalPropuesto > 0 ? ((propuesto[clase] || 0) / totalPropuesto * 100) : 0;
        });
        
        return {
          labels: CLASES,
          actual: actual,
          modelo: modeloArr,
          propuesto: CLASES.map(c => propuestoPct[c] || 0)
        };
      }
      
      const clasesOrden = ['Liquidez', 'Renta Fija CP', 'Renta Fija MP', 'Renta Variable', 'Alternativo'];
      
      // Portafolio Modelo
      const modelo = {};
      if (perfil && MODELOS[perfil]) {
        clasesOrden.forEach(clase => {
          modelo[clase] = MODELOS[perfil][clase] || 0;
        });
      }
      
      // Portafolio Actual (sin edits)
      const actual = {};
      let totalActual = 0;
      
      (LAST_HOLDINGS[cur] || []).forEach(row => {
        const clase = row.clase || '';
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        const esBono = vehiculo.includes('BONO');
        
        let valor = 0;
        
        if (esBono) {
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (bondData) {
            const lots = state.bondLots[bondData.id];
            const buyNom = lots?.buy?.nominal || 0;
            const sellNom = lots?.sell?.nominal || 0;
            let nominalInicial = 0;
            if (!row._rid?.includes('-BOND-')) {
              nominalInicial = toNum(row._nominalHint) || 0;
            }
            const netNom = nominalInicial + buyNom - sellNom;
            
            if (netNom > 0) {
              const precioLimpio = toNum(bondData.Precio) || 0;
              const AI = accruedPxPts(bondData, getAsOfDate());
              valor = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
            }
          }
        } else {
          valor = toNum(row.valor_mercado);
        }
        
        if (valor > 0) {
          totalActual += valor;
          actual[clase] = (actual[clase] || 0) + valor;
        }
      });
      
      const actualPct = {};
      clasesOrden.forEach(clase => {
        actualPct[clase] = totalActual > 0 ? ((actual[clase] || 0) / totalActual * 100) : 0;
      });
      
      // Portafolio Propuesto (con edits)
      const propuesto = {};
      let totalPropuesto = 0;
      
      (LAST_HOLDINGS[cur] || []).forEach(row => {
        const clase = row.clase || '';
        const vehiculo = String(row.vehiculo || '').toUpperCase();
        const esBono = vehiculo.includes('BONO');
        
        let valor = 0;
        
        if (esBono) {
          const isinHolding = normIsin(row._isin || row.isin);
          const bondData = BONDS.find(b => normIsin(b.ISIN) === isinHolding);
          
          if (bondData) {
            const lots = state.bondLots[bondData.id];
            const buyNom = lots?.buy?.nominal || 0;
            const sellNom = lots?.sell?.nominal || 0;
            let nominalInicial = 0;
            if (!row._rid?.includes('-BOND-')) {
              nominalInicial = toNum(row._nominalHint) || 0;
            }
            const netNom = nominalInicial + buyNom - sellNom;
            
            if (netNom > 0) {
              const precioLimpio = toNum(bondData.Precio) || 0;
              const AI = accruedPxPts(bondData, getAsOfDate());
              valor = (precioLimpio * netNom / 100) + Math.abs((netNom * AI) / 100);
            }
          }
        } else {
          const base = toNum(row.valor_mercado);
          const edit = (edits && edits[cur]) ? (edits[cur].get(row._rid) || 0) : 0;
          valor = base + edit;
        }
        
        if (valor > 0) {
          totalPropuesto += valor;
          propuesto[clase] = (propuesto[clase] || 0) + valor;
        }
      });
      
      const propuestoPct = {};
      clasesOrden.forEach(clase => {
        propuestoPct[clase] = totalPropuesto > 0 ? ((propuesto[clase] || 0) / totalPropuesto * 100) : 0;
      });
      
      return {
        labels: clasesOrden,
        modelo: clasesOrden.map(c => modelo[c] || 0),
        actual: clasesOrden.map(c => actualPct[c] || 0),
        propuesto: clasesOrden.map(c => propuestoPct[c] || 0)
      };
    }

    function renderAssetAllocationChart(canvasId, data) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!data || !data.labels || data.labels.length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('Seleccione un perfil de inversión', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: data.labels,
          datasets: [
            {
              label: 'Portafolio Modelo',
              data: data.modelo,
              backgroundColor: '#060E46',
              categoryPercentage: 0.7,
              barPercentage: 0.85
            },
            {
              label: 'Portafolio Actual',
              data: data.actual,
              backgroundColor: '#CAD1D8',
              categoryPercentage: 0.7,
              barPercentage: 0.85
            },
            {
              label: 'Portafolio Sugerido',
              data: data.propuesto,
              backgroundColor: '#9694FF',
              categoryPercentage: 0.7,
              barPercentage: 0.85
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13, family: 'Lato, sans-serif' }
              }
            },
            datalabels: {
              anchor: 'end',
              align: 'end',
              formatter: (value) => value > 0 ? value.toFixed(1) : '',
              color: '#333',
              font: { weight: 'normal', size: 13, family: 'Lato, sans-serif' }
            }
          },
          scales: {
            x: {
              grid: { display: false },
              ticks: {
                font: { size: 12, family: 'Lato, sans-serif' },
                callback: function(value, index) {
                  const label = this.getLabelForValue(value);
                  const words = label.split(' ');
                  if (words.length >= 2) {
                    const mid = Math.ceil(words.length / 2);
                    return [words.slice(0, mid).join(' '), words.slice(mid).join(' ')];
                  }
                  return label;
                }
              }
            },
            y: {
              beginAtZero: true,
              max: 100,
              grid: { display: false },
              ticks: {
                callback: (value) => value,
                font: { size: 13, family: 'Lato, sans-serif' }
              }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // =========================
    // Portafolio Final - Maturity Wall
    // =========================
    function toNumMW(x){
      const n = Number(String(x ?? '').replace(/[^\d.-]/g, ''));
      return Number.isFinite(n) ? n : 0;
    }

    function parseDMYMaybeMW(s){
      if (typeof parseDMYStrict === 'function') {
        try { return parseDMYStrict(s); } catch(_){}
      }
      const m = String(s).match(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})/);
      if (m){
        const d = +m[1], mm = +m[2]-1, yy = +m[3];
        return new Date(yy<100?2000+yy:yy, mm, d);
      }
      const d = new Date(s);
      return isNaN(d) ? null : d;
    }

    async function collectMaturityDataPF(cur){
      // Si es TOTAL, combinar USD + PEN
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        // Obtener datos de USD y PEN
        const dataUSD = await collectMaturityDataPF('USD');
        const dataPEN = await collectMaturityDataPF('PEN');
        
        // Combinar años
        const allYears = new Set([...dataUSD.years, ...dataPEN.years]);
        const years = Array.from(allYears).sort();
        
        // Combinar vehículos y convertir PEN a USD
        const byVehiculo = {};
        const allVehiculos = new Set([...Object.keys(dataUSD.byVehiculo || {}), ...Object.keys(dataPEN.byVehiculo || {})]);
        
        allVehiculos.forEach(vehiculo => {
          const usdData = dataUSD.byVehiculo[vehiculo] || [];
          const penData = dataPEN.byVehiculo[vehiculo] || [];
          
          byVehiculo[vehiculo] = years.map((y, idx) => {
            const usdIdx = dataUSD.years.indexOf(y);
            const penIdx = dataPEN.years.indexOf(y);
            const usdVal = (usdIdx >= 0 && usdData[usdIdx]) ? usdData[usdIdx] : 0;
            const penVal = (penIdx >= 0 && penData[penIdx]) ? (penData[penIdx] / tc) : 0;
            return usdVal + penVal;
          });
        });
        
        return { years, byVehiculo };
      }
      
      // Guardar moneda anterior + snapshot del tbody actual
      const prevCur = window.ACTIVE_CRONO_CUR;
      const tb = document.querySelector('#tablaAmort tbody');
      const snapshot = tb ? tb.cloneNode(true) : null;
      
      // Cambiar a la moneda solicitada
      window.ACTIVE_CRONO_CUR = cur;
      
      // Regenerar la tabla de amortizaciones con la nueva moneda
      if (typeof construirTablaAmortizaciones === 'function') {
        try {
          construirTablaAmortizaciones();
        } catch(e) {
          console.error('[MW PF] Error al construir tabla amortizaciones:', e);
        }
      }
      
      return new Promise(resolve => {
        setTimeout(() => {
          const tbody = document.querySelector('#tablaAmort tbody');
          if (!tbody) {
            window.ACTIVE_CRONO_CUR = prevCur;
            const liveTb = document.querySelector('#tablaAmort tbody');
            if (snapshot && liveTb && liveTb.parentNode) {
              liveTb.parentNode.replaceChild(snapshot, liveTb);
            }
            resolve({ years: [], byVehiculo: {} });
            return;
          }
          
          const rows = Array.from(tbody.querySelectorAll('tr'));
          const yearNow = new Date().getFullYear();
          const byYearVehiculo = new Map(); // Map<year, Map<vehiculo, amount>>
          
          for (const tr of rows){
            const tds = tr.querySelectorAll('td');
            if (tds.length < 6) continue;
            
            const primerTd = tds[0].textContent.trim();
            if (primerTd.includes('Activos Amortizables') || primerTd.includes('Activos No Amortizables')) {
              continue;
            }
            
            // Columnas: [0]Nombre, [1]TipoActivo (Vehículo), [2]Concepto, [3]Fecha, [4]%Amort, [5]Monto
            const vehiculo = tds[1]?.textContent.trim() || 'Otros';
            const fechaTxt = tds[3]?.textContent.trim();
            const montoTxt = tds[5]?.textContent.trim();
            
            const d = parseDMYMaybeMW(fechaTxt);
            if (!d || isNaN(d)) continue;
            
            const y = d.getFullYear();
            if (y < yearNow) continue;
            
            const amt = toNumMW(montoTxt);
            if (amt <= 0) continue;
            
            // Acumular por año y vehículo
            if (!byYearVehiculo.has(y)) {
              byYearVehiculo.set(y, new Map());
            }
            const vehiculoMap = byYearVehiculo.get(y);
            vehiculoMap.set(vehiculo, (vehiculoMap.get(vehiculo) || 0) + amt);
          }
          
          // Restaurar
          window.ACTIVE_CRONO_CUR = prevCur;
          const liveTb = document.querySelector('#tablaAmort tbody');
          if (snapshot && liveTb && liveTb.parentNode) {
            liveTb.parentNode.replaceChild(snapshot, liveTb);
          }
          
          if (byYearVehiculo.size === 0) {
            resolve({ years: [], byVehiculo: {} });
            return;
          }
          
          // Generar estructura: years array + byVehiculo object
          const maxYear = Math.max(...Array.from(byYearVehiculo.keys()));
          const years = [];
          
          for (let y = yearNow; y <= maxYear; y++){
            years.push(y);
          }
          
          // Recopilar todos los vehículos únicos
          const allVehiculos = new Set();
          byYearVehiculo.forEach(vehiculoMap => {
            vehiculoMap.forEach((_, vehiculo) => allVehiculos.add(vehiculo));
          });
          
          // Crear datasets por vehículo
          const byVehiculo = {};
          allVehiculos.forEach(vehiculo => {
            byVehiculo[vehiculo] = years.map(y => {
              const vehiculoMap = byYearVehiculo.get(y);
              return vehiculoMap ? (vehiculoMap.get(vehiculo) || 0) : 0;
            });
          });
          
          resolve({ years, byVehiculo });
        }, 50);
      });
    }

    async function renderMaturityWallPFChart(canvasId, cur) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      const data = await collectMaturityDataPF(cur);
      const { years, byVehiculo } = data;
      
      if (years.length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('No hay datos de vencimientos disponibles', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const labels = years.map(y => String(y));
      
      // Orden específico de vehículos
      const vehiculoOrder = [
        'DPF',
        'Bonos', 
        'CLN',
        'Autocall',
        'Twin Win',
        'SMART Deposit',
        'Fondo Cerrado',
        'Fondo Mutuo',
        'Otros'
      ];
      
      // Paleta de colores (se asignan secuencialmente)
      const colorPalette = [
        '#060E46',
        '#CAD1D8',
        '#9694FF',
        '#001391',
        '#85C8FF',
        '#FFE761',
        '#8BE1E9',
        '#46536D'
      ];
      
      // Crear datasets ordenados (uno por vehículo que exista)
      const datasets = [];
      let colorIndex = 0;
      
      // Primero agregar vehículos en el orden especificado
      vehiculoOrder.forEach(vehiculo => {
        if (byVehiculo[vehiculo]) {
          datasets.push({
            label: vehiculo,
            data: byVehiculo[vehiculo],
            backgroundColor: colorPalette[colorIndex % colorPalette.length],
            borderWidth: 0
          });
          colorIndex++;
        }
      });
      
      // Luego agregar vehículos no listados al final
      Object.keys(byVehiculo).forEach(vehiculo => {
        if (!vehiculoOrder.includes(vehiculo)) {
          datasets.push({
            label: vehiculo,
            data: byVehiculo[vehiculo],
            backgroundColor: colorPalette[colorIndex % colorPalette.length],
            borderWidth: 0
          });
          colorIndex++;
        }
      });
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { 
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13 }
              }
            },
            tooltip: { 
              enabled: true,
              mode: 'index',
              callbacks: {
                label: function(context) {
                  const value = context.parsed.y;
                  const symbol = (cur === 'PEN') ? 'S/' : '$';
                  return `${context.dataset.label}: ${symbol} ${value.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
                }
              }
            },
            datalabels: { display: false }
          },
          scales: {
            x: { 
              stacked: true,
              grid: { display: false },
              ticks: {
                font: { size: 13 }
              }
            },
            y: {
              stacked: true,
              beginAtZero: true,
              title: { display: false },
              ticks: { 
                callback: (v)=> Number(v).toLocaleString('en-US'),
                font: { size: 13 }
              },
              grid: { color: 'rgba(0,0,0,0.06)' }
            }
          }
        }
      });
    }

    // =========================
    // Portafolio Final - Asset Allocation Nivel 2
    // =========================
    function calculateAssetAllocationL2(cur, perfil) {
      // Si es TOTAL, combinar USD + PEN
      if (cur === 'TOTAL') {
        const tcInput = document.getElementById('tipoCambio');
        const tc = parseFloat(tcInput?.value) || 3.40;
        
        // Combinar datos de USD y PEN convertido a USD
        const byPMInitUSD = currentHoldingsInitialByClassPM('USD');
        const byPMInitPEN = currentHoldingsInitialByClassPM('PEN');
        const byPMFinalUSD = currentHoldingsFinalByClassPM('USD');
        const byPMFinalPEN = currentHoldingsFinalByClassPM('PEN');
        
        // Convertir PEN a USD y combinar
        const byPMInitCombined = { sumBy: {}, total: 0 };
        const byPMFinalCombined = { sumBy: {}, total: 0 };
        
        // Combinar sumBy de USD
        Object.keys(byPMInitUSD.sumBy || {}).forEach(key => {
          byPMInitCombined.sumBy[key] = (byPMInitCombined.sumBy[key] || 0) + (byPMInitUSD.sumBy[key] || 0);
        });
        Object.keys(byPMFinalUSD.sumBy || {}).forEach(key => {
          byPMFinalCombined.sumBy[key] = (byPMFinalCombined.sumBy[key] || 0) + (byPMFinalUSD.sumBy[key] || 0);
        });
        
        // Convertir y combinar sumBy de PEN
        Object.keys(byPMInitPEN.sumBy || {}).forEach(key => {
          const penValue = (byPMInitPEN.sumBy[key] || 0) / tc;
          byPMInitCombined.sumBy[key] = (byPMInitCombined.sumBy[key] || 0) + penValue;
        });
        Object.keys(byPMFinalPEN.sumBy || {}).forEach(key => {
          const penValue = (byPMFinalPEN.sumBy[key] || 0) / tc;
          byPMFinalCombined.sumBy[key] = (byPMFinalCombined.sumBy[key] || 0) + penValue;
        });
        
        byPMInitCombined.total = (byPMInitUSD.total || 0) + ((byPMInitPEN.total || 0) / tc);
        byPMFinalCombined.total = (byPMFinalUSD.total || 0) + ((byPMFinalPEN.total || 0) / tc);
        
        const totInit = byPMInitCombined.total || 0;
        const totFinal = byPMFinalCombined.total || 0;
        
        const order = ["Liquidez", "Renta Fija CP", "Renta Fija MP", "Renta Variable", "Alternativo"];
        const modelo = MODELOS_PM?.[perfil] || {};
        
        const sortPM = (a, b) => {
          const A = normTxt(a), B = normTxt(b);
          if (A === 'OTROS') return 1;
          if (B === 'OTROS') return -1;
          return String(a).localeCompare(String(b), 'es', {sensitivity: 'base'});
        };
        
        const labels = [], mod = [], act = [], sug = [];
        
        order.forEach(clase => {
          const bag = modelo[clase] || {};
          const keysModel = Object.keys(bag);
          const keysAct = Object.keys(byPMInitCombined.sumBy).filter(k => k.startsWith(`${clase}|`)).map(k => k.split('|')[1]);
          const keysSug = Object.keys(byPMFinalCombined.sumBy).filter(k => k.startsWith(`${clase}|`)).map(k => k.split('|')[1]);
          const keys = Array.from(new Set([...keysModel, ...keysAct, ...keysSug])).sort(sortPM);
          
          keys.forEach(pm => {
            const mAbs = toNum(bag[pm]) || 0;
            const aAmt = toNum(byPMInitCombined.sumBy[`${clase}|${pm}`] || 0);
            const sAmt = toNum(byPMFinalCombined.sumBy[`${clase}|${pm}`] || 0);
            
            if (!(mAbs > 0 || aAmt > 0 || sAmt > 0)) return;
            if (pm === 'CUENTA VALOR') return;
            
            // Agregar prefijo según la clase
            let label = pm;
            if (clase === 'Renta Fija CP') {
              label = `RF CP ${pm}`;
            } else if (clase === 'Renta Fija MP') {
              label = `RF MP ${pm}`;
            } else if (clase === 'Renta Variable') {
              label = `RV ${pm}`;
            }
            
            labels.push(label);
            mod.push(Number(mAbs.toFixed(2)));
            act.push(Number(totInit > 0 ? ((aAmt / totInit) * 100).toFixed(2) : 0));
            sug.push(Number(totFinal > 0 ? ((sAmt / totFinal) * 100).toFixed(2) : 0));
          });
        });
        
        return { labels, modelo: mod, actual: act, propuesto: sug };
      }
      
      const order = ["Liquidez", "Renta Fija CP", "Renta Fija MP", "Renta Variable", "Alternativo"];
      
      // Datos de modelo
      const modelo = MODELOS_PM?.[perfil] || {};
      
      // Datos actuales y propuestos
      const byPMInitCls = currentHoldingsInitialByClassPM(cur);
      const byPMFinalCls = currentHoldingsFinalByClassPM(cur);
      const totInit = byPMInitCls.total || 0;
      const totFinal = byPMFinalCls.total || 0;
      
      const sortPM = (a, b) => {
        const A = normTxt(a), B = normTxt(b);
        if (A === 'OTROS') return 1;
        if (B === 'OTROS') return -1;
        return String(a).localeCompare(String(b), 'es', {sensitivity: 'base'});
      };
      
      const labels = [], mod = [], act = [], sug = [];
      
      order.forEach(clase => {
        const bag = modelo[clase] || {};
        const keysModel = Object.keys(bag);
        const keysAct = Object.keys(byPMInitCls.sumBy).filter(k => k.startsWith(`${clase}|`)).map(k => k.split('|')[1]);
        const keysSug = Object.keys(byPMFinalCls.sumBy).filter(k => k.startsWith(`${clase}|`)).map(k => k.split('|')[1]);
        const keys = Array.from(new Set([...keysModel, ...keysAct, ...keysSug])).sort(sortPM);
        
        keys.forEach(pm => {
          const mAbs = toNum(bag[pm]) || 0;
          const aAmt = toNum(byPMInitCls.sumBy[`${clase}|${pm}`] || 0);
          const sAmt = toNum(byPMFinalCls.sumBy[`${clase}|${pm}`] || 0);
          
          if (!(mAbs > 0 || aAmt > 0 || sAmt > 0)) return;
          if (pm === 'CUENTA VALOR') return;
          
          // Agregar prefijo según la clase
          let label = pm;
          if (clase === 'Renta Fija CP') {
            label = `RF CP ${pm}`;
          } else if (clase === 'Renta Fija MP') {
            label = `RF MP ${pm}`;
          } else if (clase === 'Renta Variable') {
            label = `RV ${pm}`;
          }
          
          labels.push(label);
          mod.push(Number(mAbs.toFixed(2)));
          act.push(Number(totInit > 0 ? ((aAmt / totInit) * 100).toFixed(2) : 0));
          sug.push(Number(totFinal > 0 ? ((sAmt / totFinal) * 100).toFixed(2) : 0));
        });
      });
      
      return { labels, modelo: mod, actual: act, propuesto: sug };
    }

    function renderAssetAllocationL2Chart(canvasId, data) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      
      const existingChart = Chart.getChart(canvas);
      if (existingChart) existingChart.destroy();
      
      if (!data || !data.labels || data.labels.length === 0) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '14px Inter, sans-serif';
        ctx.fillStyle = '#6a737d';
        ctx.textAlign = 'center';
        ctx.fillText('Seleccione un perfil de inversión', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const allPct = [...data.modelo, ...data.actual, ...data.propuesto].filter(v => typeof v === 'number' && !isNaN(v));
      const maxPct = Math.max(10, ...allPct);
      const niceMax = Math.min(100, Math.ceil(maxPct / 10) * 10);
      
      const ctx = canvas.getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: data.labels,
          datasets: [
            {
              label: 'Portafolio Modelo',
              data: data.modelo,
              backgroundColor: '#060E46',
              categoryPercentage: 0.85,
              barPercentage: 0.9
            },
            {
              label: 'Portafolio Actual',
              data: data.actual,
              backgroundColor: '#CAD1D8',
              categoryPercentage: 0.85,
              barPercentage: 0.9
            },
            {
              label: 'Portafolio Sugerido',
              data: data.propuesto,
              backgroundColor: '#9694FF',
              categoryPercentage: 0.85,
              barPercentage: 0.9
            }
          ]
        },
        options: {
          indexAxis: 'x',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                boxWidth: 15,
                padding: 12,
                font: { size: 13, family: 'Lato, sans-serif' }
              }
            },
            datalabels: {
              anchor: 'end',
              align: 'end',
              rotation: -90,
              formatter: (value) => value > 0 ? value.toFixed(1) : '',
              color: '#333',
              font: { weight: 'normal', size: 13, family: 'Lato, sans-serif' }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: niceMax,
              grid: { display: true, color: '#e0e0e0' },
              ticks: {
                callback: (v) => v + '%',
                font: { size: 14, family: 'Lato, sans-serif' }
              }
            },
            x: {
              grid: { display: false },
              ticks: {
                font: { size: 13, family: 'Lato, sans-serif' },
                autoSkip: false,
                maxRotation: 0,
                minRotation: 0,
                callback: function(value, index) {
                  let label = this.getLabelForValue(value);
                  // Aplicar acrónimos
                  label = label.replace('Cash y Equivalentes', 'Cash & Eq.')
                               .replace('Global EM', 'GEM')
                               .replace('HY Desarrollados', 'HY DM')
                               .replace('IG Desarrollados', 'IG DM')
                               .replace('Latinoamerica', 'Latam')
                               .replace('Latinoamérica', 'Latam')
                               .replace('Desarrollados', 'DM')
                               .replace('Emergente', 'EM')
                               .replace('Emergentes', 'EM');
                  // Dividir en 2 líneas si tiene espacio
                  const words = label.split(' ');
                  if (words.length >= 2) {
                    const mid = Math.ceil(words.length / 2);
                    return [words.slice(0, mid).join(' '), words.slice(mid).join(' ')];
                  }
                  return label;
                }
              }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }

    // =========================
    // Build desde filas + Activos
    // =========================
    function buildFromRows(rows){
      const CLASES = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];
      const holdingsByCurrency = { USD:[], PEN:[] };
      const classTable = {}; CLASES.forEach(c=> classTable[c] = { monto_usd_nativo:0, monto_pen_nativo:0, total_dolarizado:0, total_usd_sum:0 });
      // === NUEVO: totales por subclase (scoped por clase)
      const classSubcatTable = {}; 
      CLASES.forEach(c => classSubcatTable[c] = new Map()); // Map<Clase||Subcanon, {label, usd, pen, usd_sum}>

      let totUSD=0, totPEN=0;
      const fxRows = [];

      rows.forEach(src=>{
        const row = normalizeRowKeys(src);
        
        // Excluir activos con SaldoDisponibleDetalleUSD en cero
        const saldoDisponible = toNum(row.saldodisponibledetalleusd);
        if (saldoDisponible === 0) {
          return; // Saltar este activo
        }
        
        const prod = normTxt( pick(row, ['producto']) );
        const subName = normTxt( pick(row, ['subproducto','nombre']) );
        const isin = normIsin( pick(row, ['isin']) );
        const codp = normCodprod( pick(row, ['codsubproduct','codsubproducto','subproduct_id']) );

        let clase = '';
        if(ACT.loaded){
          clase = mapClassFromActivos(prod, subName, isin, codp);
        }
        if(!clase) clase = guessClassHeuristic(row);

        const cur = guessCurrency(row, prod, isin, codp, subName);

        // 1) Usar "diccionario" de Activos.csv como prioridad (excepto DPF)
        let nombre = '';
        const esDPF = isCuentaAPlazo(row);

        if (!esDPF && ACT.loaded) {
          // Prioridad: diccionario por ISIN > codprod > subprod
          if (isin && ACT.dict_by_isin.has(isin)) {
            nombre = ACT.dict_by_isin.get(isin);
          } else if (codp && ACT.dict_by_codprod.has(codp)) {
            nombre = ACT.dict_by_codprod.get(codp);
          } else if (subName && ACT.dict_by_subprod.has(subName)) {
            nombre = ACT.dict_by_subprod.get(subName);
          }
        }

        // 2) Si no hay diccionario, usar alias directos desde Asesor360
        if (!nombre || String(nombre).trim() === '') {
          nombre = pick(row, [
          'nombre','nombredet','nombreactivo','nombreactivodet',
          'descripcion','descripciondet','instrumento',
          'emisor','emision','securityname','security','activo',
          'subproducto','subproductodet','nombresubproducto'
        ]);
        }

        // 3) Fallback desde Activos (name, no dict)
        if ((!nombre || String(nombre).trim()==='') && ACT.loaded) {
          if (isin && ACT.name_by_isin.has(isin)) {
            nombre = ACT.name_by_isin.get(isin);
          } else if (codp && ACT.name_by_codprod.has(codp)) {
            nombre = ACT.name_by_codprod.get(codp);
          }
        }

        // 4) Fallback final si aún está vacío
        if (!nombre || String(nombre).trim()==='') {
          nombre = pick(row, ['subproducto','producto']) || (codp ? `Fondo ${codp}` : '—');
        }

        // 5) Formato especial para Cuenta a Plazo (sobrescribe todo lo anterior)
        if (esDPF) {
          const plazo = pick(row, ['plazo']) || '';
          const tasa = pick(row, ['tasa']) || '';
          const fvcto = pick(row, ['fvencimientodet', 'f.vencimientodet', 'fechavcto']) || '';
          nombre = `DPF (${plazo}) - ${tasa}% ${fvcto}`;
        }

        const fecha_compra = toFechaStr(pick(row, ['f.apertura', 'F.Apertura']));
        const costo_compra = toNum(row.valorcompradet);
        const unidades     = toNum(row.saldoactualcontablentdet);
        const precio_mdo   = toNum(row.precactualdet);
        const valor_usd    = toNum(row.saldoactualdetalleusd);
        const valor_pen    = toNum(row.saldoactualori);
        const u_no_real    = toNum(row.utilidaddet);

        // Vehículo: prioridad Subproducto > ISIN > CSV
        const vehiculo = (subName && ACT.veh_by_subprod_name.get(subName))
                      || (isin && ACT.veh_by_isin.get(isin))
                      || pick(row,['vehiculo','vehicle']) || '';
        
        // Región: prioridad Subproducto > ISIN > CodProd > CSV
        // Para CUENTA A PLAZO, siempre usar "Emergentes"
        let region = '';
        if (prod === 'CUENTA A PLAZO') {
          region = 'Emergentes';
        } else {
          region = (subName && ACT.pm_by_subprod_name.get(subName))
                   || (isin && ACT.pm_by_isin.get(isin))
                   || (codp && ACT.pm_by_codprod.get(codp))
                   || '';
        }
        
        // Subclase: prioridad ISIN > CodSubproducto > Subproducto (no al revés)
        // Para CUENTA A PLAZO de Asesor360, usar campo "Plazo"
        let subclase = '';
        if (prod === 'CUENTA A PLAZO') {
          const plazo = pick(row, ['plazo']) || '';
          subclase = plazo || 'DPF';  // Si no tiene plazo, usar "DPF" por defecto
        } else {
          subclase =
            (isin && ACT.subclase_by_isin.get(isin)) ||
            (codp && ACT.subclase_by_codprod.get(codp)) ||
            (subName && ACT.subclase_by_subprod_name.get(subName)) ||
            '';
        }

        const nominalHint =
          row['Nominal Actual'] ?? row['Nominal'] ?? row['Saldo Nominal'] ??
          row['Saldo'] ?? row.nominal ?? row.nominal_actual ?? row.Unidades ?? row.unidades;

        const finalNominalHint = nominalHint !== undefined ? faceFrom(nominalHint) : (unidades * 1000);

        const h = {
          nombre,
          clase,
          Producto: prod,  // CRÍTICO: agregar para _prodVehGroupOf
          fecha_compra,
          costo_compra,
          unidades,
          precio_mercado: precio_mdo,
          valor_mercado: (cur==='USD') ? valor_usd : valor_pen,
          saldoRetenido: toNum(pick(row, ['SaldoretenidoDetalleUSD', 'SaldoRetenidoDetalleUSD', 'saldoretenidodetalleusd'])),
          gp_no_realizada: u_no_real,
          vehiculo,
          region,
          subclase,
          Moneda: cur,  // CRÍTICO: agregar para _montoFinalOf
          _isin: isin,
          _codSub: codp,
          _subn: subName,  // CRÍTICO: agregar para búsquedas en ACT
          // Si nominalHint es undefined, usar unidades * 1000 (porque unidades son en miles)
          _nominalHint: nominalHint !== undefined ? faceFrom(nominalHint) : (unidades * 1000),
          _precPromedio: toNum(pick(row, ['precpromediodet', 'precpromedioDet', 'PrecpromedioDet', 'precpromedio', 'PrecPromedio'])),
          fechavcto: pick(row, ['f.vencimientodet', 'fvencimientodet', 'fechavcto', 'fechavencimiento']),
          plazo: pick(row, ['plazo']),
          tasa: pick(row, ['tasa']),
          _rid: `${cur}-${holdingsByCurrency[cur].length}`
        };
        holdingsByCurrency[cur].push(h);

        if(cur==='USD'){
          classTable[clase].monto_usd_nativo += valor_usd;
          totUSD += valor_usd;
        } else {
          classTable[clase].monto_pen_nativo += valor_pen;
          totPEN += valor_pen;
        }
        
        // Acumular siempre el USD (SaldoactualDetalleUSD) para el total dolarizado
        classTable[clase].total_usd_sum += valor_usd;

        // === NUEVO: acumular subclase por clase (clave jerárquica)
        const scCanon = canonSubcatName(subclase) || 'SIN_SUBCLASE';
        const scKey   = `${clase}||${scCanon}`;
        const scMap   = classSubcatTable[clase];
        const label   = ACT.subcat_label_by_key.get(scKey) || (subclase || 'Sin subclase');
        const rec     = scMap.get(scKey) || { label, monto_usd_nativo:0, monto_pen_nativo:0, total_usd_sum:0 };
        if (cur==='USD') rec.monto_usd_nativo += valor_usd;
        else              rec.monto_pen_nativo += valor_pen;
        rec.total_usd_sum += valor_usd;   // coherente con Total Dolarizado global
        scMap.set(scKey, rec);

        const fx = toNum( pick(row, ['tipocambio','tc','fx','tipo_cambio']) );
        if(fx>0){ fxRows.push({ clase, valor_usd, valor_pen, fx }); }
      });

      // Total Dolarizado = suma de SaldoactualDetalleUSD (USD + PEN)
      let totalDolarizado = 0;
      CLASES.forEach(c=>{
        classTable[c].total_dolarizado = classTable[c].total_usd_sum; // incluye USD de filas PEN
        totalDolarizado += classTable[c].total_dolarizado;
      });

      // Completar total dolarizado por subclase
      CLASES.forEach(c=>{
        for (const rec of classSubcatTable[c].values()){
          rec.total_dolarizado = rec.total_usd_sum;
        }
      });

      return { holdingsByCurrency, classTable, classSubcatTable, totUSD, totPEN, totalDolarizado };
    }

    function renderDashboard(built){
      const CLASES = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];
      renderTablaConsolidada(built.classTable, built.totalDolarizado);
      const sumsUSD = {}; const sumsPEN = {};
      CLASES.forEach(c=>{
        sumsUSD[c] = built.classTable[c]?.monto_usd_nativo || 0;
        sumsPEN[c] = built.classTable[c]?.monto_pen_nativo || 0;
      });
      renderGroupedBar('aaCanvasGrouped', CLASES, sumsUSD, sumsPEN);
      renderDonut('aaCanvasDonut', built.totUSD, built.totPEN);
    }

    // =========================
    // Reset & Cargar por código
    // =========================
    function resetState(){
      A360 = []; A360ByCode = new Map(); CURRENT_CODE = null;
      CASH.aportes = { USD:0, PEN:0 };
      CASH.fxops = [];
      edits = { USD:new Map(), PEN:new Map() };
      editsAcct = { USD:new Map(), PEN:new Map() };
      document.getElementById('csvInfo').textContent = '';
      setVal('perfil',''); setVal('banca',''); setVal('banquero',''); setVal('asesor','');
      setVal('fechaDatosInput','');
      document.getElementById('tablaGuiaBodyConsolidada').innerHTML = '';
      ['holdBodyUSD','holdBodyPEN'].forEach(id=>{ const el=document.getElementById(id); if(el) el.innerHTML=''; });
      if(charts.grouped) charts.grouped.destroy(); if(charts.donut) charts.donut.destroy();
      renderCashBars();
    }
    async function cargarDesdeAsesor360(){
      const codeEl = document.getElementById('codigo');
      const norm = norm8(codeEl?.value || '');
      if(!norm || norm==='00000000'){ return; }
      if(!A360 || !A360.length){ alert('Primero carga Asesor360.csv en "Centro de datos".'); return; }
      const rows = A360ByCode.get(norm) || [];
      if(!rows.length){ alert(`No hay filas para el código ${norm}.`); return; }
      CURRENT_CODE = norm;

      // Guardar código en localStorage como opción
      guardarCodigoCliente(norm);

      // Datos del cliente (si existen columnas)
      const first = rows[0];

      populatePerfilSelector();

      const perfilCSV = pick(first, ['perfil']) || '';
      setVal('perfil', perfilCSV);

      if (perfilCSV) {
        syncPerfilToAllViews(perfilCSV);
      }

      const bancaRaw = pick(first, ['oficina']) || '';
      const banqueroRaw = pick(first, ['asesor']) || '';
      const iaRaw = pick(first, ['IA', 'ia', 'Ia']) || '';

      setVal('banca',    toTitleCase(cleanBanca(bancaRaw)));
      setVal('banquero', formatBanquero(banqueroRaw));
      setVal('asesor',   String(iaRaw).trim()); // Campo Asesor jala el valor de IA del A360
      // Fecha de datos: usar únicamente "FechaInformacion" (normalizado: fechainformacion, formato dd/mm/aaaa)
      const fechas = rows.map(r => {
        const s = r.fechainformacion;
        if (!s) return null;
        const [d,m,y] = String(s).trim().split('/').map(Number);
        const t = new Date(y, m-1, d).getTime();
        return Number.isNaN(t) ? null : t;
      }).filter(t => t !== null);

      const maxF = fechas.length ? new Date(Math.max(...fechas)) : null;
      setVal('fechaDatosInput', maxF ? maxF.toLocaleDateString('es-PE', { day:'2-digit', month:'2-digit', year:'numeric' }) : '');

      const built = buildFromRows(rows);
      
      // Calcular Tipo de Cambio promedio
      const CLASES = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];
      let tcSum = 0;
      let tcCount = 0;
      CLASES.forEach(c => {
        const cls = built.classTable[c];
        if (cls && cls.monto_pen_nativo > 0) {
          const penEnUSD = cls.total_dolarizado - cls.monto_usd_nativo;
          if (penEnUSD > 0) {
            tcSum += cls.monto_pen_nativo / penEnUSD;
            tcCount++;
          }
        }
      });
      const tc = tcCount > 0 ? tcSum / tcCount : 0;
      setVal('tipoCambio', tc > 0 ? tc.toFixed(2) : '');
      
      LAST_HOLDINGS = built.holdingsByCurrency;
      computeCashBaseForCode(rows);
      buildCashAccountsIndex(rows, built.holdingsByCurrency);
      recomputeFxMaps();
      renderDashboard(built);
      renderHoldingsTables(LAST_HOLDINGS);
      renderRentaFijaTables();
      renderPortafolioBonos();
      renderRentaVariableTables();
      renderPortafolioTables();
      renderCashBars();
      renderCashMgmtUI();
      
      // Evaluar límites para mostrar círculos morados
      if (typeof evaluateLimits === 'function') {
        evaluateLimits();
      }
    }

    // Guardar código de cliente en localStorage
    function guardarCodigoCliente(codigo) {
      if (!codigo || codigo === '00000000') return;
      try {
        const codigosGuardados = JSON.parse(localStorage.getItem('codigosCliente') || '[]');
        if (!codigosGuardados.includes(codigo)) {
          codigosGuardados.unshift(codigo); // Agregar al inicio
          // Mantener solo los últimos 20 códigos
          const codigosLimitados = codigosGuardados.slice(0, 20);
          localStorage.setItem('codigosCliente', JSON.stringify(codigosLimitados));
          actualizarDatalistCodigos();
        }
      } catch(e) {
        console.error('Error al guardar código de cliente:', e);
      }
    }

    // Cargar y mostrar códigos guardados en el datalist
    function actualizarDatalistCodigos() {
      try {
        const codigosGuardados = JSON.parse(localStorage.getItem('codigosCliente') || '[]');
        const datalist = document.getElementById('codigosCliente');
        if (datalist) {
          datalist.innerHTML = '';
          codigosGuardados.forEach(codigo => {
            const option = document.createElement('option');
            option.value = codigo;
            datalist.appendChild(option);
          });
        }
      } catch(e) {
        console.error('Error al cargar códigos de cliente:', e);
      }
    }

    // =========================
    // Función buildCashAccountsIndex y helpers
    // =========================
    function buildCashAccountsIndex(rows, holdingsByCurrency){
      CASH_ACC = { USD:new Map(), PEN:new Map() };
      const rowsN = rows.map(normalizeRowKeys);

      for(const r of rowsN){
        const subn = normTxt(pick(r,['subproducto','nombre']));
        const prod = subn ? ACT.product_by_subprod_name.get(subn) : '';
        if(prod!=='CUENTA AHORRO' && prod!=='CUENTA CORRIENTE') continue;
        const isin = normIsin(pick(r,['isin']));
        const codp = normCodprod(pick(r,['codsubproduct','codsubproducto','subproduct_id']));
        const prodRaw = normTxt(pick(r,['producto']));
        const cur  = guessCurrency(r, prodRaw, isin, codp, subn);
        const base = (cur==='USD') ? toNum(r.saldoactualdetalleusd) : toNum(r.saldoactualori);
        const M = CASH_ACC[cur];
        const item = M.get(subn) || { producto:prod, base:0 };
        item.base += base; M.set(subn, item);
      }

      ['USD','PEN'].forEach(cur=>{
        for(const h of (holdingsByCurrency[cur]||[])){
          h._subn = normTxt(h.nombre) || '';
        }
      });
    }

    function recomputeFxMaps(){
      FX_IN = { USD:new Map(), PEN:new Map() };
      FX_OUT = { USD:new Map(), PEN:new Map() };
      for(const op of FX_LOG){
        FX_OUT[op.fromCur].set(op.fromSub, (FX_OUT[op.fromCur].get(op.fromSub)||0) + op.amtFrom);
        FX_IN[op.toCur].set(op.toSub, (FX_IN[op.toCur].get(op.toSub)||0) + op.amtTo);
      }
    }

    function sumMap(m){ let s=0; for(const v of m.values()) s+=toNum(v); return s; }

    function getDisponible(cur, subn){
      const base = CASH_ACC[cur].get(subn)?.base || 0;
      const ap   = toNum(APORTES[cur].get(subn) || 0);
      const fxIn = toNum(FX_IN[cur].get(subn)   || 0);
      const fxOut= toNum(FX_OUT[cur].get(subn)  || 0);
      const asig = toNum(ASIG[cur].get(subn)    || 0);
      return base + ap + fxIn - fxOut - asig;
    }

    function listCashAccounts(cur){
      return Array.from(CASH_ACC[cur].keys());
    }

    function getSaldoNetoCV(cur){
      let net = 0;
      for(const v of (edits[cur]||new Map()).values()) net += toNum(v);
      return net;
    }

    // =========================
    // Funciones de Caja
    // =========================
    function computeCashBaseForCode(rows){
      CASH.base.USD.accts = new Map(); CASH.base.USD.total = 0;
      CASH.base.PEN.accts = new Map(); CASH.base.PEN.total = 0;

      for(const src of rows){
        const r = normalizeRowKeys(src);
        const subName = normTxt(pick(r, ['subproducto','nombre']));
        let prod = (subName && ACT.product_by_subprod_name.get(subName)) || normTxt(pick(r, ['producto']));
        if(!prod) continue;
        if(!(prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE')) continue;

        const isin = normIsin(pick(r,['isin']));
        const codp = normCodprod(pick(r,['codsubproduct','codsubproducto','subproduct_id']));
        const cur  = guessCurrency(r, prod, isin, codp, subName);
        const key  = prod;
        const amtUSD = toNum(r.saldoactualdetalleusd);
        const amtPEN = toNum(r.saldoactualori);

        if(cur==='USD'){
          CASH.base.USD.accts.set(key, (CASH.base.USD.accts.get(key)||0) + amtUSD);
          CASH.base.USD.total += amtUSD;
        }else{
          CASH.base.PEN.accts.set(key, (CASH.base.PEN.accts.get(key)||0) + amtPEN);
          CASH.base.PEN.total += amtPEN;
        }
      }
    }

    function listAccounts(cur){
      const ac = CASH.base[cur].accts;
      const keys = Array.from(ac.keys());
      if (!keys.length) keys.push('CUENTA AHORRO','CUENTA CORRIENTE');
      if (!keys.includes('APORTES')) keys.push('APORTES');
      return Array.from(new Set(keys.filter(Boolean)));
    }

    function netCvByAccount(cur){
      const res = new Map();
      for(const [rid, val] of edits[cur]){
        const acc = editsAcct[cur].get(rid) || 'CUENTA AHORRO';
        res.set(acc, (res.get(acc)||0) + toNum(val));
      }
      return res;
    }

    function computeAvailable(){
      const out = { USD:new Map(CASH.base.USD.accts), PEN:new Map(CASH.base.PEN.accts) };

      if (CASH.aportes.USD) out.USD.set('APORTES', (out.USD.get('APORTES')||0) + CASH.aportes.USD);
      if (CASH.aportes.PEN) out.PEN.set('APORTES', (out.PEN.get('APORTES')||0) + CASH.aportes.PEN);

      for(const op of CASH.fxops){
        const fromMap = out[op.fromCur]; const toMap = out[op.toCur];
        fromMap.set(op.fromAcct, (fromMap.get(op.fromAcct)||0) - op.amtFrom);
        toMap.set(op.toAcct,     (toMap.get(op.toAcct)||0)     + op.amtTo);
      }

      const usdCV = netCvByAccount('USD'); const penCV = netCvByAccount('PEN');
      for(const [acc,v] of usdCV){ out.USD.set(acc, (out.USD.get(acc)||0) - v); }
      for(const [acc,v] of penCV){ out.PEN.set(acc, (out.PEN.get(acc)||0) - v); }

      const totUSD = Array.from(out.USD.values()).reduce((a,b)=>a+toNum(b),0);
      const totPEN = Array.from(out.PEN.values()).reduce((a,b)=>a+toNum(b),0);
      return { out, totUSD, totPEN };
    }

    function fillSelect(sel, options){
      sel.innerHTML = '';
      options.forEach(o=>{
        const opt=document.createElement('option'); opt.value=o; opt.textContent=o;
        sel.appendChild(opt);
      });
    }

    function computeAvailableTotals(){
      const totUSD = listCashAccounts('USD').reduce((a, sub)=> a + getDisponible('USD', sub), 0);
      const totPEN = listCashAccounts('PEN').reduce((a, sub)=> a + getDisponible('PEN', sub), 0);
      return { totUSD, totPEN };
    }

    function computePend(cur){ return getSaldoNetoCV(cur) - sumMap(ASIG[cur]); }

    function cvNet(cur){
      let sum = 0;
      const rows = LAST_HOLDINGS[cur] || [];
      for (const [rid, v] of (edits[cur] || new Map()).entries()){
        const row = rows.find(x => x._rid === rid);
        if (!row) continue;
        
        const sub = row._subn || '';
        const prod = (sub && ACT.product_by_subprod_name.get(sub)) || row.Producto || '';
        
        // Excluir cuentas de ahorro, corriente y CTS
        if (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE' || prod === 'CTS') continue;
        
        sum += toNum(v);
      }
      return sum;
    }

    function renderCashBars(){
      const cashBase = (cur)=> Array.from(CASH_ACC[cur].keys())
        .reduce((a, sub)=> a + getDisponible(cur, sub), 0);

      const sumCTS = (cur)=> (LAST_HOLDINGS[cur] || []).reduce((a, r)=>{
        const sub  = r._subn || '';
        const prod = sub ? ACT.product_by_subprod_name.get(sub) : '';
        if (prod !== 'CTS') return a;
        const cv = toNum(edits[cur].get(r._rid) || 0);
        return a - cv;
      }, 0);

      const pendingCV = (cur)=> cvNet(cur);

      const totalUSD = cashBase('USD') + sumCTS('USD') - pendingCV('USD');
      const totalPEN = cashBase('PEN') + sumCTS('PEN') - pendingCV('PEN');

      const elUSD = document.getElementById('cashUSD'); if(elUSD) elUSD.textContent = fmtMoney(totalUSD,'USD');
      const elPEN = document.getElementById('cashPEN'); if(elPEN) elPEN.textContent = fmtMoney(totalPEN,'PEN');

    }

    function renderCashMgmtUI(){
      const subsU = listCashAccounts('USD');
      const subsP = listCashAccounts('PEN');

      const fill = (id, opts)=>{ const el = document.getElementById(id); if(!el) return;
        el.innerHTML = opts.map(s=>`<option value="${s}">${s}</option>`).join('');
      };

      // Cargar valores actuales de saldos frescos en los inputs
      const sfUInput = document.getElementById('sf-u-monto');
      const sfPInput = document.getElementById('sf-p-monto');
      if (sfUInput) sfUInput.value = SALDOS_FRESCOS.USD > 0 ? SALDOS_FRESCOS.USD.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
      if (sfPInput) sfPInput.value = SALDOS_FRESCOS.PEN > 0 ? SALDOS_FRESCOS.PEN.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';

      // Cargar valores actuales de FX en los inputs
      const fxUamtInput = document.getElementById('fx-u-amt');
      const fxUtcInput = document.getElementById('fx-u-tc');
      const fxPamtInput = document.getElementById('fx-p-amt');
      const fxPtcInput = document.getElementById('fx-p-tc');
      
      if (fxUamtInput) fxUamtInput.value = FX_TOTALES.USD ? FX_TOTALES.USD.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
      if (fxUtcInput) fxUtcInput.value = FX_TC.USD || '';
      if (fxPamtInput) fxPamtInput.value = FX_TOTALES.PEN ? FX_TOTALES.PEN.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
      if (fxPtcInput) fxPtcInput.value = FX_TC.PEN || '';

      const tbU = document.querySelector('#asig-u-table tbody'); if(tbU){ tbU.innerHTML='';
        let totSf=0, totFx=0, totDisp=0, totAsig=0;

        subsU.forEach(sub=>{
          const sf   = toNum(APORTES.USD.get(sub) || 0);                 totSf   += sf;
          const fx   = (toNum(FX_IN.USD.get(sub) || 0) - toNum(FX_OUT.USD.get(sub) || 0));
          totFx += fx;
          const disp = getDisponible('USD', sub);                        totDisp += disp;
          const asig = toNum(ASIG.USD.get(sub) || 0);                    totAsig += asig;

          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td class="left">${sub}</td>
            <td class="num">
              <span class="fxChip">${fmtMoney(sf,'USD')}
                ${sf===0 ? '' : `<span class="fxDel sfDel" title="Borrar saldo fresco" data-cur="USD" data-sub="${sub}">&#10005;</span>`}
              </span>
            </td>
            <td class="num">
              <span class="fxChip">${fmtMoney(fx,'USD')}
                ${fx===0 ? '' : `<span class="fxDel" title="Borrar TC" data-cur="USD" data-sub="${sub}">&#10005;</span>`}
              </span>
            </td>
            <td class="num">${fmtMoney(disp,'USD')}</td>
            <td class="num"><input type="number" step="any" class="asig-u-inp" data-sub="${sub}" style="width:120px;text-align:right" value="${asig||''}"></td>`;
          tbU.appendChild(tr);
        });

        document.getElementById('u-tot-sf').textContent   = fmtMoney(totSf,'USD');
        document.getElementById('u-tot-fx').textContent   = fmtMoney(totFx,'USD');
        document.getElementById('u-tot-disp').textContent = fmtMoney(totDisp,'USD');
        document.getElementById('u-tot-asig').textContent = fmtMoney(totAsig,'USD');

        const need = getSaldoNetoCV('USD');
      }

      const tbP = document.querySelector('#asig-p-table tbody'); if(tbP){ tbP.innerHTML='';
        let totSf=0, totFx=0, totDisp=0, totAsig=0;

        subsP.forEach(sub=>{
          const sf   = toNum(APORTES.PEN.get(sub) || 0);                 totSf   += sf;
          const fx   = (toNum(FX_IN.PEN.get(sub) || 0) - toNum(FX_OUT.PEN.get(sub) || 0));
          totFx += fx;
          const disp = getDisponible('PEN', sub);                        totDisp += disp;
          const asig = toNum(ASIG.PEN.get(sub) || 0);                    totAsig += asig;

          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td class="left">${sub}</td>
            <td class="num">
              <span class="fxChip">${fmtMoney(sf,'PEN')}
                ${sf===0 ? '' : `<span class="fxDel sfDel" title="Borrar saldo fresco" data-cur="PEN" data-sub="${sub}">&#10005;</span>`}
              </span>
            </td>
            <td class="num">
              <span class="fxChip">${fmtMoney(fx,'PEN')}
                ${fx===0 ? '' : `<span class="fxDel" title="Borrar TC" data-cur="PEN" data-sub="${sub}">&#10005;</span>`}
              </span>
            </td>
            <td class="num">${fmtMoney(disp,'PEN')}</td>
            <td class="num"><input type="number" step="any" class="asig-p-inp" data-sub="${sub}" style="width:120px;text-align:right" value="${asig||''}"></td>`;
          tbP.appendChild(tr);
        });

        document.getElementById('p-tot-sf').textContent   = fmtMoney(totSf,'PEN');
        document.getElementById('p-tot-fx').textContent   = fmtMoney(totFx,'PEN');
        document.getElementById('p-tot-disp').textContent = fmtMoney(totDisp,'PEN');
        document.getElementById('p-tot-asig').textContent = fmtMoney(totAsig,'PEN');

        const need = getSaldoNetoCV('PEN');
      }
    }

    // =========================
    // Wire UI
    // =========================
    // Tabs principales (sidebar/topbar)
    document.querySelectorAll(".tab:not(.tab-child):not(.tab-parent)").forEach(tab => {
      tab.addEventListener("click", function () {
        const id = tab.dataset.tab;   // 'conf' | 'hold' | 'reporte' | 'data'
        // Quitar active de tabs principales Y subpestañas
        document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
        document.querySelectorAll(".view").forEach(v => v.classList.remove("active"));
        tab.classList.add("active");
        const section = document.getElementById(`view-${id}`);
        if (section) section.classList.add("active");
        
        // Asegura que no "se vaya abajo" al entrar en Centro de datos
        if (id === 'data') {
          document.querySelector('.main-content')?.scrollTo({ top: 0, behavior: 'instant' });
          // Actualizar estado de botones cuando entras a la vista
          if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
        }
        
        // Cuando entras al reporte, refresca el cronograma
        if (id === 'reporte') {
          try { renderCronograma(); } catch(e){ console.error('[Reporte] renderCronograma', e); }
        }
      });
    });

    // Función para sincronizar todos los tabs cuando se cambia uno
    function syncAllSubtabs(currencyType, excludeGroup) {
      // currencyType puede ser: 'usd', 'pen', o 'total'
      // excludeGroup: prefijo del grupo que NO debe sincronizarse (para evitar bucles)
      const suffix = currencyType === 'usd' ? 'usd' : (currencyType === 'pen' ? 'pen' : 'total');
      
      // Lista de todos los grupos de subtabs a sincronizar
      const subtabGroups = [
        { selector: '#hold-subtabs', prefix: 'hold', special: 'hold' },
        { selector: '#crono-subtabs', prefix: 'crono', special: 'crono' },
        { selector: '#portafolio-subtabs', prefix: 'portafolio' },
        { selector: '#renta-fija-subtabs', prefix: 'renta-fija' },
        { selector: '#renta-variable-subtabs', prefix: 'renta-variable' }
      ];
      
      subtabGroups.forEach(group => {
        // Saltar el grupo que originó la sincronización
        if (excludeGroup && group.prefix === excludeGroup) return;
        
        const targetSub = `${group.prefix}-${suffix}`;
        const targetBtn = document.querySelector(`${group.selector} .subtab[data-sub="${targetSub}"]`);
        
        if (targetBtn) {
          // Remover active de todos los subtabs en este grupo
          document.querySelectorAll(`${group.selector} .subtab`).forEach(b => b.classList.remove('active'));
          // Activar el subtab correspondiente
          targetBtn.classList.add('active');
          
          // Casos especiales
          if (group.special === 'hold') {
            // Actualizar subviews para hold
            const isUSD = suffix === 'usd';
            const isPEN = suffix === 'pen';
            const isTotal = suffix === 'total';
            document.getElementById('subview-hold-usd')?.classList.toggle('active', isUSD);
            document.getElementById('subview-hold-pen')?.classList.toggle('active', isPEN);
            document.getElementById('subview-hold-total')?.classList.toggle('active', isTotal);
            // Mostrar píldoras
            document.getElementById('pillUSD')?.style.setProperty('display', (isUSD || isTotal) ? 'inline-flex' : 'none');
            document.getElementById('pillPEN')?.style.setProperty('display', (isPEN || isTotal) ? 'inline-flex' : 'none');
            renderCashBars();
          } else if (group.special === 'crono') {
            // Actualizar ACTIVE_CRONO_CUR para crono
            if (suffix === 'pen') {
              window.ACTIVE_CRONO_CUR = 'PEN';
            } else if (suffix === 'total') {
              window.ACTIVE_CRONO_CUR = 'TOTAL';
            } else {
              window.ACTIVE_CRONO_CUR = 'USD';
            }
            ACTIVE_CRONO_CUR = window.ACTIVE_CRONO_CUR;
            // Reconstruir tablas
            try {
              renderCronograma();
            } catch(e) {
              console.error('Error al sincronizar cronograma:', e);
            }
          } else {
            // Caso general: mostrar el contenido correspondiente
            const section = targetBtn.closest('section');
            if (section) {
              section.querySelectorAll('.subtab-content').forEach(c => c.classList.remove('active'));
              const targetContent = document.getElementById(targetSub);
              if (targetContent) targetContent.classList.add('active');
            }
          }
        }
      });
    }

    // Event listeners para subtabs de las nuevas pestañas
    document.querySelectorAll('#portafolio-subtabs .subtab, #renta-fija-subtabs .subtab, #renta-variable-subtabs .subtab, #trades-subtabs .subtab').forEach(btn => {
      btn.addEventListener('click', () => {
        const parent = btn.closest('.subtabs');
        const targetId = btn.dataset.sub;
        
        // Desactivar todos los subtabs hermanos
        parent.querySelectorAll('.subtab').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        // Mostrar el contenido correspondiente
        const section = btn.closest('section');
        section.querySelectorAll('.subtab-content').forEach(c => c.classList.remove('active'));
        const targetContent = document.getElementById(targetId);
        if (targetContent) targetContent.classList.add('active');
        
        // Sincronizar todos los tabs (excluyendo este grupo)
        const currencyType = targetId.includes('-usd') ? 'usd' : (targetId.includes('-pen') ? 'pen' : 'total');
        // Extraer el prefijo: para "portafolio-usd" -> "portafolio", para "renta-fija-usd" -> "renta-fija"
        const parts = targetId.split('-');
        const currentPrefix = parts.slice(0, -1).join('-');
        syncAllSubtabs(currencyType, currentPrefix);
      });
    });

    // Posiciones (USD/PEN)
    document.querySelectorAll("#hold-subtabs .subtab").forEach(st => {
      st.addEventListener("click", function(){
        document.querySelectorAll("#hold-subtabs .subtab").forEach(x => x.classList.remove("active"));
        st.classList.add("active");
        
        const subKey = st.dataset.sub;
        const isUSD = subKey === 'hold-usd';
        const isPEN = subKey === 'hold-pen';
        const isTotal = subKey === 'hold-total';
        
        document.getElementById('subview-hold-usd')?.classList.toggle('active', isUSD);
        document.getElementById('subview-hold-pen')?.classList.toggle('active', isPEN);
        document.getElementById('subview-hold-total')?.classList.toggle('active', isTotal);
        
        // Mostrar píldoras: USD en tab USD o Total, PEN en tab PEN o Total
        document.getElementById('pillUSD')?.style.setProperty('display', (isUSD || isTotal) ? 'inline-flex' : 'none');
        document.getElementById('pillPEN')?.style.setProperty('display', (isPEN || isTotal) ? 'inline-flex' : 'none');
        renderCashBars();
        
        // Sincronizar todos los tabs (excluyendo hold)
        const currencyType = isUSD ? 'usd' : (isPEN ? 'pen' : 'total');
        syncAllSubtabs(currencyType, 'hold');
      });
    });

    // Event listeners para botones USD/PEN en Cronograma de Pagos
    document.querySelectorAll("#crono-subtabs .subtab").forEach(st => {
      st.addEventListener("click", () => {
        document.querySelectorAll("#crono-subtabs .subtab").forEach(x => x.classList.remove("active"));
        st.classList.add("active");
        const subId = st.dataset.sub;
        if (subId === 'crono-pen') {
          window.ACTIVE_CRONO_CUR = 'PEN';
        } else if (subId === 'crono-total') {
          window.ACTIVE_CRONO_CUR = 'TOTAL';
        } else {
          window.ACTIVE_CRONO_CUR = 'USD';
        }
        ACTIVE_CRONO_CUR = window.ACTIVE_CRONO_CUR;
        
        // Reconstruir ambas tablas
        try {
          renderCronograma();
        } catch(e) {
          console.error('Error al cambiar moneda en cronograma:', e);
        }
        
        // Sincronizar todos los tabs (excluyendo crono)
        const currencyType = subId === 'crono-pen' ? 'pen' : (subId === 'crono-total' ? 'total' : 'usd');
        syncAllSubtabs(currencyType, 'crono');
      });
    });

    // Mini‑modal (USD/PEN)
    document.querySelectorAll("#cash-subtabs .subtab").forEach(st => {
      st.addEventListener("click", function(){
        document.querySelectorAll("#cash-subtabs .subtab").forEach(x => x.classList.remove("active"));
        st.classList.add("active");
        const isUSD = st.dataset.sub === 'cash-usd';
        document.getElementById('subview-cash-usd')?.classList.toggle('active', isUSD);
        document.getElementById('subview-cash-pen')?.classList.toggle('active', !isUSD);
      });
    });

    // === REEMPLAZO: input "Código" — solo ejecuta con Enter y NO altera el valor visible ===

    (function wireCodigo(){

      const el = document.getElementById('codigo');

      if (!el) return;

      // Cargar códigos guardados al iniciar
      actualizarDatalistCodigos();

      const onEnter = async (e) => {

        if (e.key !== 'Enter') return;

        e.preventDefault();

        // NO normalices ni completes el input; solo busca internamente.

        // cargarDesdeAsesor360() ya usa norm8(el.value) para la consulta.

        await cargarDesdeAsesor360();

      };



      // Importante: NO agregar blur / keyup / change.

      el.addEventListener('keydown', onEnter);

    })();

    // === Event Listener: Selector de Perfil (Dashboard) ===
    (function wirePerfilSelector(){
      const el = document.getElementById('perfil');
      if (!el) return;
      
      el.addEventListener('change', (e) => {
        const perfil = e.target.value;
        if (perfil) {
          syncPerfilToAllViews(perfil);
        }
      });
    })();

    // === Menús de la topbar (Portfolio Mgmt / Productos) ===
    (function wireHoldMenus(){

      const menus = Array.from(document.querySelectorAll('.hold-menu'));

      const closeAll = ()=> menus.forEach(m=> m.classList.remove('open'));



      menus.forEach(m=>{

        const trigger = m.querySelector('.menu-trigger');

        if (trigger && !trigger.dataset.bound){

          trigger.addEventListener('click', (e)=>{

            e.preventDefault(); e.stopPropagation();

            const isOpen = m.classList.contains('open');

            closeAll();

            if (!isOpen) m.classList.add('open');

          });

          trigger.dataset.bound = '1';

        }

      });



      document.addEventListener('click', closeAll);

      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeAll(); });

    })();

    // =========================
    // Modal Gestión de Saldos
    // =========================
    // Abrir/cerrar modal
    document.getElementById('btnCashModal')?.addEventListener('click', ()=>{
      const m = document.getElementById('cashModal');
      if(!m) return;
      const holdKey = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || 'hold-usd';
      const want = (holdKey==='hold-pen') ? 'cash-pen' : 'cash-usd';
      document.querySelectorAll('#cash-subtabs .subtab').forEach(x => x.classList.toggle('active', x.dataset.sub===want));
      document.getElementById('subview-cash-usd')?.classList.toggle('active', want==='cash-usd');
      document.getElementById('subview-cash-pen')?.classList.toggle('active', want==='cash-pen');

      m.style.display = 'flex';
      renderCashMgmtUI();
      renderCashBars();
    });
    document.getElementById('closeCashModal')?.addEventListener('click', ()=>{
      document.getElementById('cashModal').style.display = 'none';
    });
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape') document.getElementById('cashModal')?.style.setProperty('display','none');
    });

    /* ======== + Bonos: funciones auxiliares y carga CSV ======== */
    function parsePct(x){
      if(x===null||x===undefined||x==='') return null;
      const s = String(x).replace(/,/g,'.').replace('%','').trim();
      const v = Number(s);
      return isFinite(v) ? v : null;
    }
    function parseLtv(x){
      const p = parsePct(x);
      if(p===null) return null;
      return p>1 ? p : (p*100);
    }
    function coalesce(...a){ for(const v of a){ if(v!==undefined && v!==null && String(v).trim()!=='') return v; } return undefined; }

    // Utilidades de fecha y moneda
    function getAsOfDate(){
      const s = (document.getElementById('fechaDatosInput')?.value || '').trim();
      if(s){
        const [d,m,y] = s.split('/').map(n=>parseInt(n,10));
        const dt = new Date(y, (m-1), d);
        if(!isNaN(+dt)) return dt;
      }
      return new Date();
    }
    function moneyByCur(v, cur){
      const n = Number(v);
      if(!isFinite(n) || n===0) return ' - ';
      return n.toLocaleString(cur==='PEN'?'es-PE':'en-US', { style:'currency', currency: cur, maximumFractionDigits:0 });
    }

    function autoCsv(inputId, onRows, persistKey, infoId, mapFn){
      const inp = document.getElementById(inputId);
      if(!inp) return;
      inp.addEventListener('change', ()=>{
        const f = inp.files && inp.files[0]; if(!f) return;
        startLoader('Procesando CSV…');
        Papa.parse(f, {
          header: true,
          delimiter: ";",
          delimitersToGuess: [";"],
          skipEmptyLines: 'greedy',
          encoding: 'UTF-8',
          transformHeader: normalizeHeader,
          complete: async (res)=>{
            try{
              const raw = res.data || [];
              const payload = mapFn ? raw.map(mapFn).filter(Boolean) : raw;
              await onRows(payload, raw);
              if(persistKey) await persistCsv(persistKey, raw, f.name);
              if(infoId){ const el=document.getElementById(infoId); if(el) el.textContent = `Cargado: ${raw.length} filas de ${f.name}`; }
            } finally { stopLoader(); }
          },
          error:(err)=>{ stopLoader(); alert('Error CSV: '+err.message); }
        });
      });
    }

    function mapBondRow(rN){
      const r = normalizeRowKeys(rN);
      const id    = coalesce(pick(r,['bono']), pick(r,['id']));
      if(!id) return null;

      const ISIN  = normIsin(coalesce(pick(r,['isin'])));
      const Cup   = parsePct(coalesce(pick(r,['tasacupon','cupon','cup'])));
      const Dur   = toNum(coalesce(pick(r,['duracion','dur'])));
      const YTW   = parsePct(coalesce(pick(r,['ytw','ytm','tasa'])));
      const Precio= parsePct(coalesce(pick(r,['preciosucio','precio']))) ?? 100;
      const Venc  = coalesce(pick(r,['fechavcto','vencimiento','venc']));
      const Call  = coalesce(pick(r,['fechacall','call']));
      const Freq  = toNum(coalesce(pick(r,['frecuenciacupon','freq']))) || 2;
      const Mes1  = coalesce(pick(r,['1ermesdepagocupon','mes1']));
      const Mes2  = coalesce(pick(r,['2domesdepagocupon','mes2']));
      const IGHY  = coalesce(pick(r,['ighy']));
      const TipoB = coalesce(pick(r,['tipobono','tipo']));
      const Amortiza = (String(TipoB||'').toUpperCase().includes('SINK')) ? 'Sí' : 'No';
      const PrecioProxCall = coalesce(pick(r,['precioproxcall']));
      const Outstanding    = coalesce(pick(r,['outstanding']));
      const LTV = parseLtv(coalesce(pick(r,['ltv'])));
      const FirstPay = coalesce(pick(r,['fecha1erpago','firstpay']));

      let Moneda = String(coalesce(pick(r,['moneda','currency','divisa']),'USD')).toUpperCase();
      Moneda = Moneda.includes('PEN') ? 'PEN' : 'USD';

      return {
        id:   String(id).trim(),         // etiqueta visible del bono
        ISIN: ISIN || '',                // <<<<<< clave de cruce canónica
        Bono: String(id).trim(),
        Emisor: coalesce(pick(r,['emisor']))||'',
        Sector: coalesce(pick(r,['sector']))||'',
        Pais:   coalesce(pick(r,['pais']))||'',
        Cup, Dur, YTW, Tasa: YTW,
        Precio,
        Rating: coalesce(pick(r,['rating']))||'NR',
        Seniority: coalesce(pick(r,['seniority']))||'',
        Venc, Call, Freq, Mes1, Mes2, IGHY:IGHY||'',
        Amortiza,
        Clase: coalesce(pick(r,['clasedeactivo','clase'])) || 'Renta Fija MP',
        Vehiculo: coalesce(pick(r,['vehiculo'])) || 'Bono',
        Region: coalesce(pick(r,['region','pais'])) || 'Emergentes',
        Subclase: coalesce(pick(r,['subclase'])) || '',
        EFSub: coalesce(pick(r,['efsub'])) || '',
        PrecioProxCall, LTV, Outstanding, FirstPay,
        Moneda
      };
    }

    // === Mapper: 'Otros Activos' (CSV Agregar Otros Activos) — con Producto/ISIN/CodSubproducto/Moneda ===
    function mapOtrosActivoRow(rN){
      const r = normalizeRowKeys(rN);
      const prod = normTxt(coalesce(pick(r,['producto'])));
      const isin = normIsin(coalesce(pick(r,['isin'])));
      const codSub = normCodprod(coalesce(pick(r,['codsubproducto','codsubproduct','codsubprod'])));
      const moneda = normMoneda(coalesce(pick(r,['moneda','divisa','currency'])));

      // IG/HY opcional
      const rawIGHY = coalesce(pick(r, ['ighy','ig','ig_hy','igohy']));
      const IGHY = (String(rawIGHY||'').toUpperCase().includes('HY')) ? 'HY'
                 : (String(rawIGHY||'').toUpperCase().includes('IG') ? 'IG' : '');

      // Nombre visible
      const inst = coalesce(pick(r,['activo','instrumento','nombre'])) || (isin ? `CV ${isin}` : (codSub ? `FM ${codSub}` : ''));
      if (!inst) return null;

      // Identidad: amarra perfecto con A360
      let instKey = 'OT|' + normTxt(inst);
      if (prod === 'CUENTA VALOR' && isin) instKey = `CV|${isin}`;
      else if (prod === 'FONDOS MUTUOS' && codSub && codSub!=='0') instKey = `FM|${codSub}`;

      // Campos opcionales (se enriquecen luego si vienen vacíos)
      const out = {
        inst, instKey, prod, isin, codSub, moneda,
        clase:  coalesce(pick(r,['claseactivo','clase'])) || '',
        veh:    coalesce(pick(r,['vehiculo'])) || '',
        rating: coalesce(pick(r,['rating'])) || '',
        grupo:  coalesce(pick(r,['grupoproducto','grupo'])) || '',
        geo:    coalesce(pick(r,['geografia','region','pais'])) || '',
        expo:   coalesce(pick(r,['exposicion','subclase'])) || '',
        efsub:  coalesce(pick(r,['subclaseactivo','efsub'])) || '',
        subclasificacion: coalesce(pick(r,['subclasificación','subclasificacion'])) || '',
        IGHY,
        _min:   toNum(coalesce(pick(r,['montominimodeinversion','montominimo']))),
        _dur:   toNum(pick(r,['duracion'])),
        _tasa:  parsePct(pick(r,['tasa'])),
        _cupon: parsePct(pick(r,['cupon'])),
        _fecha_inicio: coalesce(pick(r,['fechainicio','fecha_inicio','fechadeinicio'])),
        _fecha_fin: coalesce(pick(r,['fechafin','fecha_fin','fechadefin','fechavencimiento'])),
        _ltv:   parseLtv(pick(r,['ltv'])),
        _plazo: toNum(pick(r,['plazo'])),
        _n_holdings: toNum(pick(r,['nholdings'])),
        _pe:    toNum(pick(r,['p/e','pe','per'])),
        _div_yield: parsePct(pick(r,['dividendyield'])),
        _vol:   toNum(pick(r,['vol'])),
        _patrimonio: toNum(pick(r,['patrimonio'])),
        _desc_fondo: coalesce(pick(r,['descripciondelfondo'])),
        _indice_ref: coalesce(pick(r,['indicedereferencia','indice']))
      };

      // Enriquecer con "Activos" si faltan etiquetas (por qué: consistencia UX)
      return enrichOtrosActivo(out);
    }

    // === Mínimo por activo (desde "Seleccionar Otros Activos") ===
    function _findMetaForHoldRow(r){
      const N  = normTxt(r?.nombre || '');
      const IS = String(r?._isin   || '');
      const CS = String(r?._codSub || '');
      return (ACTIVOS2||[]).find(a =>
        (IS && a.isin   === IS) ||
        (CS && a.codSub === CS) ||
        (N  && normTxt(a.inst) === N)
      ) || null;
    }
    function minInvestForRow(r){
      const direct = toNum(r?._min);
      if (direct > 0) return direct;
      const meta = _findMetaForHoldRow(r);
      const m = toNum(meta?._min);
      return m > 0 ? m : 0;
    }

    function enrichOtrosActivo(a){
      // CV → usa mapas por ISIN; FM → por CodSubproducto
      if (a.prod === 'CUENTA VALOR' && a.isin){
        a.clase  ||= ACT.class_by_isin.get(a.isin) || '';
        a.veh    ||= ACT.veh_by_isin.get(a.isin) || '';
        a.geo    ||= ACT.region_by_isin.get(a.isin) || '';
        a.expo   ||= ACT.subclase_by_isin.get(a.isin) || '';
        a.inst   ||= ACT.name_by_isin.get(a.isin) || a.inst;
      } else if (a.prod === 'FONDOS MUTUOS' && a.codSub && a.codSub!=='0'){
        a.clase  ||= ACT.class_by_codprod.get(a.codSub) || '';
        a.geo    ||= ACT.region_by_codprod.get(a.codSub) || '';
        a.expo   ||= ACT.subclase_by_codprod.get(a.codSub) || '';
        a.inst   ||= ACT.name_by_codprod.get(a.codSub) || a.inst;
      }
      return a;
    }



    // Wire autoCsv
    autoCsv('fileAsesor360', async (payload)=>{ 
      ingestRows(payload); 
      const built = buildFromRows(payload);
      renderDashboard(built);
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    }, 'asesor360', 'csvInfo');
    
    autoCsv('fileActivos', async (payload)=>{ 
      ingestActivosRows(payload);
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    }, 'activos', 'actInfo');

    // NUEVO: 'Otros Activos' (persist key: 'activos2')
    autoCsv('fileOtrosActivos', async (payload)=>{ 
      ACTIVOS2 = payload; 
      window.ACTIVOS2 = ACTIVOS2;                         // mantén sincronizado
      // si el mini‑modal está abierto, refresca filtros/lista
      if (document.getElementById('modalActivos')?.style.display === 'flex') {
        ensureAssetsFilters();
        (typeof renderActivosModal==='function' ? renderActivosModal() : renderActivosModal_fallback());
      }
      if (document.getElementById('modalDPF')?.classList.contains('show')) {
        window.populateDPFSelectors?.();
        window.renderDPFCurve?.();
      }
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    }, 'activos2', 'otrosActInfo', mapOtrosActivoRow);
    
    autoCsv('fileBonds', async (_payload, raw)=>{ 
      BONDS_RAW = Array.isArray(raw) ? raw.slice() : [];
      window.BONDS_RAW = BONDS_RAW;
      rebuildBondIndex(BONDS_RAW);
      BONDS = BONDS_RAW.map(mapBondRow).filter(Boolean);
      window.BONDS = BONDS;
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    }, 'bonds', 'bondsInfo');
    
    autoCsv('fileAmort', async (_payload, raw)=>{ 
      AMORT = Array.isArray(raw) ? raw.slice() : [];
      window.AMORT = AMORT;
      rebuildAmortData();
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    }, 'amorts', 'amortInfo');

    function rebuildBondIndex(rows = BONDS_RAW){
      BONDS_BY_ISIN.clear();
      if (!Array.isArray(rows)) return;
      for (const r of rows) {
        if (!r || typeof r !== 'object') continue;
        const rn = normalizeRowKeys(r);
        const isin = normIsin(r.ISIN || r.Isin || r.isin || rn.isin);
        if (!isin) continue;
        BONDS_BY_ISIN.set(isin, r);
      }
    }

    function rebuildAmortData(){
      const AMORTS_RAW = (window.AMORT || window.LAST_AMORTS || []);
      AMORTS_BY_ISIN = {};
      window.AMORTS_BY_CODSUB = {}; // NUEVO: para fondos
      
      for (const r of AMORTS_RAW) {
        if (!r || typeof r !== 'object') continue;
        
        // Intentar ISIN (bonos)
        const isin = String(r.ISIN || r.Isin || r.isin || '').trim().toUpperCase();
        // Intentar CodSubproducto (fondos)
        const codSub = String(r.CodSubproducto || r.codsubproducto || '').trim();
        
        if (!isin && !codSub) continue;
        
        const d = parseDMYStrict(r['fechapago'] || r['Fecha Pago'] || r.Fecha || r.date);
        if (!d) continue;
        const fac   = pctToDec(r['factoramortizacion'] || r['Factor Amortizacion'] || r.Factor || r.factor || 0);
        const after = pctToDec(r['vnremanente'] || r['VN remanente'] || r.Remanente || r.after || 0);
        
        // Guardar por ISIN (bonos)
        if (isin) {
          (AMORTS_BY_ISIN[isin] ||= []).push({ d, fac, after });
        }
        // Guardar por CodSubproducto (fondos)
        if (codSub) {
          (window.AMORTS_BY_CODSUB[codSub] ||= []).push({ d, fac, after });
        }
      }
      
      // Ordenar bonos
      for (const k in AMORTS_BY_ISIN) {
        AMORTS_BY_ISIN[k].sort((a,b)=> a.d - b.d);
      }
      // Ordenar fondos
      for (const k in window.AMORTS_BY_CODSUB) {
        window.AMORTS_BY_CODSUB[k].sort((a,b)=> a.d - b.d);
      }
      
      window.AMORTS_BY_ISIN = AMORTS_BY_ISIN;
    }

    function amortPrevFrac(isin, d){
      const key = String(isin || '').trim().toUpperCase();
      const arr = AMORTS_BY_ISIN[key];
      if (!arr) return 1;
      let prev = 1;
      const target = d ? new Date(d.getFullYear(), d.getMonth(), d.getDate()) : null;
      for (const r of arr) {
        const cmp = target ? r.d.getTime() - target.getTime() : NaN;
        if (target && cmp === 0) {
          return (Number(r.after) || 0) + (Number(r.fac) || 0);
        }
        if (!target || r.d < target) {
          prev = Number(r.after) || prev;
        } else {
          break;
        }
      }
      return prev;
    }

    function remAfterFracAt(isin, refDate){
      const key = String(isin || '').trim().toUpperCase();
      const arr = AMORTS_BY_ISIN[key];
      if (!arr) return 1;
      let f = 1;
      const tgt = refDate ? new Date(refDate.getFullYear(), refDate.getMonth(), refDate.getDate()) : null;
      for (const r of arr) {
        if (!tgt || r.d <= tgt) {
          const after = Number(r.after);
          if (!isNaN(after)) f = after;
        } else {
          break;
        }
      }
      return f;
    }

    // === FUNCIONES PARA AMORTIZACIONES DE FONDOS ===

    function amortPrevFracFondo(codSub, d){
      const key = String(codSub || '').trim();
      const arr = window.AMORTS_BY_CODSUB?.[key];
      if (!arr) return 1;
      let prev = 1;
      const target = d ? new Date(d.getFullYear(), d.getMonth(), d.getDate()) : null;
      for (const r of arr) {
        const cmp = target ? r.d.getTime() - target.getTime() : NaN;
        if (target && cmp === 0) {
          return (Number(r.after) || 0) + (Number(r.fac) || 0);
        }
        if (!target || r.d < target) {
          prev = Number(r.after) || prev;
        } else {
          break;
        }
      }
      return prev;
    }

    function remAfterFracAtFondo(codSub, refDate){
      const key = String(codSub || '').trim();
      const arr = window.AMORTS_BY_CODSUB?.[key];
      if (!arr) return 1;
      let f = 1;
      const tgt = refDate ? new Date(refDate.getFullYear(), refDate.getMonth(), refDate.getDate()) : null;
      for (const r of arr) {
        if (!tgt || r.d <= tgt) {
          const after = Number(r.after);
          if (!isNaN(after)) f = after;
        } else {
          break;
        }
      }
      return f;
    }

    function montoCuponFondoEnFecha(row, d) {
      const codSub = String(row._codSub || row.CodSubproducto || row.codsubproducto || '').trim();
      const cupPct = Number(_couponPctOf(row));
      const freq = Number(_freqOf(row) || 2);
      if (!(codSub && cupPct > 0 && freq > 0)) return 0;

      const cupDec = cupPct > 1 ? cupPct / 100 : cupPct;
      
      // Para fondos: usar SaldoactualDetalleUSD en lugar de nominal
      const baseValor = Number(row.valor_mercado || row['SaldoactualDetalleUSD'] || 0);
      if (!(baseValor > 0)) return 0;

      const amort = window.AMORTS_BY_CODSUB?.[codSub];
      if (!amort) return baseValor * (cupDec / freq);

      const hoy = new Date();
      hoy.setHours(0,0,0,0);
      
      // Valor original antes de cualquier amortización
      const origValor = baseValor / Math.max(1e-12, remAfterFracAtFondo(codSub, hoy));
      
      // Fracción antes de la fecha d
      const fracPrev = amortPrevFracFondo(codSub, d);
      
      return origValor * fracPrev * (cupDec / freq);
    }

    // === HANDLER PARA LÍMITES ===
    window.LIMITS = [];
    window.LIMITS_RESULTS = [];

    document.getElementById('fileLimites')?.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      
      startLoader('Cargando Límites...');
      
      try {
        const text = await file.text();
        Papa.parse(text, {
          header: true,
          skipEmptyLines: true,
          complete: async function(results) {
            const rows = results.data;
            
            if (!rows || rows.length === 0) {
              alert('El archivo de Límites está vacío');
              stopLoader();
              return;
            }
            
            // Procesar límites
            const limits = [];
            
            rows.forEach(row => {
              const tipo = String(row['Tipo'] || '').trim().toUpperCase();
              const nombre = String(row['Nombre del Limite '] || row['Nombre del Limite'] || '').trim();
              
              if (!tipo || !nombre) return;
              
              // Función auxiliar para normalizar valores múltiples
              const multi = (val) => {
                if (!val) return [];
                return String(val).split(/[,;\/]+/).map(s => s.trim().toUpperCase()).filter(Boolean);
              };
              
              // Función para detectar IG/HY
              const toIGHY = (val) => {
                if (!val) return null;
                const v = String(val).toUpperCase().trim();
                if (v.includes('IG') || v.includes('INVESTMENT')) return 'IG';
                if (v.includes('HY') || v.includes('HIGH YIELD')) return 'HY';
                return null;
              };
              
              // Procesar IG/HY con fallbacks
              const ighyCol = toIGHY(row['IG/HY']);
              const ighyExpo = toIGHY(row['Exposicion']);
              let ighy = ighyCol || ighyExpo;
              
              // Si no encontramos IG/HY, inferir del nombre
              if (!ighy) {
                const nombreUpper = nombre.toUpperCase();
                if (nombreUpper.includes('HIGH YIELD') || nombreUpper.includes('HY')) {
                  ighy = 'HY';
                } else if (nombreUpper.includes('INVESTMENT GRADE') || nombreUpper.includes('IG')) {
                  ighy = 'IG';
                }
              }
              
              const filters = {
                clase: multi(row['Asset Class']),
                veh: multi(row['Vehiculo']),
                grupo: multi(row['Grupo Producto']),
                geo: multi(row['Geografia']),
                ighy: ighy ? [ighy] : [],
                expo: multi(row['Exposicion']),
                codSub: multi(row['CodSubproducto']),
                rating: multi(row['Rating']),
                dur: String(row['Duracion'] || '').trim(),
                sector: multi(row['Sector'])
              };
              
              const exceptions = String(row['Excepciones por Activo'] || '')
                .split(/[,;]+/)
                .map(s => stripAccents(s.trim().toUpperCase()))
                .filter(Boolean);
              
              const parseNum = (val) => {
                if (!val) return 0;
                const n = parseFloat(String(val).replace(/[^0-9.-]/g, ''));
                return isNaN(n) ? 0 : n;
              };
              
              const thr = {
                'Extra Conservador': parseNum(row['Extra Conservador']),
                'Conservador': parseNum(row['Conservador']),
                'Moderado': parseNum(row['Moderado']),
                'Agresivo': parseNum(row['Agresivo'])
              };
              
              limits.push({
                tipo,
                name: nombre,
                filters,
                exceptions,
                thr
              });
            });
            
            window.LIMITS = limits;
            
            // Persistir
            await persistCsv('limits', rows, file.name);
            
            // Actualizar UI
            const info = document.getElementById('limitesInfo');
            if (info) {
              info.textContent = `✓ ${limits.length} límites cargados de ${file.name}`;
              info.style.color = '#16a34a';
            }
            
            stopLoader();
            
            // Evaluar límites si hay holdings cargados
            if (LAST_HOLDINGS.USD?.length || LAST_HOLDINGS.PEN?.length) {
              evaluateLimits();
            }
          },
          error: function(err) {
            console.error('Error al parsear Límites:', err);
            alert('Error al leer el archivo de Límites');
            stopLoader();
          }
        });
      } catch (err) {
        console.error('Error al cargar Límites:', err);
        alert('Error al cargar el archivo de Límites');
        stopLoader();
      }
    });


    // =========================
    // Listener: fileRatings
    // =========================
    document.getElementById('fileRatings')?.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      
      startLoader('Cargando Ratings...');
      
      try {
        const text = await file.text();
        Papa.parse(text, {
          header: true,
          delimiter: ";",
          delimitersToGuess: [";"],
          skipEmptyLines: 'greedy',
          encoding: 'UTF-8',
          transformHeader: normalizeHeader,
          complete: async function(results) {
            try {
              const rows = results.data || [];
              
              if (!rows || rows.length === 0) {
                alert('El archivo de Ratings está vacío');
                stopLoader();
                return;
              }
              
              // Ingestar ratings
              ingestRatingsRows(rows);
              
              // Persistir
              await persistCsv('ratings', rows, file.name);
              
              stopLoader();
            } catch(err) {
              console.error('Error procesando Ratings:', err);
              alert('Error al procesar el archivo de Ratings');
              stopLoader();
            }
          },
          error: function(err) {
            console.error('Error al parsear Ratings:', err);
            alert('Error al leer el archivo de Ratings');
            stopLoader();
          }
        });
      } catch (err) {
        console.error('Error al cargar Ratings:', err);
        alert('Error al cargar el archivo de Ratings');
        stopLoader();
      }
    });

    // =========================
    // Listener: fileSectores
    // =========================
    document.getElementById('fileSectores')?.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      
      startLoader('Cargando Sectores...');
      
      try {
        const text = await file.text();
        Papa.parse(text, {
          header: true,
          delimiter: ";",
          delimitersToGuess: [";"],
          skipEmptyLines: 'greedy',
          encoding: 'UTF-8',
          transformHeader: normalizeHeader,
          complete: async function(results) {
            try {
              const rows = results.data || [];
              
              if (!rows || rows.length === 0) {
                alert('El archivo de Sectores está vacío');
                stopLoader();
                return;
              }
              
              // Ingestar sectores
              ingestSectoresRows(rows);
              
              // Persistir
              await persistCsv('sectores', rows, file.name);
              
              stopLoader();
            } catch(err) {
              console.error('Error procesando Sectores:', err);
              alert('Error al procesar el archivo de Sectores');
              stopLoader();
            }
          },
          error: function(err) {
            console.error('Error al parsear Sectores:', err);
            alert('Error al leer el archivo de Sectores');
            stopLoader();
          }
        });
      } catch (err) {
        console.error('Error al cargar Sectores:', err);
        alert('Error al cargar el archivo de Sectores');
        stopLoader();
      }
    });

    // =========================
    // Listener: fileHoldings
    // =========================
    document.getElementById('fileHoldings')?.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      
      startLoader('Cargando Holdings...');
      
      try {
        const text = await file.text();
        Papa.parse(text, {
          header: true,
          delimiter: ";",
          delimitersToGuess: [";"],
          skipEmptyLines: 'greedy',
          encoding: 'UTF-8',
          transformHeader: normalizeHeader,
          complete: async function(results) {
            try {
              const rows = results.data || [];
              
              if (!rows || rows.length === 0) {
                alert('El archivo de Holdings está vacío');
                stopLoader();
                return;
              }
              
              ingestHoldingsRows(rows, file.name);
              await persistCsv('holdings', rows, file.name);
              
              stopLoader();
            } catch(err) {
              console.error('Error procesando Holdings:', err);
              alert('Error al procesar el archivo de Holdings');
              stopLoader();
            }
          },
          error: function(err) {
            console.error('Error al parsear Holdings:', err);
            alert('Error al leer el archivo de Holdings');
            stopLoader();
          }
        });
      } catch (err) {
        console.error('Error al cargar Holdings:', err);
        alert('Error al cargar el archivo de Holdings');
        stopLoader();
      }
    });

    // =========================
    // Listener: fileRegionRV
    // =========================
    document.getElementById('fileRegionRV')?.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      
      startLoader('Cargando Región RV...');
      
      try {
        const text = await file.text();
        Papa.parse(text, {
          header: true,
          delimiter: ";",
          delimitersToGuess: [";"],
          skipEmptyLines: 'greedy',
          encoding: 'UTF-8',
          transformHeader: normalizeHeader,
          complete: async function(results) {
            try {
              const rows = results.data || [];
              
              if (!rows || rows.length === 0) {
                alert('El archivo de Región RV está vacío');
                stopLoader();
                return;
              }
              
              ingestRegionRVRows(rows, file.name);
              await persistCsv('regionrv', rows, file.name);
              
              stopLoader();
            } catch(err) {
              console.error('Error procesando Región RV:', err);
              alert('Error al procesar el archivo de Región RV');
              stopLoader();
            }
          },
          error: function(err) {
            console.error('Error al parsear Región RV:', err);
            alert('Error al leer el archivo de Región RV');
            stopLoader();
          }
        });
      } catch (err) {
        console.error('Error al cargar Región RV:', err);
        alert('Error al cargar el archivo de Región RV');
        stopLoader();
      }
    });

    // Event listener para importar JSON
    document.getElementById('fileImportJSON')?.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      await importarTodosDatos(file);
      this.value = ''; // Reset para permitir reimportar el mismo archivo
    });

    // Restaurar límites al cargar
    (async function restoreLimits() {
      await restoreCsv('limits', (rows, meta) => {
        if (!rows || rows.length === 0) return;
        
        // Procesar igual que arriba (código duplicado para restore)
        const limits = [];
        const multi = (val) => {
          if (!val) return [];
          return String(val).split(/[,;\/]+/).map(s => s.trim().toUpperCase()).filter(Boolean);
        };
        const toIGHY = (val) => {
          if (!val) return null;
          const v = String(val).toUpperCase().trim();
          if (v.includes('IG') || v.includes('INVESTMENT')) return 'IG';
          if (v.includes('HY') || v.includes('HIGH YIELD')) return 'HY';
          return null;
        };
        const parseNum = (val) => {
          if (!val) return 0;
          const n = parseFloat(String(val).replace(/[^0-9.-]/g, ''));
          return isNaN(n) ? 0 : n;
        };
        
        rows.forEach(row => {
          const tipo = String(row['Tipo'] || '').trim().toUpperCase();
          const nombre = String(row['Nombre del Limite '] || row['Nombre del Limite'] || '').trim();
          if (!tipo || !nombre) return;
          
          const ighyCol = toIGHY(row['IG/HY']);
          const ighyExpo = toIGHY(row['Exposicion']);
          let ighy = ighyCol || ighyExpo;
          if (!ighy) {
            const nombreUpper = nombre.toUpperCase();
            if (nombreUpper.includes('HIGH YIELD') || nombreUpper.includes('HY')) ighy = 'HY';
            else if (nombreUpper.includes('INVESTMENT GRADE') || nombreUpper.includes('IG')) ighy = 'IG';
          }
          
          const filters = {
            clase: multi(row['Asset Class']),
            veh: multi(row['Vehiculo']),
            grupo: multi(row['Grupo Producto']),
            geo: multi(row['Geografia']),
            ighy: ighy ? [ighy] : [],
            expo: multi(row['Exposicion']),
            codSub: multi(row['CodSubproducto']),
            rating: multi(row['Rating']),
            dur: String(row['Duracion'] || '').trim(),
            sector: multi(row['Sector'])
          };
          
          const exceptions = String(row['Excepciones por Activo'] || '')
            .split(/[,;]+/)
            .map(s => stripAccents(s.trim().toUpperCase()))
            .filter(Boolean);
          
          const thr = {
            'Extra Conservador': parseNum(row['Extra Conservador']),
            'Conservador': parseNum(row['Conservador']),
            'Moderado': parseNum(row['Moderado']),
            'Agresivo': parseNum(row['Agresivo'])
          };
          
          limits.push({ tipo, name: nombre, filters, exceptions, thr });
        });
        
        window.LIMITS = limits;
        
        const info = document.getElementById('limitesInfo');
        if (info) {
          // info.textContent = ''; // Sin mensaje de restauración
          info.style.color = '#16a34a';
        }
      });
    })();

    // Restaurar ratings al cargar
    (async function restoreRatings() {
      await restoreCsv('ratings', (rows, meta) => {
        if (!rows || rows.length === 0) return;
        
        try {
          ingestRatingsRows(rows);
        } catch(err) {
          console.error('[Restore] Error al cargar Ratings:', err);
        }
      });
    })();

    // Restaurar sectores al cargar
    (async function restoreSectores() {
      await restoreCsv('sectores', (rows, meta) => {
        if (!rows || rows.length === 0) return;
        
        try {
          ingestSectoresRows(rows);
        } catch(err) {
          console.error('[Restore] Error al cargar Sectores:', err);
        }
      });
    })();

    // Restaurar holdings al cargar
    (async function restoreHoldings() {
      await restoreCsv('holdings', (rows, meta) => {
        if (!rows || rows.length === 0) return;
        
        try {
          ingestHoldingsRows(rows, meta?.filename);
        } catch(err) {
          console.error('[Restore] Error al cargar Holdings:', err);
        }
      });
    })();

    // Restaurar región RV al cargar
    (async function restoreRegionRV() {
      await restoreCsv('regionrv', (rows, meta) => {
        if (!rows || rows.length === 0) return;
        
        try {
          ingestRegionRVRows(rows, meta?.filename);
        } catch(err) {
          console.error('[Restore] Error al cargar Región RV:', err);
        }
      });
    })();

    // === FUNCIÓN PARA EVALUAR LÍMITES ===
    function evaluateLimits() {
      if (!window.LIMITS || !LIMITS.length) {
        window.LIMITS_RESULTS = [];
        return;
      }
      
      // Obtener perfil del cliente
      const perfil = document.getElementById('perfil')?.value?.trim() || 'Moderado';
      
      // Preparar todas las filas de la cartera con pesos
      // Los límites aplican a USD y PEN, el denominador es el TOTAL del portafolio dolarizado
      const allRows = [];
      
      // Obtener tipo de cambio para dolarizar PEN
      const tcInput = document.getElementById('tipoCambio');
      const tc = parseFloat(tcInput?.value) || 3.40;
      
      // Calcular total USD
      const totalUSD = (LAST_HOLDINGS.USD || []).reduce((sum, r) => {
        const base = toNum(r.valor_mercado);
        const edit = edits.USD ? (edits.USD.get(r._rid) || 0) : 0;
        return sum + base + edit;
      }, 0);
      
      // Calcular total PEN dolarizado
      const totalPENDolarizado = (LAST_HOLDINGS.PEN || []).reduce((sum, r) => {
        const base = toNum(r.valor_mercado);
        const edit = edits.PEN ? (edits.PEN.get(r._rid) || 0) : 0;
        return sum + (base + edit) / tc;
      }, 0);
      
      // El denominador es el Total del portafolio
      const totalCartera = totalUSD + totalPENDolarizado;
      
      if (totalCartera <= 0) {
        window.LIMITS_RESULTS = [];
        return;
      }
      
      // Enriquecer filas USD
      (LAST_HOLDINGS.USD || []).forEach(row => {
        const base = toNum(row.valor_mercado);
        const edit = edits.USD ? (edits.USD.get(row._rid) || 0) : 0;
        const valor = base + edit;
        if (valor <= 0) return;
        
        const enriched = enrichRow(row, 'USD');
        enriched.peso = (valor / totalCartera) * 100; // Peso sobre el TOTAL
        allRows.push(enriched);
      });
      
      // Enriquecer filas PEN (dolarizadas para el peso)
      (LAST_HOLDINGS.PEN || []).forEach(row => {
        const base = toNum(row.valor_mercado);
        const edit = edits.PEN ? (edits.PEN.get(row._rid) || 0) : 0;
        const valor = base + edit;
        if (valor <= 0) return;
        
        const valorDolarizado = valor / tc;
        const enriched = enrichRow(row, 'PEN');
        enriched.peso = (valorDolarizado / totalCartera) * 100; // Peso dolarizado sobre el TOTAL
        allRows.push(enriched);
      });
      
      // Evaluar cada límite
      const results = [];
      
      LIMITS.forEach((L, i) => {
        const thr = L.thr[perfil];
        if (thr == null) return; // Solo saltar si es null/undefined, NO si es 0
        
        // Convertir umbral a decimal si viene en porcentaje (>1)
        const threshold = thr > 1 ? thr : thr * 100;
        
        if (L.tipo === 'I') {
          // Límite Individual
          const targets = allRows.filter(r => matchesLimit(L.filters, r) && !isException(L, r));
          let maxW = 0;
          const violators = [];
          
          targets.forEach(r => {
            if (r.peso > maxW) maxW = r.peso;
            if (r.peso > threshold + 1e-9) {
              violators.push({ 
                inst: r.inst, 
                peso: parseFloat(r.peso.toFixed(2)) 
              });
            }
          });
          
          results.push({
            i,
            name: L.name,
            tipo: 'I',
            valor: parseFloat(maxW.toFixed(2)),
            limite: parseFloat(threshold.toFixed(2)),
            ok: violators.length === 0,
            violators
          });
        } else {
          // Límite Sumatorio (S)
          const sum = allRows
            .filter(r => matchesLimit(L.filters, r) && !isException(L, r))
            .reduce((s, r) => s + r.peso, 0);
          
          results.push({
            i,
            name: L.name,
            tipo: 'S',
            valor: parseFloat(sum.toFixed(2)),
            limite: parseFloat(threshold.toFixed(2)),
            ok: sum <= threshold + 1e-9
          });
        }
      });
      
      window.LIMITS_RESULTS = results;
    }

    // Enriquecer una fila con metadata de bonos/activos
    function enrichRow(row, cur) {
      const out = {
        inst: row.nombre || '',
        cur,
        clase: normTxt(row.clase || ''),
        veh: normTxt(row.vehiculo || ''),
        peso: 0,
        _codSub: row._codSub || ''
      };
      
      // Preservar grupo original del row ANTES de buscar en metadata
      out.grupo = normTxt(row.grupo || row.grupoproducto || row['Grupo Producto'] || '');
      
      const vehUpper = String(row.vehiculo || '').toUpperCase();
      const isBond = vehUpper.includes('BONO') || row.isBond;
      
      if (isBond) {
        // Buscar en BONDS_RAW
        const bond = (window.BONDS_RAW || []).find(b => {
          const isinMatch = row._isin && normIsin(b.isin) === normIsin(row._isin);
          const nameMatch = row.nombre && normTxt(b.bono).includes(normTxt(row.nombre));
          return isinMatch || nameMatch;
        });
        
        if (bond) {
          // Solo sobrescribir grupo si está vacío
          if (!out.grupo) out.grupo = normTxt(bond.tipobono || '');
          out.geo = normTxt(bond.region || bond.pais || '');
          out.ighy = normTxt(bond['ig/hy'] || '');
          out.rating = normTxt(bond.rating || '');
          out.sector = normTxt(bond.sector || '');
          out.dur = parseFloat(bond.duracion) || 0;
        }
      } else {
        // Buscar en ACTIVOS_RAW o ACTIVOS2
        let meta = null;
        
        // Buscar por ISIN solo si es válido (no vacío y no '0')
        if (row._isin && row._isin !== '' && row._isin !== '0') {
          meta = (window.ACTIVOS_RAW || []).find(a => normIsin(a.isin) === normIsin(row._isin));
          if (!meta) {
            meta = (window.ACTIVOS2 || []).find(a => normIsin(a.isin) === normIsin(row._isin));
          }
        }
        
        // Buscar por codSub solo si es válido (no '0' y no vacío)
        if (!meta && row._codSub && row._codSub !== '0' && row._codSub !== '') {
          meta = (window.ACTIVOS_RAW || []).find(a => String(a.codsubproducto) === String(row._codSub));
          if (!meta) {
            meta = (window.ACTIVOS2 || []).find(a => String(a.codSub) === String(row._codSub));
          }
        }
        
        // Si no encontró por ISIN/codSub, buscar por nombre
        if (!meta && row.nombre) {
          const normNombre = normTxt(row.nombre);
          meta = (window.ACTIVOS2 || []).find(a => normTxt(a.inst) === normNombre);
          if (!meta) {
            meta = (window.ACTIVOS_RAW || []).find(a => normTxt(a.subproducto) === normNombre);
          }
        }
        
        if (meta) {
          // Solo sobrescribir grupo si está vacío
          if (!out.grupo) out.grupo = normTxt(meta.grupoproducto || meta.grupo || '');
          out.geo = normTxt(meta.region || meta.geo || '');
          out.expo = normTxt(meta.exposicion || meta.expo || '');
          out.ighy = normTxt(meta['ig/hy'] || meta.IGHY || '');
          out.rating = normTxt(meta.rating || '');
          out.sector = normTxt(meta.sector || '');
          out.dur = parseFloat(meta.duracion || meta._dur) || 0;
        }
      }
      
      return out;
    }

    // Verificar si una fila coincide con los filtros de un límite
    function matchesLimit(filters, row) {
      // Función auxiliar para normalizar y comparar
      const matches = (filterArr, value) => {
        if (!filterArr || filterArr.length === 0) return true;
        let normValue = normTxt(value);
        
        // Normalizar Bono/Bonos para que sean equivalentes
        if (normValue === 'BONO') normValue = 'BONOS';
        
        return filterArr.some(f => {
          let normFilter = normTxt(f);
          if (normFilter === 'BONO') normFilter = 'BONOS';
          return normFilter === normValue; // Solo matching EXACTO
        });
      };
      
      // Verificar cada dimensión
      if (!matches(filters.clase, row.clase)) return false;
      if (!matches(filters.veh, row.veh)) return false;
      if (!matches(filters.grupo, row.grupo)) return false;
      if (!matches(filters.geo, row.geo)) return false;
      if (!matches(filters.ighy, row.ighy)) return false;
      if (!matches(filters.expo, row.expo)) return false;
      if (!matches(filters.codSub, row._codSub)) return false;
      if (!matches(filters.rating, row.rating)) return false;
      if (!matches(filters.sector, row.sector)) return false;
      
      // Duración (filtro especial)
      if (filters.dur && row.dur != null) {
        const durStr = String(filters.dur).trim();
        if (durStr) {
          const parsed = parseDurFilter(durStr);
          if (parsed) {
            if (parsed.min != null && row.dur < parsed.min) return false;
            if (parsed.max != null && row.dur > parsed.max) return false;
          }
        }
      }
      
      return true;
    }

    // Parsear filtro de duración
    function parseDurFilter(str) {
      if (!str) return null;
      
      // Rango: "3-5"
      const rangeMatch = str.match(/^(\d+\.?\d*)\s*-\s*(\d+\.?\d*)$/);
      if (rangeMatch) {
        return { min: parseFloat(rangeMatch[1]), max: parseFloat(rangeMatch[2]) };
      }
      
      // Mayor o igual: ">=2.5"
      const gteMatch = str.match(/^>=\s*(\d+\.?\d*)$/);
      if (gteMatch) {
        return { min: parseFloat(gteMatch[1]), max: null };
      }
      
      // Menor o igual: "<=7"
      const lteMatch = str.match(/^<=\s*(\d+\.?\d*)$/);
      if (lteMatch) {
        return { min: null, max: parseFloat(lteMatch[1]) };
      }
      
      // Valor exacto: "4"
      const exactMatch = str.match(/^(\d+\.?\d*)$/);
      if (exactMatch) {
        const val = parseFloat(exactMatch[1]);
        return { min: val - 0.5, max: val + 0.5 };
      }
      
      return null;
    }

    // Verificar si una fila es excepción
    function isException(L, row) {
      if (!L.exceptions || L.exceptions.length === 0) return false;
      const normInst = normTxt(row.inst);
      return L.exceptions.some(ex => normTxt(ex) === normInst || normInst.includes(normTxt(ex)));
    }

    // Click en la pastilla → abrir file picker (y auto-cargar via autoCsv)
    document.querySelectorAll('#view-data .upload').forEach(lbl=>{
      lbl.addEventListener('click', ()=>{
        const inp = lbl.querySelector('input[type="file"]');
        inp?.click();
      });
    });

    // Restore al abrir app
    (async function restoreBonds(){
      await restoreCsv('bonds', (rows, meta)=>{
        BONDS_RAW = Array.isArray(rows) ? rows.slice() : [];
        window.BONDS_RAW = BONDS_RAW;
        rebuildBondIndex(BONDS_RAW);
        BONDS = BONDS_RAW.map(mapBondRow).filter(Boolean);
        window.BONDS = BONDS;
        const el=document.getElementById('bondsInfo');
        // Sin mensaje de restauración
      });
      await restoreCsv('amorts', (rows, meta)=>{
        AMORT = Array.isArray(rows) ? rows.slice() : [];
        window.AMORT = AMORT;
        rebuildAmortData();
        const el=document.getElementById('amortInfo');
        // Sin mensaje de restauración
      });
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    })();

    /* ======== + Bonos: funciones de cálculo ======== */
    function days30_360_US(d1, d2){
      const D1 = new Date(d1), D2 = new Date(d2);
      let d1d = Math.min(30, D1.getDate()), d2d = D2.getDate();
      if (d1d===30) d2d = Math.min(d2d, 30);
      const days = (D2.getFullYear()-D1.getFullYear())*360 + (D2.getMonth()-D1.getMonth())*30 + (d2d - d1d);
      return Math.max(0, days);
    }
    function monthToIdx(m){ const M={'ENERO':0,'FEBRERO':1,'MARZO':2,'ABRIL':3,'MAYO':4,'JUNIO':5,'JULIO':6,'AGOSTO':7,'SEPTIEMBRE':8,'OCTUBRE':9,'NOVIEMBRE':10,'DICIEMBRE':11}; return M[String(m||'').toUpperCase()] ?? 0; }
    function anchorDateForYear(b, year){
      // USAR SOLO mes/día de 'Fecha 1er Pago' (FirstPay), ignorando el año del CSV
      if (b.FirstPay){
        const parts = String(b.FirstPay).split('/');
        const d = Number(parts[0]) || 15;
        const m = Number(parts[1]) || 6;   // 1..12; 6 = junio (fallback)
        return new Date(year, (m-1), d);
      }
      // Respaldo: Mes1/Mes2 (si no hay 'Fecha 1er Pago')
      const mName = b.Mes1 || b.Mes2 || 'Junio';
      return new Date(year, monthToIdx(mName), 15);
    }
    function couponDatesAround(b, asOf){
      const f = b.Freq || 2, step = 12/f;
      const base = anchorDateForYear(b, asOf.getFullYear());
      const wins = [];
      for(let k=-f*2;k<=f*2;k++){
        const d = new Date(base); d.setMonth(d.getMonth()+k*step); wins.push(d);
      }
      wins.sort((a,b)=>a-b);
      let last=null,next=null;
      for(const d of wins){ if(d<=asOf) last=d; if(d>asOf){ next=d; break; } }
      return {last,next};
    }
    function accruedPxPts(b, asOf){
      const cup = (b.Cup ?? 0)/100;
      const f = b.Freq || 2;
      const {last,next} = couponDatesAround(b, asOf);
      if(!last||!next) return 0;
      if(+asOf===+last) return 0;
      const dc = days30_360_US(last, asOf);
      const ai = (cup * dc / 360) * 100;
      return ai;
    }
    function usd(v){ return isFinite(v) ? v.toLocaleString('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0}) : ' - '; }
    function unique(arr, key){ return Array.from(new Set(arr.map(x=>x[key]).filter(Boolean))); }
    function normalizePct(p){ const v = parsePct(p); if(v==null) return ' - '; return v.toFixed(2)+'%'; }

    /* ======== + Bonos: funciones de renderizado ======== */
    function syncBondsIntoHoldings(){
      const net = new Map(); // key "USD|XS123" -> {netNom, dirty}

      // Agregar todos los bonos calculando neto (buy - sell)
      for(const r of state.cartera){
        const b = BONDS.find(x=>x.id===r.bondId); if(!b) continue;
        const cur = (b.Moneda || 'USD');
        const buyN  = lotNom(b.id, 'buy');
        const sellN = lotNom(b.id, 'sell');
        const netNom = (buyN || 0) - (sellN || 0);
        
        const refSide = netNom > 0 ? 'buy' : 'sell';
        const dirty = toNum(getLot(b.id, refSide).dirty ?? b.Precio ?? 100);
        const k = `${cur}|${r.bondId}`;
        const curr = net.get(k) || { netNom:0, dirty };
        curr.netNom += netNom;
        curr.dirty = dirty;
        net.set(k, curr);
      }

      // Para cada bono neteado
      for(const [k, agg] of net.entries()){
        const [cur, bid] = k.split('|');
        const rows = LAST_HOLDINGS[cur] || [];
        
        // 1º intento: línea real del bono
        let row = rows.find(r => /BONO/i.test(String(r.vehiculo||'')) && 
                                  String(r.nombre||'').toUpperCase().includes(bid.toUpperCase()) );

        // Si es bono del A360, recalcular valor_mercado con precio del CSV de Bonos
        if (row && !row._rid?.includes('-BOND-')) {
          const b = BONDS.find(x => x.id === bid);
          if (b) {
            const nominalActual = currentNominalFromHoldings(cur, bid);
            const precioLimpio = toNum(b.Precio) || 0;
            const AI = accruedPxPts(b, getAsOfDate());
            const valorGIPS = (precioLimpio * nominalActual / 100) + (AI * nominalActual / 100);
            row.valor_mercado = valorGIPS;
          }
        }
        
        // Si no hay, crea UNA sintética (si no existe)
        let rid = row ? row._rid : `${cur}-BOND-${bid}`;
        if (!row && !rows.some(r=>r._rid===rid)) {
          const b = BONDS.find(x=>x.id===bid);
          rows.push({ 
            nombre: bid, clase:'Renta Fija MP', fecha_compra: '', costo_compra: 0, unidades: 0, precio_mercado: 0,
            valor_mercado: 0, gp_no_realizada: 0, vehiculo:'Bono',
            region: (b?.Region || 'Emergentes'),
            subclase: (b?.IGHY==='IG' ? 'Latam IG' : (b?.IGHY==='HY' ? 'Latam HY' : 'Corp')),
            _rid: rid, _subn: '', _isin: (b?.ISIN ? normIsin(b.ISIN) : ''), Moneda: cur, isBond:true
          });
          LAST_HOLDINGS[cur] = rows;
        }
        
        // Si netNom es 0, limpiar el bono
        if (agg.netNom === 0) {
          // DEVOLVER DINERO A LA CUENTA ORIGINAL usando tracking
          const tracking = FONDEO_TRACKING[cur].get(rid);
          
          if (tracking && tracking.cuentaRid && tracking.monto > 0) {
            // Devolver el monto a la cuenta original que fondeó
            const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
            edits[cur].set(tracking.cuentaRid, editCuenta + tracking.monto);
            
            // Limpiar tracking
            FONDEO_TRACKING[cur].delete(rid);
          }
          
          edits[cur].delete(rid);
          continue;
        }
        
        // Calcular valor incluyendo intereses corridos (AI)
        const b = BONDS.find(x => x.id === bid);
        const AI = b ? accruedPxPts(b, getAsOfDate()) : 0;
        const precioSucio = agg.dirty + AI;
        const netAmt = Math.round(agg.netNom * precioSucio / 100);
        
        // Calcular delta respecto al valor anterior
        const valorAnterior = toNum(edits[cur].get(rid)) || 0;
        const delta = netAmt - valorAnterior;
        
        if (netAmt === 0) edits[cur].delete(rid);
        else edits[cur].set(rid, netAmt);
        
        // Mover dinero según tracking (si hay delta)
        if (delta !== 0) {
          const tracking = FONDEO_TRACKING[cur].get(rid);
          
          if (delta > 0) {
            // COMPRA/AUMENTO: descontar de cuenta activa
            const cuentaActiva = CUENTA_ACTIVA[cur];
            if (cuentaActiva) {
              const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
              edits[cur].set(cuentaActiva._rid, editCuenta - delta);
              
              // Actualizar tracking
              const trackingActual = tracking || { cuentaRid: cuentaActiva._rid, monto: 0 };
              trackingActual.monto += delta;
              FONDEO_TRACKING[cur].set(rid, trackingActual);
            }
            
          } else {
            // VENTA/REDUCCIÓN: devolver a cuenta original
            if (tracking && tracking.cuentaRid) {
              const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
              edits[cur].set(tracking.cuentaRid, editCuenta - delta); // delta es negativo
              
              // Actualizar tracking
              tracking.monto += delta; // delta es negativo, así que resta
              
              if (tracking.monto <= 0) {
                FONDEO_TRACKING[cur].delete(rid);
              } else {
                FONDEO_TRACKING[cur].set(rid, tracking);
              }
              
            } else {
              // No hay tracking: devolver a cuenta activa
              const cuentaActiva = CUENTA_ACTIVA[cur];
              if (cuentaActiva) {
                const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
                edits[cur].set(cuentaActiva._rid, editCuenta - delta);
              }
            }
          }
        }
      }
      
      renderHoldingsTables(LAST_HOLDINGS);
      renderRentaFijaTables();
      renderPortafolioBonos();
      renderOperacionesBonos();
      renderPortafolioTables();
      renderCashBars();
    }

    const RORDER = ["AAA","AA+","AA","AA-","A+","A","A-","BBB+","BBB","BBB-","BB+","BB","BB-","B+","B","B-","CCC+","CCC","CCC-","CC","C","D"];
    const R2I = new Map(RORDER.map((r,i)=>[r,i])); const I2R = (x)=> RORDER[Math.min(Math.max(Math.round(x),0),RORDER.length-1)] || 'NR';

    function updateBondKPIs(){
      let base=0, sumIG=0, sumHY=0, wDur=0, wY=0, wRate=0;
      const IG_RATINGS = ['AAA','AA+','AA','AA-','A+','A','A-','BBB+','BBB','BBB-'];
      const HY_RATINGS = ['BB+','BB','BB-','B+','B','B-','CCC+','CCC','CCC-','CC','C','D','NR'];

      // Calcular KPIs para ambas monedas (USD y PEN)
      ['USD', 'PEN'].forEach(cur => {
      (LAST_HOLDINGS[cur]||[]).forEach(h=>{
        if(!String(h.vehiculo||'').toUpperCase().includes('BONO')) return;
        const name = String(h.nombre||'').toUpperCase();
        const b = BONDS.find(x => (x.Moneda||'USD')===cur && name.includes(String(x.id).toUpperCase()));
        if(!b) return;
        const usdInv = toNum(h.valor_mercado);
        base += usdInv;
          if(IG_RATINGS.includes(b.Rating)) sumIG += usdInv; else if(HY_RATINGS.includes(b.Rating)) sumHY += usdInv;
        if(isFinite(b.Dur)) wDur += usdInv*b.Dur;
        const y = (b.YTW!=null? b.YTW : b.Cup||0); if(isFinite(y)) wY += usdInv*y;
        if(R2I.has(b.Rating)) wRate += usdInv*R2I.get(b.Rating);
        });
      });

      state.cartera.forEach(r=>{
        const b = BONDS.find(x=>x.id===r.bondId); if(!b) return;
        const bondCur = b.Moneda || 'USD';
        if(bondCur !== 'USD' && bondCur !== 'PEN') return;
        const buyN  = lotNom(b.id,'buy');  if (buyN>0){
          const d = toNum(getLot(b.id,'buy').dirty ?? b.Precio ?? 100);
          const inv = Math.round(buyN * d / 100);
          base += inv; if(IG_RATINGS.includes(b.Rating)) sumIG += inv; else if(HY_RATINGS.includes(b.Rating)) sumHY += inv;
          if(isFinite(b.Dur)) wDur += inv*b.Dur; const y=(b.YTW!=null?b.YTW:b.Cup||0); if(isFinite(y)) wY += inv*y;
          if(R2I.has(b.Rating)) wRate += inv*R2I.get(b.Rating);
        }
        const sellN = lotNom(b.id,'sell'); if (sellN>0){
          const d = toNum(getLot(b.id,'sell').dirty ?? b.Precio ?? 100);
          const inv = -Math.round(sellN * d / 100);
          base += inv; if(IG_RATINGS.includes(b.Rating)) sumIG += inv; else if(HY_RATINGS.includes(b.Rating)) sumHY += inv;
          if(isFinite(b.Dur)) wDur += inv*b.Dur; const y=(b.YTW!=null?b.YTW:b.Cup||0); if(isFinite(y)) wY += inv*y;
          if(R2I.has(b.Rating)) wRate += inv*R2I.get(b.Rating);
        }
      });

      const denom = Math.max(base, 1);
      const q = (x)=> (denom>0 ? (x/denom) : 0);
      document.getElementById('kIG').textContent  = (q(sumIG)*100).toFixed(1)+'%';
      document.getElementById('kHY').textContent  = (q(sumHY)*100).toFixed(1)+'%';
      document.getElementById('kDur').textContent = denom>0? (wDur/denom).toFixed(2) : ' - ';
      document.getElementById('kYtw').textContent = denom>0? (wY/denom).toFixed(2)+'%' : ' - ';
      document.getElementById('kRat').textContent = denom>0? I2R(wRate/denom) : 'NR';

      // Actualizar Caja disponible en modal de bonos (igual que renderCashBars)
      const cajaElement = document.getElementById('cajaDispBonos');
      if (cajaElement) {
        const cashBase = (cur) => Array.from(CASH_ACC[cur].keys())
          .reduce((a, sub) => a + getDisponible(cur, sub), 0);
        const sumCTS = (cur) => (LAST_HOLDINGS[cur] || []).reduce((a, r) => {
          const sub = r._subn || '';
          const prod = sub ? ACT.product_by_subprod_name.get(sub) : '';
          if (prod !== 'CTS') return a;
          const cv = toNum(edits[cur].get(r._rid) || 0);
          return a - cv;
        }, 0);
        const pendingCV = (cur) => cvNet(cur);
        const cur = ACTIVE_BOND_CUR;
        const totalCaja = cashBase(cur) + sumCTS(cur) - pendingCV(cur);
        cajaElement.textContent = fmtMoney(totalCaja, cur);
      }

    }

    // Flag global para event listener (una sola vez)
    let montosModalListenerAdded = false;

    // Flag para event listeners (una sola vez)
    let montosListenersAdded = false;

    function renderMontosModal(){
      const tb = document.getElementById('montosBodyModal'); if(!tb) return;
      tb.innerHTML = '';

      const asOf = getAsOfDate();
      const cur  = ACTIVE_BOND_CUR;

      // Encabezado fijo: SIEMPRE mostramos "Nominal Actual"
      const head = document.querySelector('#nominalesTbl thead tr');
      if (head) {
        head.innerHTML = `
          <th class="left" style="min-width:120px">Bono</th>
          <th class="left">Emisor</th>
          <th class="center">Fecha<br>Call</th>
          <th class="center" style="min-width:60px">Precio<br>Limpio (%)</th>
          <th class="center" style="min-width:60px">Dur.</th>
          <th class="center" style="min-width:60px">YTM</th>
          <th class="center" style="min-width:60px">Rating</th>
          <th class="center" style="min-width:60px">Amort.</th>
          <th class="center">Circulante<br>(mm)</th>
          <th class="center">Nominal<br>Inicial</th>
          <th class="center">Intereses<br>Corridos</th>
          <th class="center">Monto<br>Estimado</th>
          <th class="center">Rebalanceo<br>(V. Nominal)</th>
          <th class="center"></th>
          <th class="center"></th>`;
      }

      // Asegura que los bonos de A360 estén en la lista
      ensureInitialBondsInCartera();

      // Mostramos TODOS los bonos en cartera de ambas monedas (USD y PEN)
      const rows = state.cartera.filter(r => {
        const bondMoneda = BONDS.find(b=>b.id===r.bondId)?.Moneda || 'USD';
        return bondMoneda === 'USD' || bondMoneda === 'PEN';
      });

      rows.forEach(r=>{
        const b = BONDS.find(x=>x.id===r.bondId); if(!b) return;
        const bondCur = b.Moneda || 'USD';
        const isInitial = !!r.fromA360 || existsBondInHoldings(bondCur, b.id);

        const AI = accruedPxPts(b, asOf);
        const nominalActual = currentNominalFromHoldings(bondCur, b.id);

        const buyN  = lotNom(b.id, 'buy');   // compras vigentes
        const sellN = lotNom(b.id, 'sell');  // ventas vigentes
        const signedNom = (buyN || 0) - (sellN || 0);

        const lotRef = getLot(b.id, signedNom>=0 ? 'buy' : 'sell');
        const dirty = toNum(lotRef.dirty ?? b.Precio ?? 100);
        const clean = dirty - AI;

        const corr  = Math.abs(signedNom) * (AI/100);
        const monto = Math.round(signedNom * dirty / 100);

        // botón "quitar" SOLO para bonos agregados en esta sesión
        const delBtn = isInitial
          ? ''
          : `<button class="icon-btn btn-eliminar-holding" data-del="${b.id}" title="Quitar" aria-label="Quitar">✕</button>`;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="left">${b.id}</td>
          <td class="left">${b.Emisor||'-'}</td>
          <td class="center">${b.Call||'-'}</td>
          <td class="center">${clean.toFixed(2)}</td>
          <td class="center">${b.Dur?Number(b.Dur).toFixed(1):'-'}</td>
          <td class="center">${(b.YTW!=null? b.YTW : b.Cup||0).toFixed(2)}%</td>
          <td class="center">${b.Rating||'-'}</td>
          <td class="center">${b.Amortiza||'No'}</td>
          <td class="center">${b.Outstanding ? (Number(String(b.Outstanding).replace(/,/g, ''))/1000000).toFixed(0) : '-'}</td>
          <td class="center">${nominalActual ? nominalActual.toLocaleString('en-US') : ' - '}</td>
          <td class="center">${moneyByCur(corr, bondCur)}</td>
          <td class="center">${moneyByCur(monto, bondCur)}</td>
          <td class="center">
            <input class="nominalInp" data-bid="${b.id}" type="text" inputmode="numeric"
                   style="width:120px;text-align:right"
                   value="${signedNom!==0 ? (signedNom<0?'-':'') + Math.abs(signedNom).toLocaleString('en-US') : ''}"
                   placeholder="">
          </td>
          <td class="center">${delBtn}</td>
          <td class="center"><button class="icon-btn" data-info="${b.id}" title="Info" aria-label="Info">i</button></td>`;
        tb.appendChild(tr);
      });

      // === Edición con signo ===
      const commit = (t)=>{
        const bid = t.dataset.bid;
        const cur = ACTIVE_BOND_CUR;

        // raw permite '-' al inicio
        const raw = String(t.value).replace(/,/g,'').trim();
        if (!raw){
          setLot(bid,'buy',{nominal:0}); setLot(bid,'sell',{nominal:0});
          t.value=''; syncBondsIntoHoldings(); renderMontosModal(); updateBondKPIs(); try{ renderCronograma(); }catch(e){} return;
        }

        let num = Number(raw);                    // puede ser negativo
        if (!Number.isFinite(num)) return;

        const sign = num < 0 ? -1 : 1;
        let absNum = Math.abs(num);

        // Verificar si es bono amortizable
        const bondInfo = BONDS.find(x => x.id === bid);
        const isinNorm = bondInfo?.ISIN ? normIsin(bondInfo.ISIN) : '';
        const esAmortizable = isinNorm && AMORTS_BY_ISIN && AMORTS_BY_ISIN[isinNorm] && AMORTS_BY_ISIN[isinNorm].length > 0;

        // Redondear a múltiplos de 1,000 SOLO si NO es amortizable
        if (!esAmortizable) {
            absNum = Math.floor(absNum / 1000) * 1000;
        }

        num = absNum;

        if (sign > 0){
          // ► COMPRA: respetar mínimo por moneda
          const min = cur==='USD' ? BOND_MIN.USD : BOND_MIN.PEN;
          if (num>0 && num<min){
            num = 0;
            t.setCustomValidity(`El mínimo de compra es ${min.toLocaleString('en-US')}`);
            t.reportValidity();
          } else {
            t.setCustomValidity('');
          }
          
          // Validación de cuenta activa y fondos
          if (num > 0) {
            const cuentaActiva = CUENTA_ACTIVA[cur];
            
            if (!cuentaActiva) {
              const valorIngresado = num;
              const inputRef = t;
              
              mostrarPopupSeleccionCuenta(cur, function() {
                inputRef.value = valorIngresado;
                inputRef.dispatchEvent(new Event('change', { bubbles: true }));
              });
              
              t.value = '';
              setLot(bid,'buy',{ nominal:0 });
              setLot(bid,'sell',{ nominal:0 });
              syncBondsIntoHoldings(); renderMontosModal(); updateBondKPIs(); try{ renderCronograma(); }catch(e){}
              return;
            }
            
            const rowCuenta = (LAST_HOLDINGS[cur] || []).find(r => r._rid === cuentaActiva._rid);
            if (rowCuenta) {
              const valorCuenta = toNum(rowCuenta.valor_mercado);
              const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
              const saldoCuenta = valorCuenta + editCuenta;
              
              // Calcular costo de la compra
              const precio = toNum(getLot(bid,'buy').dirty ?? BONDS.find(x=>x.id===bid)?.Precio ?? 100);
              const costoCompra = Math.round(num * precio / 100);
              
              if (costoCompra > saldoCuenta) {
                alert('Saldo insuficiente. La operación no se ejecutó.');
                t.value = '';
                setLot(bid,'buy',{ nominal:0 });
                setLot(bid,'sell',{ nominal:0 });
                syncBondsIntoHoldings(); renderMontosModal(); updateBondKPIs(); try{ renderCronograma(); }catch(e){}
                return;
              }
            }
          }
          
          setLot(bid,'sell',{ nominal:0 });
          setLot(bid,'buy',{ nominal:num, dirty: toNum(getLot(bid,'buy').dirty ?? BONDS.find(x=>x.id===bid)?.Precio ?? 100) });
        } else {
          // ► VENTA: validar cuenta activa
          if (!CUENTA_ACTIVA[cur]) {
            const valorIngresado = num;
            const inputRef = t;
            
            mostrarPopupSeleccionCuenta(cur, function() {
              inputRef.value = valorIngresado;
              inputRef.dispatchEvent(new Event('change', { bubbles: true }));
            });
            
            t.value = '';
            setLot(bid,'buy',{ nominal:0 });
            setLot(bid,'sell',{ nominal:0 });
            syncBondsIntoHoldings(); renderMontosModal(); updateBondKPIs(); try{ renderCronograma(); }catch(e){}
            return;
          }
          
          // ► VENTA: limitado al Nominal Actual (sólo aplica a bonos iniciales)
          const max = currentNominalFromHoldings(cur, bid);
          if (num > max){
            num = max;
            t.setCustomValidity(`Excede nominal actual (máx ${max.toLocaleString('en-US')})`);
            t.reportValidity();
          } else {
            t.setCustomValidity('');
          }
          setLot(bid,'buy',{ nominal:0 });
          setLot(bid,'sell',{ nominal:num, dirty: toNum(getLot(bid,'sell').dirty ?? BONDS.find(x=>x.id===bid)?.Precio ?? 100) });
        }

        // Reescribe con separador de miles y signo
        const shown = (sign<0?'-':'') + (num? num.toLocaleString('en-US') : '');
        t.value = shown;

        syncBondsIntoHoldings(); renderMontosModal(); updateBondKPIs(); try{ renderCronograma(); }catch(e){}
      };

      // Permite '-' al inicio y sólo dígitos; sin formatear miles durante la escritura
      if (!montosListenersAdded) {
      tb.addEventListener('input', (e)=>{
        const t = e.target; if(!t.classList.contains('nominalInp')) return;
        
        const cursorPos = t.selectionStart;
        const valorAnterior = t.value;
        const longitudAnterior = valorAnterior.length;
        
        // Detectar si es negativo
        const esNegativo = valorAnterior.startsWith('-');
        
        // Remover todo excepto números
        const limpio = valorAnterior.replace(/[^\d]/g, '');
        
        // Formatear con comas
        const formateado = limpio ? parseInt(limpio, 10).toLocaleString('en-US') : '';
        
        // Agregar signo si es negativo
        t.value = esNegativo ? '-' + formateado : formateado;
        
        // Ajustar posición del cursor
        const longitudNueva = t.value.length;
        const diferencia = longitudNueva - longitudAnterior;
        t.setSelectionRange(cursorPos + diferencia, cursorPos + diferencia);
      });
      tb.addEventListener('keydown',(e)=>{
        const t=e.target;
        if(t.classList.contains('nominalInp') && e.key==='Enter'){ e.preventDefault(); t.blur(); }
      });
      tb.addEventListener('blur', (e)=>{
        if(e.target.classList.contains('nominalInp')) commit(e.target);
      }, true);

        montosListenersAdded = true;
      }


      updateBondKPIs();
    }

    function renderBonosModal(){
      const subset = BONDS.filter(b => (b.Moneda||'USD') === ACTIVE_BOND_CUR);
      const byId = new Set(state.cartera.map(r=>r.bondId));

      const setOpts = (sel, getKey)=>{ const el=document.getElementById(sel); if(!el) return;
        const vals = Array.from(new Set(subset.map(getKey).filter(Boolean)));
        el.innerHTML = `<option value="">${sel==='fRating'?'Rating': sel==='fSector'?'Sector': sel==='fPais'?'País':''}</option>`+
          vals.map(v=>`<option>${v}</option>`).join('');
      };
      setOpts('fSector', x=>x.Sector); setOpts('fRating', x=>x.Rating); setOpts('fPais', x=>x.Pais);

      const f = {
        em: (document.getElementById('fEmisor')?.value || '').toUpperCase().normalize('NFD').replace(/[\u0300-\u036f]/g,''),
        sector: document.getElementById('fSector')?.value || '',
        rating: document.getElementById('fRating')?.value || '',
        pais:   document.getElementById('fPais')?.value || '',
        dmax:   toNum(document.getElementById('fDurMax')?.value),
        ytwMin: toNum(document.getElementById('fYtwMin')?.value),
        ig:     document.getElementById('fIG')?.value || ''
      };

      const pass = b=>{
        if(f.em){ const t=(b.Emisor+' '+b.id).toUpperCase().normalize('NFD').replace(/[\u0300-\u036f]/g,''); if(!t.includes(f.em)) return false; }
        if(f.sector && b.Sector!==f.sector) return false;
        if(f.rating && b.Rating!==f.rating) return false;
        if(f.pais && b.Pais!==f.pais) return false;
        if(f.dmax && Number(b.Dur)>f.dmax) return false;
        if(f.ytwMin && Number(b.YTW)<f.ytwMin) return false;
        if(f.ig && (b.IGHY||'')!==f.ig) return false;
        return true;
      };

      const tb = document.getElementById('bonosBody'); if(!tb) return;
      tb.innerHTML = '';
      // Obtener ISINs de bonos en posiciones iniciales
      const isinsEnHoldings = new Set();
      ['USD', 'PEN'].forEach(cur => {
        (LAST_HOLDINGS[cur] || []).forEach(row => {
          if (String(row.vehiculo || '').toUpperCase().includes('BONO')) {
            const isin = normIsin(row._isin || row.isin);
            if (isin) isinsEnHoldings.add(isin);
          }
        });
      });

      subset.filter(pass).forEach(b=>{
        const added = byId.has(b.id);
        const yaEnHoldings = isinsEnHoldings.has(normIsin(b.ISIN));
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="left">${b.id}</td><td class="left">${b.Emisor}</td>
          <td>${b.Sector||'-'}</td><td>${b.Pais||'-'}</td>
          <td class="center">${b.Cup!=null ? (b.Cup.toFixed(2)+'%') : '-'}</td>
          <td class="center">${b.Dur!=null ? b.Dur.toFixed(2) : '-'}</td>
          <td class="center">${b.YTW!=null ? (b.YTW.toFixed(2)+'%') : (b.Cup!=null? (b.Cup.toFixed(2)+'%') : '-')}</td>
          <td class="center">${b.Precio!=null ? b.Precio.toFixed(3) : '100.000'}</td>
          <td class="center">${b.Rating||'NR'}</td>
          <td class="center">${b.Seniority||'-'}</td>
          <td class="center">${b.Venc||'-'}</td>
          <td class="center">${b.Call||'-'}</td>
          <td class="center">${b.Amortiza||'No'}</td>
          <td class="center">
            <button class="btn-addplus btn-addplus--row" data-add="${b.id}" ${(added || yaEnHoldings)?'disabled':''} title="${yaEnHoldings ? 'Ya existe en posiciones iniciales' : ''}">
              <span class="addplus-icon" aria-hidden="true">+</span>
            </button>
          </td>`;
        tb.appendChild(tr);
      });

      tb.onclick = (e)=>{
        const btn = e.target.closest('button');
        const id  = btn?.dataset?.add;
        if(!id) return;
        const b = subset.find(x=>x.id===id); if(!b) return;
        if(!state.cartera.some(r=>r.bondId===b.id)){
          state.cartera.push({ clase: b.Clase||'Renta Fija MP', inst:b.id, veh:b.Vehiculo||'Bono', sub:b.Subclase||b.Seniority||'Corp', region:b.Region||'Emergentes', isBond:true, bondId:b.id, existing:false, monto:0, peso:0 });
        }
        setLot(b.id, 'buy', { nominal: lotNom(b.id,'buy') || 0, dirty: toNum(BONDS.find(x=>x.id===b.id)?.Precio ?? 100) });
        renderBonosModal();
        renderMontosModal();
      };

      ['fEmisor','fSector','fRating','fPais','fDurMax','fYtwMin','fIG'].forEach(id=>{
        document.getElementById(id)?.addEventListener('input', debounce(renderBonosModal, 250));
        document.getElementById(id)?.addEventListener('change', renderBonosModal);
      });
    }

    function openMiniInfo(bid){
      const b = BONDS.find(x=>x.id===bid); if(!b){ return; }

      const titleEl = document.getElementById('miniInfoTitle');
      const bodyEl  = document.getElementById('miniInfoBody');
      const box     = document.getElementById('miniInfo');

      if (titleEl) titleEl.textContent = `${b.id} — ${b.Emisor || ''}`;

      if (bodyEl) bodyEl.innerHTML = `
        <div style="display:grid;grid-template-columns:140px 1fr;gap:6px 12px">
          <div>País</div><div>${b.Pais||'-'}</div>
          <div>Sector</div><div>${b.Sector||'-'}</div>
          <div>Moneda</div><div>${b.Moneda||'USD'}</div>
          <div>Cupón</div><div>${normalizePct(b.Cup)}</div>
          <div>Duración</div><div>${b.Dur ?? '-'}</div>
          <div>IG/HY</div><div>${b.IGHY || '-'}</div>
          <div>Rating</div><div>${b.Rating || 'NR'}</div>
          <div>Seniority</div><div>${b.Seniority || '-'}</div>
          <div>F. Venc.</div><div>${b.Venc || '-'}</div>
          <div>F. Call</div><div>${b.Call || '-'}</div>
          <div>Precio Próx. Call</div><div>${b.PrecioProxCall || '-'}</div>
          <div>Amortiza</div><div>${b.Amortiza || 'No'}</div>
          <div>Circulante</div><div>${b.Outstanding || '-'}</div>
          <div>LTV</div><div>${normalizePct(b.LTV)}</div>
        </div>`;

      if (box) box.style.display = 'flex';
    }

    // Cerrar mini‑modal (X, fondo, Escape)
    document.getElementById('miniInfoClose')?.addEventListener('click', ()=> {
      const box = document.getElementById('miniInfo'); if (box) box.style.display = 'none';
    });
    document.getElementById('miniInfo')?.addEventListener('click', (e)=> {
      if (e.target.id === 'miniInfo') e.currentTarget.style.display = 'none';
    });
    document.addEventListener('keydown', (e)=> {
      if (e.key === 'Escape') document.getElementById('miniInfo')?.style.setProperty('display','none');
    });

    /* === Helpers: detectar bonos iniciales y nominal actual (A360) === */
    function existsBondInHoldings(cur, bid){
      const rows = LAST_HOLDINGS[cur] || [];
      const U = String(bid||'').toUpperCase();
      const b = (BONDS||[]).find(x => String(x.id||'').toUpperCase() === U);
      const is = b ? normIsin(b.ISIN) : '';
      const found = rows.find(r =>
        /BONO/i.test(String(r.vehiculo||'')) &&
        (
          (is && normIsin(r._isin || r.isin) === is) ||
        String(r.nombre||'').toUpperCase().includes(U)
        )
      );
      // Solo es "inicial" si existe Y tiene valor > 0
      return found && found.valor_mercado > 0;
    }

    // ========================================
    // FUNCIÓN HELPER: Calcular factor remanente de amortización
    // ========================================
    function calcularFactorRemanente(isin, asOfDate) {
      if (!isin) return 1;
      

      const isinNorm = normIsin(isin);
      const amorts = AMORTS_BY_ISIN[isinNorm];
      

      if (!amorts || amorts.length === 0) return 1;
      

      const fecha = asOfDate || new Date(fechaMaxData || Date.now());
      let factorRem = 1;
      

      amorts.forEach(a => {
        if (a.d <= fecha) {
          factorRem = Number(a.after);
        }
      });
      

      return factorRem;
    }

    function currentNominalFromHoldings(cur, bid){
      const rows = LAST_HOLDINGS[cur] || [];
      const U = String(bid||'').toUpperCase();
      const b = (BONDS||[]).find(x => String(x.id||'').toUpperCase() === U);
      const is = b ? normIsin(b.ISIN) : '';
      const r = rows.find(r =>
        /BONO/i.test(String(r.vehiculo||'')) &&
        (
          (is && normIsin(r._isin || r.isin) === is) ||
        String(r.nombre||'').toUpperCase().includes(U)
        )
      );
      if(!r) return 0;
      

      // Nominal ORIGINAL del CSV A360 (en miles)

      let nominalOriginal = toNum(r.unidades) || 0;
      if (nominalOriginal > 0 && nominalOriginal < 1000) nominalOriginal *= 1000;
      nominalOriginal = Math.floor(nominalOriginal/1000)*1000;
      

      // AJUSTAR por amortizaciones para obtener nominal ACTUAL

      const isin = r._isin || r.isin;
      const factorRem = calcularFactorRemanente(isin);
      

      // Retornar nominal ACTUAL (post-amortización)

      return Math.round(nominalOriginal * factorRem);
    }

    /* Agrega los bonos iniciales (A360) a state.cartera una sola vez
       y precarga su 'maxSell' con el Nominal Actual */
    function ensureInitialBondsInCartera(){
      const cur = ACTIVE_BOND_CUR;
      const rows = (LAST_HOLDINGS[cur]||[]).filter(r =>
        /BONO/i.test(String(r.vehiculo||'')) && r.valor_mercado > 0
      );
      rows.forEach(r=>{
        // Buscar por ISIN (más confiable que por nombre)
        const isinHolding = normIsin(r._isin || r.isin || '');
        const b = BONDS.find(x => (x.Moneda||'USD')===cur && normIsin(x.ISIN) === isinHolding);
        if(!b) return;

        let item = state.cartera.find(x=>x.bondId===b.id);
        if(!item){
          item = {
            clase:'Renta Fija MP', inst:b.id, veh:'Bono',
            sub:b.Subclase||b.Seniority||'Corp', region:b.Region||'Emergentes',
            isBond:true, bondId:b.id, monto:0, peso:0, fromA360:true
          };
          state.cartera.push(item);
        } else {
          item.fromA360 = true;
        }

        const maxN = currentNominalFromHoldings(cur, b.id);
        const lotS = getLot(b.id, 'sell');
        setLot(b.id, 'sell', { maxSell: maxN, dirty: toNum(lotS.dirty ?? b.Precio ?? 100) });
      });
    }

    // Construye la lista de bonos existentes en cartera (moneda activa) para vender
    function preloadSellFromHoldings(){
      const cur = ACTIVE_BOND_CUR;
      const rows = (LAST_HOLDINGS[cur]||[]).filter(r => String(r.vehiculo||'').toUpperCase().includes('BONO'));
      rows.forEach(r=>{
        const name = String(r.nombre||'').toUpperCase();
        const b = BONDS.find(x => (x.Moneda||'USD')===cur && name.includes(String(x.id).toUpperCase()));
        if(!b) return;
        if(!state.cartera.some(x=>x.bondId===b.id)){
          state.cartera.push({ clase:'Renta Fija MP', inst:b.id, veh:'Bono', sub:b.Subclase||b.Seniority||'Corp', region:b.Region||'Emergentes', isBond:true, bondId:b.id, existing:true, monto:0, peso:0 });
        }
        const lotS = getLot(b.id, 'sell');
        let q = toNum(r.unidades) || 0;
        // Si parece estar en "miles", normaliza a nominal:
        if (q > 0 && q < 1000) q *= 1000;
        // Redondea hacia abajo a múltiplos de 1,000
        setLot(b.id, 'sell', {
          maxSell: Math.floor(q/1000)*1000,
          dirty: toNum(lotS.dirty ?? b.Precio ?? 100)
        });
      });
    }

    // Event listeners para acciones - Bonos
    function openBonosModal(){
      const m = document.getElementById('modalBonos');
      if(!m) return;

      const holdKey = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || 'hold-usd';
      ACTIVE_BOND_CUR = (holdKey==='hold-pen') ? 'PEN' : 'USD';
      document.getElementById('minNomBond')?.replaceChildren(
        document.createTextNode(ACTIVE_BOND_CUR==='USD' ? '$50,000' : 'S/ 1,000')
      );

      document.body.style.overflow = 'hidden';
      m.style.display = 'flex';
      BOND_MODE = 'buy';

      document.getElementById('bonosBuy')?.classList.add('btn-primary');
      document.getElementById('bonosBuy')?.classList.remove('btn-outline');
      document.getElementById('bonosSell')?.classList.add('btn-outline');
      document.getElementById('bonosSell')?.classList.remove('btn-primary');

      ensureInitialBondsInCartera(); // <-- NUEVO

      showPane('sel');
      renderBonosModal();
      renderMontosModal();
      updateBondKPIs();
    }
    function showPane(which){
      document.getElementById('paneMontos') .classList.toggle('active', which==='montos');
      document.getElementById('paneSelBonos').classList.toggle('active', which==='sel');
      document.getElementById('tabMontos').classList.toggle('active', which==='montos');
      document.getElementById('tabSelBono').classList.toggle('active', which==='sel');
    }
    
    document.getElementById('btnAddBonos')  ?.addEventListener('click', openBonosModal);
    document.getElementById('bonosCerrar')?.addEventListener('click', ()=>{
      try { syncBondsIntoHoldings(); updateBondKPIs(); renderCronograma(); } catch(e){}
      document.getElementById('modalBonos').style.display = 'none';
      document.body.style.overflow = '';
    });
    document.getElementById('tabMontos')    ?.addEventListener('click', ()=>{ showPane('montos'); });
    document.getElementById('tabSelBono')  ?.addEventListener('click', ()=>{ showPane('sel'); });

    // Event listener para botones en tabla de nominales - UNA SOLA VEZ
    document.getElementById('nominalesTbl')?.addEventListener('click', (e)=>{
      const btn = e.target.closest('button');
      if (!btn) return;
      
      // Botón × (eliminar)
      if(btn.dataset.del){
        const bid = btn.dataset.del;
        const cur = ACTIVE_BOND_CUR;
        // elimina sólo si NO es inicial
        if(!existsBondInHoldings(cur, bid)){
          // 1. DEVOLVER DINERO A LA CUENTA ORIGINAL usando tracking
          const rid = `${cur}-BOND-${bid}`;
          const tracking = FONDEO_TRACKING[cur].get(rid);
          
          if (tracking && tracking.cuentaRid && tracking.monto > 0) {
            // Devolver el monto a la cuenta original que fondeó
            const editCuenta = toNum(edits[cur].get(tracking.cuentaRid)) || 0;
            edits[cur].set(tracking.cuentaRid, editCuenta + tracking.monto);
            
            // Limpiar tracking
            FONDEO_TRACKING[cur].delete(rid);
          }
          
          // 2. Eliminar el bono
          state.cartera = state.cartera.filter(x => x.bondId !== bid);
          if(state.bondLots[bid]) delete state.bondLots[bid];
          edits.USD.delete(`USD-BOND-${bid}`); 
          edits.PEN.delete(`PEN-BOND-${bid}`);
          syncBondsIntoHoldings(); 
          renderBonosModal(); 
          renderMontosModal(); 
          updateBondKPIs(); 
          try{ renderCronograma(); }catch(e){}
        }
      }
      
      // Botón i (info)
      if(btn.dataset.info){ 
        openMiniInfo(btn.dataset.info); 
      }
    });

    // Toggle modal Centro de datos
    document.getElementById('btnDataHub')?.addEventListener('click', ()=> document.getElementById('modalData')?.classList.add('show'));
    document.getElementById('dataClose')?.addEventListener('click', ()=> document.getElementById('modalData')?.classList.remove('show'));
    
    // ===== Portafolios Modelo (perfil -> pesos por clase) =====
    let MODELOS = {};   // { Perfil: { 'Liquidez':%, 'Renta Fija CP':%, 'Renta Fija MP':%, 'Renta Variable':%, 'Alternativo':% } }
    let MODELOS_PM = {};  // { Perfil: { Clase: { PM: porcentaje absoluto (del total del perfil) } } }
    const CLASES_BAL = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];

    function _pct(x){
      const p = parsePct(x);
      if (!Number.isFinite(p)) return 0;
      // Caso 1: viene como proporción (0.0655) → 6.55
      // Caso 2: viene como porcentaje (6.55 ó "6.55%") → 6.55
      return (p <= 1 ? p*100 : p);
    }
    function _canonClase(x){ const c = canonClassName(x); return CLASES_BAL.includes(c) ? c : 'Renta Fija MP'; }

    // Normaliza claves
    const normalizeKey = (val) => {
      if (val === null || val === undefined) return '';
      let s = String(val).trim();
      // 372.0 -> 372
      if (/^\d+(\.0+)?$/.test(s)) s = String(parseInt(parseFloat(s), 10));
      // quitar acentos + mayúsculas
      s = s.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toUpperCase();
      return s;
    };

    // Clasifica PM a clase top, priorizando la clase del CSV
    const topFromPM = (pm, claseBase) => {
      const base = canonClassName(claseBase);
      if (base) return base;  // <<<<<< clave: no sobreescribir lo que viene en el csv

      const p = normTxt(pm || '');
      if (!p) return 'Otros';

      // Caso explícito: Cash y Equivalentes en Renta Fija → Renta Fija CP
      if (/cash|equival/.test(p) && /renta\s*fija/.test(claseBase)) return 'Renta Fija CP';

      const s = p;
      if (s.includes('LIQUIDEZ') || s.includes('CASH')) return 'Liquidez';
      if (s.includes('RENTA FIJA') && s.includes('CP')) return 'Renta Fija CP';
      if (s.includes('RENTA FIJA')) return 'Renta Fija MP';
      if (['EEUU','EUROPA','JAPON','ASIA','EMERGENTE','RV','RENTA VARIABLE'].some(k => s.includes(k))) return 'Renta Variable';
      if (['REAL ESTATE','MATERIAS PRIMAS','ALTERNAT','COMMOD','REIT','REITS'].some(k => s.includes(k))) return 'Alternativo';
      return 'Otros';
    };

    // Calcula exposición por perfil
    function breakdownByProfile(rows, profileCol) {
      const byClase = new Map();
      const byPM = new Map();

      for (const r of rows) {
        const w = _pct(r[profileCol]); 
        if (!w || !Number.isFinite(w)) continue;

        // Usar CLASE_TOP que viene del Excel, NO inferirla
        const clase = r['CLASE_TOP'];
        const pm = r['PM'];

        // Solo acumular si hay clase válida
        if (!clase) continue;

        byClase.set(clase, (byClase.get(clase) || 0) + w);

        // La clave DEBE incluir la clase para evitar mezclas
        const k = `${clase}|${pm}`;
        byPM.set(k, (byPM.get(k) || 0) + w);
      }

      return { byClase, byPM };
    }

    // Ingresa filas crudas (wide, long o MATRIZ: clase+instrumento con perfiles por columnas)
    function ingestModelRows(raw){

      MODELOS = {};

      MODELOS_PM = {};

      const pmRows = (raw||[]).map(normalizeRowKeys);

      if (!pmRows.length) {

        const el = document.getElementById('modelInfo');

        // Sin mensaje

        return;

      }

      // Crear diccionarios de clasificación desde Activos.csv
      const mapCodToPM = new Map();   // codsubproducto -> PM
      const mapIsinToPM = new Map();  // ISIN -> PM

      const actRows = ACT.rows || [];
      for (const r of actRows) {
        const cod = normalizeKey(r['CodSubproducto'] || r['codsubproducto']);
        const isin = normalizeKey(r['isin'] || r['Isin'] || r['ISIN']);
        const pm = (r['Subclasificacion'] || r['subclasificacion'] || r['PM'] || r['pm'] || '').toString().trim();

        if (cod) {
          if (!mapCodToPM.has(cod)) mapCodToPM.set(cod, pm); // si hay duplicados toma el primero/más común
        }
        if (isin) {
          if (!mapIsinToPM.has(isin)) mapIsinToPM.set(isin, pm);
        }
      }

      // Anexa Subclasificacion (PM) a cada fila del Portafolio Modelo
      const enriched = pmRows.map(r => {
        // PASO 1: Tomar la clase DIRECTAMENTE del Excel, NO inferirla
        const claseExcel = (r['Clase Activo'] || r['clase_activo'] || r['claseactivo'] || '').toString().trim();

        // PASO 2: Canonizar la clase (pero respetando lo que dice el Excel)
        let claseTop = '';
        const claseNorm = claseExcel.toUpperCase();
        if (claseNorm === 'LIQUIDEZ') claseTop = 'Liquidez';
        else if (claseNorm === 'RENTA FIJA CP') claseTop = 'Renta Fija CP';
        else if (claseNorm === 'RENTA FIJA MP') claseTop = 'Renta Fija MP';
        else if (claseNorm === 'RENTA VARIABLE') claseTop = 'Renta Variable';
        else if (claseNorm === 'ALTERNATIVO') claseTop = 'Alternativo';
        else claseTop = claseExcel; // Si no coincide, usar tal cual

        // PASO 3: Tomar la subcategoría del Excel
        const pm = (r['Subclasificacion'] || r['subclasificacion'] || '').toString().trim() || 'Otros';

        // NUNCA inferir la clase desde el PM, SIEMPRE usar la del Excel
        return { 
          ...r, 
          PM: pm,
          CLASE_TOP: claseTop  // Esta es la clase REAL del Excel
        };
      });

      // Detectores de formato
      const keysSet = new Set(Object.keys(enriched[0]||{}));
      const allKeys = Array.from(keysSet);

      // Perfiles válidos (cabeceras normalizadas)
      const PROFILE_COLS = new Set([
        'extraconservador',   // tu archivo
        'conservador',
        'moderado',
        'agresivo',
        'altamenteconservador' // por compatibilidad
      ]);

      const hasWide = enriched.some(r =>
        ('perfil' in r) &&
        ('liquidez' in r || 'rentafijacp' in r || 'rentafijamp' in r || 'rentavariable' in r || 'alternativo' in r)
      );

      // Formato MATRIZ: Clase + columnas de perfiles
      const profKeys = allKeys.filter(k => PROFILE_COLS.has(k));
      const isMatrix = (keysSet.has('claseactivo') || keysSet.has('clase')) && profKeys.length >= 1;

      const emptyRec = () => ({ Liquidez:0, "Renta Fija CP":0, "Renta Fija MP":0, "Renta Variable":0, Alternativo:0 });

      const PRETTY = {
        extraconservador: 'Extra Conservador',
        altamenteconservador: 'Altamente Conservador',
        conservador: 'Conservador',
        moderado: 'Moderado',
        agresivo: 'Agresivo'
      };

      if (isMatrix){
        // Usar breakdownByProfile para cada perfil
        profKeys.forEach(k => {
          const perfName = PRETTY[k] || k;
          const { byClase, byPM } = breakdownByProfile(enriched, k);

          // Construir MODELOS
          const rec = emptyRec();
          byClase.forEach((val, clase) => {
            const canonClase = _canonClase(clase);
            if (canonClase) rec[canonClase] = (rec[canonClase] || 0) + val;
          });
          MODELOS[perfName] = rec;

          // Construir MODELOS_PM
          MODELOS_PM[perfName] = {};
          byPM.forEach((val, key) => {
            const [clase, pm] = key.split('|');
            const canonClase = _canonClase(clase);
            if (canonClase) {
              MODELOS_PM[perfName][canonClase] ||= {};
              MODELOS_PM[perfName][canonClase][pm] = (MODELOS_PM[perfName][canonClase][pm] || 0) + val;
            }
          });
        });
      }
      else if (hasWide){
        // Formato WIDE clásico
        enriched.forEach(r=>{
          const perf = String(r.perfil||'').trim(); if(!perf) return;
          const rec = MODELOS[perf] ||= emptyRec();

          const clases = [
            { key: "Liquidez",      value: _pct(r.liquidez) },
            { key: "Renta Fija CP", value: _pct(r.rentafijacp) },
            { key: "Renta Fija MP", value: _pct(r.rentafijamp) },
            { key: "Renta Variable",value: _pct(r.rentavariable) },
            { key: "Alternativo",   value: _pct(r.alternativo) }
          ];

          clases.forEach(({key, value})=>{
            if (!Number.isFinite(value) || value<=0) { rec[key] ||= 0; return; }
            rec[key] = value;

            const pm = r['PM'] || 'Otros';
            const claseFrom = r['CLASE_TOP'] || key;

            MODELOS_PM[perf] ||= {};
            MODELOS_PM[perf][claseFrom] ||= {};
            MODELOS_PM[perf][claseFrom][pm] = (MODELOS_PM[perf][claseFrom][pm]||0) + value;
          });
        });
      }
      else {
        // Formato LONG (perfil / clase / peso)
        enriched.forEach(r=>{
          const perf  = String(r.perfil||'').trim(); if(!perf) return;
          const clase = _canonClase(r.clase||r.clasedeactivo||r['CLASE_TOP']||'');
          const peso  = _pct(r.peso||r.porcentaje||r.asignacion);
          const rec   = MODELOS[perf] ||= emptyRec();
          if (clase) rec[clase] = peso;

          if (Number.isFinite(peso) && peso>0){
            const pm = r['PM'] || 'Otros';
            const claseFrom = r['CLASE_TOP'] || clase;

            MODELOS_PM[perf] ||= {};
            MODELOS_PM[perf][claseFrom] ||= {};
            MODELOS_PM[perf][claseFrom][pm] = (MODELOS_PM[perf][claseFrom][pm]||0) + peso;
          }
        });
      }

      // Normaliza vacíos
      Object.values(MODELOS).forEach(rec=>{
        ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"].forEach(k=>{
          if (!Number.isFinite(rec[k])) rec[k] = 0;
        });
      });

      const el = document.getElementById('modelInfo');

      // Sin mensaje

      // Inicializa/ajusta MODELOS_PM contra catálogo de PMs por Clase
      Object.keys(MODELOS).forEach(perf=>{
        ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"].forEach(clase=>{
          ensureModelPMFor(perf, clase);    // crea bolsas por PM según catálogo actual
          normalizePMTotals(perf, clase);   // hace que suma de PMs == % de la clase
        });
      });

    }

    // Carga/restore del CSV de Portafolios Modelo
    autoCsv('fileModelos', async (_payload, raw)=>{ 
      ingestModelRows(raw);
      populatePerfilSelector();
      // Agregar después de ingestModelRows(res.data):
      const inp = document.getElementById('fileModelos');
      await persistCsv('modelos', raw, (inp?.files?.[0]?.name || 'Portafolios_Modelo.csv'));
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    }, 'modelos', 'modelInfo');
    (async function restoreModelos(){
      const stored = await getStoredCsv('modelos');
      if (stored?.rows?.length) {
        ingestModelRows(stored.rows);
        populatePerfilSelector();
        const el = document.getElementById('modelInfo');
        // Sin mensaje de restauración
      }
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    })();

    function modelProfiles(){ return Object.keys(MODELOS); }
    function getModelForPerfil(perf){
      return MODELOS[perf] || { Liquidez:0, "Renta Fija CP":0, "Renta Fija MP":0, "Renta Variable":0, Alternativo:0 };
    }

    function ensureModelPMFor(perf, clase){
      MODELOS_PM[perf] ||= {};
      const cur = (MODELOS_PM[perf][clase] ||= {});
      const catsAct = pmCatsForClass(clase) || [];
      const catsMod = Object.keys(cur);
      const cats = Array.from(new Set([...catsAct, ...catsMod])); // UNIÓN
      cats.forEach(pm => { if(!(pm in cur)) cur[pm] = 0; });
      // NO borrar PMs que vinieron en el Modelo
    }
    function normalizePMTotals(perf, clase){
      const classPct = toNum(getModelForPerfil(perf)[clase]);
      const bag = MODELOS_PM[perf]?.[clase] || {};
      const sum = Object.values(bag).reduce((a,b)=>a+toNum(b),0);
      // Si la suma es 0, no tocar
      if (sum <= 0) return;
      // Si falta para llegar a la clase, mete el residuo en "Otros" (no redistribuir)
      if (sum < classPct - 1e-6){
        bag['Otros'] = toNum(bag['Otros']) + (classPct - sum);
        return;
      }
      // Si se pasó, escala proporcionalmente
      if (sum > classPct + 1e-6){
        const k = classPct / sum;
        Object.keys(bag).forEach(pm => bag[pm] = toNum(bag[pm]) * k);
      }
    }
    function classShareToAbs(perf, clase, pmShareWithinClassPct){
      const classPct = toNum(getModelForPerfil(perf)[clase]);
      return (classPct * toNum(pmShareWithinClassPct) / 100);
    }

    // ===== Propuesto desde Posiciones (Peso Final) =====
    function _isCashProdBySub(sub){
      const p = sub ? ACT.product_by_subprod_name.get(sub) : '';
      return (p==='CUENTA AHORRO' || p==='CUENTA CORRIENTE');
    }
    function _rebalanceoForRow(cur, r){
      const sub = r._subn || '';
      if (_isCashProdBySub(sub)){
        const base = (CASH_ACC[cur]?.get(sub)?.base)||0;
        return getDisponible(cur, sub) - base;     // ap + fxIn - fxOut - asig
      }
      return toNum(edits[cur].get(r._rid)) || 0;
    }

    // Función global para calcular Monto Final (usado en cuponera)
    function _montoFinalOf(row){
      const cur = normMoneda(row.Moneda || row.moneda || 'USD');
      const base = toNum(row.valor_mercado || 0);
      const mov = _rebalanceoForRow(cur, row);
      return base + mov;
    }

    function currentHoldingsInitialByClass(cur){
      const sumBy = Object.fromEntries(CLASES_BAL.map(c=>[c,0]));
      const rows = (LAST_HOLDINGS[cur]||[]);
      rows.forEach(r=>{
        const base  = toNum(r.valor_mercado);   // Peso Inicial = solo base
        const clase = _canonClase(r.clase||'');
        sumBy[clase] += base;
      });
      const total = Object.values(sumBy).reduce((a,b)=> a + toNum(b), 0);
      return { sumBy, total };
    }

    function currentHoldingsFinalByClass(cur){
      const sumBy = Object.fromEntries(CLASES_BAL.map(c=>[c,0]));
      const rows = (LAST_HOLDINGS[cur]||[]);
      rows.forEach(r=>{
        const base = toNum(r.valor_mercado);
        const mov  = _rebalanceoForRow(cur, r);
        const final = base + mov;
        const clase = _canonClase(r.clase||'');
        sumBy[clase] += final;
      });
      const total = Object.values(sumBy).reduce((a,b)=>a+toNum(b),0);
      return { sumBy, total };
    }

    // --- PM (subcategoría) desde Posiciones ---
    // Regla de cruce: CV→ISIN, FM→CodSubproducto, CV (fallback)→"CUENTA VALOR",
    // Cta Plazo/Divisas/CTS/Cta Corriente→Subproducto; resto: intenta ISIN/CodSub/SUB
    // Etiqueta PM canónica para un holding (derivada de Activos)
    function pmLabelForHolding(r){
      // FALLBACK PRIMERO: Si es vehículo de liquidez, retornar inmediatamente

      const vehiculo = String(r.vehiculo || '').toUpperCase();

      const producto = String(r.Producto || '').toUpperCase();

      

      // Cuentas, DPF, SMART Deposit → "Cash y Equivalentes"

      if (vehiculo.includes('CUENTA') || 

          vehiculo.includes('CTS') ||

          vehiculo.includes('DPF') ||

          vehiculo.includes('SMART') ||

          producto.includes('CUENTA AHORRO') ||

          producto.includes('CUENTA CORRIENTE') ||

          producto.includes('CUENTA INDEPENDENCIA') ||

          producto.includes('CTS') ||

          producto.includes('CUENTA A PLAZO')) {

        return 'Cash y Equivalentes';

      }



      // Ahora buscar en mapas de Activos (Subclasificacion)

      const isin = String(r._isin || r.isin || '').toUpperCase();

      const codp = String(r._codSub || r.codSub || r.codsubproducto || '').toUpperCase();

      const subn = r._subn || r.subproducto || r.Subproducto || '';



      const pm =

        (isin && ACT.pm_by_isin.get(isin)) ||

        (codp && ACT.pm_by_codprod.get(codp)) ||

        (subn && ACT.pm_by_subprod_name.get(subn)) ||

        r.subclase || r.subcategoria || '';



      // canoniza para que "EE.UU." == "EEUU", etc.

      return canonPMLabel(pm) || 'Otros';

    }

    function pmKey(clase, pm){ // clave jerárquica estable
      return `${clase}|${canonPMLabel(pm) || 'Otros'}`;
    }

    function pmForHoldRow(r){
      // Si el usuario añadió el activo a mano y ya trae subcategoría, úsala.

      if (r && r.subcategoria) return canonPMLabel(r.subcategoria);

      

      // FALLBACK PRIMERO: Si es vehículo de liquidez, retornar inmediatamente

      const vehiculo = String(r.vehiculo || '').toUpperCase();

      const producto = String(r.Producto || '').toUpperCase();

      

      // Cuentas, DPF, SMART Deposit → "Cash y Equivalentes"

      if (vehiculo.includes('CUENTA') || 

          vehiculo.includes('CTS') ||

          vehiculo.includes('DPF') ||

          vehiculo.includes('SMART') ||

          producto.includes('CUENTA AHORRO') ||

          producto.includes('CUENTA CORRIENTE') ||

          producto.includes('CUENTA INDEPENDENCIA') ||

          producto.includes('CTS') ||

          producto.includes('CUENTA A PLAZO')) {

        return 'Cash y Equivalentes';

      }

      

      // Ahora buscar en mapas de Activos (Subclasificacion)

      const isin = String(r._isin || r.isin || '').toUpperCase();

      const codp = String(r._codSub || r.codSub || r.codsubproducto || '').toUpperCase();

      const subn = r._subn || r.subproducto || r.Subproducto || '';



      const pm =

        (isin && ACT.pm_by_isin.get(isin)) ||

        (codp && ACT.pm_by_codprod.get(codp)) ||

        (subn && ACT.pm_by_subprod_name.get(subn)) ||

        r.subclase || r.subcategoria || '';



      // canoniza para que "EE.UU." == "EEUU", etc.

      return canonPMLabel(pm) || 'Otros';

    }

    // === Parametrización para Cronograma de Pagos ===
    const CRONO_IR_RATE = 0.05;   // 5% de impuesto estimado

    // Config
    const _NZ = x => Number.isFinite(+x) ? +x : 0;
    const _USD = n => (_NZ(n)).toLocaleString('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0});

    // Fuente principal: tus filas en memoria
    function _rowsPosicionesElegibles(){
      const cur  = (typeof getActiveCur==='function') ? getActiveCur() : 'USD';
      const rows = (LAST_HOLDINGS[cur] || []);
      return rows.filter(r => eligibleForCrono(r) && _couponPctOf(r) > 0);
    }

    // Lectores
    function _nameOf(r){
      return (r.nombre || r.Producto || r.Instrumento || r.Emisor || r.Bono || '').toString();
    }

    function _isinOf(r){
      return String(r._isin || r.isin || '').toUpperCase();
    }

    function _codSubOf(r){
      return String(r._codSub || r.codSub || r.codsubproducto || '').toUpperCase();
    }

    // Utilidad para leer el código desde Asesor360/Activos (nombres de columna variantes)
    function _codeOf(row){
      const v =
        row?._codSub ??
        row?.codSub ??
        row?.CodSubproducto ??
        row?.Codsubproducto ??
        row?.['Cod Subproducto'] ??
        row?.['codsubproducto'] ??
        row?.codsubproduct;
      // normaliza: quita ".0", trim
      return String(v ?? '').replace(/\.0+$/,'').trim();
    }

    function _subprodNameOf(r){
      return r._subn || r.Subproducto || r.subproducto || '';
    }

    function _pricePctOf(r){
      // distintos alias de precio % (limpio/sucio/mercado)
      const p = r['Precio Limpio'] ?? r['Precio'] ?? r['Px Limpio'] ?? r['PX'] ?? r.clean ?? r.px ?? r.precio_mercado;
      const n = Number(String(p).replace('%','').replace(',','.'));
      return Number.isFinite(n) ? n : 0;
    }

    function _ridCurOf(r){
      const pref = String(r?._rid||'').split('-')[0];
      return (pref === 'PEN') ? 'PEN' : 'USD';
    }

    function _nominalOriginalOf(r){
      // Devuelve el nominal ORIGINAL (antes de amortizaciones)
      // Usado para cálculos de cupones en bonos amortizables
      

      const vehTxt = String(r.vehiculo || '').toUpperCase();
      const isBond = r.isBond || vehTxt.includes('BONO');
      

      if (!isBond) {
        return _nominalOf(r); // No aplica para no-bonos
      }



      // 1) Obtener nominal ACTUAL

      const nominalActual = _nominalOf(r);
      

      // 2) Convertir a ORIGINAL dividiendo por factor remanente

      const isin = r._isin || r.isin || r.ISIN;
      const factorRem = calcularFactorRemanente(isin);
      

      if (factorRem > 0 && factorRem < 1) {
        // Es amortizable: convertir actual → original
        return Math.round(nominalActual / factorRem);
      }
      

      // No es amortizable: actual = original
      return nominalActual;
    }

    function _nominalOf(r){
      const vehTxt = String(r.vehiculo || '').toUpperCase();
      const isBond = r.isBond || vehTxt.includes('BONO');
      
      const nombre = r.nombre || r.Nombre || '';

      // 1) Bonos agregados (mini-modal): usa neto buy−sell en nominal (face)
      let lotNomValue = 0;
      let lotNomNet = 0; // Guardamos el valor neto (puede ser negativo para ventas)
      if (isBond && typeof lotNom === 'function') {
        try {
          const b = _bondForRow(r);
          if (b) {
            const buy = lotNom(b.id,'buy')||0;
            const sell = lotNom(b.id,'sell')||0;
            const net = buy - sell;
            lotNomNet = net; // ✅ Mantiene el valor correcto (no usar faceFrom para bondLots)
            lotNomValue = Math.abs(lotNomNet); // Valor absoluto para comparaciones
          }
        } catch(e){
        }
      }

      // 2) POSICIONES INICIALES: usa _nominalHint si existe
      const hint = r._nominalHint ?? r.nominal_hint ?? r._nomHint ?? r._nominal;
      const hintFace = faceFrom(hint);

      // ✅ SOLUCIÓN: Si hay lotNom (positivo o negativo) Y hintFace, calcular según sea compra o venta
      if (lotNomNet !== 0 && hintFace > 0) {
        // AJUSTAR hintFace por amortización ANTES de sumar
        const isin = r._isin || r.isin || r.ISIN;
        const factorRem = calcularFactorRemanente(isin);
        const hintActual = Math.round(hintFace * factorRem); // Convertir a actual
        

        const total = hintActual + lotNomNet; // Ahora ambos son nominales actuales
        return Math.max(0, total);
      }

      // Si solo hay lotNom (sin posición inicial)
      if (lotNomValue > 0) {
        return lotNomValue;
      }

      // Si solo hay hint - AJUSTAR por amortizaciones si aplica
      if (isBond && hintFace > 0) {
        const isin = r._isin || r.isin || r.ISIN;
        const factorRem = calcularFactorRemanente(isin);
        return Math.round(hintFace * factorRem);
      }

      // 3) A360 por "Unidades" (si viene en #bonos)
      if (isBond){
        const units = toNum(r.unidades ?? r.Unidades);
        const unitsFace = faceFrom(units);
        if (unitsFace > 0) {
          return unitsFace;
        }
      }

      // 4) Otros campos de nominal que pueda traer A360 / posiciones
      const n1 = r['Nominal Actual'] ?? r['Nominal'] ?? r['Saldo Nominal'] ?? r['Saldo'] ?? r.nominal ?? r.nominal_actual;
      const n1Face = faceFrom(n1);
      if (n1Face > 0) {
        return n1Face;
      }

      // 5) Aproximación genérica por VM / (Precio%/100)
      const vm = _NZ(r.valor_mercado || r.Monto || r['Monto']);
      const px = _pricePctOf(r);
      if (vm > 0 && px > 0) {
        const approx = Math.round(vm * 100 / px);
        return approx;
      }

      // 6) Último recurso
      const lastResort = vm > 0 ? Math.round(vm) : 0;
      return lastResort;
    }

    function _bondCatalogRow(row){
      const isin = normIsin(row?._isin || row?.ISIN || row?.Isin || row?.isin);
      if (!isin || !BONDS_BY_ISIN) return null;
      return BONDS_BY_ISIN.get(isin) || null;
    }

    function _couponPctOf(row){
      // Primero intentar buscar en el catálogo de bonos
      const b = _bondCatalogRow(row);
      if (b) {
        const rn = normalizeRowKeys(b);
        const raw = b['Tasa Cupon'] ?? b['Tasa Cupon (%)'] ?? b['Tasa'] ?? b['Cupon'] ?? b['Cup'] ??
                    rn['tasacupon'] ?? rn['tasacuponporcentaje'] ?? rn['tasa'] ?? rn['cupon'] ?? rn['cup'];
        if (raw != null) {
          const s = String(raw).replace(/[^\d,.\-]/g,'').replace(',','.');
          const n = parseFloat(s);
          if (Number.isFinite(n)) return n;
        }
      }
      
      // Para activos NO-BONO: buscar Dividend Yield en ACT
      const isin = String(row._isin || row.ISIN || row.isin || '').trim().toUpperCase();
      const codp = String(row._codSub || row.CodSubproducto || row.codsubproducto || '').trim();
      const subn0 = String(row._subn || row.Subproducto || row.subproducto || row.nombre || '').trim();
      const subn = typeof normTxt === 'function' ? normTxt(subn0) : subn0;
      
      // Buscar en mapas de ACT (Dividend Yield se guarda en coupon_pct_by_*)
      const pct = 
        ACT?.coupon_pct_by_isin?.get?.(isin) ??
        ACT?.coupon_pct_by_codprod?.get?.(codp) ??
        ACT?.coupon_pct_by_subprod_name?.get?.(subn) ??
        null;
      
      return (pct !== null && Number.isFinite(pct)) ? pct : 0;
    }

    function _freqOf(row){
      // Primero intentar buscar en el catálogo de bonos
      const b = _bondCatalogRow(row);
      if (b) {
        const rn = normalizeRowKeys(b);
        const raw = b['Frecuencia Cupon'] ?? b['Frecuencia'] ?? b['Freq'] ?? rn['frecuenciacupon'] ?? rn['frecuencia'] ?? rn['freq'];
        const n = raw != null ? parseInt(String(raw).trim(), 10) : NaN;
        if (Number.isFinite(n) && n > 0) return n;
      }
      
      // Para activos NO-BONO: buscar Frecuencia Cupon en ACT
      const isin = String(row._isin || row.ISIN || row.isin || '').trim().toUpperCase();
      const codp = String(row._codSub || row.CodSubproducto || row.codsubproducto || '').trim();
      const subn0 = String(row._subn || row.Subproducto || row.subproducto || row.nombre || '').trim();
      const subn = typeof normTxt === 'function' ? normTxt(subn0) : subn0;
      
      // Buscar en mapas de ACT
      const freq = 
        ACT?.freq_by_isin?.get?.(isin) ??
        ACT?.freq_by_codprod?.get?.(codp) ??
        ACT?.freq_by_subprod_name?.get?.(subn) ??
        null;
      
      return (freq !== null && Number.isFinite(freq) && freq > 0) ? freq : 2;
    }

    function _proxCuponOf(r){
      const inRow = r['Prox Cupon'] || r['Proximo Cupon'] || r['prox_cupon'] || r['Fecha Próximo Cupón'];
      if (inRow){
        const d = new Date(inRow); if (!isNaN(d)) return d;
      }
      const isin = _isinOf(r), codp=_codSubOf(r), subn=_subprodNameOf(r);
      const v =
        ACT.proxcupon_by_isin.get(isin) ||
        ACT.proxcupon_by_codprod.get(codp) ||
        ACT.proxcupon_by_subprod_name.get(subn);
      if (v) return v;

      // Fallback: bonos del mini-modal → próxima fecha según Freq/Mes1/Mes2
      const V = String(r.vehiculo||'').toUpperCase();
      if ((r.isBond || V.includes('BONO')) && Array.isArray(BONDS)) {
        const b = _bondForRow(r);
        if (b) {
          const asOf = (typeof getAsOfDate==='function') ? getAsOfDate() : new Date();
          const { next } = couponDatesAround(b, asOf);
          if (next) return next;
        }
      }
      return null;
    }

    // === Utilidades para cronograma de cupones ===
    
    // Utilidad de normalización (quita acentos, minúsculas)
    const norm = s => (s ?? '')
      .toString()
      .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // quita acentos
      .trim().toLowerCase();
    
    // ======== Helpers estrictos para D/M/Y y porcentajes ========
    function parseDMYStrict(s) {
      if (!s) return null;
      const m = String(s).trim().split(/[\/\-]/);
      if (m.length < 3) return null;
      const d = parseInt(m[0],10), mo = parseInt(m[1],10)-1, y = parseInt(m[2],10);
      if (!(d>0 && mo>=0 && y>0)) return null;
      return new Date(y, mo, d);
    }

    function pctToDec(x) {
      if (x == null || x === '') return 0;
      let s = (typeof x === 'string') ? x.replace(',', '.').trim() : String(x);
      if (s.endsWith('%')) s = s.slice(0, -1);
      return Number(s) / 100;
    }

    function sameMD(a,b){ return a && b && a.getDate()===b.getDate() && a.getMonth()===b.getMonth(); }

    // === Fechas de cupón por día/mes fijo (ignora año del primer pago; sólo día/mes) ===
    function fechasCuponBond(row, inicio, fin) {
      const cat = _bondCatalogRow(row) || {};
      const nk  = (typeof normalizeRowKeys === 'function') ? normalizeRowKeys(cat) : cat;

      const nombre = row?.nombre || row?.Nombre || cat?.Nombre || cat?.nombre || '';

      const first = parseDMYStrict(
        row?.['Fecha 1er Pago'] || row?.['Fecha 1er pago'] || row?.FirstPay ||
        cat['Fecha 1er Pago']   || cat['Fecha 1er pago']  || cat['FirstPay'] ||
        nk?.['fecha1erpago']
      );

      const freqRaw =
        _freqOf(row) ||
        row?.['Frecuencia Cupon'] || row?.['Frecuencia'] ||
        cat['Frecuencia Cupon']   || cat['Frecuencia'];

      const freq = Number(freqRaw || 2);
      
      if (!first || !freq) {
        return [];
      }

      const stepM = Math.max(1, Math.round(12 / Math.max(1, freq)));
      const day   = first.getDate();
      const mon   = first.getMonth();

      // Buscar la primera fecha de cupón ANTES o EN inicio
      let d = new Date(inicio.getFullYear(), mon, day);
      
      // Si la fecha está después de inicio, retroceder hasta encontrar la última antes de inicio
      while (d > inicio) {
        d = new Date(d.getFullYear(), d.getMonth() - stepM, day);
      }
      
      // Ahora avanzar hasta que esté >= inicio
      while (d < inicio) {
        d = new Date(d.getFullYear(), d.getMonth() + stepM, day);
      }

      const out = [];
      while (d <= fin) {
        out.push(new Date(d));
        d = new Date(d.getFullYear(), d.getMonth() + stepM, day);
      }
      
      return out;
    }

    // === Monto simple del cupón por período (sin días hábiles; día exacto) ===
    function montoCuponBond(row) {
      const freq   = Number(_freqOf(row) || row?.['Frecuencia'] || 2);
      const cupPct = Number(_couponPctOf(row));
      const cupDec = (cupPct > 1 ? cupPct/100 : cupPct);
      const nom    = Number(_nominalOf(row) || 0);
      if (!(freq > 0 && cupDec > 0 && nom > 0)) return 0;
      return nom * (cupDec / freq);
    }

    // Cupón ajustado por amortizaciones en la fecha exacta
    function montoCuponBondEnFecha(row, d) {
      const isin = String(row?.ISIN || row?.Isin || row?.isin || row?._isin || '').trim().toUpperCase();
      const cupPct = Number(_couponPctOf(row));
      const freq = Number(_freqOf(row) || 2);
      if (!(isin && cupPct > 0 && freq > 0)) return 0;

      const cupDec = cupPct > 1 ? cupPct / 100 : cupPct;
      const baseNom = Number(_nominalOriginalOf(row) || 0);
      if (!(baseNom > 0)) return 0;

      const amort = AMORTS_BY_ISIN ? AMORTS_BY_ISIN[isin] : undefined;
      if (!amort) return baseNom * (cupDec / freq);

      // baseNom ya es ORIGINAL (gracias a _nominalOriginalOf)
      // Solo aplicar el factor remanente antes de la fecha del cupón
      const fracPrev = amortPrevFrac(isin, d);
      return baseNom * fracPrev * (cupDec / freq);
    }

    // b) Parseo y utilidades de fecha/clave de mes
    const MESES_ES = ['ENE','FEB','MAR','ABR','MAY','JUN','JUL','AGO','SEP','OCT','NOV','DIC'];

    function parseDate(v) {
      if (!v) return null;
      // Soporta "YYYY-MM-DD", "DD/MM/YYYY", Date, etc.
      if (v instanceof Date) return v;
      const s = String(v).trim();
      // Intenta ISO:
      const iso = new Date(s);
      if (!isNaN(+iso)) return new Date(iso.getFullYear(), iso.getMonth(), iso.getDate());
      // Intenta D/M/Y:
      const m = s.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})$/);
      if (m) {
        const dd = +m[1], mm = +m[2]-1, yy = +m[3] < 100 ? 2000 + (+m[3]) : +m[3];
        return new Date(yy, mm, dd);
      }
      return null;
    }
    function claveMes(d) {
      return `${MESES_ES[d.getMonth()]} ${String(d.getFullYear()).slice(-2)}`; // p.ej. "NOV 25"
    }

    function entreInclusivo(d, ini, fin) {
      const t = +d;
      return t >= +ini && t <= +fin; // INCLUSIVO en ambos bordes
    }

    // Helpers de día hábil US (fin de semana + feriados observados)
    function isWeekend(d){
      const wd = d.getDay(); // 0=Dom,6=Sáb
      return wd === 0 || wd === 6;
    }

    // utilidades para feriados US "regla fija"
    function nthWeekdayOfMonth(year, month, weekday, n){
      // weekday: 0=Dom..6=Sáb; n=1..5
      const first = new Date(year, month, 1);
      const offset = (7 + weekday - first.getDay()) % 7;
      return new Date(year, month, 1 + offset + 7*(n-1));
    }

    function lastWeekdayOfMonth(year, month, weekday){
      const last = new Date(year, month+1, 0);
      const offset = (7 + last.getDay() - weekday) % 7;
      return new Date(year, month+1, 0 - offset);
    }

    function observedFixedHoliday(year, month, day){
      // Observa feriado si cae en fin de semana
      const d = new Date(year, month, day);
      if (d.getDay() === 0) return new Date(year, month, day + 1); // domingo → lunes
      if (d.getDay() === 6) return new Date(year, month, day - 1); // sábado → viernes
      return d;
    }

    // Feriados US "comunes" (suficiente para tu uso de cupones)
    function isUSHoliday(d){
      const y = d.getFullYear(), m = d.getMonth(), day = d.getDate();

      // Fijos (observados)
      const newYear = observedFixedHoliday(y, 0, 1);    // Jan 1
      const juneteenth = observedFixedHoliday(y, 5, 19);// Jun 19
      const independence = observedFixedHoliday(y, 6, 4);// Jul 4
      const christmas = observedFixedHoliday(y, 11, 25);// Dec 25
      // Lunes/jueves "móviles"
      const mlk = nthWeekdayOfMonth(y, 0, 1, 3);        // 3er lunes de enero
      const presidents = nthWeekdayOfMonth(y, 1, 1, 3); // 3er lunes de febrero
      const memorial = lastWeekdayOfMonth(y, 4, 1);     // último lunes de mayo
      const labor = nthWeekdayOfMonth(y, 8, 1, 1);      // 1er lunes de septiembre
      const thanksgiving = nthWeekdayOfMonth(y, 10, 4, 4); // 4º jueves de noviembre

      const sameDay = (a,b)=> a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate();
      const list = [newYear, mlk, presidents, memorial, independence, labor, thanksgiving, juneteenth, christmas];
      return list.some(h => sameDay(h, d));
    }

    function nextBusinessDayUS(d){
      let x = new Date(d.getFullYear(), d.getMonth(), d.getDate());
      // avanza hasta que no sea fin de semana ni feriado
      while (isWeekend(x) || isUSHoliday(x)){
        x.setDate(x.getDate() + 1);
      }
      return x;
    }

    function prevBusinessDayUS(d0){
      let d = new Date(d0.getFullYear(), d0.getMonth(), d0.getDate());
      while (isWeekend(d) || isUSHoliday(d)){
        d.setDate(d.getDate() - 1);   // ← retrocede hasta día hábil US
      }
      return d;
    }

    // Normalizadores simples (reusan normTxt)
    const _N = (s)=> normTxt(s);

    // Canoniza Vehículo a etiquetas canónicas usadas por la whitelist
    function canonVeh(v){
      const x = _N(v);
      if (!x) return '';
      if (x === 'BEST') return 'BEST';
      if (x === 'ETF' || x === 'ETFS') return 'ETF';
      if (x === 'REIT' || x === 'REITS') return 'REIT';
      if (x === 'ACCION' || x === 'ACCIONES') return 'ACCIONES';
      if (x === 'PAPEL COMERCIAL' || x === 'PAPELES COMERCIALES' || x.includes('PAPEL COMERCIAL')) return 'PAPELES COMERCIALES';
      if (x === 'BONO' || x === 'BONOS' || x.includes('BONO')) return 'BONO'; // captura "Bonos", "Bono corporativo", etc.
      return x;
    }

    // Combinaciones permitidas (normalizadas)
    const CRONO_ALLOWED_VEH = new Set(['BONO','BEST','PAPELES COMERCIALES','ETF','REIT','ACCIONES']);

    // Grupos permitidos para PRODUCTO = FONDOS MUTUOS
    const FM_ALLOWED_GROUPS = new Set(['FONDO DISTRIBUTIVO', 'POOL DE BONOS']);

    // Utilidades para filtro directo desde columnas
    const VEH_PERMITIDOS = new Set([
      'etf','acciones','best','bono','bonos','papeles comerciales','reit','reits'
    ]);


    function pasaFiltroCupones(row){
      const { prod, veh, gprod } = _prodVehGroupOf(row);
      const code = _codeOf(row);
      return _allowedCombo(prod, veh, gprod, code);
    }

    // - FONDOS MUTUOS => sólo CodSub ∈ {382,582,622}
    // - CUENTA VALOR  => Vehículo en whitelist; si Vehículo=BEST => Grupo=CLN
    function _allowedCombo(prod, veh, gprod, code){
      const P = _N(prod);
      const V = typeof canonVeh === 'function' ? canonVeh(veh) : _N(veh);
      const G = _N(gprod);
      const C = String(code||'').trim();

      // Fondos mutuos por grupo
      if (P === 'FONDOS MUTUOS') return FM_ALLOWED_GROUPS.has(G);

      // Cuenta Valor por vehículo
      if (P !== 'CUENTA VALOR') return false;
      if (!CRONO_ALLOWED_VEH.has(V)) return false;
      if (V === 'BEST') return G === 'CLN';
      return true;
    }

    // Calcula Producto/Vehículo/Grupo desde Activos para una fila de Posiciones
    function _prodVehGroupOf(row){
      const isin = String(row._isin || row.isin || '').toUpperCase();
      const subn = row._subn || row.subproducto || row.Subproducto || '';
      const code = _codeOf(row);

      // Producto: mapas de Activos -> fallback de la fila
      let prod =
        (subn && ACT.product_by_subprod_name.get(subn)) ||
        row.Producto || row.producto || '';

      // Vehículo: mapas de Activos -> fallback de la fila
      let veh =
        (isin && ACT.veh_by_isin.get(isin)) ||
        (subn && ACT.veh_by_subprod_name.get(subn)) ||
        row.Vehiculo || row.vehiculo || '';

      // Grupo: mapas de Activos -> fallback de la fila
      const gprod =
        (isin && ACT.group_by_isin.get(isin)) ||
        (code && ACT.group_by_codprod.get(code)) ||
        (subn && ACT.group_by_subprod_name.get(subn)) ||
        row['Grupo Producto'] || row.grupoproducto || row.grupo || '';

      // Bonos sintéticos: si es bono y no hay Producto, fuerza "CUENTA VALOR"
      const vCanon = typeof canonVeh === 'function' ? canonVeh(veh) : veh;
      if (!prod && (row.isBond || (vCanon && vCanon.toUpperCase().includes('BONO')))) {
        prod = 'CUENTA VALOR';
      }

      return { prod, veh: vCanon || veh, gprod };
    }

    // Elegibilidad estricta para Cronograma de Pagos
    function eligibleForCrono(row){
      const { prod, veh, gprod } = _prodVehGroupOf(row);
      const code = _codeOf(row); // lee CodSubproducto desde Asesor360/Activos
      return _allowedCombo(prod, veh, gprod, code);
    }

    function currentHoldingsInitialByPM(cur){
      const sumBy = {};
      let total = 0;
      const rows = (LAST_HOLDINGS[cur] || []);

      rows.forEach(r=>{
        const base = toNum(r.valor_mercado);
        const pm = pmForHoldRow(r);
        sumBy[pm] = (sumBy[pm]||0) + base;
        total += base;
      });

      return { sumBy, total };
    }

    function currentHoldingsFinalByPM(cur){
      const sumBy = {};
      let total = 0;
      const rows = (LAST_HOLDINGS[cur] || []);

      rows.forEach(r=>{
        const base  = toNum(r.valor_mercado);
        const mov   = _rebalanceoForRow(cur, r);      // ya existe en el archivo
        const final = base + mov;
        const pm = pmForHoldRow(r);
        sumBy[pm] = (sumBy[pm]||0) + final;
        total += final;
      });

      return { sumBy, total };
    }

    // --- % Inicial por Clase+PM (denominador: total de la moneda activa)
    function currentHoldingsInitialByClassPM(cur){
      const sumBy = {}; let total = 0;
      const rows = (LAST_HOLDINGS[cur] || []);
      rows.forEach(r=>{
        const key = pmKey(r.clase || '', pmLabelForHolding(r));
        const base = toNum(r.valor_mercado);
        sumBy[key] = (sumBy[key]||0) + base;
        total += base;
      });
      return { sumBy, total };
    }

    // --- % Final por Clase+PM (USA montoFinalOf: incluye Rebalanceo y Peso Final)
    function currentHoldingsFinalByClassPM(cur){
      const sumBy = {}; let total = 0;
      const rows = (LAST_HOLDINGS[cur] || []);
      rows.forEach(r=>{
        const key = pmKey(r.clase || '', pmLabelForHolding(r));
        // Calcular monto final: base + rebalanceo (usa la misma lógica que renderHoldingsTables)
        const base = toNum(r.valor_mercado);
        const sub  = r._subn || '';
        const prod = sub ? ACT.product_by_subprod_name.get(sub) : '';
        const isCash = (prod === 'CUENTA AHORRO' || prod === 'CUENTA CORRIENTE' || prod === 'CTS');
        
        let final;
        if (isCash) {
          const ap  = toNum(APORTES[cur]?.get(sub) || 0);
          const fx  = (toNum(FX_IN[cur]?.get(sub) || 0) - toNum(FX_OUT[cur]?.get(sub) || 0));
          const asg = toNum(ASIG[cur]?.get(sub) || 0);
          final = base + ap + fx - asg;
        } else {
          final = base + (toNum(edits[cur]?.get(r._rid)) || 0);
        }
        
        sumBy[key] = (sumBy[key]||0) + final;
        total += final;
      });
      return { sumBy, total };
    }

    // ===== Render del mini-modal =====
    let balanceChart = null;
    let ACTIVE_BAL_CUR = 'USD';
    const BANDA_10 = 0.10;

    function fmtMoneyCur(v, cur){ return fmtMoney(v, cur); }

    // Escala Y "bonita" en %: añade ~4pp de aire y ajusta a múltiplos 5/10/20
    function nicePctAxis(values){
      const arr = (values||[]).map(v=>Number(v)||0);
      const m = Math.max(0, ...arr);
      const target = Math.min(100, m + 8);           // más aire arriba
      let step = 5;
      if (target > 25 && target <= 60) step = 10;
      else if (target > 60)            step = 20;    // 61–100 → cada 20%
      const max = Math.min(100, Math.ceil(target / step) * step);
      return { max, step };
    }

    const PERFIL_ORDER = ['Altamente Conservador','Conservador','Moderado','Agresivo'];

    function populateBalancePerfil(){
      const sel = document.getElementById('balPerfilSel'); if(!sel) return;
      const keep = sel.value || '';
      const perfDash = (document.getElementById('perfil')?.value || '').trim();

      const list = modelProfiles();
      // Orden requerido
      const ordered = PERFIL_ORDER.filter(p=>list.includes(p))
        .concat(list.filter(p=>!PERFIL_ORDER.includes(p))); // extra que no estén en la lista

      sel.innerHTML = ordered.map(p=>`<option>${p}</option>`).join('');

      // default → PERFIL del Dashboard si existe; si no, 1º de la lista; si había selección previa válida, respétala
      if (keep && ordered.includes(keep))       sel.value = keep;
      else if (perfDash && ordered.includes(perfDash)) sel.value = perfDash;
      else if (ordered.length)                  sel.value = ordered[0];
    }

    function renderBalance(){
      const cur = ACTIVE_BAL_CUR;
      const perf = document.getElementById('balPerfilSel')?.value || '';
      const modelo = getModelForPerfil(perf);                           // %

      // % Modelo (desde MODELOS)
      const modPct  = CLASES_BAL.map(c => toNum(modelo[c]));

      // % Actual (Peso Inicial) desde Posiciones
      const { sumBy: initBy,  total: totInit }  = currentHoldingsInitialByClass(cur);
      const actPct  = CLASES_BAL.map(c => totInit>0 ? (initBy[c]/totInit*100) : 0);

      // % Propuesto (Peso Final) desde Posiciones
      const { sumBy: finalBy, total: totFinal } = currentHoldingsFinalByClass(cur);
      const propPct = CLASES_BAL.map(c => totFinal>0 ? (finalBy[c]/totFinal*100) : 0);

      // Para la tabla: "Asignado" y el denominador vienen del Peso Final
      const sumBy = finalBy;
      const total = totFinal;

      // Eje Y dinámico con las tres series
      const allPct = [...modPct, ...actPct, ...propPct];
      const { max: yMax, step: yStep } = nicePctAxis(allPct);

      // Chart
      const ctx = document.getElementById('balanceChart')?.getContext('2d');
      if (ctx){
        if (balanceChart) balanceChart.destroy();
        balanceChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: CLASES_BAL,
            datasets: [
              { label:'Portafolio Modelo',    data: modPct,  backgroundColor:'#060E46' },
              { label:'Portafolio Actual',    data: actPct,  backgroundColor:'#CAD1D8' },
              { label:'Portafolio Propuesto', data: propPct, backgroundColor:'#9694FF' }
            ]
          },
          options:{
            responsive:true, maintainAspectRatio:false,
            layout:{ padding:{ top: 18 } },
            plugins:{
              legend:{ display:true, position:'bottom' },
              datalabels:{ anchor:'end', align:'end', formatter:(v)=> (Number(v).toFixed(1)+'%'), color:'#333', font:{weight:'bold', size:11} }
            },
            scales:{
              x:{ grid:{display:false} },
              y:{
                beginAtZero:true,
                min:0,
                max:yMax,                       // ← dinámico
                grid:{ display:false },
                ticks:{ stepSize:yStep, callback:(v)=> v + '%' }
              }
            }
          },
          plugins:[ChartDataLabels]
        });
      }

      // --- Tabla mini (Mín / P. Modelo / Máx / Actual / Propuesto / OW-UW) ---
      const tb = document.getElementById('tablaBalanceBody'); if (!tb) return;
      tb.innerHTML='';

      let totMin=0, totSug=0, totMax=0, totAct=0, totProp=0, totDel=0;

      CLASES_BAL.forEach(c=>{
        const sug = totFinal * (toNum(modelo[c])/100);  // P. Modelo en moneda activa
        const min = Math.max(0, sug - totFinal*BANDA_10);
        const max = Math.min(totFinal, sug + totFinal*BANDA_10);

        const act = initBy[c];   // Actual (Peso Inicial, USD/PEN)
        const prop = finalBy[c]; // Propuesto (Peso Final, USD/PEN)
        const del = prop - sug;  // OW/UW vs P. Modelo

        totMin += min; totSug += sug; totMax += max;
        totAct += act; totProp += prop; totDel += del;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="left">${c}</td>
          <td class="num">${fmtMoneyCur(min, cur)}</td>
          <td class="num">${fmtMoneyCur(sug, cur)}</td>
          <td class="num">${fmtMoneyCur(max, cur)}</td>
          <td class="num">${fmtMoneyCur(act, cur)}</td>
          <td class="num">${fmtMoneyCur(prop, cur)}</td>
          <td class="num" style="color:${del>=0?'#001391':'#9694FF'}">${fmtMoneyCur(del, cur)}</td>`;
        tb.appendChild(tr);
      });

      // Totales (Min/Max vacíos)
      document.getElementById('balMinTot').textContent = '';
      document.getElementById('balSugTot').textContent = fmtMoneyCur(totSug, cur); // P. Modelo
      document.getElementById('balMaxTot').textContent = '';
      document.getElementById('balActTot').textContent = fmtMoneyCur(totAct, cur); // Actual
      document.getElementById('balAsiTot').textContent = fmtMoneyCur(totProp, cur); // Propuesto
      document.getElementById('balDelTot').textContent = fmtMoneyCur(totDel, cur);  // OW/UW
    }

    function openBalanceModal(){
      const m = document.getElementById('modalBalance'); if(!m) return;
      // Moneda activa según Posiciones
      const holdKey = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || 'hold-usd';
      ACTIVE_BAL_CUR = (holdKey==='hold-pen') ? 'PEN' : 'USD';

      populateBalancePerfil();
      renderBalance();
      m.classList.add('show');
    }
    function closeBalanceModal(){
      document.getElementById('modalBalance')?.classList.remove('show');
    }

    // Wiring del modal Balance
    (function wireBalance(){
      document.getElementById('balanceClose')?.addEventListener('click', closeBalanceModal);
      document.getElementById('modalBalance')?.addEventListener('click', (e)=>{ if(e.target.id==='modalBalance') closeBalanceModal(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeBalanceModal(); });

      // Tabs USD/PEN
      document.querySelectorAll('#bal-subtabs .subtab').forEach(st=>{
        st.addEventListener('click', function(){
          document.querySelectorAll('#bal-subtabs .subtab').forEach(x=>x.classList.remove('active'));
          st.classList.add('active');
          ACTIVE_BAL_CUR = (st.dataset.sub==='bal-pen') ? 'PEN' : 'USD';
          renderBalance();
        });
      });

      // Cambiar perfil
      document.getElementById('balPerfilSel')?.addEventListener('change', renderBalance);

      // Botón de apertura (reemplaza el TODO que ya tienes)
      const btn = document.getElementById('btnBalance');
      if (btn && !btn.dataset.boundBal){
        btn.addEventListener('click', openBalanceModal);
        btn.dataset.boundBal = '1';
      }
    })();
    
    // Atajo de carga: dLoadAssets -> fileActivos.click()
    document.getElementById('dLoadAssets')?.addEventListener('click', ()=>{
      document.getElementById('fileActivos')?.click();
    });
    // Placeholder - listener será agregado por wireBalance()
    document.getElementById('btnCurvaDPF')?.addEventListener('click', ()=> window.openDPFModal && window.openDPFModal());
    document.getElementById('btnMatrizBono')?.addEventListener('click', ()=> window.openMatrizBonosModal && window.openMatrizBonosModal());

    // Commit Aportes: Enter / blur
    function commitAporte(cur){
      const side = (cur==='USD')?'u':'p';
      const inputEl = document.getElementById(`sf-${side}-monto`);
      const valorSinComas = String(inputEl?.value).replace(/,/g, '');
      const nuevoTotal = Math.round(toNum(valorSinComas));
      
      if(!Number.isFinite(nuevoTotal)) return;
      
      // Calcular delta
      const totalAnterior = SALDOS_FRESCOS[cur];
      const delta = nuevoTotal - totalAnterior;
      
      if (delta === 0) return; // Sin cambios
      
      // Validar cuenta activa
      const cuentaActiva = CUENTA_ACTIVA[cur];
      if (!cuentaActiva) {
        const inputRef = inputEl;
        const nuevoValor = nuevoTotal;
        
        mostrarPopupSeleccionCuenta(cur, function() {
          inputRef.value = nuevoValor;
          inputRef.dispatchEvent(new Event('change', { bubbles: true }));
        });
        
        inputEl.value = totalAnterior > 0 ? totalAnterior.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
        return;
      }
      
      const rowCuenta = (LAST_HOLDINGS[cur] || []).find(r => r._rid === cuentaActiva._rid);
      if (!rowCuenta) {
        alert('Error: No se encontró la cuenta activa.');
        inputEl.value = totalAnterior > 0 ? totalAnterior.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
        return;
      }
      
      const valorCuenta = toNum(rowCuenta.valor_mercado);
      const editCuenta = toNum(edits[cur].get(cuentaActiva._rid)) || 0;
      const saldoCuenta = valorCuenta + editCuenta;
      
      let deltaFinal = delta;
      
      // Si QUITAS saldos frescos (delta negativo), necesitas fondos en cuenta
      if (delta < 0) {
        const retiro = Math.abs(delta);
        
        if (retiro > saldoCuenta) {
          // Ejecutar parcialmente
          deltaFinal = -saldoCuenta;
          const totalEjecutado = totalAnterior + deltaFinal;
          
          alert('Saldo Insuficiente: Operación ejecutada hasta agotar saldo');
          inputEl.value = totalEjecutado > 0 ? totalEjecutado.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
        }
      }
      
      // APLICAR: saldos frescos SUMAN a cuenta
      edits[cur].set(cuentaActiva._rid, editCuenta + deltaFinal);
      
      // Actualizar total de saldos frescos
      SALDOS_FRESCOS[cur] += deltaFinal;
      
      // Mantener el valor formateado en el input
      inputEl.value = SALDOS_FRESCOS[cur] > 0 ? SALDOS_FRESCOS[cur].toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
      
      // Actualizar vistas
      renderCashMgmtUI(); 
      renderCashBars(); 
      renderHoldingsTables(LAST_HOLDINGS); 
      renderRentaFijaTables();
      renderPortafolioBonos();
      
    }
    ['sf-u-monto','sf-p-monto'].forEach(id=>{
      const input = document.getElementById(id);
      if (!input) return;
      
      // Formateo en tiempo real mientras escribe
      input.addEventListener('input', e => {
        const cursorPos = e.target.selectionStart;
        const valorAnterior = e.target.value;
        const longitudAnterior = valorAnterior.length;
        
        // Remover todo excepto números
        const limpio = valorAnterior.replace(/[^\d]/g, '');
        
        // Formatear con comas
        const formateado = limpio ? parseInt(limpio, 10).toLocaleString('en-US') : '';
        
        // Actualizar valor
        e.target.value = formateado;
        
        // Ajustar posición del cursor
        const longitudNueva = formateado.length;
        const diferencia = longitudNueva - longitudAnterior;
        e.target.setSelectionRange(cursorPos + diferencia, cursorPos + diferencia);
      });
      
      // Enter y focusout ejecutan commitAporte
      input.addEventListener('keydown', e=>{ if(e.key==='Enter') commitAporte(id.includes('-u-')?'USD':'PEN'); });
      input.addEventListener('focusout', ()=> commitAporte(id.includes('-u-')?'USD':'PEN'));
    });

    // Commit FX: Enter en Monto o TC
    function commitFx(cur){
      const isUSD = (cur==='USD');
      const side = isUSD?'u':'p';
      const inputAmt = document.getElementById(`fx-${side}-amt`);
      const inputTC = document.getElementById(`fx-${side}-tc`);
      
      const valorAmt = String(inputAmt?.value).replace(/,/g, '');
      const nuevoTotal = Math.round(toNum(valorAmt));
      const tc = toNum(inputTC?.value);
      
      // Validar TC
      if (!Number.isFinite(tc) || tc <= 0) {
        alert('Debe ingresar un Tipo de Cambio válido');
        return;
      }

      if (!Number.isFinite(nuevoTotal)) return;
      
      // Calcular delta
      const totalAnterior = FX_TOTALES[cur];
      const delta = nuevoTotal - totalAnterior;
      
      if (delta === 0) return; // Sin cambios
      
      // Validar cuentas activas en AMBAS monedas
      const cuentaOrigen = CUENTA_ACTIVA[cur];
      const toCur = isUSD ? 'PEN' : 'USD';
      const cuentaDestino = CUENTA_ACTIVA[toCur];
      
      if (!cuentaOrigen || !cuentaDestino) {
        const inputRef = inputAmt;
        const totalRef = totalAnterior;
        
        mostrarPopupSeleccionCuentaFX(function() {
          inputRef.dispatchEvent(new Event('change', { bubbles: true }));
        });
        
        inputAmt.value = totalAnterior > 0 ? totalAnterior.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
        return;
      }
      
      // Obtener información de cuenta origen
      const rowOrigen = (LAST_HOLDINGS[cur] || []).find(r => r._rid === cuentaOrigen._rid);
      if (!rowOrigen) {
        alert('Error: No se encontró la cuenta origen.');
        inputAmt.value = totalAnterior > 0 ? totalAnterior.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
        return;
      }
      
      // Validar fondos disponibles para el DELTA
      const valorOrigen = toNum(rowOrigen.valor_mercado);
      const editOrigen = toNum(edits[cur].get(cuentaOrigen._rid)) || 0;
      const saldoOrigen = valorOrigen + editOrigen;
      
      let deltaFinal = delta;
      
      // Si aumentas FX (delta positivo), necesitas más fondos en origen
      if (delta > 0) {
        if (delta > saldoOrigen) {
          // Ejecutar parcialmente
          deltaFinal = saldoOrigen;
          const totalEjecutado = totalAnterior + deltaFinal;
          
          alert('Saldo Insuficiente: Operación ejecutada hasta agotar saldo');
          inputAmt.value = totalEjecutado > 0 ? totalEjecutado.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
          
          FX_TOTALES[cur] = totalEjecutado;
        } else {
          // Operación completa
          FX_TOTALES[cur] = nuevoTotal;
          inputAmt.value = nuevoTotal > 0 ? nuevoTotal.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
        }
      } else {
        // Si reduces FX (delta negativo), devuelves fondos a origen
        FX_TOTALES[cur] = nuevoTotal;
        inputAmt.value = nuevoTotal > 0 ? nuevoTotal.toLocaleString('en-US', {maximumFractionDigits: 0, useGrouping: true}) : '';
      }
      
      // Calcular monto destino del delta
      const amtToDelta = isUSD ? (deltaFinal * tc) : (deltaFinal / tc);
      
      // Aplicar cambios a cuentas (DELTA)
      edits[cur].set(cuentaOrigen._rid, editOrigen - deltaFinal); // Sale de origen
      
      const rowDestino = (LAST_HOLDINGS[toCur] || []).find(r => r._rid === cuentaDestino._rid);
      const editDestino = toNum(edits[toCur].get(cuentaDestino._rid)) || 0;
      edits[toCur].set(cuentaDestino._rid, editDestino + amtToDelta); // Entra a destino
      
      // Guardar TC usado
      FX_TC[cur] = tc;
      
      // Actualizar vistas
      renderCashMgmtUI(); 
      renderCashBars(); 
      renderHoldingsTables(LAST_HOLDINGS); 
      renderRentaFijaTables();
      renderPortafolioBonos();
      
    }
    [['fx-u-amt','USD'],['fx-u-tc','USD'],['fx-p-amt','PEN'],['fx-p-tc','PEN']]
      .forEach(([id,cur])=> {
        const input = document.getElementById(id);
        if (!input) return;
        
        // Formateo en tiempo real SOLO para inputs de monto (fx-u-amt, fx-p-amt)
        if (id.includes('-amt')) {
          input.addEventListener('input', e => {
            const cursorPos = e.target.selectionStart;
            const valorAnterior = e.target.value;
            const longitudAnterior = valorAnterior.length;
            
            // Remover todo excepto números
            const limpio = valorAnterior.replace(/[^\d]/g, '');
            
            // Formatear con comas
            const formateado = limpio ? parseInt(limpio, 10).toLocaleString('en-US') : '';
            
            // Actualizar valor
            e.target.value = formateado;
            
            // Ajustar posición del cursor
            const longitudNueva = formateado.length;
            const diferencia = longitudNueva - longitudAnterior;
            e.target.setSelectionRange(cursorPos + diferencia, cursorPos + diferencia);
          });
        }
        
        // Enter ejecuta commitFx
        input.addEventListener('keydown', e=>{ if(e.key==='Enter') commitFx(cur); });
      });

    // Asignación: función reutilizable
    function commitAsignacion(cur, sub, val){
      const v = toNum(val);
      if (v === 0) ASIG[cur].delete(sub); else ASIG[cur].set(sub, v);
      renderCashMgmtUI();
      renderHoldingsTables(LAST_HOLDINGS);
      renderRentaFijaTables();
      renderPortafolioBonos();
      renderCashBars();
    }

    // Asignación: focusout + Enter
    const asigUTbl = document.getElementById('asig-u-table');
    asigUTbl?.addEventListener('focusout', (e)=>{
      const t = e.target; if(!t.classList.contains('asig-u-inp')) return;
      commitAsignacion('USD', t.dataset.sub, t.value);
    });
    asigUTbl?.addEventListener('keydown', (e)=>{
      const t = e.target; if(!t.classList.contains('asig-u-inp')) return;
      if (e.key === 'Enter'){ e.preventDefault(); commitAsignacion('USD', t.dataset.sub, t.value); }
    });

    const asigPTbl = document.getElementById('asig-p-table');
    asigPTbl?.addEventListener('focusout', (e)=>{
      const t = e.target; if(!t.classList.contains('asig-p-inp')) return;
      commitAsignacion('PEN', t.dataset.sub, t.value);
    });
    asigPTbl?.addEventListener('keydown', (e)=>{
      const t = e.target; if(!t.classList.contains('asig-p-inp')) return;
      if (e.key === 'Enter'){ e.preventDefault(); commitAsignacion('PEN', t.dataset.sub, t.value); }
    });


    // Borrar FX y Saldos Frescos por cuenta
    document.getElementById('asig-u-table')?.addEventListener('click', (e)=>{
      const t = e.target;
      if(t.classList.contains('fxDel') && !t.classList.contains('sfDel')){
        const sub = t.dataset.sub;
        FX_LOG = FX_LOG.filter(op => !((op.fromCur==='USD' && op.fromSub===sub) || (op.toCur==='USD' && op.toSub===sub)));
        recomputeFxMaps(); renderCashMgmtUI(); renderCashBars(); renderHoldingsTables(LAST_HOLDINGS); renderRentaFijaTables(); renderPortafolioBonos();
      }
      if(t.classList.contains('sfDel')){
        const sub = t.dataset.sub; APORTES.USD.delete(sub);
        renderCashMgmtUI(); renderCashBars(); renderHoldingsTables(LAST_HOLDINGS); renderRentaFijaTables(); renderPortafolioBonos();
      }
    });
    document.getElementById('asig-p-table')?.addEventListener('click', (e)=>{
      const t = e.target;
      if(t.classList.contains('fxDel') && !t.classList.contains('sfDel')){
        const sub = t.dataset.sub;
        FX_LOG = FX_LOG.filter(op => !((op.fromCur==='PEN' && op.fromSub===sub) || (op.toCur==='PEN' && op.toSub===sub)));
        recomputeFxMaps(); renderCashMgmtUI(); renderCashBars(); renderHoldingsTables(LAST_HOLDINGS); renderRentaFijaTables(); renderPortafolioBonos();
      }
      if(t.classList.contains('sfDel')){
        const sub = t.dataset.sub; APORTES.PEN.delete(sub);
        renderCashMgmtUI(); renderCashBars(); renderHoldingsTables(LAST_HOLDINGS); renderRentaFijaTables(); renderPortafolioBonos();
      }
    });

    // =========================
    // Recuperar datos de IndexedDB al cargar
    // =========================
    (async function restoreOnBoot(){
      await restoreCsv('asesor360', (rows, meta) => {
        ingestRows(rows);
        const el = document.getElementById('csvInfo');
        // Sin mensaje de restauración
      });
      await restoreCsv('activos', (rows, meta) => {
        ingestActivosRows(rows);
        const el = document.getElementById('actInfo');
        // Sin mensaje de restauración
      });
      await restoreCsv('activos2',  (rows, meta) => {
        ACTIVOS2 = (rows||[]).map(mapOtrosActivoRow).filter(Boolean);
        window.ACTIVOS2 = ACTIVOS2;                       // mantén sincronizado
        const el = document.getElementById('otrosActInfo');
        // Sin mensaje de restauración
      });
      if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
    })();
  </script>

  <!-- ============ Modal: Agregar Otros Activos (mismo shell que + Bonos) ============ -->
  <div id="modalActivos" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(7,14,70,.32);z-index:10010;">
    <div class="bonos-shell">
      <!-- Header (mismo estilo; píldora a la derecha) -->
      <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid #e1e4e8;">
        <div style="display:flex;gap:6px;">
          <button class="subtab active" id="tabSelActivos">Seleccionar Otros Activos</button>
        </div>
        <div id="minActTag" class="pill" style="display: none;">Moneda activa: <span id="minActCur" class="amount">USD</span></div>
        <button id="activosCerrar" title="Cerrar" style="background:transparent;border:none;font-size:18px;color:#070E46;cursor:pointer;">✕</button>
      </div>
      <!-- Body (usa bonos-body para tipografías, paddings, scroll, etc.) -->
      <div class="bonos-body">
        <!-- 1 sola línea, sin labels (placeholders en los selects) -->
        <div class="filters-act">
          <input  id="faBusca" type="text" placeholder="Buscar activo"/>
          <select id="faClase"></select>
          <select id="faVeh"></select>
          <select id="faReg"></select>
          <select id="faSub"></select>
        </div>
        <div class="table-wrapper" style="margin-top:10px;">
          <table id="tablaActivos">
            <thead>
              <tr>
                <th class="left">Activo</th>
                <th class="left">Clase</th>
                <th class="left">Vehículo</th>
                <th class="left">Categoría</th>
                <th class="left">Región</th>
                <th class="left">Exposición</th>
                <th class="center"></th>   <!-- sin cabecera -->
                <th class="center"></th>   <!-- sin cabecera -->
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- MINI MODAL: Ficha de Activo (idéntico a miniInfo de Bonos) -->
  <div id="miniInfoAsset" role="dialog" aria-modal="true">
    <div class="panel">
      <div class="head">
        <div id="miniInfoAssetTitle">Ficha del activo</div>
        <button class="close" id="miniInfoAssetClose" title="Cerrar">✕</button>
      </div>
      <div class="body" id="miniInfoAssetBody"></div>
    </div>
  </div>

  <!-- POPUP: Configuración CLN -->
  <div id="popupCLNConfig" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(7,14,70,.4);z-index:10020;">
    <div style="background:#fff;border-radius:12px;padding:24px;width:400px;box-shadow:0 12px 40px rgba(0,0,0,.2);">
      <h3 style="margin:0 0 20px;color:var(--bbva-primary);">Configuración CLN</h3>
      
      <label style="display:block;margin-bottom:8px;font-weight:600;">Fecha de Inicio (dd/mm/aaaa)</label>
      <input type="text" id="clnFechaInicio" placeholder="01/01/2025" style="width:100%;padding:8px;margin-bottom:16px;border:1px solid #e1e4e8;border-radius:4px;">
      
      <label style="display:block;margin-bottom:8px;font-weight:600;">Tasa Cupón (%)</label>
      <input type="number" id="clnTasaCupon" step="0.01" placeholder="5.00" style="width:100%;padding:8px;margin-bottom:16px;border:1px solid #e1e4e8;border-radius:4px;">
      
      <label style="display:block;margin-bottom:8px;font-weight:600;">Fecha de Fin (calculada, editable)</label>
      <input type="text" id="clnFechaFin" placeholder="09/01/2030" style="width:100%;padding:8px;margin-bottom:20px;border:1px solid #e1e4e8;border-radius:4px;">
      
      <div style="display:flex;gap:12px;justify-content:flex-end;">
        <button id="clnConfigCancel" class="btn" style="background:#6c757d;">Cancelar</button>
        <button id="clnConfigOk" class="btn">Confirmar</button>
      </div>
    </div>
  </div>

  <script>
  // === Modal "Agregar Otros Activos" — abrir/cerrar + wiring básico ===
  (function wireAddAssetsModal(){
    const open = () => {
      const m = document.getElementById('modalActivos'); if (!m) return;
      // Moneda activa (exactamente como en Bonos)
      const holdKey = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || 'hold-usd';
      const cur = (holdKey==='hold-pen') ? 'PEN' : 'USD';
      const pill = document.getElementById('minActCur'); if (pill) pill.textContent = cur;
      document.body.style.overflow = 'hidden'; // mismo bloqueo que + Bonos
      m.style.display = 'flex';
      ensureAssetsFilters();        // usa ACTIVOS2 y Moneda activa
      if (typeof renderActivosModal === 'function') {
        renderActivosModal();   // usa tu implementación si ya existe
      } else {
        renderActivosModal_fallback();  // versión mínima (más abajo)
      }
    };
    const close = () => {
      const m = document.getElementById('modalActivos');
      if (m) m.style.display = 'none';
      document.body.style.overflow = '';
    };

    const btnOpen  = document.getElementById('btnAddAssets');  // compat si existiera
    const btnClose = document.getElementById('activosCerrar');
    if (btnOpen && !btnOpen.dataset.bound) { btnOpen.addEventListener('click', open); btnOpen.dataset.bound = '1'; }
    if (btnClose && !btnClose.dataset.bound){ btnClose.addEventListener('click', close); btnClose.dataset.bound='1'; }

    // Compatibilidad: si existe el botón actual 'btnAddActivos', también abre
    const btnOpenAlt = document.getElementById('btnAddActivos'); // botón real en Posiciones
    if (btnOpenAlt && !btnOpenAlt.dataset.boundAct){ btnOpenAlt.addEventListener('click', open); btnOpenAlt.dataset.boundAct = '1'; }

    // Cerrar al clickear el fondo
    const modal = document.getElementById('modalActivos');
    if (modal && !modal.dataset.bound){ modal.addEventListener('click', (e)=>{ if (e.target === modal) close(); }); modal.dataset.bound = '1'; }
  })();

  function getActiveCur(){           // por qué: alinear moneda con sub‑tab Posiciones
    const key = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || 'hold-usd';
    return key==='hold-pen' ? 'PEN' : 'USD';
  }

  function _datasetOtrosActivos(){
    const cur = getActiveCur();
    return (ACTIVOS2||[]).filter(a => (a.moneda||'USD') === cur);
  }

  function ensureAssetsFilters(){
    // arma combos con valores únicos de ACTIVOS2 (solo moneda activa)
    const uniq = (arr) => Array.from(new Set((arr||[]).filter(Boolean))).sort((a,b)=> String(a).localeCompare(String(b),'es',{sensitivity:'base'}));
    const setOpts = (sel, arr, label) => {
      if (!sel) return;
      const keep = sel.value || '';
      sel.innerHTML = `<option value="">${label}</option>`;
      uniq(arr).forEach(v => sel.appendChild(new Option(v, v)));
      if (keep && (arr||[]).includes(keep)) sel.value = keep;
    };

    const clase = document.getElementById('faClase');
    const veh   = document.getElementById('faVeh');
    const reg   = document.getElementById('faReg');
    const sub   = document.getElementById('faSub');

    const DS = _datasetOtrosActivos();
    setOpts(clase, DS.map(a=>a.clase),  'Todas las clases');
    setOpts(veh,   DS.map(a=>a.veh),    'Todos los vehículos');
    setOpts(reg,   DS.map(a=>a.geo||a.region), 'Todas las regiones');
    setOpts(sub,   DS.map(a=>a.expo),   'Todas las exposiciones');
  }

  function _rowMatchesA360(meta, cur){
    if (!window.CURRENT_CODE) return false;
    const rows = window.A360ByCode.get(window.CURRENT_CODE) || [];
    for (const src of rows){
      const r = normalizeRowKeys(src);
      const subn = normTxt(pick(r,['subproducto','nombre']));
      const prodRaw = normTxt(pick(r,['producto']));
      const isinR = normIsin(pick(r,['isin']));
      const codpR = normCodprod(pick(r,['codsubproduct','codsubproducto','subproduct_id']));
      const rowCur = guessCurrency(r, prodRaw, isinR, codpR, subn);
      if (rowCur !== cur) continue;
      // Match estricto por ISIN o CodSubproducto; fallback por nombre
      if (meta.prod === 'CUENTA VALOR' && meta.isin && isinR && meta.isin === isinR) return true;
      if (meta.prod === 'FONDOS MUTUOS' && meta.codSub && codpR && meta.codSub === codpR) return true;
      if (normTxt(meta.inst) && (normTxt(meta.inst) === subn)) return true;
    }
    return false;
  }
  // YA existe en Posiciones (USD/PEN)
  function _rowExistsInHoldings(meta, cur){
    const rows = (LAST_HOLDINGS[cur] || []);
    const N = normTxt(meta.inst);
    return rows.some(r=>{
      if (meta.prod === 'CUENTA VALOR'  && meta.isin   && r._isin)   return r._isin   === meta.isin;
      if (meta.prod === 'FONDOS MUTUOS' && meta.codSub && r._codSub) return r._codSub === meta.codSub;
      return normTxt(r.nombre) === N;
    });
  }
  function _rowAlreadyInState(meta){
    return (state?.cartera||[]).some(r => !r.isBond && normTxt(r.inst) === normTxt(meta.inst));
  }

  function renderActivosModal_fallback(){
    const tb = document.querySelector('#tablaActivos tbody');
    if (!tb) return;
    tb.innerHTML = '';

    const DS = _datasetOtrosActivos();
    if (!Array.isArray(DS) || !DS.length){
      const tr = document.createElement('tr');
      tr.innerHTML = `<td colspan="8" class="left" style="opacity:.8">
        No hay activos cargados. Usa el Centro de datos → <strong>Seleccionar Otros Activos</strong>.
      </td>`;
      tb.appendChild(tr);
      return;
    }

    const q   = (document.getElementById('faBusca')?.value || '').trim().toLowerCase();
    const cla = document.getElementById('faClase')?.value || '';
    const veh = document.getElementById('faVeh')?.value || '';
    const reg = document.getElementById('faReg')?.value || '';
    const sub = document.getElementById('faSub')?.value || '';

    const pass = (a, f) => !f || String(a||'') === String(f);

    const cur = getActiveCur();
    const rows = DS.filter(a=>{
      const hitQ = !q || [a.inst, a.grupo, a.expo, a.veh, a.geo].join(' ').toLowerCase().includes(q);
      return hitQ && pass(a.clase, cla) && pass(a.veh, veh) && pass(a.geo, reg) && pass(a.expo, sub);
    });

    if (!rows.length){
      const tr = document.createElement('tr');
      tr.innerHTML = `<td colspan="8" class="left" style="opacity:.8">Sin resultados con los filtros.</td>`;
      tb.appendChild(tr);
      return;
    }

    rows.forEach(a=>{
      const exists = _rowExistsInHoldings(a, cur) || _rowMatchesA360(a, cur); // evitar duplicados en Posiciones o A360
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="left">${a.inst}</td>
        <td class="left">${a.clase||''}</td>
        <td class="left">${a.veh||''}</td>
        <td class="left">${a.grupo||''}</td>
        <td class="left">${a.geo||'Global'}</td>
        <td class="left">${a.expo||''}</td>
        <td class="center">
          <button class="btn-addplus btn-addplus--row" data-add="${encodeURIComponent(a.inst)}" ${exists?'disabled':''}>
            <span class="addplus-icon" aria-hidden="true">+</span>
          </button>
        </td>
        <td class="center">
          <button class="icon-btn" data-info="${encodeURIComponent(a.inst)}" title="Info" aria-label="Info">i</button>
        </td>
      `;
      tb.appendChild(tr);
    });

    // acciones: Añadir / Info
    tb.onclick = (e)=>{
      const btn = e.target.closest('button');
      if (!btn) return;
      if (btn.dataset.add){
        addAssetToPortfolio(decodeURIComponent(btn.dataset.add));
      } else if (btn.dataset.info){
        openAssetMiniInfo(decodeURIComponent(btn.dataset.info));
      }
    };
  }

  // re‑render al filtrar
  ;['faBusca','faClase','faVeh','faReg','faSub'].forEach(id=>{
    const el = document.getElementById(id);
    if (el && !el.dataset.bound){
      el.addEventListener('input',  ()=> (typeof renderActivosModal==='function'?renderActivosModal():renderActivosModal_fallback()));
      el.addEventListener('change', ()=> (typeof renderActivosModal==='function'?renderActivosModal():renderActivosModal_fallback()));
      el.dataset.bound = '1';
    }
  });

  // Inserta en POSICIONES (LAST_HOLDINGS) y deja el mini-modal ABIERTO
  function addAssetToPortfolio(inst){
    const meta = (ACTIVOS2||[]).find(a => a.inst === inst);
    if (!meta) return alert('No se encontró el activo.');
    const cur = getActiveCur();

    // Duplicados: A360 o Posiciones (misma moneda)
    if (_rowMatchesA360(meta, cur))      { alert('El activo ya existe en Asesor360 para esta moneda.'); return; }
    if (_rowExistsInHoldings(meta, cur)) { alert('El activo ya está en Posiciones.'); return; }

    // Clase y RID estables
    const claseCalc = mapClassFromActivos(meta.prod, normTxt(meta.inst), meta.isin, meta.codSub) || meta.clase || 'Renta Fija MP';
    
    // RID único y estable (sin colisiones entre "Otros Activos")
    const isinOk = !!(meta.isin && String(meta.isin).trim());
    const codOk  = !!(meta.codSub && String(meta.codSub).trim() !== '' && String(meta.codSub) !== '0');
    const nameKey = normTxt(meta.inst).replace(/[^A-Z0-9]+/g,'_'); // fallback estable por nombre

    const ridBase =
      isinOk ? `CV-${meta.isin}` :
      (codOk ? `FM-${meta.codSub}` : `INST-${nameKey}`);

    let rid = `${cur}-OA-${ridBase}`;

    // Si por cualquier motivo ya existe, añade sufijo breve para garantizar unicidad
    if ((LAST_HOLDINGS[cur] || []).some(r => r._rid === rid)) {
      rid += '-' + Date.now().toString(36).slice(-4);
    }

    // Resolver Subcategoría (PM) para la columna "Subclase de Activo"
    // ATENCIÓN: en el índice se llama pm_by_*, no subcategoria_by_*
    const subcat =
      (meta.isin   && ACT.pm_by_isin.get(meta.isin)) ||
      (meta.codSub && ACT.pm_by_codprod.get(meta.codSub)) ||
      (normTxt(meta.inst) && ACT.pm_by_subprod_name.get(normTxt(meta.inst))) ||
      '';

    // Para cálculos/agrupaciones usamos la misma etiqueta canonizada
    const pm = subcat;

    // Fila sintética mínima: el rebalanceo se edita en Posiciones
    const row = {
      nombre: meta.inst,

      prod:      meta.prod || '',
      Producto:  meta.prod || '',

      clase:  claseCalc,
      fecha_compra: '',
      costo_compra: 0,
      unidades: 0,
      precio_mercado: 0,
      valor_mercado: 0,
      gp_no_realizada: 0,

      vehiculo: meta.veh || '',
      Moneda: cur,  // ← CRÍTICO: siempre presente

      grupo:           meta.grupo || '',
      grupoproducto:   meta.grupo || '',

      region:   subcat,
      subclase: meta.expo || '',
      subcategoria: subcat,

      _rid: rid,
      _subn: normTxt(meta.inst),
      _isin:   meta.isin   || '',
      _codSub: meta.codSub || '',
      _min: toNum(meta?._min) || 0,
      _pmLabel: canonPMLabel(pm),
      clnFechaInicio: null,
      clnTasaCupon: null,
      clnFechaFin: null
    };

    // --- Normalización específica para DPF (CUENTA A PLAZO) ---
    const isDPF = String(meta.veh||'').toUpperCase()==='DPF'
               && String(meta.prod||'').toUpperCase().includes('CUENTA A PLAZO');
    if (isDPF) {
      row.Producto = 'CUENTA VALOR';
      row.vehiculo = 'DPF';
      row.fechavcto = meta.fvencimientodet || meta['f.vencimientodet'] || meta.venc || meta.fechavcto || '';
      
      if (!row.fechavcto && Number.isFinite(meta._plazo)) {
        const d = new Date();
        d.setMonth(d.getMonth() + Number(meta._plazo));
        row.fechavcto = `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;
      }
      
      // Agregar tasa al nombre para que la cuponera la pueda extraer
      if (meta._tasa && !row.nombre.includes('%')) {
        // Quitar lo que está entre paréntesis
        const nombreLimpio = row.nombre.replace(/\s*\([^)]*\)/g, '').trim();
        const tasaStr = Number(meta._tasa).toFixed(2);
        row.nombre = `Nuevo ${nombreLimpio} - ${tasaStr}% ${row.fechavcto}`;
      }
      
      // Calcular plazo en formato "M###" o "D###" para cuponera
      if (Number.isFinite(meta._plazo)) {
        const meses = meta._plazo;
        row.plazo = `M${String(meses).padStart(3, '0')}`;
      }
    }

    (LAST_HOLDINGS[cur] ||= []).push(row);

    // Refrescar Posiciones (sin cerrar el mini-modal)
    renderHoldingsTables(LAST_HOLDINGS);
    renderRentaFijaTables();
    renderPortafolioBonos();
    renderRentaVariableTables();
    renderPortafolioTables();
    renderCashBars();
    try{ window.showToast?.(`Añadido: ${meta.inst}`); }catch(_){}

    // Re-pintar la lista para marcar como "Añadido"
    renderActivosModal_fallback();
  }

  function travelToHoldingsAndFocus(rid, cur){
    // Activar USD/PEN
    const want = (cur==='PEN') ? 'hold-pen' : 'hold-usd';
    document.querySelectorAll('#hold-subtabs .subtab').forEach(x=>{
      x.classList.toggle('active', x.dataset.sub===want);
    });
    document.getElementById('subview-hold-usd')?.classList.toggle('active', want==='hold-usd');
    document.getElementById('subview-hold-pen')?.classList.toggle('active', want==='hold-pen');
    document.getElementById('pillUSD')    ?.style.setProperty('display', want==='hold-usd' ? 'inline-flex' : 'none');
    document.getElementById('pillPEN')    ?.style.setProperty('display', want==='hold-pen' ? 'inline-flex' : 'none');
    // Enfocar input de rebalanceo
    setTimeout(()=>{
      const t = document.querySelector(`.cv-input[data-id="${rid}"]`);
      if (t){ t.focus(); t.scrollIntoView({block:'center'}); }
    }, 0);
  }

  function openAssetMiniInfo(inst){
    const a = (ACTIVOS2||[]).find(x => x.inst === inst);
    if (!a) return;
    const title = document.getElementById('miniInfoAssetTitle');
    if (title) title.textContent = a.inst || 'Ficha del activo';

    const body = document.getElementById('miniInfoAssetBody');
    if (!body) return;
    const pct = (x)=> (x==null || x==='') ? ' - ' : (String(x).includes('%') ? x : `${Number(x).toFixed(2)}%`);
    body.innerHTML = `
      <div style="display:grid;grid-template-columns:160px 1fr;gap:6px 12px;">
        <div>Producto</div><div>${a.prod||'-'}</div>
        <div>Moneda</div><div>${a.moneda||'USD'}</div>
        <div>Clase</div><div>${a.clase||'-'}</div>
        <div>Vehículo</div><div>${a.veh||'-'}</div>
        <div>Categoría</div><div>${a.grupo||'-'}</div>
        <div>Región</div><div>${a.geo||'Global'}</div>
        <div>Exposición</div><div>${a.expo||'-'}</div>
        ${a.isin   ? `<div>ISIN</div><div>${a.isin}</div>` : ''}
        ${a.codSub ? `<div>CodSubproducto</div><div>${a.codSub}</div>` : ''}
        ${a.IGHY   ? `<div>IG/HY</div><div>${a.IGHY}</div>` : ''}
        ${a._indice_ref ? `<div>Índice de referencia</div><div>${a._indice_ref}</div>` : ''}
        ${isFinite(+a._patrimonio) ? `<div>Patrimonio (mm)</div><div>${(+a._patrimonio).toLocaleString('en-US')}</div>` : ''}
        ${a._n_holdings ? `<div>N. Holdings</div><div>${a._n_holdings}</div>` : ''}
        ${a._vol ? `<div>Volatilidad</div><div>${a._vol}</div>` : ''}
        ${a._pe ? `<div>P/E</div><div>${a._pe}</div>` : ''}
        ${a._div_yield ? `<div>Dividend Yield</div><div>${pct(a._div_yield)}</div>` : ''}
        ${a._dur ? `<div>Duración*</div><div>${a._dur}</div>` : ''}
        ${(a._tasa||a._cupon) ? `<div>Tasa / Cupón*</div><div>${a._tasa || a._cupon}</div>` : ''}
        ${a._min ? `<div>Monto mínimo</div><div>${a._min}</div>` : ''}
        ${a._desc_fondo ? `<div style="grid-column:1/-1;color:#586069;margin-top:6px">Descripción</div><div style="grid-column:1/-1">${a._desc_fondo}</div>` : ''}
      </div>
      ${(a._dur || a._tasa || a._cupon) ? `<div class="small" style="opacity:.8;margin-top:8px"><em>* Valores reportados por el proveedor del instrumento.</em></div>`:''}
    `;
    const modal = document.getElementById('miniInfoAsset');
    if (!modal) return;
    modal.style.display = 'flex';
    const doClose = (e)=>{ 
      if (!e || e?.target?.id === 'miniInfoAssetClose' || e?.target === modal) {
        modal.style.display = 'none';
      }
    };
    modal.onclick = doClose;
    document.getElementById('miniInfoAssetClose').onclick = doClose;
    document.addEventListener('keydown', function onEsc(ev){
      if(ev.key==='Escape'){ doClose(); document.removeEventListener('keydown', onEsc); }
    });
  }

  // ===== Mini-modal Curva DPF (fuente: "Seleccionar Otros Activos") =====
  let dpfChart = null;

  function dpfIsMeta(a){
    const prodOK = String(a?.prod || '').toUpperCase().includes('CUENTA A PLAZO'); // incluye "CUENTA A PLAZO"
    const vehOK  = String(a?.veh  || '').trim().toUpperCase() === 'DPF';           // EXACTO "DPF"
    return prodOK && vehOK;
  }
  function dpfGroups(cur){
    return Array.from(new Set((window.ACTIVOS2||[])
      .filter(a => a && a.moneda === cur && dpfIsMeta(a))
      .map(a => a.grupo).filter(Boolean)))
      .sort((a,b)=>String(a).localeCompare(String(b),'es',{numeric:true}));
  }
  function dpfMonthsFrom(a){
    const v = Number(a?._plazo || 0);
    if (v>0){
      if (v>36 && v<366) return Math.round(v/30); // días -> meses
      return v;
    }
    const text = String(a?.inst||'').toLowerCase();
    let m = text.match(/(\d+(?:[.,]\d+)?)\s*(m|mes|meses)\b/);
    if(m) return Math.round(parseFloat(m[1].replace(',','.')));
    m = text.match(/(\d+(?:[.,]\d+)?)\s*(a|ano|años|anio)\b/);
    if(m) return Math.round(parseFloat(m[1].replace(',','.'))*12);
    m = text.match(/(\d+(?:[.,]\d+)?)\s*d/);
    if(m) return Math.round(parseFloat(m[1].replace(',','.'))/30);
    return null;
  }
  function dpfPoints(cur, group){
    const map = new Map(); // months -> [tasas]
    (window.ACTIVOS2||[]).forEach(a=>{
      if (!a || a.moneda!==cur || !dpfIsMeta(a)) return;
      if (group && a.grupo!==group) return;
      const x = dpfMonthsFrom(a);
      const y = Number(a?._tasa);
      if (!x || !isFinite(y)) return;
      const arr = map.get(x) || [];
      arr.push(y);
      map.set(x, arr);
    });
    const pts = Array.from(map.entries()).map(([x, arr]) => ({x:Number(x), y: arr.reduce((s,v)=>s+v,0)/arr.length}));
    pts.sort((p,q)=>p.x-q.x);
    return pts;
  }

  // --- Config & helpers para Rangos ---
  const DPF_NONE = "__NINGUNO__";

  function dpfGroupMin(label){
    const m = String(label).match(/\d[\d.,]*/);
    return m ? parseInt(m[0].replace(/[.,]/g,''),10) : Number.POSITIVE_INFINITY;
  }
  function isDefaultRange(label){
    const nums = String(label).match(/\d[\d.,]*/g);
    if (!nums || nums.length < 2) return false;
    const toInt = s => parseInt(s.replace(/[.,]/g,''),10);
    return toInt(nums[0])===500 && toInt(nums[1])===19999; // $500 a 19,999
  }

  const USD_DEFAULT_LABEL = '$500 - 19,999';

  function normLabel(s){ return String(s||'').toUpperCase().replace(/\s+/g,'').replace(/,/g,''); }
  function isDefaultUSDLabel(s){ return normLabel(s) === normLabel(USD_DEFAULT_LABEL); }
  function isDefaultPENLabel(s){
    const t = normLabel(s);
    // Soporta "S/2K - 9,999" y "S/2,000 - 9,999"
    return t.includes('S/2K-9999') || t.includes('S/2000-9999');
  }
  function promoteTop(list, predicate){
    const i = list.findIndex(predicate);
    if (i > 0){ const [x] = list.splice(i,1); list.unshift(x); }
  }

  function populateDPFSelectors(){
    const uSel = document.getElementById('dpfSelUSD');
    const pSel = document.getElementById('dpfSelPEN');
    if (!uSel || !pSel) return;

    const sortAsc = (arr)=> arr.slice().sort((a,b)=> dpfGroupMin(a) - dpfGroupMin(b));

    // Listas ordenadas ascendente
    const usd = sortAsc(dpfGroups('USD'));
    const pen = sortAsc(dpfGroups('PEN'));

    // SUBIR por requerimiento: USD = "$500 - 19,999" / PEN = "S/2K - 9,999"
    promoteTop(usd, isDefaultUSDLabel);
    promoteTop(pen, isDefaultPENLabel);

    const prevUSD = uSel.value;
    const prevPEN = pSel.value;

    const buildOptions = (list)=>
      list.map(g=>`<option>${g}</option>`).join('') + `<option value="${DPF_NONE}">Ninguno</option>`;

    uSel.innerHTML = buildOptions(usd);
    pSel.innerHTML = buildOptions(pen);

    const setDefault = (sel, list, prev, cur) => {
      if (prev && (prev === DPF_NONE || list.includes(prev))) { sel.value = prev; return; }
      let def = null;
      if (cur === 'USD') def = list.find(isDefaultUSDLabel);
      if (cur === 'PEN') def = list.find(isDefaultPENLabel);
      sel.value = def || list[0] || DPF_NONE;   // si no existe, toma el 1ro de la lista
    };

    setDefault(uSel, usd, prevUSD, 'USD');  // default USD → "$500 - 19,999" y 1º en la lista
    setDefault(pSel, pen, prevPEN, 'PEN');  // default PEN → "S/2K - 9,999" y 1º en la lista
  }

  const FIXED_X_TICKS = [2, 3, 6, 9, 12, 24, 36];

  // --- Y máx = (máxima tasa + 1%) redondeado HACIA ABAJO en saltos de 0.5 ---
  function dpfYMax(datasets){
    let maxY = -Infinity;
    datasets?.forEach(ds=>{
      (ds?.data||[]).forEach(p=>{
        const y = Number(p?.y);
        if (Number.isFinite(y) && y > maxY) maxY = y;
      });
    });
    if (!Number.isFinite(maxY)) return 2; // fallback si no hay datos
    const up1 = maxY + 1;                 // +1%
    return Math.floor(up1 * 2) / 2;       // ↓ a múltiplos de 0.5
  }

  function renderDPFCurve(){
    const sUSD = document.getElementById('dpfSelUSD')?.value || DPF_NONE;
    const sPEN = document.getElementById('dpfSelPEN')?.value || DPF_NONE;

    const showUSD = document.getElementById('showUSDLabels')?.checked ?? true;
    const showPEN = document.getElementById('showPENLabels')?.checked ?? true;

    const datasets = [];
    if (sUSD !== DPF_NONE) {
      datasets.push({
        label:'USD',
        data: dpfPoints('USD', sUSD),
        tension:.15, pointRadius:4, borderWidth:2,
        borderColor:'#060E46', fill:false,
        pointBackgroundColor:'#060E46', pointBorderColor:'#060E46',
        datalabels:{ display: !!showUSD }
      });
    }
    if (sPEN !== DPF_NONE) {
      datasets.push({
        label:'PEN',
        data: dpfPoints('PEN', sPEN),
        tension:.15, pointRadius:4, borderWidth:2,
        borderColor:'#CAD1D8', fill:false,
        pointBackgroundColor:'#CAD1D8', pointBorderColor:'#CAD1D8',
        datalabels:{ display: !!showPEN }
      });
    }

    const yMax = dpfYMax(datasets);

    const ctx = document.getElementById('dpfChart2')?.getContext('2d');
    if (!ctx) return;
    if (dpfChart) dpfChart.destroy();

    dpfChart = new Chart(ctx, {
      type: 'line',
      data: { datasets },
      options: {
        responsive:true, maintainAspectRatio:false, parsing:false,
        plugins:{
          legend:{
            display:true,
            position:'bottom',
            labels:{
              usePointStyle:false,
              boxWidth:28,
              boxHeight:2,
              // línea horizontal del color del dataset
              generateLabels: (chart) => {
                const ds = chart.data.datasets || [];
                return ds.map((d,i)=>({
                  text: d.label,
                  datasetIndex: i,
                  hidden: !chart.isDatasetVisible(i),
                  strokeStyle: d.borderColor,
                  fillStyle: d.borderColor,
                  lineWidth: d.borderWidth ?? 2
                }));
              }
            }
          },
          datalabels:{ anchor:'end', align:'top', formatter:(v)=> (Number(v.y).toFixed(2)+'%') }
        },
        scales:{
          x: {
            type: 'linear',
            min: 0,     // margen 0→2 (no se etiqueta)
            max: 38,    // margen 36→38 igual al de la izquierda
            offset: false,
            title: { display: true, text: 'Plazo (meses)' },
            grid: { display: false },
            ticks: {
              autoSkip: false,
              stepSize: 1,
              maxTicksLimit: 100,
              callback: (v) => ( [2,3,6,9,12,24,36].includes(Number(v)) ? v : '' )
            }
          },
          y: {
            min: 0,
            max: yMax,
            beginAtZero: true,
            title: { display: true, text: 'Tasa (%)' },
            grid: { display: false }
          }
        }
      },
      plugins:[ChartDataLabels]
    });

    bindDPFCanvasDblClick();

    const hint = document.getElementById('dpfHint');
    if (hint) {
      if (datasets.length === 0)       hint.textContent = 'Seleccione un rango (o active al menos una moneda).';
      else if (datasets.every(ds=>!ds.data.length)) hint.textContent = 'Sin datos para el/los rangos elegidos.';
      else                             hint.textContent = '';
    }
  }
  function openDPFModal(){
    const modal = document.getElementById('modalDPF');
    if (!modal) return;
    populateDPFSelectors();
    renderDPFCurve();
    modal.classList.add('show');
  }
  function closeDPFModal(){
    const modal = document.getElementById('modalDPF');
    if (modal) modal.classList.remove('show');
  }

  // === DPF: añadir al portafolio con doble clic en un punto ===
  function dpfFindCandidate(cur, group, months, rate){
    const rows = (window.ACTIVOS2||[]).filter(a=>{
      if (!a || a.moneda !== cur) return false;
      if (!dpfIsMeta(a)) return false;                   // Producto "CUENTA A PLAZO" y Vehículo "DPF"
      if (group && group !== DPF_NONE && a.grupo !== group) return false;
      const m = dpfMonthsFrom(a);
      if (m !== months) return false;
      return Number.isFinite(a._tasa);
    });
    if (!rows.length) return null;
    if (Number.isFinite(rate)) {
      rows.sort((r1, r2)=> Math.abs(r1._tasa - rate) - Math.abs(r2._tasa - rate)); // el más cercano a la tasa graficada
    }
    return rows[0];
  }

  function addDPFInstance(meta){
    const cur = meta.moneda || 'USD';
    // Siempre NUEVO: RID único (no mergea con existentes)
    const rid = `${cur}-DPF-${(meta._plazo||'M')}-${Date.now().toString(36)}${Math.random().toString(36).slice(2,6)}`;
    const row = {
      nombre: meta.inst,
      clase:  'Renta Fija CP',
      fecha_compra: '', costo_compra: 0, unidades: 0,
      precio_mercado: 0, valor_mercado: 0, gp_no_realizada: 0,
      vehiculo: 'DPF',
      Producto: 'CUENTA VALOR',
      Moneda: cur,
      fechavcto: meta.fvencimientodet || meta['f.vencimientodet'] || meta.venc || meta.fechavcto || '',
      region: meta.geo || '', subclase: meta.expo || '',
      _rid: rid, _subn: normTxt(meta.inst), _isin: meta.isin || '', _codSub: meta.codSub || '',
      _min: toNum(meta?._min) || 0          // <<--- NUEVO
    };
    
    // Si no tiene fecha de vencimiento, derivarla del plazo
    if (!row.fechavcto && Number.isFinite(meta._plazo)) {
      const d = new Date(); d.setMonth(d.getMonth() + Number(meta._plazo));
      row.fechavcto = `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;
    }
    (LAST_HOLDINGS[cur] ||= []).push(row);
    renderHoldingsTables(LAST_HOLDINGS);
    renderCashBars();
    try{ window.showToast?.(`Añadido DPF: ${meta.inst}`); }catch(_){}
    travelToHoldingsAndFocus(rid, cur); // navega a Posiciones y enfoca el input de CV
  }

  function onDPFChartDblClick(evt){
    if (!dpfChart) return;
    const els = dpfChart.getElementsAtEventForMode(evt, 'nearest', {intersect:true}, true);
    if (!els || !els.length) return;
    const el = els[0];
    const ds = dpfChart.data.datasets[el.datasetIndex];
    const cur = (ds.label === 'PEN') ? 'PEN' : 'USD';
    const months = Math.round(ds.data[el.index].x);
    const rate   = Number(ds.data[el.index].y);

    const group = (cur==='USD')
      ? (document.getElementById('dpfSelUSD')?.value || '')
      : (document.getElementById('dpfSelPEN')?.value || '');

    const meta = dpfFindCandidate(cur, group, months, rate)
             || dpfFindCandidate(cur, group, months, NaN)
             || dpfFindCandidate(cur, '',     months, NaN);

    if (!meta) { alert('No se encontró el DPF para ese punto.'); return; }
    addDPFInstance(meta);
  }

  function bindDPFCanvasDblClick(){
    const cv = document.getElementById('dpfChart2');
    if (cv && !cv._dpfBound) {
      cv.addEventListener('dblclick', onDPFChartDblClick);
      cv._dpfBound = true;
    }
  }

  // Wire & export a window para el listener del paso 2
  (function wireDPF(){
    document.getElementById('dpfClose')?.addEventListener('click', closeDPFModal);
    document.getElementById('modalDPF')?.addEventListener('click', (e)=>{ if(e.target.id==='modalDPF') closeDPFModal(); });
    ['dpfSelUSD','dpfSelPEN'].forEach(id=>{
      document.getElementById(id)?.addEventListener('change', renderDPFCurve);
    });
    ['showUSDLabels','showPENLabels'].forEach(id=>{
      document.getElementById(id)?.addEventListener('change', renderDPFCurve);
    });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeDPFModal(); });
    // export
    window.openDPFModal = openDPFModal;
    window.populateDPFSelectors = populateDPFSelectors;
    window.renderDPFCurve = renderDPFCurve;
  })();

  // ===== Mini-modal: + Matriz de Bonos (fuente: "Seleccionar Bonos") =====
  let matrizChart = null;
  let pmChart = null;   // gráfico de Portafolios Modelo (Clase — PM)
  let ACTIVE_MATRIX_CUR = 'USD';

  function _activeHoldCurrency(){
    const key = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || 'hold-usd';
    return key==='hold-pen' ? 'PEN' : 'USD';
  }
  function _uniqSorted(arr){ return Array.from(new Set(arr.filter(Boolean))).sort((a,b)=> String(a).localeCompare(String(b),'es',{sensitivity:'base'})); }

  // Paso de X dinámico (1, 2 o 3) según rango
  function xStepFor(range){
    const s = Math.ceil(range/8);
    return Math.max(1, Math.min(3, s));
  }

  function getMulti(sel){
    if (!sel) return [];
    return Array.from(sel.selectedOptions).map(o=>o.value).filter(Boolean);
  }
  function setMulti(sel, values){
    if (!sel) return;
    const want = new Set(values||[]);
    Array.from(sel.options).forEach(opt => opt.selected = want.has(opt.value));
  }

  // === Multi-dropdown (usa el <select multiple> oculto como modelo de datos) ===
  // opts: { search: true/false, searchPlaceholder: '...' }
  function ensureMultiDropdownUI(selectId, placeholder, opts={}) {
    const sel = document.getElementById(selectId);
    if (!sel) return;

    // Crear wrapper + botón + panel si no existen
    let wrap = document.getElementById(selectId + 'Wrap');
    if (!wrap){
      wrap = document.createElement('div');
      wrap.id = selectId + 'Wrap';
      wrap.style.position = 'relative';
      wrap.style.display  = 'inline-block';
      wrap.style.flex     = sel.style.flex || '0 0 auto';
      sel.parentNode.insertBefore(wrap, sel.nextSibling);

      // Botón que simula el select (respeta tus anchos/altura)
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.id   = selectId + 'Btn';
      btn.style.cssText =
        `height:${sel.style.height||'28px'};` +
        (sel.style.minWidth ? `min-width:${sel.style.minWidth};` : '') +
        (sel.style.maxWidth ? `max-width:${sel.style.maxWidth};` : '') +
        `padding:6px 28px 6px 8px;border:1px solid var(--border-light);border-radius:6px;` +
        `background:#fff;color:var(--text-primary);white-space:nowrap;`;
      btn.textContent = placeholder;
      btn.style.position = 'relative';
      btn.style.display  = 'inline-flex';
      btn.style.alignItems = 'center';
      wrap.appendChild(btn);

      // Flechita tipo <select>
      let car = document.getElementById(selectId + 'Caret');
      if (!car){
        car = document.createElement('span');
        car.id = selectId + 'Caret';
        car.style.cssText = 'position:absolute; right:10px; top:50%; transform:translateY(-50%); ' +
                            'width:10px; height:6px; pointer-events:none;';
        car.innerHTML = '<svg width="10" height="6" viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">' +
                        '<path d="M1 1l4 4 4-4" stroke="#001391" stroke-width="2" fill="none" ' +
                        'stroke-linecap="round" stroke-linejoin="round"/></svg>';
        btn.appendChild(car); // ← dentro del botón (no en el wrapper)
      }

      // Panel flotante con checkboxes
      const panel = document.createElement('div');
      panel.id = selectId + 'Panel';
      panel.className = 'multiPanel';
      panel.style.cssText =
        'position:absolute;z-index:10050;top:calc(100% + 4px);left:0;' +
        'background:#fff;border:1px solid var(--border-light);border-radius:6px;' +
        'box-shadow:0 8px 24px rgba(0,0,0,.08);padding:8px;display:none;' +
        'max-height:260px;overflow:auto;min-width:220px;';
      wrap.appendChild(panel);

      // Toggle panel
      btn.addEventListener('click', ()=>{
        const open = panel.style.display !== 'block';
        document.querySelectorAll('.multiPanel').forEach(p=> p.style.display='none');
        panel.style.display = open ? 'block' : 'none';

        // ancho = botón (mín. 220px), siempre hacia ABAJO
        const w = Math.max(220, btn.offsetWidth);
        panel.style.left = '0';
        panel.style.right = 'auto';
        panel.style.minWidth = w + 'px';
        panel.style.maxWidth = w + 'px';
        panel.style.overflowX = 'hidden';
        panel.style.overflowY = 'auto';

        // evita scroll horizontal de la fila al abrir
        const rowWrap = wrap.closest('.row');
        if (rowWrap){
          if (open){
            rowWrap.dataset._prevOverflowX = rowWrap.style.overflowX || '';
            rowWrap.style.overflowX = 'visible';
          } else {
            rowWrap.style.overflowX = rowWrap.dataset._prevOverflowX || '';
          }
        }

        // rotación de flecha
        const car = document.getElementById(selectId + 'Caret');
        if (car) car.style.transform = open ? 'translateY(-50%) rotate(180deg)' : 'translateY(-50%)';
      });

      // Cerrar al click afuera (y restaurar overflow/flecha)
      document.addEventListener('click', (e)=>{
        if(!wrap.contains(e.target)) {
          panel.style.display='none';
          const rowWrap = wrap.closest('.row');
          if (rowWrap){ rowWrap.style.overflowX = rowWrap.dataset._prevOverflowX || ''; }
          const car = document.getElementById(selectId + 'Caret');
          if (car) car.style.transform = 'translateY(-50%)';
        }
      });

      // Oculta el <select multiple> (sigue siendo la fuente de datos)
      sel.style.display = 'none';

      // --- Tipografía igual a la de #mbPais (mismo tamaño/color/letra)
      (function syncBtnTypography(){
        const ref = document.getElementById('mbPais') || sel;
        if (!ref) return;
        const cs = window.getComputedStyle(ref);
        btn.style.fontFamily   = cs.fontFamily;
        btn.style.fontSize     = cs.fontSize;
        btn.style.fontWeight   = cs.fontWeight;
        btn.style.color        = cs.color;
        btn.style.letterSpacing= cs.letterSpacing;
        btn.style.lineHeight   = cs.lineHeight;
      })();
    }

    // Reconstruir panel desde las opciones actuales del <select>
    const panel = document.getElementById(selectId + 'Panel');
    const btn   = document.getElementById(selectId + 'Btn');
    panel.innerHTML = '';

    // Buscador (opcional)
    let searchInput = null, listBox = null;
    if (opts.search){
      const top = document.createElement('div');
      top.style.cssText = 'position:sticky;top:0;background:#fff;padding:4px 4px 8px;z-index:1;';
      searchInput = document.createElement('input');
      searchInput.type = 'text';
      searchInput.placeholder = opts.searchPlaceholder || 'Buscar...';
      searchInput.style.cssText = 'width:100%;height:28px;border:1px solid var(--border-light);border-radius:6px;padding:4px 8px;';
      top.appendChild(searchInput);
      panel.appendChild(top);

      listBox = document.createElement('div');
      panel.appendChild(listBox);
    } else {
      listBox = panel;
    }

    const optsAll = Array.from(sel.options).map(o=>o.value).filter(Boolean);
    const selected = new Set(Array.from(sel.selectedOptions).map(o=>o.value).filter(Boolean));

    function addOption(val){
      const row = document.createElement('label');
      row.dataset.t = val.toUpperCase();
      row.style.cssText = 'display:flex;align-items:center;gap:8px;padding:4px 6px;white-space:nowrap;';
      const cb = document.createElement('input');
      cb.type = 'checkbox'; cb.value = val; cb.checked = selected.has(val);
      cb.addEventListener('change', ()=>{
        const opt = Array.from(sel.options).find(o=>o.value===val);
        if (opt){ opt.selected = cb.checked; }
        updateBtn();
        renderMatriz();
      });
      row.appendChild(cb);
      const tx = document.createElement('span'); tx.textContent = val;
      row.appendChild(tx);
      listBox.appendChild(row);
    }
    optsAll.forEach(addOption);

    function updateBtn(){
      const vals = Array.from(sel.selectedOptions).map(o=>o.value).filter(Boolean);
      if (vals.length === 0) { btn.textContent = placeholder; return; }
      if (vals.length === optsAll.length) { btn.textContent = placeholder; return; } // (Todos)
      if (vals.length <= 2) { btn.textContent = vals.join(', '); return; }
      btn.textContent = `${placeholder.split('(')[0].trim()} (${vals.length})`;
    }
    updateBtn();

    // Filtro por texto (si aplica)
    if (searchInput){
      const applyFilter = ()=>{
        const q = searchInput.value.trim().toUpperCase();
        Array.from(listBox.children).forEach(row=>{
          row.style.display = row.dataset.t.includes(q) ? '' : 'none';
        });
      };
      searchInput.addEventListener('input', applyFilter);
    }
  }

  function populateMatrizFilters(){
    const cur = ACTIVE_MATRIX_CUR;
    const sub = (BONDS||[]).filter(b => (bMoneda(b) || 'USD') === cur);

    const elPais   = document.getElementById('mbPais');
    const elSector = document.getElementById('mbSector');
    const elRating = document.getElementById('mbRating');
    const elBono   = document.getElementById('mbBono');

    // Guardar selección previa
    const keepPais   = elPais?.value || '';
    const keepSector = getMulti(elSector);
    const keepRating = getMulti(elRating);
    const keepBono   = getMulti(elBono);

    // Build únicos
    const paises  = _uniqSorted(sub.map(b=>bPais(b)));
    const sectores= _uniqSorted(sub.map(b=>b.Sector));
    const ratings = _uniqSorted(sub.map(b=>bRating(b)));
    const bonos   = _uniqSorted(sub.map(b=>bNombre(b))).filter(Boolean);

    // País (single) con "País (Todos)"
    if (elPais){
      elPais.innerHTML = `<option value="">País (Todos)</option>` + paises.map(v=>`<option>${v}</option>`).join('');
      if (keepPais && paises.includes(keepPais)) elPais.value = keepPais; else elPais.value = '';
    }

    // Sector (multi) con "Sector (Todos)" como primera opción vacía
    if (elSector){
      elSector.innerHTML = `<option value="">Sector (Todos)</option>` + sectores.map(v=>`<option>${v}</option>`).join('');
      setMulti(elSector, keepSector.filter(v => sectores.includes(v)));
    }

    // Rating (multi) con "Rating (Todos)" como primera opción vacía
    if (elRating){
      elRating.innerHTML = `<option value="">Rating (Todos)</option>` + ratings.map(v=>`<option>${v}</option>`).join('');
      setMulti(elRating, keepRating.filter(v => ratings.includes(v)));
    }

    // ---- Bono (multi) ----
    if (elBono){
      elBono.innerHTML = `<option value="">Bonos (Todos)</option>` + bonos.map(v=>`<option>${v}</option>`).join('');
      setMulti(elBono, keepBono.filter(v => bonos.includes(v)));
      // UI con buscador
      ensureMultiDropdownUI('mbBono', 'Bonos (Todos)', { search:true, searchPlaceholder:'Buscar bono...' });
    }

    // Actualiza también la UI de Sector/Rating (sin cambiar tamaños)
    ensureMultiDropdownUI('mbSector', 'Sector (Todos)');
    ensureMultiDropdownUI('mbRating', 'Rating (Todos)');
  }

  // --- Colores por país y calidad ---
  const COLOR_IG_DEF = '#001391';
  const COLOR_HY_DEF = '#85C8FF';
  const COLOR_BY_COUNTRY = {
    'PERU':     { IG: '#001391', HY: '#85C8FF' },
    'COLOMBIA': { IG: '#060E46', HY: '#9694FF' }
  };

  function colorForPoint(raw){
    const pais = String(raw?.pais || '').toUpperCase().trim();
    const typ  = String(raw?.ighy || '').toUpperCase().trim();
    const map  = COLOR_BY_COUNTRY[pais];
    if (map && map[typ]) return map[typ];
    return (typ==='IG') ? COLOR_IG_DEF : COLOR_HY_DEF;
  }

  // --- Accesores robustos al CSV de Bonos ---
  function bPais(b){ return b.Pais ?? b['País'] ?? b['PAIS'] ?? b.pais; }
  function bIGHY(b){ 
    // Intentar leer del CSV primero
    const csvValue = (b.IGHY ?? b['IG/HY'] ?? b.IG_HY ?? b.ig_hy ?? b.IgHy ?? '').toString().toUpperCase();
    if (csvValue) return csvValue;
    
    // Si está vacío, calcular desde Rating
    const rating = (b.Rating ?? b['RATING'] ?? b.rating ?? '').toString().trim().toUpperCase();
    if (!rating || rating === 'NR') return '';
    
    // IG: BBB- o mejor, HY: BB+ o peor
    const igRatings = ['AAA', 'AA+', 'AA', 'AA-', 'A+', 'A', 'A-', 'BBB+', 'BBB', 'BBB-'];
    return igRatings.includes(rating) ? 'IG' : 'HY';
  }
  function bRating(b){ return b.Rating ?? b['RATING'] ?? b.rating; }
  function bMoneda(b){ return b.Moneda ?? b['MONEDA'] ?? b.moneda; }
  function bDur(b){ return toNum(b.Duracion ?? b['Duración'] ?? b.Dur ?? b.duracion); }
  function bYTM(b){ return toNum(b.Tasa ?? b.YTW ?? b['YTM'] ?? b.ytm); }   // Tasa primero, fallback YTW
  function bNombre(b){ return b.Bono ?? b['Bono'] ?? b.Nombre ?? b['Nombre'] ?? b.id ?? ''; }

  function ceilToMultiple(value, step){
    return Math.ceil(value / step) * step;
  }

  // Y máx: (máximo + 1%) alineado al siguiente múltiplo del paso (1,2 o 3)
  function matrizYMaxFromDatasets(ds){
    let m = -Infinity;
    ds.forEach(d => (d.data||[]).forEach(p => {
      const y = Number(p.y);
      if (isFinite(y) && y > m) m = y;
    }));
    if (!isFinite(m)) return 5;

    const up1 = m + 1;                 // +1% de aire
    const base = Math.ceil(up1);       // entero hacia arriba
    const step = yStepFor(base);       // decide 1 / 2 / 3 según rango
    return ceilToMultiple(base, step); // alinea al siguiente múltiplo del paso
  }

  // --- Paso del eje Y: mínimo 1, adaptado a 2 o 3 si conviene ---
  function yStepFor(yMax){
    if (yMax <= 6)  return 1;
    if (yMax <= 12) return 2;
    return 3;
  }

  function portfolioBondIdSet(cur){
    const S = new Set();
    (state?.cartera || []).forEach(r=>{
      if (!r || !r.isBond) return;
      const b = (BONDS||[]).find(x=> x.id === r.bondId);
      if (!b) return;
      const m = (b.Moneda || 'USD');
      if (m === cur) S.add(b.id);
    });
    return S;
  }

  function renderMatriz(){
    const cur = ACTIVE_MATRIX_CUR;

    // Asegura que los bonos iniciales (A360) ya estén en state.cartera
    // incluso si nunca abriste + Bonos en esta sesión:
    const __prevBondCur = ACTIVE_BOND_CUR;
    ACTIVE_BOND_CUR = cur;
    ensureInitialBondsInCartera();
    ACTIVE_BOND_CUR = __prevBondCur;

    const onlyPort = document.getElementById('mbPortfolioOnly')?.checked || false;
    const allowed = onlyPort ? portfolioBondIdSet(cur) : null;

    // filtros UI
    const f = {
      pais:     document.getElementById('mbPais')?.value || '',
      ig:       document.getElementById('mbIG')?.value || '',
      sectors:  getMulti(document.getElementById('mbSector')),   // << múltiple
      ratings:  getMulti(document.getElementById('mbRating')),   // << múltiple
      bonos:    getMulti(document.getElementById('mbBono')),           // << NUEVO
      dmin:     toNum(document.getElementById('mbDurMin')?.value),
      dmax:     toNum(document.getElementById('mbDurMax')?.value)
    };

    // filtra por moneda activa y criterios
    const rows = (BONDS||[])
      .filter(b => (bMoneda(b) || 'USD') === cur)
      .filter(b => !onlyPort || allowed.has(b.id))          // ← NUEVO
      .filter(b => !f.pais || bPais(b) === f.pais)
      .filter(b => !f.ig   || bIGHY(b) === f.ig)
      .filter(b => !f.sectors.length || f.sectors.includes(b.Sector))           // << múltiple
      .filter(b => !f.ratings.length || f.ratings.includes(bRating(b)))         // << múltiple
      .filter(b => !f.bonos.length   || f.bonos.includes(bNombre(b)))   // << NUEVO
      .map(b => ({
        x: bDur(b),               // Duración (años)
        y: bYTM(b),               // Tasa (YTM)
        bono: bNombre(b),
        pais: bPais(b),
        ighy: bIGHY(b)
      }))
      .filter(p => isFinite(p.x) && isFinite(p.y))
      .filter(p => !f.dmin || p.x >= f.dmin)
      .filter(p => !f.dmax || p.x <= f.dmax);

    // Agrupa por país/calidad (leyenda con 4 grupos principales + otros)
    const rowsUp = rows.map(p => ({ ...p, P: String(p.pais||'').toUpperCase() }));
    const PER_IG = rowsUp.filter(p => p.P==='PERU'     && p.ighy==='IG');
    const PER_HY = rowsUp.filter(p => p.P==='PERU'     && p.ighy==='HY');
    const COL_IG = rowsUp.filter(p => p.P==='COLOMBIA' && p.ighy==='IG');
    const COL_HY = rowsUp.filter(p => p.P==='COLOMBIA' && p.ighy==='HY');
    const OTH_IG = rowsUp.filter(p => !['PERU','COLOMBIA'].includes(p.P) && p.ighy==='IG');
    const OTH_HY = rowsUp.filter(p => !['PERU','COLOMBIA'].includes(p.P) && p.ighy==='HY');

    const ds = [];
    if (PER_IG.length) ds.push({ label:'Perú IG',      data:PER_IG, type:'scatter', showLine:false, borderWidth:0, pointRadius:4, pointBackgroundColor:'#060E46', pointBorderColor:'#060E46' });
    if (PER_HY.length) ds.push({ label:'Perú HY',      data:PER_HY, type:'scatter', showLine:false, borderWidth:0, pointRadius:4, pointBackgroundColor:'#CAD1D8', pointBorderColor:'#CAD1D8' });
    if (COL_IG.length) ds.push({ label:'Colombia IG',  data:COL_IG, type:'scatter', showLine:false, borderWidth:0, pointRadius:4, pointBackgroundColor:'#9694FF', pointBorderColor:'#9694FF' });
    if (COL_HY.length) ds.push({ label:'Colombia HY',  data:COL_HY, type:'scatter', showLine:false, borderWidth:0, pointRadius:4, pointBackgroundColor:'#85C8FF', pointBorderColor:'#85C8FF' });
    if (OTH_IG.length) ds.push({ label:'Otros IG',     data:OTH_IG, type:'scatter', showLine:false, borderWidth:0, pointRadius:4, pointBackgroundColor:COLOR_IG_DEF, pointBorderColor:COLOR_IG_DEF });
    if (OTH_HY.length) ds.push({ label:'Otros HY',     data:OTH_HY, type:'scatter', showLine:false, borderWidth:0, pointRadius:4, pointBackgroundColor:COLOR_HY_DEF, pointBorderColor:COLOR_HY_DEF });

    // X: rango y paso (mínimo 1, puede ser 2 o 3)
    let xMin = 0, xMax = 1;
    if (rows.length){
      xMin = Math.max(0, Math.floor(Math.min(...rows.map(p=>p.x))));
      xMax = Math.ceil(Math.max(...rows.map(p=>p.x)));
      if (xMax <= xMin) xMax = xMin + 1;
    }
    const xStep = xStepFor(xMax - xMin);

    // Y: tope dinámico (máx + 1 redondeado hacia arriba) y paso adaptable 1/2/3
    const yMax  = matrizYMaxFromDatasets(ds);
    const yStep = yStepFor(yMax);

    const ctx = document.getElementById('matrizChart')?.getContext('2d');
    if (!ctx) return;
    if (matrizChart) matrizChart.destroy();

    matrizChart = new Chart(ctx, {
      type:'scatter',
      data:{ datasets: ds },
      options:{
        responsive:true, maintainAspectRatio:false, parsing:false,
        layout:{ padding:{ top: 18 } }, // más aire arriba del gráfico
        plugins:{
          legend:{
            display:true,
            position:'bottom',
            labels:{
              usePointStyle:false,
              boxWidth:28,
              boxHeight:2,
              // línea horizontal del color del dataset
              generateLabels: (chart) => {
                const ds = chart.data.datasets || [];
                return ds.map((d,i)=>{
                  // Para scatter plots: usar pointBackgroundColor o pointBorderColor
                  // Para line charts: usar borderColor
                  const color = d.pointBackgroundColor || d.pointBorderColor || d.borderColor || '#001391';
                  return {
                    text: d.label,
                    datasetIndex: i,
                    hidden: !chart.isDatasetVisible(i),
                    strokeStyle: color,
                    fillStyle: color,
                    lineWidth: 2
                  };
                });
              }
            }
          },
          datalabels:{ display:false },
          tooltip:{
            callbacks:{
              label: (c)=> String(c.raw?.bono || ''),
              afterLabel: (c)=> {
                const y = Number(c.raw?.y);
                const x = Number(c.raw?.x);
                return [
                  `YTM: ${isFinite(y)? y.toFixed(2):'-'}%`,
                  `Duración: ${isFinite(x)? x.toFixed(2):'-'} años`
                ];
              }
            }
          }
        },
        scales:{
          x:{ type:'linear',
              min:xMin, max:xMax,
              title:{ display:true, text:'Duración (años)' },
              grid:{ display:false },
              ticks:{ stepSize:xStep, precision:0 }
          },
          y:{ beginAtZero:true, min:0, max:yMax,
              title:{ display:true, text:'Tasa (%)' },
              grid:{ display:false },
              ticks:{
                stepSize: yStep,
                callback: v => v + '%'   // todas las etiquetas siguen la secuencia del step
              }
          }
        }
      }
    });

    // sin mensaje: queda en blanco por defecto
    const hint = document.getElementById('mbHint');
    if (hint) hint.textContent = '';

    bindMatrizCanvasDblClick();
  }

  // === Doble-clic en scatter: añadir bono como en "Seleccionar Bonos" ===
  function addBondFromScatter(bid, cur){
    // busca el bono en la moneda activa
    let b = (BONDS||[]).find(x => x.id === bid && (x.Moneda||'USD') === cur);
    if (!b) b = (BONDS||[]).find(x => x.id === bid);
    if (!b) { alert('No se encontró el bono: ' + bid); return; }

    // mismo push que "Añadir" en Seleccionar Bonos (+ Bonos)
    if (!state.cartera.some(r => r.bondId === b.id)){
      state.cartera.push({
        clase:  b.Clase||'Renta Fija MP',
        inst:   b.id,
        veh:    b.Vehiculo||'Bono',
        sub:    b.Subclase||b.Seniority||'Corp',
        region: b.Region||'Emergentes',
        isBond: true,
        bondId: b.id,
        existing:false,
        monto:  0,
        peso:   0
      });
    }

    // preparar lote de compra con dirty (igual que el botón "Añadir")
    setLot(b.id, 'buy', {
      nominal: lotNom(b.id,'buy') || 0,
      dirty:   toNum(b.Precio ?? 100)
    });

    // alinear moneda para que el modal +Bonos, si está abierto, muestre este lado
    ACTIVE_BOND_CUR = cur;

    // refrescar UI si el modal +Bonos está abierto; si no, solo queda preparado
    if (document.getElementById('modalBonos')?.style.display === 'flex'){
      renderBonosModal();
      renderMontosModal();
    }

    try{ window.showToast?.(`Añadido: ${b.id}`); }catch(_){}
  }

  function onMatrizChartDblClick(evt){
    if (!matrizChart) return;
    const els = matrizChart.getElementsAtEventForMode(evt, 'nearest', { intersect:true }, true);
    if (!els || !els.length) return;
    const el = els[0];
    const ds = matrizChart.data.datasets[el.datasetIndex];
    const point = ds.data[el.index];              // {x,y,bono,pais,ighy}
    const bid = String(point?.bono || '').trim();
    if (!bid) return;
    addBondFromScatter(bid, ACTIVE_MATRIX_CUR);
  }

  function bindMatrizCanvasDblClick(){
    const cv = document.getElementById('matrizChart');
    if (cv && !cv._mbBound){
      cv.addEventListener('dblclick', onMatrizChartDblClick);
      cv._mbBound = true;
    }
  }

  function openMatrizBonosModal(){
    ACTIVE_MATRIX_CUR = _activeHoldCurrency();  // USD o PEN según sub-tab
    const m = document.getElementById('modalMatriz'); if(!m) return;
    // Sembrar bonos iniciales para la moneda activa al abrir el modal
    const __prevCur = ACTIVE_BOND_CUR;
    ACTIVE_BOND_CUR = ACTIVE_MATRIX_CUR;
    ensureInitialBondsInCartera();
    ACTIVE_BOND_CUR = __prevCur;
    populateMatrizFilters();
    renderMatriz();
    m.classList.add('show');
  }
  function closeMatrizBonosModal(){
    document.getElementById('modalMatriz')?.classList.remove('show');
  }

  // Wiring del modal
  (function wireMatriz(){
    document.getElementById('matrizClose')?.addEventListener('click', closeMatrizBonosModal);
    document.getElementById('modalMatriz')?.addEventListener('click', (e)=>{ if (e.target.id==='modalMatriz') closeMatrizBonosModal(); });
    ['mbPais','mbSector','mbIG','mbRating','mbBono','mbDurMin','mbDurMax','mbPortfolioOnly'].forEach(id=>{
      const el = document.getElementById(id);
      el?.addEventListener('input', renderMatriz);
      el?.addEventListener('change', renderMatriz);
    });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMatrizBonosModal(); });

    // Export para el botón
    window.openMatrizBonosModal = openMatrizBonosModal;
  })();

  // --- Portafolios Modelo: Clase + PMs con P.Modelo / P.Actual / P.Sugerido ---
function renderModelosTable(){
  const sel  = document.getElementById('mmPerfilSel');
  const perf = (sel?.value || document.getElementById('balPerfilSel')?.value || document.getElementById('perfil')?.value || '').trim();
  const modelo = getModelForPerfil(perf);
  const tb = document.getElementById('mmBody'); if(!tb) return;
  tb.innerHTML = '';

  const order = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];
  const cur = (typeof getActiveCur==='function') ? getActiveCur() : 'USD';

  const byClassInit  = currentHoldingsInitialByClass(cur) || {sumBy:{}, total:0};
  const byClassFinal = currentHoldingsFinalByClass(cur)  || {sumBy:{}, total:0};
  const byPMInitCls  = currentHoldingsInitialByClassPM(cur);
  const byPMFinalCls = currentHoldingsFinalByClassPM(cur);

  const pctAbs = v => (Number(v)||0).toFixed(2) + '%';
  const pctRel = (amt,den) => ((den>0 ? (Number(amt)/den*100) : 0).toFixed(2) + '%');
  
  // Función de ordenamiento específico por clase
  const sortPMByClass = (clase) => (a, b) => {
    const A = normTxt(a);
    const B = normTxt(b);
    
    // Para Renta Fija CP y MP, omitir el prefijo "RF " al comparar
    const isRentaFija = (clase === 'Renta Fija CP' || clase === 'Renta Fija MP');
    const removeRF = (txt) => {
      if (isRentaFija && txt.startsWith('RF ')) {
        return txt.substring(3).trim();
      }
      return txt;
    };
    
    const A_clean = removeRF(A);
    const B_clean = removeRF(B);
    
    // Definir órdenes específicos por clase usando nombres normalizados

    let orderMap = {};

    

    if (clase === 'Renta Fija CP') {

      orderMap = {

        'CASH Y EQUIVALENTES': 1,

        'IG DESARROLLADOS': 2,

        'IG M. DESARROLLADOS': 2,

        'IG MERCADOS DESARROLLADOS': 2,

        'HY DESARROLLADOS': 3,

        'HY M. DESARROLLADOS': 3,

        'HY MERCADOS DESARROLLADOS': 3,

        'GLOBAL EM': 4,

        'M. EMERGENTES': 4,

        'MERCADOS EMERGENTES': 4,

        'LATINOAMERICA': 5,

        'LATINO AMERICA': 5

      };

    } else if (clase === 'Renta Fija MP') {

      orderMap = {

        'CASH Y EQUIVALENTES': 1,

        'IG DESARROLLADOS': 2,

        'IG M. DESARROLLADOS': 2,

        'IG MERCADOS DESARROLLADOS': 2,

        'HY DESARROLLADOS': 3,

        'HY M. DESARROLLADOS': 3,

        'HY MERCADOS DESARROLLADOS': 3,

        'GLOBAL EM': 4,

        'M. EMERGENTES': 4,

        'MERCADOS EMERGENTES': 4,

        'LATINOAMERICA': 5,

        'LATINO AMERICA': 5

      };

    } else if (clase === 'Renta Variable') {

      orderMap = {

        'GLOBAL': 1,

        'EEUU': 2,

        'EUROPA': 3,

        'JAPON': 4,

        'EMERGENTE': 5,

        'EMERGENTES': 5,

        'ASIA EX JAPON': 6,

        'ASIA EX - JAPON': 6,

        'ASIA DESARROLLADO EX - JAPON': 6,

        'ASIA DESARROLLADO EX JAPON': 6,

        'ASIA DESARROLLADO EXJAPON': 6

      };

    } else if (clase === 'Alternativo') {

      orderMap = {

        'REITS': 1,

        'REIT': 1,

        'REAL ESTATE': 1,

        'MATERIAS PRIMAS': 2,

        'CRIPTOMONEDAS': 3,

        'CRIPTO': 3

      };

    }
    
    // "Otros" siempre al final
    if (A === 'OTROS') return 1;
    if (B === 'OTROS') return -1;
    
    // Buscar coincidencias parciales también
    const getOrder = (txt) => {
      const txtClean = removeRF(txt);
      // Primero busca coincidencia exacta
      if (orderMap[txtClean] !== undefined) return orderMap[txtClean];
      
      // Luego busca coincidencias parciales (el texto contiene la clave completa con longitud mínima)
      for (const key in orderMap) {
        // Coincidencia parcial: si el texto contiene la clave completa (mínimo 5 caracteres para evitar falsos positivos)
        if (txtClean.includes(key) && key.length > 5) {
          return orderMap[key];
        }
        // O si la clave contiene el texto completo (para casos como "IG" vs "IG M. DESARROLLADOS")
        if (key.includes(txtClean) && txtClean.length > 5) {
          return orderMap[key];
        }
      }
      return undefined;
    };
    
    const idxA = getOrder(A);
    const idxB = getOrder(B);
    
    if (idxA !== undefined && idxB !== undefined) {
      return idxA - idxB;
    }
    if (idxA !== undefined) return -1; // A tiene prioridad
    if (idxB !== undefined) return 1;  // B tiene prioridad
    
    // Si ninguno está en el orden específico, orden alfabético
    return String(a).localeCompare(String(b), 'es', {sensitivity:'base'});
  };

  let totMod = 0;

  order.forEach(clase=>{
    // Bolsa de PM del modelo para esta clase
    const bag = MODELOS_PM?.[perf]?.[clase] || {};
    const keys = Object.keys(bag).sort(sortPMByClass(clase));

    // Construir subfilas: se muestra si (Modelo>0) o (Actual>0) o (Sugerido>0)
    let sumModAbs = 0, sumActPct = 0, sumSugPct = 0;
    const pmRows = [];

    keys.forEach(pm=>{
      const mAbs = toNum(bag[pm]) || 0;
      const key = pmKey(clase, pm); // pm es la etiqueta de la fila del modelo
      const aAmt = toNum(byPMInitCls.sumBy[key]  || 0);
      const sAmt = toNum(byPMFinalCls.sumBy[key] || 0);
      const aPct = byPMInitCls.total  > 0 ? (aAmt/byPMInitCls.total*100)  : 0;
      const sPct = byPMFinalCls.total > 0 ? (sAmt/byPMFinalCls.total*100) : 0;

      const show = (mAbs>0) || (aAmt>0) || (sAmt>0);
      if (!show) return;

      sumModAbs += mAbs;
      sumActPct += aPct;
      sumSugPct += sPct;

      pmRows.push(
        `<tr class="pmSubRow">
           <td class="left">${pm}</td>
           <td class="num">${pctAbs(mAbs)}</td>
           <td class="num">${aPct.toFixed(2)}%</td>
           <td class="num">${sPct.toFixed(2)}%</td>
         </tr>`
      );
    });

    // Si no hay PMs visibles pero la clase tiene % de modelo, crea una única subfila con la clase
    if (!pmRows.length){
      const pModClase = toNum(modelo?.[clase]) || 0;
      if (pModClase > 0){
        sumModAbs = pModClase; // todo el modelo en una sola línea
        const aAmt = toNum(byClassInit.sumBy?.[clase] || 0);
        const sAmt = toNum(byClassFinal.sumBy?.[clase] || 0);
        sumActPct = (byPMInitCls.total  > 0) ? (aAmt/byPMInitCls.total*100)  : 0;
        sumSugPct = (byPMFinalCls.total > 0) ? (sAmt/byPMFinalCls.total*100) : 0;
        pmRows.push(
          `<tr class="pmSubRow">
             <td class="left">${clase}</td>
             <td class="num">${pctAbs(pModClase)}</td>
             <td class="num">${pctRel(aAmt, byPMInitCls.total)}</td>
             <td class="num">${pctRel(sAmt, byPMFinalCls.total)}</td>
           </tr>`
        );
      }
    }

    // ¿Se pinta la CLASE? (si cualquiera de las tres columnas tiene valor o hay subfilas)
    const showClass = (sumModAbs>0) || (sumActPct>0) || (sumSugPct>0) || pmRows.length;
    if (!showClass) return;

    // Fila CLASE = suma de sus subfilas (garantiza cuadrar)
    const trClass = document.createElement('tr');
    trClass.className = 'row-sub';
    trClass.innerHTML =
      `<td class="left">${clase}</td>
       <td class="num">${pctAbs(sumModAbs)}</td>
       <td class="num">${sumActPct.toFixed(2)}%</td>
       <td class="num">${sumSugPct.toFixed(2)}%</td>`;
    tb.appendChild(trClass);

    // Subfilas planas
    if (pmRows.length){
      const frag = document.createElement('tbody');
      frag.innerHTML = pmRows.join('');
      Array.from(frag.children).forEach(tr=>tb.appendChild(tr));
    }

    totMod += sumModAbs;

  });

  // Totales (dos decimales, con mismo denominador global)
  const tMod = document.getElementById('mmTotMod');
  const tAct = document.getElementById('mmTotAct');
  const tSug = document.getElementById('mmTotSug');
  if (tMod) tMod.textContent = (toNum(totMod)||0).toFixed(2) + '%';
  if (tAct) tAct.textContent = ((byPMInitCls.total  > 0 ? 100 : 0).toFixed(2) + '%');
  if (tSug) tSug.textContent = ((byPMFinalCls.total > 0 ? 100 : 0).toFixed(2) + '%');
}

function renderPMChart(){
  const sel  = document.getElementById('mmPerfilSel');
  const perf = (sel?.value || document.getElementById('balPerfilSel')?.value || document.getElementById('perfil')?.value || '').trim();
  const order = ["Liquidez","Renta Fija CP","Renta Fija MP","Renta Variable","Alternativo"];
  const cur = (typeof getActiveCur==='function') ? getActiveCur() : 'USD';

  // Datos base (los mismos de la tabla)
  const byClassInitObj  = currentHoldingsInitialByClass(cur) || {sumBy:{}, total:0};
  const byClassFinalObj = currentHoldingsFinalByClass(cur)  || {sumBy:{}, total:0};
  const byPMInitCls  = currentHoldingsInitialByClassPM(cur);
  const byPMFinalCls = currentHoldingsFinalByClassPM(cur);
  const totInit = byPMInitCls.total || 0, totFinal = byPMFinalCls.total || 0;

  // Utilidades
  const pctAbs = v => Number(v||0).toFixed(2);
  const pctRel = (amt,den) => Number(den>0 ? (Number(amt)/den*100) : 0).toFixed(2);
  const sortPM = (a,b)=>{ const A=normTxt(a), B=normTxt(b);
    if (A==='OTROS') return 1; if (B==='OTROS') return -1;
    return String(a).localeCompare(String(b),'es',{sensitivity:'base'});
  };

  // Construcción de datos
  const labels=[], mod=[], act=[], sug=[];
  order.forEach(clase=>{
    const bag = MODELOS_PM?.[perf]?.[clase] || {};
    const keysModel = Object.keys(bag);
    const keysAct   = Object.keys(byPMInitCls.sumBy).filter(k=>k.startsWith(`${clase}|`)).map(k=>k.split('|')[1]);
    const keysSug   = Object.keys(byPMFinalCls.sumBy).filter(k=>k.startsWith(`${clase}|`)).map(k=>k.split('|')[1]);
    const keys = Array.from(new Set([...keysModel, ...keysAct, ...keysSug])).sort(sortPM);

    keys.forEach(pm=>{
      const mAbs = toNum(bag[pm]) || 0;
      const aAmt = toNum(byPMInitCls.sumBy[`${clase}|${pm}`]  || 0);
      const sAmt = toNum(byPMFinalCls.sumBy[`${clase}|${pm}`] || 0);
      if (!(mAbs>0 || aAmt>0 || sAmt>0)) return;

      // Filtrar "CUENTA VALOR"
      if (pm === 'CUENTA VALOR') return;

      // Agregar prefijo según la clase
      let label = pm;
      if (clase === 'Renta Fija CP') {
        label = `RF CP ${pm}`;
      } else if (clase === 'Renta Fija MP') {
        label = `RF MP ${pm}`;
      } else if (clase === 'Renta Variable') {
        label = `RV ${pm}`;
      }
      // Liquidez y Alternativo quedan sin prefijo

      labels.push(label);
      mod.push(Number(pctAbs(mAbs)));
      act.push(Number(pctRel(aAmt, totInit)));
      sug.push(Number(pctRel(sAmt, totFinal)));
    });
  });

  // Altura dinámica para listas largas
  const wrapper = document.querySelector('#mmViewChart .chart-wrapper');
  if (wrapper){
    wrapper.style.height = '70vh'; // mismo tamaño que la tabla
  }

  // Eje X agradable
  const allPct = [...mod, ...act, ...sug].filter(v=>typeof v==='number' && !isNaN(v));
  const maxPct = Math.max(10, ...allPct);
  const niceMax = Math.min(100, Math.ceil(maxPct/10)*10);

  const ctx = document.getElementById('mmChart')?.getContext('2d');
  if (!ctx) return;
  if (pmChart){ pmChart.destroy(); pmChart=null; }

  pmChart = new Chart(ctx, {
    type:'bar',
    data:{
      labels,
      datasets:[
        { label:'P. Modelo',   data: mod, backgroundColor:'#060E46' },
        { label:'P. Actual',   data: act, backgroundColor:'#CAD1D8' },
        { label:'P. Sugerido', data: sug, backgroundColor:'#9694FF' }
      ]
    },
    options:{
      indexAxis:'y',
      responsive:true, 
      maintainAspectRatio:false,
      plugins:{
        legend:{ 
          display: true,
          position: 'bottom'
        },
        datalabels: (typeof ChartDataLabels!=='undefined') ? {
          display: document.getElementById('pmShowLabels')?.checked ?? true,
          anchor:'end', 
          align:'right',
          formatter:(v)=> (v==null? '' : (Number(v).toFixed(2)+'%')),
          color:'#333', 
          font:{weight:'bold', size:11}
        } : {}
      },
      scales:{
        x:{ beginAtZero:true, max:niceMax,
            ticks:{ callback:(v)=> v+'%' }, grid:{ display:true } },
        y:{ grid:{ display:false } }
      }
    },
    plugins: typeof ChartDataLabels !== 'undefined' ? [ChartDataLabels] : []
  });

  // Manejar checkbox de etiquetas
  document.getElementById('pmShowLabels')?.addEventListener('change', (e) => {
    if (pmChart) {
      pmChart.options.plugins.datalabels.display = e.target.checked;
      pmChart.update();
    }
  });
}

function wirePMChartFilters(){
  // Solo manejar el checkbox de etiquetas
  const cb = document.getElementById('pmShowLabels');
  if (cb && !cb.dataset.bound) {
    cb.dataset.bound = '1';
    cb.addEventListener('change', (e) => {
      if (pmChart) {
        pmChart.options.plugins.datalabels.display = e.target.checked;
        pmChart.update();
      }
    });
  }
}

  function openModelosModal(){
    const m = document.getElementById('modalModelos'); if (!m) return;

    const sel  = document.getElementById('mmPerfilSel');
    const list = modelProfiles();
    sel.innerHTML = list.map(p=>`<option>${p}</option>`).join('');

    const perfAA   = (document.getElementById('balPerfilSel')?.value || '').trim();
    const perfDash = (document.getElementById('perfil')?.value || '').trim();

    if (perfAA && list.includes(perfAA))          sel.value = perfAA;
    else if (perfDash && list.includes(perfDash)) sel.value = perfDash;
    else if (list.length)                         sel.value = list[0];

    // Vista por defecto: TABLA
    document.getElementById('mmViewTable')?.classList.add('active');
    document.getElementById('mmViewChart')?.classList.remove('active');
    const labelsContainer = document.getElementById('pmShowLabelsContainer');
    if (labelsContainer) labelsContainer.style.display = 'none';

    renderModelosTable();
    m.classList.add('show');
  }
  function closeModelosModal(){
    const m = document.getElementById('modalModelos');
    if (m) m.classList.remove('show');
    if (pmChart){ pmChart.destroy(); pmChart = null; }
  }
  document.getElementById('btnModelos')   ?.addEventListener('click', openModelosModal);
  document.getElementById('modelosClose') ?.addEventListener('click', closeModelosModal);
  document.getElementById('modalModelos') ?.addEventListener('click', (e)=>{ if (e.target.id==='modalModelos') closeModelosModal(); });

  // === Maturity Wall (mini‑modal) ===
  let mwChart = null;
  let ACTIVE_MW_CUR = 'USD';

  function toNumMW(x){
    const n = Number(String(x ?? '').replace(/[^\d.-]/g, ''));
    return Number.isFinite(n) ? n : 0;
  }
  function parseDMYMaybeMW(s){
    if (typeof parseDMYStrict === 'function') {
      try { return parseDMYStrict(s); } catch(_){}
    }
    const m = String(s).match(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})/);
    if (m){
      const d = +m[1], mm = +m[2]-1, yy = +m[3];
      return new Date(yy<100?2000+yy:yy, mm, d);
    }
    const d = new Date(s);
    return isNaN(d) ? null : d;
  }

  // Lee lo que ya arma Cronograma (AMORTIZACIONES Y VENCIMIENTOS) y agrega por año.
  // Devuelve { years: number[], amounts: number[] }, amounts en miles.
  function _collectMaturityFromAmortTable(cur){
    // Guardar moneda anterior + snapshot del tbody actual
    const prevCur = window.ACTIVE_CRONO_CUR;
    const tb = document.querySelector('#tablaAmort tbody');
    const snapshot = tb ? tb.cloneNode(true) : null;
    
    // Cambiar a la moneda solicitada
    window.ACTIVE_CRONO_CUR = cur;
    
    // Regenerar la tabla de amortizaciones con la nueva moneda
    if (typeof construirTablaAmortizaciones === 'function') {
      try {
        construirTablaAmortizaciones();
      } catch(e) {
        console.error('[MW] Error al construir tabla amortizaciones:', e);
      }
    }
    
    // CRÍTICO: Esperar un momento para que el DOM se actualice
    // Usar setTimeout con 0ms para que se ejecute después del repaint
    return new Promise(resolve => {
      setTimeout(() => {
        // Leer datos de la tabla HTML renderizada
        const tbody = document.querySelector('#tablaAmort tbody');
        if (!tbody) {
          console.warn('[MW] No se encontró #tablaAmort tbody');
          // Restaurar SIN re-render
          window.ACTIVE_CRONO_CUR = prevCur;
          const liveTb = document.querySelector('#tablaAmort tbody');
          if (snapshot && liveTb && liveTb.parentNode) {
            liveTb.parentNode.replaceChild(snapshot, liveTb);
          }
          resolve({ years: [], amounts: [] });
          return;
        }
        
        const rows = Array.from(tbody.querySelectorAll('tr'));
        const yearNow = new Date().getFullYear();
        const byYear = new Map();
        
        for (const tr of rows){
          const tds = tr.querySelectorAll('td');
          if (tds.length < 6) continue;
          
          // Saltar fila de encabezado
          const primerTd = tds[0].textContent.trim();
          if (primerTd.includes('Activos Amortizables') || primerTd.includes('Activos No Amortizables')) {
            continue;
          }
          
          // Columnas: [0]Nombre, [1]TipoActivo, [2]Concepto, [3]Fecha, [4]%Amort, [5]Monto, [6]ValorReman
          const fechaTxt = tds[3]?.textContent.trim();
          const montoTxt = tds[5]?.textContent.trim();
          
          // Parsear fecha
          const d = parseDMYMaybeMW(fechaTxt);
          if (!d || isNaN(d)) continue;
          
          const y = d.getFullYear();
          if (y < yearNow) continue;
          
          // Parsear monto
          const amt = toNumMW(montoTxt);
          if (amt <= 0) continue;
          
          // Acumular por año
          byYear.set(y, (byYear.get(y) || 0) + amt);
        }
        
        // Restaurar SIN re-render (evita pisar la moneda que el usuario eligió)
        window.ACTIVE_CRONO_CUR = prevCur;
        const liveTb = document.querySelector('#tablaAmort tbody');
        if (snapshot && liveTb && liveTb.parentNode) {
          liveTb.parentNode.replaceChild(snapshot, liveTb);
        }
        
        // Generar arrays de años y montos
        if (byYear.size === 0) {
          resolve({ years: [], amounts: [] });
          return;
        }
        
        const maxYear = Math.max(...Array.from(byYear.keys()));
        const years = [];
        const amounts = [];
        
        for (let y = yearNow; y <= maxYear; y++){
          years.push(y);
          amounts.push(byYear.get(y) || 0);
        }
        
        resolve({ years, amounts });
      }, 50); // 50ms es suficiente para que el DOM se actualice
    });
  }

  async function renderMaturityChart(){
    const cur = ACTIVE_MW_CUR;
    const data = await _collectMaturityFromAmortTable(cur);
    const { years, amounts } = data;
    const labels = years.map(y => String(y));

    const ctx = document.getElementById('mwChart')?.getContext('2d');
    if (!ctx) return;
    if (mwChart){ mwChart.destroy(); mwChart = null; }

    mwChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels,
        datasets: [{
          label: cur,
          data: amounts,
          backgroundColor: (cur === 'PEN') ? '#85C8FF' : '#001391'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: { 
            enabled: true,
            callbacks: {
              label: function(context) {
                const value = context.parsed.y;
                const symbol = (cur === 'PEN') ? 'S/' : '$';
                return `${symbol} ${value.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
              }
            }
          },
          datalabels: { display: false }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: { display: false },
            ticks: { callback: (v)=> Number(v).toLocaleString('en-US') },
            grid: { color: 'rgba(0,0,0,0.06)' }
          },
          x: { grid: { display: false } }
        }
      }
    });
  }

  async function renderMaturityTable(){
    const cur = ACTIVE_MW_CUR;
    const data = await _collectMaturityFromAmortTable(cur);
    const { years, amounts } = data;
    const tbody = document.querySelector('#mwTable tbody');
    if (!tbody) return;
    const symbol = (cur === 'PEN') ? 'S/' : '$';
    tbody.innerHTML = years.map((y,i)=>(
      `<tr><td class="left">${String(y)}</td><td class="num">${symbol} ${amounts[i].toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td></tr>`
    )).join('');
  }

  function openMaturityModal(){
    const m = document.getElementById('modalMaturity'); if (!m) return;

    // Moneda por defecto: la subpestaña activa de Posiciones, si existe
    const holdKey = document.querySelector('#hold-subtabs .subtab.active')?.dataset.sub || '';
    ACTIVE_MW_CUR = (holdKey === 'hold-pen') ? 'PEN' : 'USD';

    document.querySelectorAll('#mw-subtabs .subtab').forEach(b=>b.classList.remove('active'));
    document.querySelector(`#mw-subtabs .subtab[data-sub="${ACTIVE_MW_CUR==='PEN'?'mw-pen':'mw-usd'}"]`)?.classList.add('active');

    // Vista por defecto: GRÁFICO
    document.getElementById('mwViewChart')?.classList.add('active');
    document.getElementById('mwViewTable')?.classList.remove('active');
    if (mwChart){ mwChart.destroy(); mwChart = null; }

    renderMaturityChart();
    m.classList.add('show');
  }

  function closeMaturityModal(){
    const m = document.getElementById('modalMaturity');
    if (m) m.classList.remove('show');
    if (mwChart){ mwChart.destroy(); mwChart = null; }
  }

  // Wiring
  (function wireMaturityWall(){
    document.getElementById('btnMaturity')?.addEventListener('click', openMaturityModal);
    document.getElementById('maturityClose')?.addEventListener('click', closeMaturityModal);
    document.getElementById('modalMaturity')?.addEventListener('click', (e)=>{ if (e.target.id==='modalMaturity') closeMaturityModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMaturityModal(); });

    // Tabla / Gráfico
    document.getElementById('btnMWTable')?.addEventListener('click', ()=>{
      document.getElementById('mwViewTable')?.classList.add('active');
      document.getElementById('mwViewChart')?.classList.remove('active');
      if (mwChart){ mwChart.destroy(); mwChart = null; }
      renderMaturityTable();
    });
    document.getElementById('btnMWChart')?.addEventListener('click', ()=>{
      document.getElementById('mwViewChart')?.classList.add('active');
      document.getElementById('mwViewTable')?.classList.remove('active');
      renderMaturityChart();
    });

    // USD / PEN
    document.querySelectorAll('#mw-subtabs .subtab').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('#mw-subtabs .subtab').forEach(x=>x.classList.remove('active'));
        btn.classList.add('active');
        ACTIVE_MW_CUR = (btn.dataset.sub === 'mw-pen') ? 'PEN' : 'USD';
        if (document.getElementById('mwViewChart')?.classList.contains('active')) renderMaturityChart();
        else renderMaturityTable();
      });
    });
  })();

  // Sub-pestañas del Reporte (toggle panes)
  (function wireReporteSubtabs(){
    const bar = document.getElementById('repSubtabs');
    if (!bar || bar.dataset.bound) return;
    bar.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-reptab]'); if(!btn) return;
      bar.querySelectorAll('.subtab').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');

      document.querySelectorAll('#repPanes .repPane').forEach(p=>p.classList.remove('active'));
      const pane = document.getElementById('repPane-'+btn.dataset.reptab);
      if (pane) pane.classList.add('active');

      // si estás en Cronograma, vuelve a pintar por si cambió la fecha o montos
      if (btn.dataset.reptab === 'crono') {
        try { renderCronograma(); } catch(e){ console.error('[Reporte] renderCronograma', e); }
      }
    });
    bar.dataset.bound = '1';
  })();

  // ==== Helpers genéricos
  const NZ = (x)=> Number.isFinite(+x) ? +x : 0;
  const USD = (n)=> (NZ(n)).toLocaleString('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0});
  const PCT = (n)=> (NZ(n)).toFixed(2)+'%';

  function parseDateLike(x){
    if(!x) return null;
    // acepta Date, 'YYYY-MM-DD', 'DD/MM/YYYY', etc.
    const t = (typeof x==='string') ? x.trim() : x;
    const d1 = (t instanceof Date) ? t : (/\d{4}-\d{2}-\d{2}/.test(t) ? new Date(t+'T00:00:00') : null);
    if (d1) return d1;
    const m = String(t).match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})$/);
    if (m){ const dd=+m[1], mm=+m[2]-1, yy=(+m[3]<100?2000+(+m[3]):+m[3]); return new Date(yy,mm,dd); }
    const d = new Date(t); return Number.isFinite(d?.getTime()) ? d : null;
  }
  function addMonths(d, m){ const x=new Date(d.getTime()); x.setMonth(x.getMonth()+m); return x; }
  function sameOrAfter(a,b){ return a.getTime() >= b.getTime(); }
  function before(a,b){ return a.getTime() < b.getTime(); }

  // ---- Detección de RF y lectura de campos de Posiciones/Activos
  function isRF(row){
    const clase = (row['Clase de Activo']||row['clase']||'').toString().toUpperCase();
    const veh   = (row['Vehiculo']||row['vehiculo']||'').toString().toUpperCase();
    return clase.includes('RENTA FIJA') || veh.includes('BONO');
  }
  function readFreq(row){
    // Busca explícitos: 'Frecuencia', 'Cupones/año', etc. Si no hay -> 2 (semestral).
    const fx = row['Frecuencia']||row['frecuencia']||row['Cupones/año']||row['cupones']||row['coupon_freq'];
    const v  = NZ(fx);
    return v>0 ? v : 2;
  }
  function readCouponPct(row){
    // 'Cupon' puede venir como porcentaje (5) o decimal (0.05). Normaliza a %.
    const raw = row['Cupon']||row['cupon']||row['Tasa']||row['tasa'];
    if (raw==null) return 0;
    const n = +raw;
    if (!Number.isFinite(n)) return 0;
    // Si parece decimal (<1), llévalo a %
    return (Math.abs(n) <= 1) ? (n*100) : n;
  }
  function readVencimiento(row){
    return parseDateLike(row['Venc']||row['Vencimiento']||row['Fecha Vencimiento']||row['venc']||row['vencimiento']);
  }
  function readProxCupon(row){
    return parseDateLike(row['Prox Cupon']||row['Fecha Próximo Cupón']||row['prox_cupon']||row['proxcupon']);
  }
  function readNominal(row){
    // Preferimos 'Nominal'. Si no, aproximamos por Monto/PrecioLimpio×100 si existen.
    const N = NZ(row['Nominal']||row['nominal']);
    if (N>0) return N;
    const monto = NZ(row['Monto']||row['monto']);
    const px = NZ(row['Precio Limpio']||row['Precio']||row['clean']||row['px']);
    return (monto>0 && px>0) ? Math.round(monto*100/px) : 0;
  }
  function readInstrumento(row){
    return (row['Producto']||row['Instrumento']||row['inst']||row['Emisor']||row['Bono']||'').toString();
  }
  function readClase(row){
    return (row['Clase de Activo']||row['clase']||'').toString();
  }

  // **Obtén tus filas RF**: ajusta esta función si tus datos viven en otra estructura
  function rfRowsFromPosiciones(){
    // Intenta detectar la tabla de Posiciones / dataset en memoria
    // 1) Si guardas una matriz global POSICIONES / rows, úsala:
    if (Array.isArray(window.POSICIONES)) return window.POSICIONES.filter(isRF);
    
    // 2) Usar LAST_HOLDINGS (USD y PEN combinados)
    const allRows = [];
    if (LAST_HOLDINGS && LAST_HOLDINGS.USD) allRows.push(...LAST_HOLDINGS.USD);
    if (LAST_HOLDINGS && LAST_HOLDINGS.PEN) allRows.push(...LAST_HOLDINGS.PEN);
    
    return allRows.filter(isRF);
  }

  // === Helper para mapear meses a números ===
  const MES2NUM = {
    'enero': 1, 'febrero': 2, 'marzo': 3, 'abril': 4, 'mayo': 5, 'junio': 6,
    'julio': 7, 'agosto': 8, 'septiembre': 9, 'octubre': 10, 'noviembre': 11, 'diciembre': 12,
    'january': 1, 'february': 2, 'march': 3, 'april': 4, 'may': 5, 'june': 6,
    'july': 7, 'august': 8, 'september': 9, 'october': 10, 'november': 11, 'december': 12
  };

  // === Helper para obtener bono por ID ===
  function bondById(id){
    if (!Array.isArray(BONDS)) return null;
    return BONDS.find(b => b && String(b.id||'').trim() === String(id||'').trim()) || null;
  }

  // Helper para obtener bono desde una fila (por nombre o ISIN)
  function _bondForRow(r){
    const is = normIsin(_isinOf(r));
    if (is) {
      const byIsin = (BONDS||[]).find(x => normIsin(x.ISIN) === is);
      if (byIsin) return byIsin;
    }
    const id = String(_nameOf(r)||'').trim();
    let b = bondById(id);
    if (!b && is){
      b = (BONDS||[]).find(x => String(x.id||'').toUpperCase().includes(is));
    }
    return b || null;
  }

  // Bonos con nominal (buy/sell) en lotes → filas sintéticas para Cronograma
  function _rowsBonosFromLots(){
    if (!state?.bondLots || !Array.isArray(BONDS)) return [];

    const out = [];
    const asOf = (typeof getAsOfDate==='function') ? getAsOfDate() : new Date();

    for (const bid of Object.keys(state.bondLots)){
      const buy  = toNum(state.bondLots[bid]?.buy?.nominal);
      const sell = toNum(state.bondLots[bid]?.sell?.nominal);
      const net  = (buy||0) - (sell||0);
      if (!net) continue; // sólo si hay posición neta ≠ 0

      const b = BONDS.find(x=> String(x.id).trim() === String(bid).trim());
      const cur = (b?.Moneda || 'USD');

      // Próximo cupón desde catálogo (ancla robusta)
      let prox = null;
      if (b){
        const { next } = couponDatesAround(b, asOf);
        prox = next || null;
      }

      out.push({
        // === mínimos de posiciones
        nombre: bid,
        clase: 'Renta Fija MP',
        fecha_compra: '', costo_compra: 0, unidades: 0,
        precio_mercado: 0, valor_mercado: 0, gp_no_realizada: 0,
        vehiculo: 'Bono',
        region: (b?.Region || 'Emergentes'),
        subclase: (b?.IGHY==='IG' ? 'Latam IG' : (b?.IGHY==='HY' ? 'Latam HY' : 'Corp')),
        _rid: `${cur}-BOND-${bid}`,
        _subn: '',
        _isin: (b?.ISIN ? normIsin(b.ISIN) : ''),
        _codSub: '',
        isBond: true,

        // === CLAVE: datos que usa el cronograma (para no depender del fallback)
        Producto: 'CUENTA VALOR',
        Cupon: (b?.Cup != null ? b.Cup : undefined),              // en %
        Frecuencia: (b?.Freq != null ? b.Freq : 2),               // cupones/año
        'Fecha Vencimiento': (b?.Venc || ''),                     // string fecha
        'Fecha Próximo Cupón': prox || ''                         // Date o ''
      });
    }
    return out;
  }

  // === Helper para tasa de impuesto por bono ===
  function taxRateForBond(b){
    // Por defecto usa CRONO_IR_RATE, pero puedes personalizar por bono
    return CRONO_IR_RATE;
  }

  // === Helper para formato USD ===
  const F = {
    usd0: (v) => _USD(v)
  };

  // === Adaptador universal de fuente ===
  // 1) Si existe window.LAST_HOLDINGS (como en Asesor360), lo mapeo a "filas portafolio"
  // 2) Si no existe, uso state.cartera (comportamiento original)
  function getPortfolioRowsForCrono(){
    // Caso A: tienes un arreglo de holdings "externo" (Asesor360) por moneda
    if (window.LAST_HOLDINGS && Array.isArray(LAST_HOLDINGS.USD)) {
      const rows = (LAST_HOLDINGS.USD || []).map(h => {
        const nombre = String(h.Producto || h.Instrumento || h.nombre || '').trim();
        const veh    = String(h.Vehiculo || h.vehiculo || '').trim();
        const clase  = String(h['Clase de Activo'] || h.clase || '').trim();
        const px     = Number(String(h['Precio Limpio'] || h['Precio'] || h.clean || h.px || '').toString().replace(',', '.')) || 0;
        const vm     = Number(h.valor_mercado || h.Monto || 0) || 0;

        // nominal: explícito, o vm / (px%/100), o 0
        let nominal = Number(h.Nominal || h['Nominal Actual'] || 0) || 0;
        if (!nominal && px > 0 && vm > 0) nominal = Math.round(vm * 100 / px);

        // intento de id de bono: usa el texto de producto
        const bond = (Array.isArray(BONDS) ? BONDS.find(b => b && String(b.id||'').trim() === nombre) : null);

        return {
          clase, inst: nombre, veh,
          isBond: !!bond || /bono/i.test(veh),
          bondId: bond ? bond.id : undefined,
          // estos dos los usa el cronograma
          monto: vm,
          _nominalHint: nominal
        };
      });

      // si hay al menos una fila, úsalo
      if (rows.length) return rows;
    }

    // Caso B: tu comportamiento original (usa el portafolio interno)
    return Array.isArray(state.cartera) ? state.cartera.slice() : [];
  }

  // Nominal efectivo de una fila (estado del modal si existe; si no, pistas de la fuente)
  function nominalForRow(r){
    if (r.isBond) {
      // 1) si es un bono del portafolio interno → usa bondLots
      if (r.bondId && state.bondLots && state.bondLots[r.bondId]) {
        return Number(state.bondLots[r.bondId].buy?.nominal || state.bondLots[r.bondId].nominal || 0) || 0;
      }
      // 2) si vino de holdings externos (adaptador) → pista calculada
      if (r._nominalHint) return Number(r._nominalHint) || 0;
    }
    return 0;
  }

  // ==== Render principal
  // === REGLA ÚNICA: listar TODOS los instrumentos que están en Posiciones ===

  // =====================================================
  // SISTEMA DE LOGGING PARA DEBUG DE CUPONERA
  // =====================================================
  // SISTEMA DE LOGGING SIMPLIFICADO (solo console.log)
  const CUPONERA_LOG = {
    enabled: true,
    clear() {},
    log(type, message, data = {}) {
      if (!this.enabled) return;
    },
    info(msg, data) { this.log('INFO', msg, data); },
    warn(msg, data) { this.log('WARN', msg, data); },
    error(msg, data) { this.log('ERROR', msg, data); },
    debug(msg, data) { this.log('DEBUG', msg, data); }
  };

  // === Cronograma para ACTIVOS (ETF, ACCIÓN, CLN, FONDO CERRADO) ===
  // Reutiliza los mapas ACT ya poblados desde Activos.csv

  function _proxCuponDateActivo(row){
    const isin  = String(row._isin || row.ISIN || row.isin || '').trim();
    const codp  = String(row._codSub || row.CodSubproducto || row.codsubproducto || '').trim();
    const subn0 = String(row._subn || row.Subproducto || row.subproducto || row.nombre || '').trim();
    const subn  = typeof normTxt === 'function' ? normTxt(subn0) : subn0;

    const s =
      (isin && ACT?.proxcupon_by_isin?.get?.(isin)) ||
      (codp && ACT?.proxcupon_by_codprod?.get?.(codp)) ||
      (subn && ACT?.proxcupon_by_subprod_name?.get?.(subn)) ||
      '';

    // Usar parseDateLike que maneja d/mm/aaaa o ISO
    const d = (typeof parseDateLike === 'function') ? parseDateLike(s) : new Date(s);
    return (d && !isNaN(d)) ? d : null;
  }

  function fechasDivActivos(row, inicio, fin){
    const f = Number(_freqOf(row) || 0);
    if (!f || f <= 0) return [];
    const step = Math.round(12 / f);

    const anc = _proxCuponDateActivo(row);
    if (!anc) return [];

    // Usamos solo mes y día del ancla; el año se ignora (se repite cada período)
    const anchorMonth = anc.getMonth();
    const anchorDay   = anc.getDate();

    // Primera fecha >= inicio con ese mes/día; se usa addMonthsKeepEOM si existe
    let y = inicio.getFullYear();
    let cur = new Date(y, anchorMonth, anchorDay);
    if (cur < inicio) {
      if (typeof addMonthsKeepEOM === 'function') cur = addMonthsKeepEOM(cur, step);
      else cur = new Date(cur.getFullYear(), cur.getMonth()+step, cur.getDate());
    }

    const out = [];
    while (cur <= fin){
      out.push(new Date(cur.getFullYear(), cur.getMonth(), cur.getDate()));
      if (typeof addMonthsKeepEOM === 'function') cur = addMonthsKeepEOM(cur, step);
      else cur = new Date(cur.getFullYear(), cur.getMonth()+step, cur.getDate());
    }
    return out;
  }

  function montoDivActivoEnFecha(row, fecha){
    // OJO: Monto Final; _montoFinalOf ya existe en el proyecto y se usa en cuponera
    const pct  = Number(_couponPctOf(row) || 0) / 100;
    const freq = Number(_freqOf(row) || 0);
    if (!pct || !freq) return 0;
    const M = (typeof _montoFinalOf === 'function') ? _montoFinalOf(row) : 0;
    return (Number(M) || 0) * pct / freq;
  }

  function construirCupones12Meses(inicio, fin, headers){
    CUPONERA_LOG.clear();
    CUPONERA_LOG.info('=== INICIO CONSTRUCCIÓN DE CUPONERA ===', {
      inicio: inicio.toISOString(),
      fin: fin.toISOString(),
      headers
    });

    const totalesMes = Object.fromEntries(headers.map(h => [h, 0]));
    const filas = [];

    const rowsHoldings = []
      .concat(LAST_HOLDINGS?.USD || [])
      .concat(LAST_HOLDINGS?.PEN || []);

    CUPONERA_LOG.info('Holdings cargados', {
      totalRows: rowsHoldings.length,
      USD: LAST_HOLDINGS?.USD?.length || 0,
      PEN: LAST_HOLDINGS?.PEN?.length || 0
    });

    // Deduplicar por ISIN o nombre para evitar duplicados cuando se agregan bonos existentes
    const isinSet = new Set(rowsHoldings.map(r => normIsin(r._isin || r.ISIN || r.isin)).filter(Boolean));
    const nombreSet = new Set(rowsHoldings.map(r => String(r.nombre || '').trim().toUpperCase()).filter(Boolean));
    
    const extraBondRows = _rowsBonosFromLots()
      .filter(r => {
        const isin = normIsin(r._isin || r.ISIN || r.isin);
        const nombre = String(r.nombre || r.Nombre || '').trim().toUpperCase();
        
        // Excluir si ISIN ya existe
        if (isin && isinSet.has(isin)) return false;
        
        // Excluir si nombre ya existe (para bonos sin ISIN)
        if (nombre && nombreSet.has(nombre)) return false;
        
        return true;
      });

    CUPONERA_LOG.info('Bonos adicionales del mini-modal', {
      extraBondRows: extraBondRows.length
    });

    const cronoMoneda = ACTIVE_CRONO_CUR; // USD, PEN o TOTAL
    const rows = rowsHoldings.concat(extraBondRows)
      .filter(eligibleForCrono)
      .filter(r => {
        if (cronoMoneda === 'TOTAL') return true; // Incluir todas las monedas
        const cur = r.Moneda || r.moneda || (r._rid && r._rid.startsWith('USD') ? 'USD' : 'PEN');
        return cur === cronoMoneda;
      });

    // Ordenar por vehículo
    rows.sort((a, b) => {
      const vehA = (a.vehiculo || a.Vehiculo || '').toUpperCase();
      const vehB = (b.vehiculo || b.Vehiculo || '').toUpperCase();
      return vehA.localeCompare(vehB);
    });

    CUPONERA_LOG.info('Filas después de filtro eligibleForCrono', {
      totalElegibles: rows.length
    });

    let activosProcesados = 0;
    let activosConCupones = 0;
    let activosRechazados = 0;

    // === CUPONES DE CLN NUEVOS (lógica específica) ===
    const clnNuevos = rows.filter(r => {
      const { gprod } = _prodVehGroupOf(r);
      return gprod === 'CLN' && r._rid && r._rid.includes('-OA-') && !!r.clnFechaInicio;
    });

    CUPONERA_LOG.info('CLN nuevos detectados', { total: clnNuevos.length });

    clnNuevos.forEach(cln => {
      const fechaInicio = parseDMYStrict(cln.clnFechaInicio);
      const fechaFin = parseDMYStrict(cln.clnFechaFin);
      
      if (!fechaInicio || !fechaFin) {
        CUPONERA_LOG.warn('CLN sin fechas válidas', { nombre: cln.nombre });
        return;
      }
      
      const tasaAnual = Number(cln.clnTasaCupon) / 100;
      const cur = cln.Moneda || cln.moneda || (cln._rid && cln._rid.startsWith('USD') ? 'USD' : 'PEN');
      let nominal = Number(edits[cur]?.get(cln._rid)) || 0;
      
      // NO convertir - mostrar en moneda original
      
      if (nominal <= 0) {
        CUPONERA_LOG.warn('CLN sin monto', { nombre: cln.nombre });
        return;
      }
      
      CUPONERA_LOG.info('Procesando CLN', {
        nombre: cln.nombre,
        fechaInicio: cln.clnFechaInicio,
        fechaFin: cln.clnFechaFin,
        tasa: cln.clnTasaCupon,
        nominal
      });
      
      const linea = Object.fromEntries(headers.map(h => [h, 0]));
      let totalAnual = 0;
      
      // Generar pagos: solo 9 de enero y 9 de julio
      let fechaPago = new Date(fechaInicio);
      
      // Ajustar al primer pago (siguiente 9 ene o 9 jul después de fecha inicio)
      if (fechaPago.getMonth() < 6) {
        fechaPago.setMonth(6, 9); // Julio 9
        if (fechaPago <= fechaInicio) {
          fechaPago.setFullYear(fechaPago.getFullYear() + 1);
          fechaPago.setMonth(0, 9); // Enero 9
        }
      } else {
        fechaPago.setFullYear(fechaPago.getFullYear() + 1);
        fechaPago.setMonth(0, 9); // Enero 9
      }
      
      let fechaAnterior = new Date(fechaInicio);
      
      // Generar todos los pagos hasta el vencimiento (no depende del periodo de la cuponera)
      while (fechaPago <= fechaFin) {
        // Ajustar a fecha útil (si cae sábado/domingo)
        const fechaPagoFinal = new Date(fechaPago);
        const dia = fechaPagoFinal.getDay();
        if (dia === 0) fechaPagoFinal.setDate(10); // domingo -> lunes
        else if (dia === 6) fechaPagoFinal.setDate(11); // sábado -> lunes
        
        // Solo agregar si está dentro del rango de la cuponera
        if (fechaPagoFinal >= inicio && fechaPagoFinal <= fin) {
          // Calcular días transcurridos
          const diasTranscurridos = Math.round((fechaPagoFinal - fechaAnterior) / (1000 * 60 * 60 * 24));
          const cupon = (nominal * tasaAnual * diasTranscurridos) / 360;
          
          const mesKey = headers.find(h => {
            const [mesAbrev, anio] = h.split(' ');
            const meses = { 'ENE': 1, 'FEB': 2, 'MAR': 3, 'ABR': 4, 'MAY': 5, 'JUN': 6, 
                            'JUL': 7, 'AGO': 8, 'SEP': 9, 'OCT': 10, 'NOV': 11, 'DIC': 12 };
            const mesNum = meses[mesAbrev];
            const anioNum = 2000 + parseInt(anio);
            return mesNum === fechaPagoFinal.getMonth() + 1 && anioNum === fechaPagoFinal.getFullYear();
          });
          if (mesKey && linea[mesKey] !== undefined) {
            linea[mesKey] += cupon;
            // Para totalesMes: convertir PEN a USD si es TOTAL
            if (ACTIVE_CRONO_CUR === 'TOTAL' && cur === 'PEN') {
              const tcConv = parseFloat(document.getElementById('tipoCambio')?.value) || 3.40;
              totalesMes[mesKey] = (totalesMes[mesKey] || 0) + cupon / tcConv;
            } else {
              totalesMes[mesKey] = (totalesMes[mesKey] || 0) + cupon;
            }
            totalAnual += cupon;
          }
          
          CUPONERA_LOG.debug('Cupón CLN calculado', {
            fecha: fechaPagoFinal.toISOString().split('T')[0],
            dias: diasTranscurridos,
            cupon
          });
          
          fechaAnterior = new Date(fechaPagoFinal);
        }
        
        // Avanzar 6 meses (enero <-> julio)
        if (fechaPago.getMonth() === 0) {
          fechaPago.setMonth(6, 9);
        } else {
          fechaPago.setFullYear(fechaPago.getFullYear() + 1);
          fechaPago.setMonth(0, 9);
        }
      }
      
      if (totalAnual > 0) {
        filas.push({
          Instrumento: cln.nombre || '—',
          ...linea,
          Total: totalAnual,
          _moneda: cur
        });
        activosConCupones++;
        CUPONERA_LOG.info('✅ CLN agregado a cuponera', {
          nombre: cln.nombre,
          totalAnual
        });
      }
    });

    // Excluir CLN nuevos del procesamiento normal
    const rowsSinCLNNuevos = rows.filter(r => {
      const { gprod } = _prodVehGroupOf(r);
      const esCLNNuevo = gprod === 'CLN' && r._rid && r._rid.includes('-OA-') && r.clnFechaInicio;
      return !esCLNNuevo;
    });

    for (const r of rowsSinCLNNuevos) {
      activosProcesados++;
      
      // Extraer información del activo
      const isin = normIsin(r._isin || r.ISIN || r.isin);
      const nombre = String(
        r['Subproducto'] || r.Subproducto ||
        r['Bono'] || r.Bono ||
        r['Instrumento'] || r.Instrumento ||
        r['Nombre'] || r.Nombre ||
        r.nombre ||
        r['isin'] || r['Isin'] || r['ISIN'] || r.isin || r.Isin || r.ISIN ||
        r['Emisor'] || r.Emisor ||
        r['Instrument'] || r.instrument ||
        ''
      ).trim();
      
      const { prod, veh, gprod } = _prodVehGroupOf(r);
      const esBono = (r.isBond === true) || /BONO/i.test(String(veh || ''));
      const montoFinal = typeof _montoFinalOf === 'function' ? _montoFinalOf(r) : 0;
      const divYield = _couponPctOf(r);
      const freq = _freqOf(r);
      const fechaPago = esBono ? _proxCuponOf(r) : _proxCuponDateActivo(r);
      
      const logData = {
        activo: nombre,
        isin,
        producto: prod,
        vehiculo: veh,
        grupo: gprod,
        esBono,
        montoFinal,
        divYield,
        freq,
        fechaPago: fechaPago ? fechaPago.toISOString() : null,
        tieneMontoFinal: montoFinal > 0,
        tieneDivYield: divYield > 0,
        tieneFreq: freq > 0,
        tieneFechaPago: !!fechaPago
      };

      // Verificar si el activo califica para estar en cuponera
      if (montoFinal <= 0) {
        CUPONERA_LOG.warn('❌ Activo rechazado: Monto Final <= 0', logData);
        activosRechazados++;
        continue;
      }

      if (divYield <= 0) {
        CUPONERA_LOG.warn('❌ Activo rechazado: Dividend Yield/Cupón <= 0', logData);
        activosRechazados++;
        continue;
      }

      if (freq <= 0) {
        CUPONERA_LOG.warn('❌ Activo rechazado: Frecuencia <= 0', logData);
        activosRechazados++;
        continue;
      }

      if (!fechaPago) {
        CUPONERA_LOG.warn('❌ Activo rechazado: No tiene Fecha de Pago', logData);
        activosRechazados++;
        continue;
      }

      CUPONERA_LOG.info('✅ Activo elegible para cuponera', logData);

      const linea = Object.fromEntries(headers.map(h => [h, 0]));
      const fechas = esBono ? fechasCuponBond(r, inicio, fin)
                      : fechasDivActivos(r, inicio, fin);
      
      CUPONERA_LOG.debug('Fechas calculadas para activo', {
        activo: nombre,
        fechas: fechas.map(f => f.toISOString()),
        totalFechas: fechas.length
      });

      // Determinar si es Pool de Bonos (fondo amortizable)
      const esPoolBonos = (prod === 'FONDOS MUTUOS' && gprod === 'POOL DE BONOS');

      const _montoEnFecha = esBono
        ? (f)=> montoCuponBondEnFecha(r, f)
        : esPoolBonos
          ? (f)=> montoCuponFondoEnFecha(r, f)
          : (f)=> montoDivActivoEnFecha(r, f);
      
      const vcto = parseDMYStrict(r['Fecha VCTO'] || r['Fecha Vencimiento'] || r['Vencimiento'] || r['Venc'] || r['Fecha Vcto']);
      
      let cuponesAgregados = 0;
      for (const f of fechas) {
        if (vcto && f > vcto) continue;
        const idx = (f.getFullYear() - inicio.getFullYear()) * 12 + (f.getMonth() - inicio.getMonth());
        const k = (idx >= 0 && idx < headers.length) ? headers[idx] : null;
        let m = (k ? _montoEnFecha(f) : 0);
        // NO convertir - mostrar en moneda original
        if (m > 0 && k) {
          linea[k] += m;
          // Para totalesMes: convertir PEN a USD si es TOTAL
          if (ACTIVE_CRONO_CUR === 'TOTAL') {
            const curRow = r.Moneda || r.moneda || (r._rid && r._rid.startsWith('USD') ? 'USD' : 'PEN');
            if (curRow === 'PEN') {
              const tcConv = parseFloat(document.getElementById('tipoCambio')?.value) || 3.40;
              totalesMes[k] += m / tcConv;
            } else {
              totalesMes[k] += m;
            }
          } else {
            totalesMes[k] += m;
          }
          cuponesAgregados++;
          
          CUPONERA_LOG.debug('Cupón agregado', {
            activo: nombre,
            fecha: f.toISOString(),
            mes: k,
            monto: m
          });
        }
      }
      
      const total = headers.reduce((s, h) => s + linea[h], 0);
      // Determinar moneda del activo
      const monedaActivo = r.Moneda || r.moneda || (r._rid && r._rid.startsWith('USD') ? 'USD' : 'PEN');
      
      if (total > 0) {
        filas.push({
          Instrumento: nombre || '—',
          ...linea,
          Total: total,
          _moneda: monedaActivo
        });
        activosConCupones++;
        
        CUPONERA_LOG.info('✅ Activo agregado a cuponera', {
          activo: nombre,
          cuponesAgregados,
          totalAnual: total
        });
      } else {
        CUPONERA_LOG.warn('⚠️ Activo no agregado: Total = 0', {
          activo: nombre,
          cuponesAgregados
        });
      }
    }

    // === CUPONES DE CUENTA A PLAZO (DPF) ===
    const dpfRows = rowsHoldings.filter(r => {
      if (!isCuentaAPlazo(r)) return false;
      if (cronoMoneda === 'TOTAL') return true; // Incluir todas las monedas en TOTAL
      const cur = r.Moneda || r.moneda || (r._rid && r._rid.startsWith('USD') ? 'USD' : 'PEN');
      return cur === cronoMoneda;
    });

    dpfRows.forEach(dpf => {
      const fechaVcto = dpf.fechavcto;
      if (!fechaVcto) return;
      
      // Parsear fecha
      const fechaVctoDate = parseDMYStrict(fechaVcto);
      
      if (!fechaVctoDate || fechaVctoDate < inicio || fechaVctoDate > fin) return;
      
      // Calcular interés
      const principal = (typeof _montoFinalOf === 'function' ? _montoFinalOf(dpf) : toNum(dpf.valor_mercado)) || 0;
      if (principal === 0) return;
      
      const plazoStr = String(dpf.plazo || '');
      let dias = 0;
      if (plazoStr.startsWith('D')) {
        dias = parseInt(plazoStr.substring(1));
      } else if (plazoStr.startsWith('M')) {
        const meses = parseInt(plazoStr.substring(1));
        dias = meses * 30;
      }
      
      // Extraer tasa del nombre (ej: "DPF ... - 1.60% ...")
      const tasaMatch = dpf.nombre.match(/(\d+\.?\d*)%/);
      const tasa = tasaMatch ? parseFloat(tasaMatch[1]) : toNum(dpf.tasa);
      const interes = dias > 0 && tasa > 0 ? principal * (tasa / 100) * (dias / 360) : 0;
      
      if (interes === 0) return;
      
      // Agregar a la fila de cuponera
      const claveMesVcto = claveMes(fechaVctoDate);
      const monedaDPF = dpf.Moneda || dpf.moneda || (dpf._rid && dpf._rid.startsWith('USD') ? 'USD' : 'PEN');
      
      // Modificar nombre para incluir moneda si es TOTAL
      let nombre = dpf.nombre || 'DPF';
      if (ACTIVE_CRONO_CUR === 'TOTAL') {
        if (nombre.startsWith('DPF ')) {
          nombre = `DPF ${monedaDPF} ` + nombre.substring(4);
        } else if (nombre.startsWith('DPF')) {
          nombre = `DPF ${monedaDPF}` + nombre.substring(3);
        }
      }
      
      let fila = filas.find(f => f.Instrumento === nombre);
      if (!fila) {
        fila = { Instrumento: nombre, _moneda: monedaDPF };
        headers.forEach(h => fila[h] = 0);
        fila.Total = 0;
        filas.push(fila);
      }
      
      fila[claveMesVcto] = (fila[claveMesVcto] || 0) + Math.round(interes);
      fila.Total = (fila.Total || 0) + Math.round(interes);
      
      // Para totalesMes: convertir PEN a USD si es TOTAL
      if (ACTIVE_CRONO_CUR === 'TOTAL' && monedaDPF === 'PEN') {
        const tcConv = parseFloat(document.getElementById('tipoCambio')?.value) || 3.40;
        totalesMes[claveMesVcto] = (totalesMes[claveMesVcto] || 0) + Math.round(interes / tcConv);
      } else {
        totalesMes[claveMesVcto] = (totalesMes[claveMesVcto] || 0) + Math.round(interes);
      }
    });

    CUPONERA_LOG.info('=== FIN CONSTRUCCIÓN DE CUPONERA ===', {
      activosProcesados,
      activosConCupones,
      activosRechazados,
      filasEnCuponera: filas.length,
      totalMeses: headers.length
    });


    return { headers, filas, totalesMes };
  }

  function construirTablaAmortizaciones() {
    const tbody = document.querySelector('#tablaAmort tbody');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    // Obtener fecha de datos del dashboard
    const fechaDatosInput = document.getElementById('fechaDatosInput');
    const fechaDatosStr = fechaDatosInput?.value || '';
    const fechaDatos = fechaDatosStr ? parseDMYStrict(fechaDatosStr) : new Date();
    fechaDatos.setHours(0, 0, 0, 0);
    
    const filas = [];
    
    // === 1. BONOS (por ISIN) ===
    if (AMORTS_BY_ISIN) {
      let allRows = [...(LAST_HOLDINGS.USD || []), ...(LAST_HOLDINGS.PEN || [])];
      
      // Si no hay holdings, salir inmediatamente
      if (allRows.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="center muted">Cargue un código de cliente primero</td></tr>';
        return;
      }
      
      // Deduplicar por ISIN o nombre para evitar duplicados
      const isinSet = new Set(allRows.map(r => normIsin(r._isin || r.ISIN || r.isin)).filter(Boolean));
      const nombreSet = new Set(allRows.map(r => String(r.nombre || '').trim().toUpperCase()).filter(Boolean));
      
      const extraBondRows = (typeof _rowsBonosFromLots === 'function' ? _rowsBonosFromLots() : [])
        .filter(r => {
          const isin = normIsin(r._isin || r.ISIN || r.isin);
          const nombre = String(r.nombre || r.Nombre || '').trim().toUpperCase();
          
          // Excluir si ISIN ya existe
          if (isin && isinSet.has(isin)) return false;
          
          // Excluir si nombre ya existe (para bonos sin ISIN)
          if (nombre && nombreSet.has(nombre)) return false;
          
          return true;
        });
      
      const cronoMoneda = ACTIVE_CRONO_CUR;
      const todosLosBonos = allRows.concat(extraBondRows).filter(b => {
        if (cronoMoneda === 'TOTAL') return true; // Incluir todas las monedas
        const cur = b.Moneda || b.moneda || (b._rid && b._rid.startsWith('USD') ? 'USD' : 'PEN');
        return cur === cronoMoneda;
      });
      
      for (const isin in AMORTS_BY_ISIN) {
        const amorts = AMORTS_BY_ISIN[isin];
        if (!amorts || amorts.length === 0) continue;
        
        // Buscar el bono en holdings
        const bono = todosLosBonos.find(r => {
          const rowIsin = String(r._isin || r.ISIN || r.isin || '').trim().toUpperCase();
          return rowIsin === isin;
        });
        
        if (!bono) continue;
        
        const nombre = String(
          bono.nombre || bono.Nombre || bono.Subproducto || bono.subproducto || isin
        ).trim();
        
        const vehiculo = String(bono.vehiculo || bono.Vehiculo || '').trim();
        const nominal = Number(_nominalOf ? _nominalOf(bono) : 0);
        const { gprod } = _prodVehGroupOf(bono);
        
        // Agregar cada amortización FUTURA
        amorts.forEach((a, idx) => {
          if (a.d < fechaDatos) return;
          
          // Calcular factor remanente actual (después de amortizaciones pasadas)
          let factorRemActual = 1;
          amorts.forEach(ax => {
            if (ax.d <= fechaDatos) {
              factorRemActual = Number(ax.after);
            }
          });
          
          // Ajustar factores al nominal actual (no al original)
          const montoAmort = factorRemActual > 0 ? nominal * Number(a.fac) / factorRemActual : 0;
          const valorReman = factorRemActual > 0 ? nominal * Number(a.after) / factorRemActual : 0;
          const esUltima = (idx === amorts.length - 1) || (Number(a.after) === 0);
          
          // Determinar moneda del bono
          const monedaBono = bono.Moneda || bono.moneda || (bono._rid && bono._rid.startsWith('USD') ? 'USD' : 'PEN');
          
          filas.push({
            vehiculo,
            nombre,
            tipoActivo: gprod || 'No definido',
            fecha: a.d,
            pctAmort: Number(a.fac) * 100,
            montoAmort,
            valorReman,
            concepto: esUltima ? 'Vencimiento' : 'Amortización',
            tipo: esUltima ? 'Bono-venc' : 'Bono-amort',
            _moneda: monedaBono
          });
        });
      }
    }
    
    // === 2. FONDOS (por CodSubproducto) ===
    if (window.AMORTS_BY_CODSUB) {
      let allRows = [...(LAST_HOLDINGS.USD || []), ...(LAST_HOLDINGS.PEN || [])];
      
      if (allRows.length === 0) return; // Salir si no hay datos
      
      // Filtrar por moneda
      const cronoMoneda = ACTIVE_CRONO_CUR;
      const allRowsFiltrados = allRows.filter(r => {
        const cur = r.Moneda || r.moneda || (r._rid && r._rid.startsWith('USD') ? 'USD' : 'PEN');
        return cur === cronoMoneda;
      });
      
      for (const codSub in window.AMORTS_BY_CODSUB) {
        const amorts = window.AMORTS_BY_CODSUB[codSub];
        if (!amorts || amorts.length === 0) continue;
        
        const fondo = allRowsFiltrados.find(r => {
          const rowCod = String(r._codSub || r.CodSubproducto || r.codsubproducto || '').trim();
          return rowCod === codSub;
        });
        
        if (!fondo) continue;
        
        const nombre = String(fondo.nombre || fondo.Nombre || fondo.Subproducto || '').trim();
        const vehiculo = String(fondo.vehiculo || fondo.Vehiculo || 'FONDO MUTUO').trim();
        const valorMercado = Number(fondo.valor_mercado || fondo.SaldoactualDetalleUSD || 0);
        const { gprod } = _prodVehGroupOf(fondo);
        
        // Agregar cada amortización FUTURA
        amorts.forEach((a, idx) => {
          if (a.d < fechaDatos) return;
          
          const montoAmort = valorMercado * (Number(a.fac) || 0);
          const valorReman = valorMercado * (Number(a.after) || 0);
          const esUltima = (idx === amorts.length - 1) || (Number(a.after) === 0);
          
          // Determinar moneda del fondo
          const monedaFondo = fondo.Moneda || fondo.moneda || (fondo._rid && fondo._rid.startsWith('USD') ? 'USD' : 'PEN');
          
          filas.push({
            vehiculo,
            nombre,
            tipoActivo: 'Pool de Bonos',
            fecha: a.d,
            pctAmort: Number(a.fac) * 100,
            montoAmort,
            valorReman,
            concepto: esUltima ? 'Vencimiento' : 'Amortización',
            tipo: 'Fondo',
            _moneda: monedaFondo
          });
        });
      }
    }
    
    // === 3. AGREGAR VENCIMIENTOS (para bonos/CLN sin amortizaciones) ===
    // Usar BONDS como fallback si LAST_HOLDINGS está vacío
    let allRows = [...(LAST_HOLDINGS.USD || []), ...(LAST_HOLDINGS.PEN || [])];
    
    if (allRows.length === 0 && window.BONDS) {
      allRows = window.BONDS.map(b => ({
        _isin: b.ISIN,
        ISIN: b.ISIN,
        isin: b.ISIN,
        nombre: b.Bono,
        Nombre: b.Bono,
        Subproducto: b.Bono,
        Moneda: b.Moneda,
        moneda: b.Moneda,
        vehiculo: 'BONO',
        Vehiculo: 'BONO',
        _rid: (b.Moneda === 'PEN' || b.Moneda === 'S/') ? 'PEN-' + b.ISIN : 'USD-' + b.ISIN,
        fechavcto: b.FechaVcto || b.fechavcto,
        _nominalHint: 99000
      }));
    }
    
    // Deduplicar por ISIN o nombre para evitar duplicados
    const isinSet = new Set(allRows.map(r => normIsin(r._isin || r.ISIN || r.isin)).filter(Boolean));
    const nombreSet = new Set(allRows.map(r => String(r.nombre || '').trim().toUpperCase()).filter(Boolean));
    
    const extraBondRows = (typeof _rowsBonosFromLots === 'function' ? _rowsBonosFromLots() : [])
      .filter(r => {
        const isin = normIsin(r._isin || r.ISIN || r.isin);
        const nombre = String(r.nombre || r.Nombre || '').trim().toUpperCase();
        
        // Excluir si ISIN ya existe
        if (isin && isinSet.has(isin)) return false;
        
        // Excluir si nombre ya existe (para bonos sin ISIN)
        if (nombre && nombreSet.has(nombre)) return false;
        
        return true;
      });
    
    const todosLosBonos = allRows.concat(extraBondRows);
    
    const todosFiltrados = todosLosBonos.filter(b => {
      if (ACTIVE_CRONO_CUR === 'TOTAL') return true; // Incluir todas las monedas
      const cur = b.Moneda || b.moneda || (b._rid && b._rid.startsWith('USD') ? 'USD' : 'PEN');
      return cur === ACTIVE_CRONO_CUR;
    });
    
    todosFiltrados.forEach(bono => {
      const isin = String(bono._isin || bono.ISIN || bono.isin || '').trim().toUpperCase();
      const codSub = String(bono._codSub || bono.CodSubproducto || bono.codsubproducto || '').trim();
      const veh = String(bono.vehiculo || bono.Vehiculo || '').toUpperCase();
      
      // Solo bonos/BEST
      if (!veh.includes('BONO') && !veh.includes('BEST')) return;
      
      // Si tiene amortizaciones (ISIN o CodSub), saltar
      if (isin && AMORTS_BY_ISIN && AMORTS_BY_ISIN[isin]) return;
      if (codSub && window.AMORTS_BY_CODSUB && window.AMORTS_BY_CODSUB[codSub]) return;
      
      // Verificar Grupo Producto
      const { gprod } = _prodVehGroupOf(bono);
      
      // Excluir Pool de Bonos
      if (gprod === 'POOL DE BONOS') return;
      
      let fechaVcto = null;
      let tipoBono = '';
      
      // PRIORIDAD 1: fechavcto del holding (Asesor360)
      if (gprod === 'CLN') {
        // Para CLN nuevos, usar clnFechaFin
        if (bono.clnFechaFin) {
          fechaVcto = parseDMYStrict(bono.clnFechaFin);
        } else if (bono.fechavcto) {
          // Para CLN del Asesor360
          fechaVcto = parseDMYStrict(bono.fechavcto);
        }
      } else if (bono.fechavcto) {
        fechaVcto = parseDMYStrict(bono.fechavcto);
      }
      
      // PRIORIDAD 1.5: Para bonos sintéticos, buscar en catálogo BONDS/BONDS_BY_ISIN
      if (!fechaVcto) {
        // 1) intenta catálogo por ISIN
        const isin = (bono._isin || bono.ISIN || bono.isin || '').toUpperCase();
        let b = isin ? (window.BONDS_BY_ISIN?.get(isin) || null) : null;
        // 2) si no, empareja por id/nombre del bono (synthetic row: nombre = bid)
        if (!b) b = window.BONDS?.find(x => String(x.id).toUpperCase() === String(bono.nombre||'').toUpperCase()) || null;
        const fv = b?.Venc || b?.['Fecha Vencimiento'] || b?.Vencimiento || b?.['vencimiento'];
        if (fv){
          // usa el mismo parser que el resto del archivo
          const d = (typeof parseDateLike==='function') ? parseDateLike(fv) : parseDMYStrict(fv);
          if (d) fechaVcto = d;
        }
      }
      
      // PRIORIDAD 2: Buscar en ACTIVOS_RAW por ISIN o Subproducto
      if (!fechaVcto && window.ACTIVOS_RAW) {
        const nombreBuscar = String(bono.nombre || bono.Nombre || bono.Subproducto || '').trim().toUpperCase();
        
        const activoData = window.ACTIVOS_RAW.find(r => {
          // Buscar por ISIN
          if (isin && String(r.isin || '').toUpperCase() === isin) return true;
          // Buscar por nombre/subproducto
          const nombreActivo = String(r.subproducto || r.nombre || '').trim().toUpperCase();
          return nombreActivo && nombreBuscar && nombreActivo === nombreBuscar;
        });
        
        if (activoData) {
          fechaVcto = parseDMYStrict(
            activoData['f.vencimientodet'] || 
            activoData['fvencimientodet'] || 
            activoData['F.VencimientoDet'] ||
            activoData.fechavcto ||
            activoData.fechavencimiento
          );
        }
      }
      
      // PRIORIDAD 3: Para bonos (no CLN), buscar en BONDS_RAW
      if (!fechaVcto && gprod !== 'CLN') {
        const bondData = isin && window.BONDS_RAW ? 
          window.BONDS_RAW.find(r => String(r.isin || r.ISIN || '').toUpperCase() === isin) : 
          null;
        
        if (bondData) {
          tipoBono = String(bondData.tipobono || bondData['Tipo Bono'] || '').toUpperCase();
          if (tipoBono.includes('CALL') || tipoBono.includes('SINK')) return;
          
          fechaVcto = parseDMYStrict(bondData.fechavcto || bondData.FechaVcto || bondData['Fecha Vcto']);
        }
      }
      
      if (!fechaVcto || fechaVcto < fechaDatos) return;
      
      const nombre = String(
        bono.nombre || bono.Nombre || bono.Subproducto || bono.subproducto || isin
      ).trim();
      
      const vehiculo = String(bono.vehiculo || bono.Vehiculo || '').trim();
      // Para CLN nuevos, usar el rebalanceo; para otros, usar _nominalOf
      let nominal = 0;
      const vehTxt = String(bono.vehiculo || '').toUpperCase();
      const isBEST = vehTxt.includes('BEST');

      if (gprod === 'CLN' && bono._rid && bono._rid.includes('-OA-')) {
        // CLN nuevo: usar rebalanceo
        const cur = bono.Moneda || bono.moneda || (bono._rid && bono._rid.startsWith('USD') ? 'USD' : 'PEN');
        nominal = Number(edits[cur]?.get(bono._rid)) || 0;
      } else if (isBEST) {
        // BEST: usar valor de mercado en lugar de nominal
        nominal = (typeof _montoFinalOf === 'function' ? _montoFinalOf(bono) : toNum(bono.valor_mercado)) || 0;
      } else {
        // Bonos regulares: usar _nominalOf
        nominal = Number(_nominalOf ? _nominalOf(bono) : 0);
      }
      
      // Determinar moneda del activo
      const monedaActivo = bono.Moneda || bono.moneda || (bono._rid && bono._rid.startsWith('USD') ? 'USD' : 'PEN');
      
      if (nominal > 0) {
        filas.push({
          vehiculo,
          nombre,
          tipoActivo: gprod === 'CLN' ? 'CLN' : (gprod || 'BONOS'),
          fecha: fechaVcto,
          pctAmort: 100,
          montoAmort: nominal,
          valorReman: 0,
          concepto: 'Vencimiento',
          tipo: gprod === 'CLN' ? 'CLN' : 'Bono',
          _moneda: monedaActivo
        });
      }
    });
    
    // === 4. VENCIMIENTOS DE CUENTA A PLAZO (DPF) ===
    let dpfFiltrados;
    if (ACTIVE_CRONO_CUR === 'TOTAL') {
      // Para TOTAL: incluir ambas monedas
      dpfFiltrados = [...(LAST_HOLDINGS['USD'] || []), ...(LAST_HOLDINGS['PEN'] || [])].filter(isCuentaAPlazo);
    } else {
      const CUR = (window.ACTIVE_CRONO_CUR === 'PEN' ? 'PEN' : 'USD');
      dpfFiltrados = (LAST_HOLDINGS[CUR] || []).filter(isCuentaAPlazo);
    }
    
    dpfFiltrados.forEach(dpf => {
      const monedaDPF = dpf.Moneda || dpf.moneda || (dpf._rid && dpf._rid.startsWith('USD') ? 'USD' : 'PEN');
      
      // Modificar nombre para incluir moneda si es TOTAL
      let nombre = dpf.nombre || '';
      if (ACTIVE_CRONO_CUR === 'TOTAL') {
        if (nombre.startsWith('DPF ')) {
          nombre = `DPF ${monedaDPF} ` + nombre.substring(4);
        } else if (nombre.startsWith('DPF')) {
          nombre = `DPF ${monedaDPF}` + nombre.substring(3);
        }
      }
      
      const vehiculo = dpf.vehiculo || 'DPF';
      const fechaVcto = dpf.fechavcto || dpf['Fecha Vencimiento'] || dpf.venc || dpf['fvencimientodet'] || dpf['f.vencimientodet'];
      
      if (!fechaVcto) return; // Si no tiene fecha de vencimiento, skip
      
      // Parsear fecha de vencimiento
      const fechaVctoDate = parseDMYStrict(fechaVcto);
      
      if (!fechaVctoDate || fechaVctoDate < fechaDatos) return; // Solo futuros
      
      let monto = (typeof _montoFinalOf === 'function' ? _montoFinalOf(dpf) : toNum(dpf.valor_mercado)) || 0;
      if (monto <= 0) return;
      
      // NO convertir - mostrar en moneda original
      
      filas.push({
        vehiculo,
        nombre,
        tipoActivo: 'DPF',
        fecha: fechaVctoDate,
        pctAmort: 100,
        montoAmort: monto,
        valorReman: 0,
        concepto: 'Vencimiento',
        tipo: 'DPF-venc',
        _moneda: monedaDPF
      });
    });
    
    // === 5. ORDENAR: Amortizables primero, luego No amortizables por fecha ===
    filas.sort((a, b) => {
      // Determinar si es amortizable
      const esAmortA = (a.tipo === 'Bono-amort' || a.tipo === 'Bono-venc' || a.tipo === 'Fondo');
      const esAmortB = (b.tipo === 'Bono-amort' || b.tipo === 'Bono-venc' || b.tipo === 'Fondo');
      
      // Primero: Amortizables vs No amortizables
      if (esAmortA && !esAmortB) return -1;
      if (!esAmortA && esAmortB) return 1;
      
      // Dentro de amortizables: por nombre, luego fecha
      if (esAmortA && esAmortB) {
        if (a.nombre !== b.nombre) return a.nombre.localeCompare(b.nombre);
        return a.fecha - b.fecha;
      }
      
      // Dentro de no amortizables: solo por fecha (menor a mayor)
      return a.fecha - b.fecha;
    });
    
    // === 5. RENDERIZAR (sin colores) ===
    const fmtDate = d => {
      const day = String(d.getDate()).padStart(2, '0');
      const month = String(d.getMonth() + 1).padStart(2, '0');
      const year = d.getFullYear();
      return `${day}/${month}/${year}`;
    };
    
    const fmtMoney = (v, moneda) => {
      const cur = moneda || ((window.ACTIVE_CRONO_CUR === 'PEN') ? 'PEN' : 'USD');
      const symbol = cur === 'PEN' ? 'S/' : '$';
      const n = Number(v) || 0;
      return n ? symbol + ' ' + n.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })
               : symbol + '0';
    };
    
    const fmtTipoActivo = (tipo) => {
      if (!tipo) return '';
      // Caso especial: CLN -> CLN (mantener mayúsculas)
      if (tipo.toUpperCase() === 'CLN') return 'CLN';
      // Caso especial: DPF -> DPF (mantener mayúsculas)
      if (tipo.toUpperCase() === 'DPF') return 'DPF';
      // Caso especial: BONOS -> Bono
      if (tipo.toUpperCase() === 'BONOS') return 'Bono';
      // Formato Nombre Propio: primera letra mayúscula, resto minúsculas
      return tipo.charAt(0).toUpperCase() + tipo.slice(1).toLowerCase();
    };
    
    let seccionActual = null;
    
    filas.forEach(f => {
      // Determinar sección
      const esAmort = (f.tipo === 'Bono-amort' || f.tipo === 'Bono-venc' || f.tipo === 'Fondo');
      const seccion = esAmort ? 'amortizable' : 'no-amortizable';
      
      // Si cambia la sección, agregar encabezado
      if (seccion !== seccionActual) {
        const trHeader = document.createElement('tr');
        trHeader.className = 'row-sub';
        trHeader.innerHTML = `
          <td colspan="7" class="left" style="font-weight:600;">
            ${seccion === 'amortizable' ? 'Activos Amortizables' : 'Activos No Amortizables'}
          </td>
        `;
        tbody.appendChild(trHeader);
        seccionActual = seccion;
      }
      
      const tr = document.createElement('tr');
      
      tr.innerHTML = `
        <td class="left">${f.nombre}</td>
        <td class="left">${fmtTipoActivo(f.tipoActivo)}</td>
        <td class="left">${f.concepto}</td>
        <td class="center">${fmtDate(f.fecha)}</td>
        <td class="center">${f.pctAmort.toFixed(2)}%</td>
        <td class="center">${fmtMoney(f.montoAmort, f._moneda)}</td>
        <td class="center">${fmtMoney(f.valorReman, f._moneda)}</td>
      `;
      
      tbody.appendChild(tr);
    });
  }

  function renderCronograma(){

    const table = document.querySelector('#tablaCupones'); 

    if (!table) return;

    // Funciones helper para formato
    const formatMoney = (n) => {
      const num = Number(n);
      if (!Number.isFinite(num) || num === 0) return '';
      const currency = ACTIVE_CRONO_CUR === 'PEN' ? 'PEN' : 'USD';
      const symbol = ACTIVE_CRONO_CUR === 'PEN' ? 'S/' : '$';
      return num.toLocaleString('en-US', {style:'currency', currency, maximumFractionDigits:0}).replace('PEN', symbol);
    };

    // Tipo de cambio para TOTAL
    const tcCrono = parseFloat(document.getElementById('tipoCambio')?.value) || 3.40;

    const hoy = new Date();
    const inicio = new Date(hoy.getFullYear(), hoy.getMonth(), 1);
    const fin    = new Date(hoy.getFullYear(), hoy.getMonth() + 12, 0, 23, 59, 59, 999);

    const headers = [];
    let cursor = new Date(inicio.getFullYear(), inicio.getMonth(), 1);
    for (let i = 0; i < 12; i++) {
      headers.push(claveMes(cursor));
      cursor = new Date(cursor.getFullYear(), cursor.getMonth() + 1, 1);
    }

    const { filas, totalesMes } = construirCupones12Meses(inicio, fin, headers);
    construirTablaAmortizaciones(); // AGREGAR ESTA LÍNEA
    const fullHeaders = ['Instrumento', ...headers, 'Total'];
    const filasConTotal = (() => {
      const filaTotal = { Instrumento: 'Flujo Bruto Total' };
      headers.forEach(h => filaTotal[h] = totalesMes[h] || 0);
      filaTotal.Total = headers.reduce((s,h)=> s + (totalesMes[h] || 0), 0);
      return [...filas, filaTotal];
    })();

    // Redefinir la cabecera completa
    const thead = table.querySelector('thead');
    if (thead) {
      const headerRow = fullHeaders.map((h, i) => 
        i === 0 ? `<th class="left">${h}</th>` : `<th class="num">${h}</th>`
      ).join('');
      thead.innerHTML = `<tr>${headerRow}</tr>`;
    } else {
      const headerRow = fullHeaders.map((h, i) => 
        i === 0 ? `<th class="left">${h}</th>` : `<th class="num">${h}</th>`
      ).join('');
      table.innerHTML = `<thead><tr>${headerRow}</tr></thead><tbody></tbody>`;
    }

    const tbody = table.querySelector('tbody'); 
    if (!tbody) return;
    tbody.innerHTML = '';

    // Si no hay nada, mostrar mensaje amigable
    if (filasConTotal.length === 0 || (filasConTotal.length === 1 && filasConTotal[0].Instrumento === 'Flujo Bruto Total' && filasConTotal[0].Total === 0)){
      const tr = document.createElement('tr');
      tr.innerHTML = `<td class="left" colspan="${fullHeaders.length}" style="color:#6b7280">No hay instrumentos elegibles en Posiciones.</td>`;
      tbody.appendChild(tr);
      return;
    }

    // Función para formatear con moneda específica
    const formatMoneyWithCur = (n, moneda) => {
      const num = Number(n);
      if (!Number.isFinite(num) || num === 0) return '';
      const symbol = moneda === 'PEN' ? 'S/' : '$';
      return symbol + num.toLocaleString('en-US', {maximumFractionDigits: 0});
    };
    
    // Renderizar filas
    filasConTotal.forEach((fila) => {
      const tr = document.createElement('tr');
      const esFilaTotal = fila.Instrumento === 'Flujo Bruto Total';
      
      if (esFilaTotal) {
        tr.style.background = '#F3F5FF';
      }
      
      // Moneda de la fila: para fila total usar USD, para activos usar su moneda original
      const monedaFila = esFilaTotal ? 'USD' : (fila._moneda || 'USD');
      
      let htmlRow = '';
      fullHeaders.forEach((h, i) => {
        if (i === 0) {
          htmlRow += `<td class="left">${fila[h] || ''}</td>`;
        } else {
          const valor = fila[h] || 0;
          const contenido = formatMoneyWithCur(valor, monedaFila);
          if (esFilaTotal) {
            htmlRow += `<td class="num"><b>${contenido}</b></td>`;
          } else {
            htmlRow += `<td class="num">${contenido}</td>`;
          }
        }
      });
      
      tr.innerHTML = htmlRow;
      tbody.appendChild(tr);
    });

    // Disclaimer bajo la tabla (una sola vez)
    const wrap = document.querySelector('#tablaCupones')?.closest('.table-wrapper')?.parentElement;
    if (wrap && !document.getElementById('cuponesDisclaimer')) {
      const note = document.createElement('div');
      note.id = 'cuponesDisclaimer';
      note.className = 'small';
      note.style.marginTop = '6px';
      note.innerHTML = '<em>Montos estimados. Por días útiles y feriados, la fecha efectiva de pago puede variar.</em>';
      wrap.appendChild(note);
    }
  }

  // Toggle tabla/gráfico
  (function wirePMToggles(){
    const bT = document.getElementById('btnPMTable');
    const bC = document.getElementById('btnPMChart');
    const labelsContainer = document.getElementById('pmShowLabelsContainer');
    if (bT && !bT.dataset.bound){
      bT.addEventListener('click', ()=>{
        document.getElementById('mmViewTable')?.classList.add('active');
        document.getElementById('mmViewChart')?.classList.remove('active');
        if (labelsContainer) labelsContainer.style.display = 'none';
        if (pmChart){ pmChart.destroy(); pmChart=null; }
      });
      bT.dataset.bound='1';
    }
    if (bC && !bC.dataset.bound){
      bC.addEventListener('click', ()=>{
        document.getElementById('mmViewTable')?.classList.remove('active');
        document.getElementById('mmViewChart')?.classList.add('active');
        if (labelsContainer) labelsContainer.style.display = 'block';
        wirePMChartFilters();   // <<< boxed
        renderPMChart();        // <<< gráfico horizontal por secciones
      });
      bC.dataset.bound='1';
    }
  })();

  // Al cambiar el perfil, refrescar tabla y, si procede, el gráfico
  const _mmSel = document.getElementById('mmPerfilSel');
  if (_mmSel && !_mmSel.dataset.bound){
    _mmSel.addEventListener('change', ()=>{
      renderModelosTable();
      if (document.getElementById('mmViewChart')?.classList.contains('active')) renderPMChart();
    });
    _mmSel.dataset.bound='1';
  }

  // === Modal Cargar CSVs ===
  function updateCsvButtonsState(){
    // Asesor360
    const btnAsesor360 = document.getElementById('btnCsvAsesor360');
    if (btnAsesor360) {
      const isLoaded = (typeof A360 !== 'undefined' && A360 && A360.length > 0) || 
                       (document.getElementById('csvInfo')?.textContent?.trim() || '').length > 0;
      btnAsesor360.classList.toggle('loaded', isLoaded);
    }
        // Activos
    const btnActivos = document.getElementById('btnCsvActivos');
    if (btnActivos) {
      const isLoaded = (typeof ACT !== 'undefined' && ACT.loaded) ||
                       (document.getElementById('actInfo')?.textContent?.trim() || '').length > 0;
      btnActivos.classList.toggle('loaded', isLoaded);
    }
        // Otros Activos
    const btnOtrosActivos = document.getElementById('btnCsvOtrosActivos');
    if (btnOtrosActivos) {
      const isLoaded = (typeof ACTIVOS2 !== 'undefined' && ACTIVOS2 && ACTIVOS2.length > 0) ||
                       (document.getElementById('otrosActInfo')?.textContent?.trim() || '').length > 0;
      btnOtrosActivos.classList.toggle('loaded', isLoaded);
    }
    // Modelos
    const btnModelos = document.getElementById('btnCsvModelos');
    if (btnModelos) {
      const isLoaded = (typeof MODELOS !== 'undefined' && Object.keys(MODELOS).length > 0) ||
                       (document.getElementById('modelInfo')?.textContent?.trim() || '').length > 0;
      btnModelos.classList.toggle('loaded', isLoaded);
    }
    // Bonos
    const btnBonos = document.getElementById('btnCsvBonos');
    if (btnBonos) {
      const isLoaded = (typeof BONDS !== 'undefined' && BONDS && BONDS.length > 0) ||
                       (document.getElementById('bondsInfo')?.textContent?.trim() || '').length > 0;
      btnBonos.classList.toggle('loaded', isLoaded);
    }
    
    // Amortizaciones
    const btnAmort = document.getElementById('btnCsvAmort');
    if (btnAmort) {
      const isLoaded = (typeof AMORTS_BY_ISIN !== 'undefined' && AMORTS_BY_ISIN && Object.keys(AMORTS_BY_ISIN).length > 0) ||
                       (document.getElementById('amortInfo')?.textContent?.trim() || '').length > 0;
      btnAmort.classList.toggle('loaded', isLoaded);
    }
    
    // Límites
    const btnLimites = document.getElementById('btnCsvLimites');
    if (btnLimites) {
      const isLoaded = (typeof LIMITS !== 'undefined' && LIMITS && LIMITS.length > 0) ||
                       (document.getElementById('limitesInfo')?.textContent?.trim() || '').length > 0;
      btnLimites.classList.toggle('loaded', isLoaded);
    }
    
    // Ratings
    const btnRatings = document.getElementById('btnCsvRatings');
    if (btnRatings) {
      const isLoaded = (typeof RATINGS !== 'undefined' && RATINGS && RATINGS.loaded) ||
                       (document.getElementById('ratingsInfo')?.textContent?.trim() || '').length > 0;
      btnRatings.classList.toggle('loaded', isLoaded);
    }
    
    // Sectores
    const btnSectores = document.getElementById('btnCsvSectores');
    if (btnSectores) {
      const isLoaded = (typeof SECTORES !== 'undefined' && SECTORES && SECTORES.loaded) ||
                       (document.getElementById('sectoresInfo')?.textContent?.trim() || '').length > 0;
      btnSectores.classList.toggle('loaded', isLoaded);
    }
    
    // Holdings
    const btnHoldings = document.getElementById('btnCsvHoldings');
    if (btnHoldings) {
      const isLoaded = (typeof HOLDINGS !== 'undefined' && HOLDINGS && HOLDINGS.loaded) ||
                       (document.getElementById('holdingsInfo')?.textContent?.trim() || '').length > 0;
      btnHoldings.classList.toggle('loaded', isLoaded);
    }
    
    // Región RV
    const btnRegionRV = document.getElementById('btnCsvRegionRV');
    if (btnRegionRV) {
      const isLoaded = (typeof REGION_RV !== 'undefined' && REGION_RV && REGION_RV.loaded) ||
                       (document.getElementById('regionRVInfo')?.textContent?.trim() || '').length > 0;
      btnRegionRV.classList.toggle('loaded', isLoaded);
    }
  }
  
  function openCargarCSVsModal(){
    const clave = prompt('Ingrese la clave de acceso:');
    if (clave !== 'Estrategia_2025') {
      alert('Clave incorrecta');
      return;
    }
    const m = document.getElementById('modalCargarCSVs');
    if (!m) return;
    updateCsvButtonsState();
    m.classList.add('show');
  }
  function closeCargarCSVsModal(){
    document.getElementById('modalCargarCSVs')?.classList.remove('show');
  }
  document.getElementById('btnCargarCSVs')?.addEventListener('click', openCargarCSVsModal);
  document.getElementById('cargarCSVsClose')?.addEventListener('click', closeCargarCSVsModal);
  document.getElementById('modalCargarCSVs')?.addEventListener('click', (e)=>{ if (e.target.id==='modalCargarCSVs') closeCargarCSVsModal(); });

  // === MODAL DE LÍMITES ===
  document.getElementById('btnLimites')?.addEventListener('click', openLimitesModal);
  document.getElementById('limitesClose')?.addEventListener('click', closeLimitesModal);
  document.getElementById('modalLimites')?.addEventListener('click', (e) => {
    if (e.target.id === 'modalLimites') closeLimitesModal();
  });
  
  function openLimitesModal() {
    evaluateLimits();
    renderLimitesModal();
    document.getElementById('modalLimites')?.classList.add('show');
  }
  
  function closeLimitesModal() {
    document.getElementById('modalLimites')?.classList.remove('show');
  }
  
  // === MODAL: Exceso de Concentración (individual) ===
  function openExcesoConcentracionModal(nombreActivo, moneda, violaciones) {
    const tbody = document.getElementById('excesoConcentracionBody');
    if (!tbody) return;
    
    // Renderizar tabla
    tbody.innerHTML = violaciones.map(v => `
      <tr>
        <td class="left">${v.nombre}</td>
        <td class="center">${v.tipo === 'I' ? 'Individual' : 'Agregado'}</td>
        <td class="center">${v.limite.toFixed(2)}%</td>
        <td class="center">${v.valor.toFixed(2)}%</td>
      </tr>
    `).join('');
    
    // Mostrar modal
    document.getElementById('modalExcesoConcentracion')?.classList.add('show');
  }
  
  function closeExcesoConcentracionModal() {
    document.getElementById('modalExcesoConcentracion')?.classList.remove('show');
  }
  
  // Event listeners
  document.getElementById('excesoConcentracionClose')?.addEventListener('click', closeExcesoConcentracionModal);
  document.getElementById('modalExcesoConcentracion')?.addEventListener('click', (e) => {
    if (e.target.id === 'modalExcesoConcentracion') closeExcesoConcentracionModal();
  });
  
  function renderLimitesModal() {
    const violados = (LIMITS_RESULTS || []).filter(r => !r.ok);
    const todosOk = violados.length === 0;
    
    // Mostrar/ocultar secciones
    const excedidosContainer = document.getElementById('limitesExcedidosContainer');
    const okMessage = document.getElementById('limitesOkMessage');
    
    if (todosOk) {
      excedidosContainer.style.display = 'none';
      okMessage.style.display = 'block';
    } else {
      excedidosContainer.style.display = 'block';
      okMessage.style.display = 'none';
      
      // Obtener tipo de cambio para dolarizar PEN
      const tcInput = document.getElementById('tipoCambio');
      const tc = parseFloat(tcInput?.value) || 3.40;
      
      // Calcular total del portafolio (USD + PEN dolarizado)
      const totalUSD = (LAST_HOLDINGS.USD || []).reduce((sum, r) => {
        const b = toNum(r.valor_mercado);
        const e = edits.USD ? (edits.USD.get(r._rid) || 0) : 0;
        return sum + b + e;
      }, 0);
      const totalPENDolarizado = (LAST_HOLDINGS.PEN || []).reduce((sum, r) => {
        const b = toNum(r.valor_mercado);
        const e = edits.PEN ? (edits.PEN.get(r._rid) || 0) : 0;
        return sum + (b + e) / tc;
      }, 0);
      const totalCartera = totalUSD + totalPENDolarizado;
      
      // Renderizar tabla de excedidos
      const tbody = document.getElementById('limitesExcedidosBody');
      tbody.innerHTML = '';
      
      violados.forEach(lim => {
        // Fila del límite
        const tr = document.createElement('tr');
        const exceso = lim.valor - lim.limite;
        const ambito = lim.tipo === 'I' ? 'Individual' : 'Agregado';
        
        tr.style.cursor = 'pointer';
        tr.innerHTML = `
          <td class="left" style="font-weight:600;">
            <span id="toggle-${lim.i}" style="display:inline-block;width:6px;font-size:7.5px;text-align:center;margin-right:6px;color:#060E46;vertical-align:3px;">▶</span>
            ${lim.name}
          </td>
          <td class="center">${ambito}</td>
          <td class="center">${lim.limite.toFixed(2)}%</td>
          <td class="center">${lim.valor.toFixed(2)}%</td>
          <td class="center" style="color:#9694FF;">+${exceso.toFixed(2)}%</td>
        `;
        tbody.appendChild(tr);
        
        // Event listener para toggle
        tr.addEventListener('click', () => {
          const activosRows = document.querySelectorAll(`.activos-limite-${lim.i}`);
          const toggle = document.getElementById(`toggle-${lim.i}`);
          const isVisible = activosRows[0]?.style.display !== 'none';
          
          activosRows.forEach(row => {
            row.style.display = isVisible ? 'none' : 'table-row';
          });
          
          toggle.textContent = isVisible ? '▶' : '▼';
        });
        
        // Filas de activos incluidos (USD y PEN)
        const limite = LIMITS[lim.i];
        const activos = [];
        
        // Procesar USD
        (LAST_HOLDINGS.USD || []).forEach(row => {
          const enriched = enrichRow(row, 'USD');
          if (matchesLimit(limite.filters, enriched) && !isException(limite, enriched)) {
            const base = toNum(row.valor_mercado);
            const edit = edits.USD ? (edits.USD.get(row._rid) || 0) : 0;
            const valor = base + edit;
            const peso = totalCartera > 0 ? (valor / totalCartera) * 100 : 0;
            
            if (peso > 0.01) {
              if (lim.tipo === 'I') {
                if (peso > lim.limite) {
                  activos.push({ nombre: row.nombre, peso, moneda: 'USD' });
                }
              } else {
                activos.push({ nombre: row.nombre, peso, moneda: 'USD' });
              }
            }
          }
        });
        
        // Procesar PEN (dolarizado)
        (LAST_HOLDINGS.PEN || []).forEach(row => {
          const enriched = enrichRow(row, 'PEN');
          if (matchesLimit(limite.filters, enriched) && !isException(limite, enriched)) {
            const base = toNum(row.valor_mercado);
            const edit = edits.PEN ? (edits.PEN.get(row._rid) || 0) : 0;
            const valor = base + edit;
            const valorDolarizado = valor / tc;
            const peso = totalCartera > 0 ? (valorDolarizado / totalCartera) * 100 : 0;
            
            if (peso > 0.01) {
              if (lim.tipo === 'I') {
                if (peso > lim.limite) {
                  activos.push({ nombre: row.nombre, peso, moneda: 'PEN' });
                }
              } else {
                activos.push({ nombre: row.nombre, peso, moneda: 'PEN' });
              }
            }
          }
        });
        
        // Ordenar por peso descendente
        activos.sort((a, b) => b.peso - a.peso);
        
        // Renderizar cada activo como fila con sangría (oculto por defecto)
        activos.forEach(activo => {
          const trActivo = document.createElement('tr');
          trActivo.classList.add(`activos-limite-${lim.i}`);
          trActivo.style.display = 'none'; // Oculto por defecto
          trActivo.innerHTML = `
            <td class="left" style="padding-left:32px;font-size:12px;">${activo.nombre}</td>
            <td></td>
            <td></td>
            <td class="center" style="font-size:12px;">${activo.peso.toFixed(2)}%</td>
            <td></td>
          `;
          tbody.appendChild(trActivo);
        });
      });
    }
  }

  // Actualizar estado inicial de botones después de que todo esté cargado
  setTimeout(() => {
    if (typeof updateCsvButtonsState === 'function') updateCsvButtonsState();
  }, 500);

  // === FIX UBICACIÓN DE VISTAS: mueve Reporte y Centro de datos al contenedor principal ===
  (function fixViewsPlacement(){
    // Detecta el contenedor donde ya están Dashboard/Posiciones
    const main =
      document.querySelector('main .views') ||
      document.querySelector('main#content') ||
      document.querySelector('#content') ||
      document.querySelector('main#main') ||
      document.querySelector('main');

    if (!main) return;

    const views = [
      document.getElementById('view-reporte'),
      document.getElementById('view-portafolio'),
      document.getElementById('view-renta-fija'),
      document.getElementById('view-renta-variable'),
      document.getElementById('view-datos'),
      document.getElementById('view-data')
    ].filter(Boolean);

    views.forEach(v => {
      if (!main.contains(v)) main.appendChild(v);
    });
  })();

  // Guardar referencia a evaluateLimits original
  const originalEvaluateLimits = (typeof evaluateLimits !== 'undefined') ? evaluateLimits : null;
  
  // === FUNCIÓN: Agregar círculos morados en columna "!" ===
  function updateLimitViolationIndicators() {
    // Evaluar límites antes de actualizar círculos
    if (typeof evaluateLimits === 'function') {
      evaluateLimits();
    }
    
    // Si el modal de límites está abierto, re-renderizarlo
    const modal = document.getElementById('modalLimites');
    const box = modal?.querySelector('.box');
    const isOpen = box && window.getComputedStyle(box).display !== 'none';
    if (isOpen) {
      renderLimitesModal();
    }
    
    if (!LIMITS_RESULTS || !LAST_HOLDINGS) return;
    
    // Obtener límites violados (tanto Individuales como Sumatorios)
    const violados = LIMITS_RESULTS.filter(r => !r.ok);
    
    // Obtener tipo de cambio para calcular total del portafolio
    const tcInput = document.getElementById('tipoCambio');
    const tc = parseFloat(tcInput?.value) || 3.40;
    
    // Calcular total del portafolio (USD + PEN dolarizado) - SIEMPRE usar este denominador
    const totalUSD = (LAST_HOLDINGS.USD || []).reduce((sum, r) => {
      const b = toNum(r.valor_mercado);
      const e = edits.USD ? (edits.USD.get(r._rid) || 0) : 0;
      return sum + b + e;
    }, 0);
    const totalPENDolarizado = (LAST_HOLDINGS.PEN || []).reduce((sum, r) => {
      const b = toNum(r.valor_mercado);
      const e = edits.PEN ? (edits.PEN.get(r._rid) || 0) : 0;
      return sum + (b + e) / tc;
    }, 0);
    const totalCartera = totalUSD + totalPENDolarizado;
    
    // Crear mapa de violaciones por activo
    const violacionesPorActivo = new Map(); // { nombreActivo-moneda: [limite1, limite2, ...] }
    
    // Procesar todos los límites violados (I y S)
    violados.forEach(lim => {
      const limite = LIMITS[lim.i];
      
      // Evaluar ambas monedas sobre el total del portafolio
      ['USD', 'PEN'].forEach(cur => {
        const holdings = LAST_HOLDINGS[cur] || [];
        holdings.forEach(row => {
          const enriched = enrichRow(row, cur);
          if (matchesLimit(limite.filters, enriched) && !isException(limite, enriched)) {
            const base = toNum(row.valor_mercado);
            const edit = edits[cur] ? (edits[cur].get(row._rid) || 0) : 0;
            const valor = base + edit;
            
            // Dolarizar si es PEN para calcular peso sobre Total
            const valorDolarizado = cur === 'PEN' ? valor / tc : valor;
            const peso = totalCartera > 0 ? (valorDolarizado / totalCartera) * 100 : 0;
            
            // Para límites Individuales: solo agregar si este activo excede el límite
            // Para límites Sumatorios: agregar todos los activos que contribuyen al sumatorio
            const debeAgregar = (lim.tipo === 'I') ? (peso > lim.limite) : true;
            
            if (debeAgregar) {
              const key = `${row.nombre?.trim()}-${cur}`;
              if (!violacionesPorActivo.has(key)) {
                violacionesPorActivo.set(key, []);
              }
              violacionesPorActivo.get(key).push({
                nombre: lim.name,
                tipo: lim.tipo,
                limite: lim.limite,
                valor: lim.tipo === 'I' ? peso : lim.valor, // Para I: peso del activo, para S: valor total del sumatorio
                pesoActivo: peso // Siempre incluir el peso del activo
              });
            }
          }
        });
      });
    });
    
    // Actualizar las tablas de Posiciones (USD, PEN y Total)
    const tables = document.querySelectorAll('table');
    tables.forEach(table => {
      const headers = Array.from(table.querySelectorAll('thead th'));
      const exclamacionIdx = headers.findIndex(h => h.textContent.trim() === '!');
      
      if (exclamacionIdx >= 0) {
        const filas = table.querySelectorAll('tbody tr');
        const tableId = (table.id || '').toLowerCase();
        const isTablaTotal = tableId.includes('total');
        const isTablaPEN = tableId.includes('pen');
        
        filas.forEach(fila => {
          const celdas = fila.querySelectorAll('td');
          const nombreCelda = celdas[0];
          const exclamacionCelda = celdas[exclamacionIdx];
          
          if (nombreCelda && exclamacionCelda) {
            const nombre = nombreCelda.textContent.trim();
            
            // Detectar moneda de la fila
            let cur;
            if (isTablaTotal) {
              // En tabla Total: buscar moneda en el data-cur de los inputs de la fila
              const inputEnFila = fila.querySelector('input[data-cur]');
              cur = inputEnFila?.dataset?.cur || 'USD';
            } else {
              cur = isTablaPEN ? 'PEN' : 'USD';
            }
            
            const key = `${nombre}-${cur}`;
            
            if (violacionesPorActivo.has(key)) {
              const violaciones = violacionesPorActivo.get(key);
              
              // Crear tooltip con información
              const tooltipText = violaciones.map(v => {
                if (v.tipo === 'I') {
                  return `${v.nombre}: ${v.pesoActivo.toFixed(2)}% / ${v.limite.toFixed(2)}%`;
                } else {
                  return `${v.nombre} (Agregado): ${v.valor.toFixed(2)}% / ${v.limite.toFixed(2)}% [Este activo: ${v.pesoActivo.toFixed(2)}%]`;
                }
              }).join('\n');
              
              exclamacionCelda.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100%;"><div class="limit-violation-indicator" style="width:7px;height:7px;border-radius:50%;background-color:#9694FF;cursor:pointer;flex-shrink:0;" title="' + tooltipText + '" data-nombre="' + nombre + '" data-moneda="' + cur + '">&nbsp;</div></div>';
              
              // Agregar event listener para doble clic
              const circulo = exclamacionCelda.querySelector('.limit-violation-indicator');
              if (circulo) {
                circulo.addEventListener('dblclick', () => {
                  openExcesoConcentracionModal(nombre, cur, violaciones);
                });
              }
            } else {
              exclamacionCelda.innerHTML = '';
            }
          }
        });
      }
    });
  }

  // === MENÚ TIPO ÁRBOL - REPORTE ===
  (function() {
    const subtabs = document.querySelectorAll('.tab-child');
    
    // Manejar clics en subpestañas
    subtabs?.forEach(subtab => {
      subtab.addEventListener('click', (e) => {
        e.stopPropagation();
        
        // Remover active de TODAS las subpestañas
        subtabs.forEach(s => s.classList.remove('active'));
        
        // Activar esta subpestaña
        subtab.classList.add('active');
        
        // Activar "Reporte" (sombreado)
        const tabReporte = document.getElementById('tabReporte');
        tabReporte?.classList.add('active');
        
        // Remover active de tabs principales
        document.querySelectorAll('.tab').forEach(t => {
          if (!t.classList.contains('tab-child') && !t.classList.contains('tab-label')) {
            t.classList.remove('active');
          }
        });
        
        // Mostrar vista correspondiente
        const tabName = subtab.dataset.tab;
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(`view-${tabName}`)?.classList.add('active');
        
        // Renderizar contenido específico de cada subpestaña
        if (tabName === 'reporte') {
          try { renderCronograma(); } catch(e){ console.error('[Reporte] renderCronograma', e); }
        }
      });
    });
    
    // Clic en "Reporte" → activar "Portafolio Final"
    const tabReporte = document.getElementById('tabReporte');
    tabReporte?.addEventListener('click', () => {
      const portafolioFinal = document.querySelector('[data-tab="portafolio"].tab-child');
      portafolioFinal?.click();
    });
  })();

  // === NAVEGACION CON FLECHAS EN SIDEBAR ===
  document.addEventListener('keydown', function(e) {
    // Solo procesar si no estamos en un input/textarea
    const activeEl = document.activeElement;
    if (activeEl && (activeEl.tagName === 'INPUT' || activeEl.tagName === 'TEXTAREA' || activeEl.isContentEditable)) {
      return;
    }
    
    // Solo flechas arriba/abajo
    if (e.key !== 'ArrowUp' && e.key !== 'ArrowDown') return;
    
    // Obtener todos los tabs navegables del sidebar (excluyendo tab-label que es solo título)
    const allTabs = Array.from(document.querySelectorAll('.sidebar .tabs .tab:not(.tab-label)'));
    if (allTabs.length === 0) return;
    
    // Encontrar el tab activo actual
    let currentIndex = allTabs.findIndex(t => t.classList.contains('active'));
    if (currentIndex === -1) currentIndex = 0;
    
    // Calcular nuevo índice (sin ciclar)
    let newIndex;
    if (e.key === 'ArrowDown') {
      newIndex = Math.min(currentIndex + 1, allTabs.length - 1);
    } else {
      newIndex = Math.max(currentIndex - 1, 0);
    }
    
    // Si no hay cambio, solo prevenir scroll
    if (newIndex === currentIndex) {
      e.preventDefault();
      return;
    }
    
    // Simular click en el nuevo tab
    allTabs[newIndex].click();
    
    // Quitar el focus para evitar outline negro
    allTabs[newIndex].blur();
    
    // Prevenir scroll de la página
    e.preventDefault();
  });

  </script>
</body>
</html>